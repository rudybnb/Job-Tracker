var IS=Object.defineProperty;var Ux=e=>{throw TypeError(e)};var DS=(e,t,r)=>t in e?IS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var be=(e,t,r)=>DS(e,typeof t!="symbol"?t+"":t,r),r0=(e,t,r)=>t.has(e)||Ux("Cannot "+r);var W=(e,t,r)=>(r0(e,t,"read from private field"),r?r.call(e):t.get(e)),Te=(e,t,r)=>t.has(e)?Ux("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ye=(e,t,r,n)=>(r0(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Re=(e,t,r)=>(r0(e,t,"access private method"),r);var fc=(e,t,r,n)=>({set _(s){ye(e,t,s,r)},get _(){return W(e,t,n)}});function OS(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function qv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qv={exports:{}},cd={},Jv={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gl=Symbol.for("react.element"),LS=Symbol.for("react.portal"),MS=Symbol.for("react.fragment"),BS=Symbol.for("react.strict_mode"),US=Symbol.for("react.profiler"),$S=Symbol.for("react.provider"),WS=Symbol.for("react.context"),HS=Symbol.for("react.forward_ref"),VS=Symbol.for("react.suspense"),zS=Symbol.for("react.memo"),GS=Symbol.for("react.lazy"),$x=Symbol.iterator;function KS(e){return e===null||typeof e!="object"?null:(e=$x&&e[$x]||e["@@iterator"],typeof e=="function"?e:null)}var Zv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e1=Object.assign,t1={};function mo(e,t,r){this.props=e,this.context=t,this.refs=t1,this.updater=r||Zv}mo.prototype.isReactComponent={};mo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};mo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function r1(){}r1.prototype=mo.prototype;function Mh(e,t,r){this.props=e,this.context=t,this.refs=t1,this.updater=r||Zv}var Bh=Mh.prototype=new r1;Bh.constructor=Mh;e1(Bh,mo.prototype);Bh.isPureReactComponent=!0;var Wx=Array.isArray,n1=Object.prototype.hasOwnProperty,Uh={current:null},s1={key:!0,ref:!0,__self:!0,__source:!0};function a1(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)n1.call(t,n)&&!s1.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Gl,type:e,key:i,ref:o,props:s,_owner:Uh.current}}function YS(e,t){return{$$typeof:Gl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $h(e){return typeof e=="object"&&e!==null&&e.$$typeof===Gl}function XS(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Hx=/\/+/g;function n0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?XS(""+e.key):t.toString(36)}function Gc(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Gl:case LS:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+n0(o,0):n,Wx(s)?(r="",e!=null&&(r=e.replace(Hx,"$&/")+"/"),Gc(s,t,r,"",function(u){return u})):s!=null&&($h(s)&&(s=YS(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Hx,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Wx(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+n0(i,l);o+=Gc(i,t,r,c,s)}else if(c=KS(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+n0(i,l++),o+=Gc(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function hc(e,t,r){if(e==null)return e;var n=[],s=0;return Gc(e,n,"","",function(i){return t.call(r,i,s++)}),n}function qS(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var mr={current:null},Kc={transition:null},QS={ReactCurrentDispatcher:mr,ReactCurrentBatchConfig:Kc,ReactCurrentOwner:Uh};function i1(){throw Error("act(...) is not supported in production builds of React.")}Oe.Children={map:hc,forEach:function(e,t,r){hc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return hc(e,function(){t++}),t},toArray:function(e){return hc(e,function(t){return t})||[]},only:function(e){if(!$h(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Oe.Component=mo;Oe.Fragment=MS;Oe.Profiler=US;Oe.PureComponent=Mh;Oe.StrictMode=BS;Oe.Suspense=VS;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QS;Oe.act=i1;Oe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=e1({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Uh.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)n1.call(t,c)&&!s1.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Gl,type:e.type,key:s,ref:i,props:n,_owner:o}};Oe.createContext=function(e){return e={$$typeof:WS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$S,_context:e},e.Consumer=e};Oe.createElement=a1;Oe.createFactory=function(e){var t=a1.bind(null,e);return t.type=e,t};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(e){return{$$typeof:HS,render:e}};Oe.isValidElement=$h;Oe.lazy=function(e){return{$$typeof:GS,_payload:{_status:-1,_result:e},_init:qS}};Oe.memo=function(e,t){return{$$typeof:zS,type:e,compare:t===void 0?null:t}};Oe.startTransition=function(e){var t=Kc.transition;Kc.transition={};try{e()}finally{Kc.transition=t}};Oe.unstable_act=i1;Oe.useCallback=function(e,t){return mr.current.useCallback(e,t)};Oe.useContext=function(e){return mr.current.useContext(e)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(e){return mr.current.useDeferredValue(e)};Oe.useEffect=function(e,t){return mr.current.useEffect(e,t)};Oe.useId=function(){return mr.current.useId()};Oe.useImperativeHandle=function(e,t,r){return mr.current.useImperativeHandle(e,t,r)};Oe.useInsertionEffect=function(e,t){return mr.current.useInsertionEffect(e,t)};Oe.useLayoutEffect=function(e,t){return mr.current.useLayoutEffect(e,t)};Oe.useMemo=function(e,t){return mr.current.useMemo(e,t)};Oe.useReducer=function(e,t,r){return mr.current.useReducer(e,t,r)};Oe.useRef=function(e){return mr.current.useRef(e)};Oe.useState=function(e){return mr.current.useState(e)};Oe.useSyncExternalStore=function(e,t,r){return mr.current.useSyncExternalStore(e,t,r)};Oe.useTransition=function(){return mr.current.useTransition()};Oe.version="18.3.1";Jv.exports=Oe;var b=Jv.exports;const bs=qv(b),o1=OS({__proto__:null,default:bs},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JS=b,ZS=Symbol.for("react.element"),ej=Symbol.for("react.fragment"),tj=Object.prototype.hasOwnProperty,rj=JS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nj={key:!0,ref:!0,__self:!0,__source:!0};function l1(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)tj.call(t,n)&&!nj.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:ZS,type:e,key:i,ref:o,props:s,_owner:rj.current}}cd.Fragment=ej;cd.jsx=l1;cd.jsxs=l1;Qv.exports=cd;var a=Qv.exports,c1={exports:{}},Wr={},u1={exports:{}},d1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,te){var ue=V.length;V.push(te);e:for(;0<ue;){var xe=ue-1>>>1,L=V[xe];if(0<s(L,te))V[xe]=te,V[ue]=L,ue=xe;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var te=V[0],ue=V.pop();if(ue!==te){V[0]=ue;e:for(var xe=0,L=V.length,G=L>>>1;xe<G;){var U=2*(xe+1)-1,A=V[U],H=U+1,Y=V[H];if(0>s(A,ue))H<L&&0>s(Y,A)?(V[xe]=Y,V[H]=ue,xe=H):(V[xe]=A,V[U]=ue,xe=U);else if(H<L&&0>s(Y,ue))V[xe]=Y,V[H]=ue,xe=H;else break e}}return te}function s(V,te){var ue=V.sortIndex-te.sortIndex;return ue!==0?ue:V.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,f=3,p=!1,x=!1,h=!1,g=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var te=r(u);te!==null;){if(te.callback===null)n(u);else if(te.startTime<=V)n(u),te.sortIndex=te.expirationTime,t(c,te);else break;te=r(u)}}function N(V){if(h=!1,y(V),!x)if(r(c)!==null)x=!0,X(S);else{var te=r(u);te!==null&&ee(N,te.startTime-V)}}function S(V,te){x=!1,h&&(h=!1,w(E),E=-1),p=!0;var ue=f;try{for(y(te),m=r(c);m!==null&&(!(m.expirationTime>te)||V&&!M());){var xe=m.callback;if(typeof xe=="function"){m.callback=null,f=m.priorityLevel;var L=xe(m.expirationTime<=te);te=e.unstable_now(),typeof L=="function"?m.callback=L:m===r(c)&&n(c),y(te)}else n(c);m=r(c)}if(m!==null)var G=!0;else{var U=r(u);U!==null&&ee(N,U.startTime-te),G=!1}return G}finally{m=null,f=ue,p=!1}}var C=!1,j=null,E=-1,k=5,F=-1;function M(){return!(e.unstable_now()-F<k)}function R(){if(j!==null){var V=e.unstable_now();F=V;var te=!0;try{te=j(!0,V)}finally{te?z():(C=!1,j=null)}}else C=!1}var z;if(typeof v=="function")z=function(){v(R)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,K=B.port2;B.port1.onmessage=R,z=function(){K.postMessage(null)}}else z=function(){g(R,0)};function X(V){j=V,C||(C=!0,z())}function ee(V,te){E=g(function(){V(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,X(S))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(V){switch(f){case 1:case 2:case 3:var te=3;break;default:te=f}var ue=f;f=te;try{return V()}finally{f=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,te){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ue=f;f=V;try{return te()}finally{f=ue}},e.unstable_scheduleCallback=function(V,te,ue){var xe=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?xe+ue:xe):ue=xe,V){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=ue+L,V={id:d++,callback:te,priorityLevel:V,startTime:ue,expirationTime:L,sortIndex:-1},ue>xe?(V.sortIndex=ue,t(u,V),r(c)===null&&V===r(u)&&(h?(w(E),E=-1):h=!0,ee(N,ue-xe))):(V.sortIndex=L,t(c,V),x||p||(x=!0,X(S))),V},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(V){var te=f;return function(){var ue=f;f=te;try{return V.apply(this,arguments)}finally{f=ue}}}})(d1);u1.exports=d1;var sj=u1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aj=b,Ur=sj;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f1=new Set,dl={};function za(e,t){Ji(e,t),Ji(e+"Capture",t)}function Ji(e,t){for(dl[e]=t,e=0;e<t.length;e++)f1.add(t[e])}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sf=Object.prototype.hasOwnProperty,ij=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vx={},zx={};function oj(e){return sf.call(zx,e)?!0:sf.call(Vx,e)?!1:ij.test(e)?zx[e]=!0:(Vx[e]=!0,!1)}function lj(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function cj(e,t,r,n){if(t===null||typeof t>"u"||lj(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xr(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xt[e]=new xr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xt[t]=new xr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xt[e]=new xr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xt[e]=new xr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xt[e]=new xr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xt[e]=new xr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xt[e]=new xr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xt[e]=new xr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xt[e]=new xr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wh=/[\-:]([a-z])/g;function Hh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wh,Hh);Xt[t]=new xr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wh,Hh);Xt[t]=new xr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wh,Hh);Xt[t]=new xr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xt[e]=new xr(e,1,!1,e.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new xr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xt[e]=new xr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vh(e,t,r,n){var s=Xt.hasOwnProperty(t)?Xt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(cj(t,r,s,n)&&(r=null),n||s===null?oj(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xs=aj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mc=Symbol.for("react.element"),ci=Symbol.for("react.portal"),ui=Symbol.for("react.fragment"),zh=Symbol.for("react.strict_mode"),af=Symbol.for("react.profiler"),h1=Symbol.for("react.provider"),m1=Symbol.for("react.context"),Gh=Symbol.for("react.forward_ref"),of=Symbol.for("react.suspense"),lf=Symbol.for("react.suspense_list"),Kh=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),x1=Symbol.for("react.offscreen"),Gx=Symbol.iterator;function _o(e){return e===null||typeof e!="object"?null:(e=Gx&&e[Gx]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,s0;function Wo(e){if(s0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);s0=t&&t[1]||""}return`
`+s0+e}var a0=!1;function i0(e,t){if(!e||a0)return"";a0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{a0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Wo(e):""}function uj(e){switch(e.tag){case 5:return Wo(e.type);case 16:return Wo("Lazy");case 13:return Wo("Suspense");case 19:return Wo("SuspenseList");case 0:case 2:case 15:return e=i0(e.type,!1),e;case 11:return e=i0(e.type.render,!1),e;case 1:return e=i0(e.type,!0),e;default:return""}}function cf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ui:return"Fragment";case ci:return"Portal";case af:return"Profiler";case zh:return"StrictMode";case of:return"Suspense";case lf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case m1:return(e.displayName||"Context")+".Consumer";case h1:return(e._context.displayName||"Context")+".Provider";case Gh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Kh:return t=e.displayName||null,t!==null?t:cf(e.type)||"Memo";case js:t=e._payload,e=e._init;try{return cf(e(t))}catch{}}return null}function dj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cf(t);case 8:return t===zh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function p1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fj(e){var t=p1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xc(e){e._valueTracker||(e._valueTracker=fj(e))}function g1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=p1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function fu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function uf(e,t){var r=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Kx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Xs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function v1(e,t){t=t.checked,t!=null&&Vh(e,"checked",t,!1)}function df(e,t){v1(e,t);var r=Xs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ff(e,t.type,r):t.hasOwnProperty("defaultValue")&&ff(e,t.type,Xs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Yx(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ff(e,t,r){(t!=="number"||fu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ho=Array.isArray;function Si(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Xs(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function hf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ce(92));if(Ho(r)){if(1<r.length)throw Error(ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Xs(r)}}function y1(e,t){var r=Xs(t.value),n=Xs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function qx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function w1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?w1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var pc,b1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(pc=pc||document.createElement("div"),pc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Xo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hj=["Webkit","ms","Moz","O"];Object.keys(Xo).forEach(function(e){hj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xo[t]=Xo[e]})});function N1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Xo.hasOwnProperty(e)&&Xo[e]?(""+t).trim():t+"px"}function S1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=N1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var mj=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xf(e,t){if(t){if(mj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function pf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gf=null;function Yh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vf=null,ji=null,Ti=null;function Qx(e){if(e=Xl(e)){if(typeof vf!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=md(t),vf(e.stateNode,e.type,t))}}function j1(e){ji?Ti?Ti.push(e):Ti=[e]:ji=e}function T1(){if(ji){var e=ji,t=Ti;if(Ti=ji=null,Qx(e),t)for(e=0;e<t.length;e++)Qx(t[e])}}function E1(e,t){return e(t)}function C1(){}var o0=!1;function k1(e,t,r){if(o0)return e(t,r);o0=!0;try{return E1(e,t,r)}finally{o0=!1,(ji!==null||Ti!==null)&&(C1(),T1())}}function hl(e,t){var r=e.stateNode;if(r===null)return null;var n=md(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var yf=!1;if(is)try{var Ao={};Object.defineProperty(Ao,"passive",{get:function(){yf=!0}}),window.addEventListener("test",Ao,Ao),window.removeEventListener("test",Ao,Ao)}catch{yf=!1}function xj(e,t,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var qo=!1,hu=null,mu=!1,wf=null,pj={onError:function(e){qo=!0,hu=e}};function gj(e,t,r,n,s,i,o,l,c){qo=!1,hu=null,xj.apply(pj,arguments)}function vj(e,t,r,n,s,i,o,l,c){if(gj.apply(this,arguments),qo){if(qo){var u=hu;qo=!1,hu=null}else throw Error(ce(198));mu||(mu=!0,wf=u)}}function Ga(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function _1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jx(e){if(Ga(e)!==e)throw Error(ce(188))}function yj(e){var t=e.alternate;if(!t){if(t=Ga(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Jx(s),e;if(i===n)return Jx(s),t;i=i.sibling}throw Error(ce(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function A1(e){return e=yj(e),e!==null?P1(e):null}function P1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=P1(e);if(t!==null)return t;e=e.sibling}return null}var F1=Ur.unstable_scheduleCallback,Zx=Ur.unstable_cancelCallback,wj=Ur.unstable_shouldYield,bj=Ur.unstable_requestPaint,Nt=Ur.unstable_now,Nj=Ur.unstable_getCurrentPriorityLevel,Xh=Ur.unstable_ImmediatePriority,R1=Ur.unstable_UserBlockingPriority,xu=Ur.unstable_NormalPriority,Sj=Ur.unstable_LowPriority,I1=Ur.unstable_IdlePriority,ud=null,Ln=null;function jj(e){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(ud,e,void 0,(e.current.flags&128)===128)}catch{}}var vn=Math.clz32?Math.clz32:Cj,Tj=Math.log,Ej=Math.LN2;function Cj(e){return e>>>=0,e===0?32:31-(Tj(e)/Ej|0)|0}var gc=64,vc=4194304;function Vo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Vo(l):(i&=o,i!==0&&(n=Vo(i)))}else o=r&~s,o!==0?n=Vo(o):i!==0&&(n=Vo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-vn(t),s=1<<r,n|=e[r],t&=~s;return n}function kj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _j(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-vn(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=kj(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function bf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function D1(){var e=gc;return gc<<=1,!(gc&4194240)&&(gc=64),e}function l0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Kl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vn(t),e[t]=r}function Aj(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-vn(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function qh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-vn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var qe=0;function O1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var L1,Qh,M1,B1,U1,Nf=!1,yc=[],$s=null,Ws=null,Hs=null,ml=new Map,xl=new Map,Es=[],Pj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ep(e,t){switch(e){case"focusin":case"focusout":$s=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Hs=null;break;case"pointerover":case"pointerout":ml.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(t.pointerId)}}function Po(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Xl(t),t!==null&&Qh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Fj(e,t,r,n,s){switch(t){case"focusin":return $s=Po($s,e,t,r,n,s),!0;case"dragenter":return Ws=Po(Ws,e,t,r,n,s),!0;case"mouseover":return Hs=Po(Hs,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ml.set(i,Po(ml.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,xl.set(i,Po(xl.get(i)||null,e,t,r,n,s)),!0}return!1}function $1(e){var t=wa(e.target);if(t!==null){var r=Ga(t);if(r!==null){if(t=r.tag,t===13){if(t=_1(r),t!==null){e.blockedOn=t,U1(e.priority,function(){M1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Sf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gf=n,r.target.dispatchEvent(n),gf=null}else return t=Xl(r),t!==null&&Qh(t),e.blockedOn=r,!1;t.shift()}return!0}function tp(e,t,r){Yc(e)&&r.delete(t)}function Rj(){Nf=!1,$s!==null&&Yc($s)&&($s=null),Ws!==null&&Yc(Ws)&&(Ws=null),Hs!==null&&Yc(Hs)&&(Hs=null),ml.forEach(tp),xl.forEach(tp)}function Fo(e,t){e.blockedOn===t&&(e.blockedOn=null,Nf||(Nf=!0,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,Rj)))}function pl(e){function t(s){return Fo(s,e)}if(0<yc.length){Fo(yc[0],e);for(var r=1;r<yc.length;r++){var n=yc[r];n.blockedOn===e&&(n.blockedOn=null)}}for($s!==null&&Fo($s,e),Ws!==null&&Fo(Ws,e),Hs!==null&&Fo(Hs,e),ml.forEach(t),xl.forEach(t),r=0;r<Es.length;r++)n=Es[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Es.length&&(r=Es[0],r.blockedOn===null);)$1(r),r.blockedOn===null&&Es.shift()}var Ei=xs.ReactCurrentBatchConfig,gu=!0;function Ij(e,t,r,n){var s=qe,i=Ei.transition;Ei.transition=null;try{qe=1,Jh(e,t,r,n)}finally{qe=s,Ei.transition=i}}function Dj(e,t,r,n){var s=qe,i=Ei.transition;Ei.transition=null;try{qe=4,Jh(e,t,r,n)}finally{qe=s,Ei.transition=i}}function Jh(e,t,r,n){if(gu){var s=Sf(e,t,r,n);if(s===null)v0(e,t,n,vu,r),ep(e,n);else if(Fj(s,e,t,r,n))n.stopPropagation();else if(ep(e,n),t&4&&-1<Pj.indexOf(e)){for(;s!==null;){var i=Xl(s);if(i!==null&&L1(i),i=Sf(e,t,r,n),i===null&&v0(e,t,n,vu,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else v0(e,t,n,null,r)}}var vu=null;function Sf(e,t,r,n){if(vu=null,e=Yh(n),e=wa(e),e!==null)if(t=Ga(e),t===null)e=null;else if(r=t.tag,r===13){if(e=_1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vu=e,null}function W1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Nj()){case Xh:return 1;case R1:return 4;case xu:case Sj:return 16;case I1:return 536870912;default:return 16}default:return 16}}var Ls=null,Zh=null,Xc=null;function H1(){if(Xc)return Xc;var e,t=Zh,r=t.length,n,s="value"in Ls?Ls.value:Ls.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Xc=s.slice(e,1<n?1-n:void 0)}function qc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wc(){return!0}function rp(){return!1}function Hr(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wc:rp,this.isPropagationStopped=rp,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wc)},persist:function(){},isPersistent:wc}),t}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},em=Hr(xo),Yl=pt({},xo,{view:0,detail:0}),Oj=Hr(Yl),c0,u0,Ro,dd=pt({},Yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ro&&(Ro&&e.type==="mousemove"?(c0=e.screenX-Ro.screenX,u0=e.screenY-Ro.screenY):u0=c0=0,Ro=e),c0)},movementY:function(e){return"movementY"in e?e.movementY:u0}}),np=Hr(dd),Lj=pt({},dd,{dataTransfer:0}),Mj=Hr(Lj),Bj=pt({},Yl,{relatedTarget:0}),d0=Hr(Bj),Uj=pt({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),$j=Hr(Uj),Wj=pt({},xo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hj=Hr(Wj),Vj=pt({},xo,{data:0}),sp=Hr(Vj),zj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Kj[e])?!!t[e]:!1}function tm(){return Yj}var Xj=pt({},Yl,{key:function(e){if(e.key){var t=zj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Gj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tm,charCode:function(e){return e.type==="keypress"?qc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),qj=Hr(Xj),Qj=pt({},dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ap=Hr(Qj),Jj=pt({},Yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tm}),Zj=Hr(Jj),eT=pt({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),tT=Hr(eT),rT=pt({},dd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nT=Hr(rT),sT=[9,13,27,32],rm=is&&"CompositionEvent"in window,Qo=null;is&&"documentMode"in document&&(Qo=document.documentMode);var aT=is&&"TextEvent"in window&&!Qo,V1=is&&(!rm||Qo&&8<Qo&&11>=Qo),ip=" ",op=!1;function z1(e,t){switch(e){case"keyup":return sT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function G1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var di=!1;function iT(e,t){switch(e){case"compositionend":return G1(t);case"keypress":return t.which!==32?null:(op=!0,ip);case"textInput":return e=t.data,e===ip&&op?null:e;default:return null}}function oT(e,t){if(di)return e==="compositionend"||!rm&&z1(e,t)?(e=H1(),Xc=Zh=Ls=null,di=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return V1&&t.locale!=="ko"?null:t.data;default:return null}}var lT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!lT[e.type]:t==="textarea"}function K1(e,t,r,n){j1(n),t=yu(t,"onChange"),0<t.length&&(r=new em("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jo=null,gl=null;function cT(e){sy(e,0)}function fd(e){var t=mi(e);if(g1(t))return e}function uT(e,t){if(e==="change")return t}var Y1=!1;if(is){var f0;if(is){var h0="oninput"in document;if(!h0){var cp=document.createElement("div");cp.setAttribute("oninput","return;"),h0=typeof cp.oninput=="function"}f0=h0}else f0=!1;Y1=f0&&(!document.documentMode||9<document.documentMode)}function up(){Jo&&(Jo.detachEvent("onpropertychange",X1),gl=Jo=null)}function X1(e){if(e.propertyName==="value"&&fd(gl)){var t=[];K1(t,gl,e,Yh(e)),k1(cT,t)}}function dT(e,t,r){e==="focusin"?(up(),Jo=t,gl=r,Jo.attachEvent("onpropertychange",X1)):e==="focusout"&&up()}function fT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fd(gl)}function hT(e,t){if(e==="click")return fd(t)}function mT(e,t){if(e==="input"||e==="change")return fd(t)}function xT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bn=typeof Object.is=="function"?Object.is:xT;function vl(e,t){if(bn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!sf.call(t,s)||!bn(e[s],t[s]))return!1}return!0}function dp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fp(e,t){var r=dp(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dp(r)}}function q1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?q1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Q1(){for(var e=window,t=fu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=fu(e.document)}return t}function nm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function pT(e){var t=Q1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&q1(r.ownerDocument.documentElement,r)){if(n!==null&&nm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=fp(r,i);var o=fp(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gT=is&&"documentMode"in document&&11>=document.documentMode,fi=null,jf=null,Zo=null,Tf=!1;function hp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Tf||fi==null||fi!==fu(n)||(n=fi,"selectionStart"in n&&nm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zo&&vl(Zo,n)||(Zo=n,n=yu(jf,"onSelect"),0<n.length&&(t=new em("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=fi)))}function bc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var hi={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionend:bc("Transition","TransitionEnd")},m0={},J1={};is&&(J1=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);function hd(e){if(m0[e])return m0[e];if(!hi[e])return e;var t=hi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in J1)return m0[e]=t[r];return e}var Z1=hd("animationend"),ey=hd("animationiteration"),ty=hd("animationstart"),ry=hd("transitionend"),ny=new Map,mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sa(e,t){ny.set(e,t),za(t,[e])}for(var x0=0;x0<mp.length;x0++){var p0=mp[x0],vT=p0.toLowerCase(),yT=p0[0].toUpperCase()+p0.slice(1);sa(vT,"on"+yT)}sa(Z1,"onAnimationEnd");sa(ey,"onAnimationIteration");sa(ty,"onAnimationStart");sa("dblclick","onDoubleClick");sa("focusin","onFocus");sa("focusout","onBlur");sa(ry,"onTransitionEnd");Ji("onMouseEnter",["mouseout","mouseover"]);Ji("onMouseLeave",["mouseout","mouseover"]);Ji("onPointerEnter",["pointerout","pointerover"]);Ji("onPointerLeave",["pointerout","pointerover"]);za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));za("onBeforeInput",["compositionend","keypress","textInput","paste"]);za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wT=new Set("cancel close invalid load scroll toggle".split(" ").concat(zo));function xp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,vj(n,t,void 0,e),e.currentTarget=null}function sy(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;xp(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;xp(s,l,u),i=c}}}if(mu)throw e=wf,mu=!1,wf=null,e}function at(e,t){var r=t[Af];r===void 0&&(r=t[Af]=new Set);var n=e+"__bubble";r.has(n)||(ay(t,e,2,!1),r.add(n))}function g0(e,t,r){var n=0;t&&(n|=4),ay(r,e,n,t)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function yl(e){if(!e[Nc]){e[Nc]=!0,f1.forEach(function(r){r!=="selectionchange"&&(wT.has(r)||g0(r,!1,e),g0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nc]||(t[Nc]=!0,g0("selectionchange",!1,t))}}function ay(e,t,r,n){switch(W1(t)){case 1:var s=Ij;break;case 4:s=Dj;break;default:s=Jh}r=s.bind(null,t,r,e),s=void 0,!yf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function v0(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=wa(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}k1(function(){var u=i,d=Yh(r),m=[];e:{var f=ny.get(e);if(f!==void 0){var p=em,x=e;switch(e){case"keypress":if(qc(r)===0)break e;case"keydown":case"keyup":p=qj;break;case"focusin":x="focus",p=d0;break;case"focusout":x="blur",p=d0;break;case"beforeblur":case"afterblur":p=d0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=np;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Mj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Zj;break;case Z1:case ey:case ty:p=$j;break;case ry:p=tT;break;case"scroll":p=Oj;break;case"wheel":p=nT;break;case"copy":case"cut":case"paste":p=Hj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ap}var h=(t&4)!==0,g=!h&&e==="scroll",w=h?f!==null?f+"Capture":null:f;h=[];for(var v=u,y;v!==null;){y=v;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,w!==null&&(N=hl(v,w),N!=null&&h.push(wl(v,N,y)))),g)break;v=v.return}0<h.length&&(f=new p(f,x,null,r,d),m.push({event:f,listeners:h}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==gf&&(x=r.relatedTarget||r.fromElement)&&(wa(x)||x[os]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?wa(x):null,x!==null&&(g=Ga(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(h=np,N="onMouseLeave",w="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(h=ap,N="onPointerLeave",w="onPointerEnter",v="pointer"),g=p==null?f:mi(p),y=x==null?f:mi(x),f=new h(N,v+"leave",p,r,d),f.target=g,f.relatedTarget=y,N=null,wa(d)===u&&(h=new h(w,v+"enter",x,r,d),h.target=y,h.relatedTarget=g,N=h),g=N,p&&x)t:{for(h=p,w=x,v=0,y=h;y;y=ei(y))v++;for(y=0,N=w;N;N=ei(N))y++;for(;0<v-y;)h=ei(h),v--;for(;0<y-v;)w=ei(w),y--;for(;v--;){if(h===w||w!==null&&h===w.alternate)break t;h=ei(h),w=ei(w)}h=null}else h=null;p!==null&&pp(m,f,p,h,!1),x!==null&&g!==null&&pp(m,g,x,h,!0)}}e:{if(f=u?mi(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=uT;else if(lp(f))if(Y1)S=mT;else{S=fT;var C=dT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=hT);if(S&&(S=S(e,u))){K1(m,S,r,d);break e}C&&C(e,f,u),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&ff(f,"number",f.value)}switch(C=u?mi(u):window,e){case"focusin":(lp(C)||C.contentEditable==="true")&&(fi=C,jf=u,Zo=null);break;case"focusout":Zo=jf=fi=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,hp(m,r,d);break;case"selectionchange":if(gT)break;case"keydown":case"keyup":hp(m,r,d)}var j;if(rm)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else di?z1(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(V1&&r.locale!=="ko"&&(di||E!=="onCompositionStart"?E==="onCompositionEnd"&&di&&(j=H1()):(Ls=d,Zh="value"in Ls?Ls.value:Ls.textContent,di=!0)),C=yu(u,E),0<C.length&&(E=new sp(E,e,null,r,d),m.push({event:E,listeners:C}),j?E.data=j:(j=G1(r),j!==null&&(E.data=j)))),(j=aT?iT(e,r):oT(e,r))&&(u=yu(u,"onBeforeInput"),0<u.length&&(d=new sp("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:u}),d.data=j))}sy(m,t)})}function wl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yu(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=hl(e,r),i!=null&&n.unshift(wl(e,i,s)),i=hl(e,t),i!=null&&n.push(wl(e,i,s))),e=e.return}return n}function ei(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pp(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=hl(r,i),c!=null&&o.unshift(wl(r,c,l))):s||(c=hl(r,i),c!=null&&o.push(wl(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var bT=/\r\n?/g,NT=/\u0000|\uFFFD/g;function gp(e){return(typeof e=="string"?e:""+e).replace(bT,`
`).replace(NT,"")}function Sc(e,t,r){if(t=gp(t),gp(e)!==t&&r)throw Error(ce(425))}function wu(){}var Ef=null,Cf=null;function kf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _f=typeof setTimeout=="function"?setTimeout:void 0,ST=typeof clearTimeout=="function"?clearTimeout:void 0,vp=typeof Promise=="function"?Promise:void 0,jT=typeof queueMicrotask=="function"?queueMicrotask:typeof vp<"u"?function(e){return vp.resolve(null).then(e).catch(TT)}:_f;function TT(e){setTimeout(function(){throw e})}function y0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),pl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);pl(t)}function Vs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),Rn="__reactFiber$"+po,bl="__reactProps$"+po,os="__reactContainer$"+po,Af="__reactEvents$"+po,ET="__reactListeners$"+po,CT="__reactHandles$"+po;function wa(e){var t=e[Rn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[os]||r[Rn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=yp(e);e!==null;){if(r=e[Rn])return r;e=yp(e)}return t}e=r,r=e.parentNode}return null}function Xl(e){return e=e[Rn]||e[os],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function mi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function md(e){return e[bl]||null}var Pf=[],xi=-1;function aa(e){return{current:e}}function it(e){0>xi||(e.current=Pf[xi],Pf[xi]=null,xi--)}function nt(e,t){xi++,Pf[xi]=e.current,e.current=t}var qs={},sr=aa(qs),Nr=aa(!1),Ra=qs;function Zi(e,t){var r=e.type.contextTypes;if(!r)return qs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Sr(e){return e=e.childContextTypes,e!=null}function bu(){it(Nr),it(sr)}function wp(e,t,r){if(sr.current!==qs)throw Error(ce(168));nt(sr,t),nt(Nr,r)}function iy(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ce(108,dj(e)||"Unknown",s));return pt({},r,n)}function Nu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qs,Ra=sr.current,nt(sr,e),nt(Nr,Nr.current),!0}function bp(e,t,r){var n=e.stateNode;if(!n)throw Error(ce(169));r?(e=iy(e,t,Ra),n.__reactInternalMemoizedMergedChildContext=e,it(Nr),it(sr),nt(sr,e)):it(Nr),nt(Nr,r)}var qn=null,xd=!1,w0=!1;function oy(e){qn===null?qn=[e]:qn.push(e)}function kT(e){xd=!0,oy(e)}function ia(){if(!w0&&qn!==null){w0=!0;var e=0,t=qe;try{var r=qn;for(qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}qn=null,xd=!1}catch(s){throw qn!==null&&(qn=qn.slice(e+1)),F1(Xh,ia),s}finally{qe=t,w0=!1}}return null}var pi=[],gi=0,Su=null,ju=0,Yr=[],Xr=0,Ia=null,Jn=1,Zn="";function pa(e,t){pi[gi++]=ju,pi[gi++]=Su,Su=e,ju=t}function ly(e,t,r){Yr[Xr++]=Jn,Yr[Xr++]=Zn,Yr[Xr++]=Ia,Ia=e;var n=Jn;e=Zn;var s=32-vn(n)-1;n&=~(1<<s),r+=1;var i=32-vn(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Jn=1<<32-vn(t)+s|r<<s|n,Zn=i+e}else Jn=1<<i|r<<s|n,Zn=e}function sm(e){e.return!==null&&(pa(e,1),ly(e,1,0))}function am(e){for(;e===Su;)Su=pi[--gi],pi[gi]=null,ju=pi[--gi],pi[gi]=null;for(;e===Ia;)Ia=Yr[--Xr],Yr[Xr]=null,Zn=Yr[--Xr],Yr[Xr]=null,Jn=Yr[--Xr],Yr[Xr]=null}var Mr=null,Lr=null,ct=!1,dn=null;function cy(e,t){var r=Qr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Np(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Mr=e,Lr=Vs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Mr=e,Lr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ia!==null?{id:Jn,overflow:Zn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Mr=e,Lr=null,!0):!1;default:return!1}}function Ff(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rf(e){if(ct){var t=Lr;if(t){var r=t;if(!Np(e,t)){if(Ff(e))throw Error(ce(418));t=Vs(r.nextSibling);var n=Mr;t&&Np(e,t)?cy(n,r):(e.flags=e.flags&-4097|2,ct=!1,Mr=e)}}else{if(Ff(e))throw Error(ce(418));e.flags=e.flags&-4097|2,ct=!1,Mr=e}}}function Sp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Mr=e}function jc(e){if(e!==Mr)return!1;if(!ct)return Sp(e),ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!kf(e.type,e.memoizedProps)),t&&(t=Lr)){if(Ff(e))throw uy(),Error(ce(418));for(;t;)cy(e,t),t=Vs(t.nextSibling)}if(Sp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Lr=Vs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Lr=null}}else Lr=Mr?Vs(e.stateNode.nextSibling):null;return!0}function uy(){for(var e=Lr;e;)e=Vs(e.nextSibling)}function eo(){Lr=Mr=null,ct=!1}function im(e){dn===null?dn=[e]:dn.push(e)}var _T=xs.ReactCurrentBatchConfig;function Io(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,e))}return e}function Tc(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jp(e){var t=e._init;return t(e._payload)}function dy(e){function t(w,v){if(e){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!e)return null;for(;v!==null;)t(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function s(w,v){return w=Ys(w,v),w.index=0,w.sibling=null,w}function i(w,v,y){return w.index=y,e?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,v,y,N){return v===null||v.tag!==6?(v=C0(y,w.mode,N),v.return=w,v):(v=s(v,y),v.return=w,v)}function c(w,v,y,N){var S=y.type;return S===ui?d(w,v,y.props.children,N,y.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===js&&jp(S)===v.type)?(N=s(v,y.props),N.ref=Io(w,v,y),N.return=w,N):(N=nu(y.type,y.key,y.props,null,w.mode,N),N.ref=Io(w,v,y),N.return=w,N)}function u(w,v,y,N){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=k0(y,w.mode,N),v.return=w,v):(v=s(v,y.children||[]),v.return=w,v)}function d(w,v,y,N,S){return v===null||v.tag!==7?(v=Pa(y,w.mode,N,S),v.return=w,v):(v=s(v,y),v.return=w,v)}function m(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=C0(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case mc:return y=nu(v.type,v.key,v.props,null,w.mode,y),y.ref=Io(w,null,v),y.return=w,y;case ci:return v=k0(v,w.mode,y),v.return=w,v;case js:var N=v._init;return m(w,N(v._payload),y)}if(Ho(v)||_o(v))return v=Pa(v,w.mode,y,null),v.return=w,v;Tc(w,v)}return null}function f(w,v,y,N){var S=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(w,v,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case mc:return y.key===S?c(w,v,y,N):null;case ci:return y.key===S?u(w,v,y,N):null;case js:return S=y._init,f(w,v,S(y._payload),N)}if(Ho(y)||_o(y))return S!==null?null:d(w,v,y,N,null);Tc(w,y)}return null}function p(w,v,y,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(y)||null,l(v,w,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case mc:return w=w.get(N.key===null?y:N.key)||null,c(v,w,N,S);case ci:return w=w.get(N.key===null?y:N.key)||null,u(v,w,N,S);case js:var C=N._init;return p(w,v,y,C(N._payload),S)}if(Ho(N)||_o(N))return w=w.get(y)||null,d(v,w,N,S,null);Tc(v,N)}return null}function x(w,v,y,N){for(var S=null,C=null,j=v,E=v=0,k=null;j!==null&&E<y.length;E++){j.index>E?(k=j,j=null):k=j.sibling;var F=f(w,j,y[E],N);if(F===null){j===null&&(j=k);break}e&&j&&F.alternate===null&&t(w,j),v=i(F,v,E),C===null?S=F:C.sibling=F,C=F,j=k}if(E===y.length)return r(w,j),ct&&pa(w,E),S;if(j===null){for(;E<y.length;E++)j=m(w,y[E],N),j!==null&&(v=i(j,v,E),C===null?S=j:C.sibling=j,C=j);return ct&&pa(w,E),S}for(j=n(w,j);E<y.length;E++)k=p(j,w,E,y[E],N),k!==null&&(e&&k.alternate!==null&&j.delete(k.key===null?E:k.key),v=i(k,v,E),C===null?S=k:C.sibling=k,C=k);return e&&j.forEach(function(M){return t(w,M)}),ct&&pa(w,E),S}function h(w,v,y,N){var S=_o(y);if(typeof S!="function")throw Error(ce(150));if(y=S.call(y),y==null)throw Error(ce(151));for(var C=S=null,j=v,E=v=0,k=null,F=y.next();j!==null&&!F.done;E++,F=y.next()){j.index>E?(k=j,j=null):k=j.sibling;var M=f(w,j,F.value,N);if(M===null){j===null&&(j=k);break}e&&j&&M.alternate===null&&t(w,j),v=i(M,v,E),C===null?S=M:C.sibling=M,C=M,j=k}if(F.done)return r(w,j),ct&&pa(w,E),S;if(j===null){for(;!F.done;E++,F=y.next())F=m(w,F.value,N),F!==null&&(v=i(F,v,E),C===null?S=F:C.sibling=F,C=F);return ct&&pa(w,E),S}for(j=n(w,j);!F.done;E++,F=y.next())F=p(j,w,E,F.value,N),F!==null&&(e&&F.alternate!==null&&j.delete(F.key===null?E:F.key),v=i(F,v,E),C===null?S=F:C.sibling=F,C=F);return e&&j.forEach(function(R){return t(w,R)}),ct&&pa(w,E),S}function g(w,v,y,N){if(typeof y=="object"&&y!==null&&y.type===ui&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case mc:e:{for(var S=y.key,C=v;C!==null;){if(C.key===S){if(S=y.type,S===ui){if(C.tag===7){r(w,C.sibling),v=s(C,y.props.children),v.return=w,w=v;break e}}else if(C.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===js&&jp(S)===C.type){r(w,C.sibling),v=s(C,y.props),v.ref=Io(w,C,y),v.return=w,w=v;break e}r(w,C);break}else t(w,C);C=C.sibling}y.type===ui?(v=Pa(y.props.children,w.mode,N,y.key),v.return=w,w=v):(N=nu(y.type,y.key,y.props,null,w.mode,N),N.ref=Io(w,v,y),N.return=w,w=N)}return o(w);case ci:e:{for(C=y.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=s(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else t(w,v);v=v.sibling}v=k0(y,w.mode,N),v.return=w,w=v}return o(w);case js:return C=y._init,g(w,v,C(y._payload),N)}if(Ho(y))return x(w,v,y,N);if(_o(y))return h(w,v,y,N);Tc(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=s(v,y),v.return=w,w=v):(r(w,v),v=C0(y,w.mode,N),v.return=w,w=v),o(w)):r(w,v)}return g}var to=dy(!0),fy=dy(!1),Tu=aa(null),Eu=null,vi=null,om=null;function lm(){om=vi=Eu=null}function cm(e){var t=Tu.current;it(Tu),e._currentValue=t}function If(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ci(e,t){Eu=e,om=vi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(br=!0),e.firstContext=null)}function Zr(e){var t=e._currentValue;if(om!==e)if(e={context:e,memoizedValue:t,next:null},vi===null){if(Eu===null)throw Error(ce(308));vi=e,Eu.dependencies={lanes:0,firstContext:e}}else vi=vi.next=e;return t}var ba=null;function um(e){ba===null?ba=[e]:ba.push(e)}function hy(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,um(t)):(r.next=s.next,s.next=r),t.interleaved=r,ls(e,n)}function ls(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ts=!1;function dm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function my(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function es(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ue&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ls(e,r)}return s=n.interleaved,s===null?(t.next=t,um(n)):(t.next=s.next,s.next=t),n.interleaved=t,ls(e,r)}function Qc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qh(e,r)}}function Tp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Cu(e,t,r,n){var s=e.updateQueue;Ts=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,p=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,h=l;switch(f=t,p=r,h.tag){case 1:if(x=h.payload,typeof x=="function"){m=x.call(p,m,f);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=h.payload,f=typeof x=="function"?x.call(p,m,f):x,f==null)break e;m=pt({},m,f);break e;case 2:Ts=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=m):d=d.next=p,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Oa|=o,e.lanes=o,e.memoizedState=m}}function Ep(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ce(191,s));s.call(n)}}}var ql={},Mn=aa(ql),Nl=aa(ql),Sl=aa(ql);function Na(e){if(e===ql)throw Error(ce(174));return e}function fm(e,t){switch(nt(Sl,t),nt(Nl,e),nt(Mn,ql),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mf(t,e)}it(Mn),nt(Mn,t)}function ro(){it(Mn),it(Nl),it(Sl)}function xy(e){Na(Sl.current);var t=Na(Mn.current),r=mf(t,e.type);t!==r&&(nt(Nl,e),nt(Mn,r))}function hm(e){Nl.current===e&&(it(Mn),it(Nl))}var ht=aa(0);function ku(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var b0=[];function mm(){for(var e=0;e<b0.length;e++)b0[e]._workInProgressVersionPrimary=null;b0.length=0}var Jc=xs.ReactCurrentDispatcher,N0=xs.ReactCurrentBatchConfig,Da=0,xt=null,Rt=null,Ot=null,_u=!1,el=!1,jl=0,AT=0;function Jt(){throw Error(ce(321))}function xm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!bn(e[r],t[r]))return!1;return!0}function pm(e,t,r,n,s,i){if(Da=i,xt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jc.current=e===null||e.memoizedState===null?IT:DT,e=r(n,s),el){i=0;do{if(el=!1,jl=0,25<=i)throw Error(ce(301));i+=1,Ot=Rt=null,t.updateQueue=null,Jc.current=OT,e=r(n,s)}while(el)}if(Jc.current=Au,t=Rt!==null&&Rt.next!==null,Da=0,Ot=Rt=xt=null,_u=!1,t)throw Error(ce(300));return e}function gm(){var e=jl!==0;return jl=0,e}function kn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?xt.memoizedState=Ot=e:Ot=Ot.next=e,Ot}function en(){if(Rt===null){var e=xt.alternate;e=e!==null?e.memoizedState:null}else e=Rt.next;var t=Ot===null?xt.memoizedState:Ot.next;if(t!==null)Ot=t,Rt=e;else{if(e===null)throw Error(ce(310));Rt=e,e={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Ot===null?xt.memoizedState=Ot=e:Ot=Ot.next=e}return Ot}function Tl(e,t){return typeof t=="function"?t(e):t}function S0(e){var t=en(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=Rt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Da&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=n):c=c.next=m,xt.lanes|=d,Oa|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,bn(n,t.memoizedState)||(br=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,xt.lanes|=i,Oa|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function j0(e){var t=en(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);bn(i,t.memoizedState)||(br=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function py(){}function gy(e,t){var r=xt,n=en(),s=t(),i=!bn(n.memoizedState,s);if(i&&(n.memoizedState=s,br=!0),n=n.queue,vm(wy.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Ot!==null&&Ot.memoizedState.tag&1){if(r.flags|=2048,El(9,yy.bind(null,r,n,s,t),void 0,null),Ut===null)throw Error(ce(349));Da&30||vy(r,t,s)}return s}function vy(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function yy(e,t,r,n){t.value=r,t.getSnapshot=n,by(t)&&Ny(e)}function wy(e,t,r){return r(function(){by(t)&&Ny(e)})}function by(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!bn(e,r)}catch{return!0}}function Ny(e){var t=ls(e,1);t!==null&&yn(t,e,1,-1)}function Cp(e){var t=kn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:e},t.queue=e,e=e.dispatch=RT.bind(null,xt,e),[t.memoizedState,e]}function El(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Sy(){return en().memoizedState}function Zc(e,t,r,n){var s=kn();xt.flags|=e,s.memoizedState=El(1|t,r,void 0,n===void 0?null:n)}function pd(e,t,r,n){var s=en();n=n===void 0?null:n;var i=void 0;if(Rt!==null){var o=Rt.memoizedState;if(i=o.destroy,n!==null&&xm(n,o.deps)){s.memoizedState=El(t,r,i,n);return}}xt.flags|=e,s.memoizedState=El(1|t,r,i,n)}function kp(e,t){return Zc(8390656,8,e,t)}function vm(e,t){return pd(2048,8,e,t)}function jy(e,t){return pd(4,2,e,t)}function Ty(e,t){return pd(4,4,e,t)}function Ey(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Cy(e,t,r){return r=r!=null?r.concat([e]):null,pd(4,4,Ey.bind(null,t,e),r)}function ym(){}function ky(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function _y(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ay(e,t,r){return Da&21?(bn(r,t)||(r=D1(),xt.lanes|=r,Oa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,br=!0),e.memoizedState=r)}function PT(e,t){var r=qe;qe=r!==0&&4>r?r:4,e(!0);var n=N0.transition;N0.transition={};try{e(!1),t()}finally{qe=r,N0.transition=n}}function Py(){return en().memoizedState}function FT(e,t,r){var n=Ks(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Fy(e))Ry(t,r);else if(r=hy(e,t,r,n),r!==null){var s=dr();yn(r,e,n,s),Iy(r,t,n)}}function RT(e,t,r){var n=Ks(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Fy(e))Ry(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,bn(l,o)){var c=t.interleaved;c===null?(s.next=s,um(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=hy(e,t,s,n),r!==null&&(s=dr(),yn(r,e,n,s),Iy(r,t,n))}}function Fy(e){var t=e.alternate;return e===xt||t!==null&&t===xt}function Ry(e,t){el=_u=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Iy(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qh(e,r)}}var Au={readContext:Zr,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},IT={readContext:Zr,useCallback:function(e,t){return kn().memoizedState=[e,t===void 0?null:t],e},useContext:Zr,useEffect:kp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Zc(4194308,4,Ey.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Zc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Zc(4,2,e,t)},useMemo:function(e,t){var r=kn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=kn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=FT.bind(null,xt,e),[n.memoizedState,e]},useRef:function(e){var t=kn();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:ym,useDeferredValue:function(e){return kn().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=PT.bind(null,e[1]),kn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=xt,s=kn();if(ct){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),Ut===null)throw Error(ce(349));Da&30||vy(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,kp(wy.bind(null,n,i,e),[e]),n.flags|=2048,El(9,yy.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=kn(),t=Ut.identifierPrefix;if(ct){var r=Zn,n=Jn;r=(n&~(1<<32-vn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=jl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=AT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},DT={readContext:Zr,useCallback:ky,useContext:Zr,useEffect:vm,useImperativeHandle:Cy,useInsertionEffect:jy,useLayoutEffect:Ty,useMemo:_y,useReducer:S0,useRef:Sy,useState:function(){return S0(Tl)},useDebugValue:ym,useDeferredValue:function(e){var t=en();return Ay(t,Rt.memoizedState,e)},useTransition:function(){var e=S0(Tl)[0],t=en().memoizedState;return[e,t]},useMutableSource:py,useSyncExternalStore:gy,useId:Py,unstable_isNewReconciler:!1},OT={readContext:Zr,useCallback:ky,useContext:Zr,useEffect:vm,useImperativeHandle:Cy,useInsertionEffect:jy,useLayoutEffect:Ty,useMemo:_y,useReducer:j0,useRef:Sy,useState:function(){return j0(Tl)},useDebugValue:ym,useDeferredValue:function(e){var t=en();return Rt===null?t.memoizedState=e:Ay(t,Rt.memoizedState,e)},useTransition:function(){var e=j0(Tl)[0],t=en().memoizedState;return[e,t]},useMutableSource:py,useSyncExternalStore:gy,useId:Py,unstable_isNewReconciler:!1};function ln(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Df(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var gd={isMounted:function(e){return(e=e._reactInternals)?Ga(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=dr(),s=Ks(e),i=es(n,s);i.payload=t,r!=null&&(i.callback=r),t=zs(e,i,s),t!==null&&(yn(t,e,s,n),Qc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=dr(),s=Ks(e),i=es(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=zs(e,i,s),t!==null&&(yn(t,e,s,n),Qc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=dr(),n=Ks(e),s=es(r,n);s.tag=2,t!=null&&(s.callback=t),t=zs(e,s,n),t!==null&&(yn(t,e,n,r),Qc(t,e,n))}};function _p(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!vl(r,n)||!vl(s,i):!0}function Dy(e,t,r){var n=!1,s=qs,i=t.contextType;return typeof i=="object"&&i!==null?i=Zr(i):(s=Sr(t)?Ra:sr.current,n=t.contextTypes,i=(n=n!=null)?Zi(e,s):qs),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=gd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ap(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&gd.enqueueReplaceState(t,t.state,null)}function Of(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},dm(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Zr(i):(i=Sr(t)?Ra:sr.current,s.context=Zi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Df(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&gd.enqueueReplaceState(s,s.state,null),Cu(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function no(e,t){try{var r="",n=t;do r+=uj(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function T0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Lf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var LT=typeof WeakMap=="function"?WeakMap:Map;function Oy(e,t,r){r=es(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Fu||(Fu=!0,Kf=n),Lf(e,t)},r}function Ly(e,t,r){r=es(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Lf(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Lf(e,t),typeof n!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Pp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new LT;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=QT.bind(null,e,t,r),t.then(e,e))}function Fp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rp(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=es(-1,1),t.tag=2,zs(r,t,1))),r.lanes|=1),e)}var MT=xs.ReactCurrentOwner,br=!1;function lr(e,t,r,n){t.child=e===null?fy(t,null,r,n):to(t,e.child,r,n)}function Ip(e,t,r,n,s){r=r.render;var i=t.ref;return Ci(t,s),n=pm(e,t,r,n,i,s),r=gm(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(ct&&r&&sm(t),t.flags|=1,lr(e,t,n,s),t.child)}function Dp(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Cm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,My(e,t,i,n,s)):(e=nu(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:vl,r(o,n)&&e.ref===t.ref)return cs(e,t,s)}return t.flags|=1,e=Ys(i,n),e.ref=t.ref,e.return=t,t.child=e}function My(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(vl(i,n)&&e.ref===t.ref)if(br=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(br=!0);else return t.lanes=e.lanes,cs(e,t,s)}return Mf(e,t,r,n,s)}function By(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(wi,Fr),Fr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,nt(wi,Fr),Fr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,nt(wi,Fr),Fr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,nt(wi,Fr),Fr|=n;return lr(e,t,s,r),t.child}function Uy(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Mf(e,t,r,n,s){var i=Sr(r)?Ra:sr.current;return i=Zi(t,i),Ci(t,s),r=pm(e,t,r,n,i,s),n=gm(),e!==null&&!br?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(ct&&n&&sm(t),t.flags|=1,lr(e,t,r,s),t.child)}function Op(e,t,r,n,s){if(Sr(r)){var i=!0;Nu(t)}else i=!1;if(Ci(t,s),t.stateNode===null)eu(e,t),Dy(t,r,n),Of(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zr(u):(u=Sr(r)?Ra:sr.current,u=Zi(t,u));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Ap(t,o,n,u),Ts=!1;var f=t.memoizedState;o.state=f,Cu(t,n,o,s),c=t.memoizedState,l!==n||f!==c||Nr.current||Ts?(typeof d=="function"&&(Df(t,r,d,n),c=t.memoizedState),(l=Ts||_p(t,r,l,n,f,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,my(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ln(t.type,l),o.props=u,m=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zr(c):(c=Sr(r)?Ra:sr.current,c=Zi(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||f!==c)&&Ap(t,o,n,c),Ts=!1,f=t.memoizedState,o.state=f,Cu(t,n,o,s);var x=t.memoizedState;l!==m||f!==x||Nr.current||Ts?(typeof p=="function"&&(Df(t,r,p,n),x=t.memoizedState),(u=Ts||_p(t,r,u,n,f,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Bf(e,t,r,n,i,s)}function Bf(e,t,r,n,s,i){Uy(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&bp(t,r,!1),cs(e,t,i);n=t.stateNode,MT.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=to(t,e.child,null,i),t.child=to(t,null,l,i)):lr(e,t,l,i),t.memoizedState=n.state,s&&bp(t,r,!0),t.child}function $y(e){var t=e.stateNode;t.pendingContext?wp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&wp(e,t.context,!1),fm(e,t.containerInfo)}function Lp(e,t,r,n,s){return eo(),im(s),t.flags|=256,lr(e,t,r,n),t.child}var Uf={dehydrated:null,treeContext:null,retryLane:0};function $f(e){return{baseLanes:e,cachePool:null,transitions:null}}function Wy(e,t,r){var n=t.pendingProps,s=ht.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),nt(ht,s&1),e===null)return Rf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=wd(o,n,0,null),e=Pa(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=$f(r),t.memoizedState=Uf,e):wm(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return BT(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Ys(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ys(l,i):(i=Pa(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?$f(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Uf,n}return i=e.child,e=i.sibling,n=Ys(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function wm(e,t){return t=wd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ec(e,t,r,n){return n!==null&&im(n),to(t,e.child,null,r),e=wm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function BT(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=T0(Error(ce(422))),Ec(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=wd({mode:"visible",children:n.children},s,0,null),i=Pa(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&to(t,e.child,null,o),t.child.memoizedState=$f(o),t.memoizedState=Uf,i);if(!(t.mode&1))return Ec(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(ce(419)),n=T0(i,n,void 0),Ec(e,t,o,n)}if(l=(o&e.childLanes)!==0,br||l){if(n=Ut,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ls(e,s),yn(n,e,s,-1))}return Em(),n=T0(Error(ce(421))),Ec(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=JT.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Lr=Vs(s.nextSibling),Mr=t,ct=!0,dn=null,e!==null&&(Yr[Xr++]=Jn,Yr[Xr++]=Zn,Yr[Xr++]=Ia,Jn=e.id,Zn=e.overflow,Ia=t),t=wm(t,n.children),t.flags|=4096,t)}function Mp(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),If(e.return,t,r)}function E0(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Hy(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(lr(e,t,n.children,r),n=ht.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Mp(e,r,t);else if(e.tag===19)Mp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(nt(ht,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&ku(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),E0(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ku(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}E0(t,!0,r,null,i);break;case"together":E0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function eu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Oa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=Ys(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ys(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function UT(e,t,r){switch(t.tag){case 3:$y(t),eo();break;case 5:xy(t);break;case 1:Sr(t.type)&&Nu(t);break;case 4:fm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;nt(Tu,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(nt(ht,ht.current&1),t.flags|=128,null):r&t.child.childLanes?Wy(e,t,r):(nt(ht,ht.current&1),e=cs(e,t,r),e!==null?e.sibling:null);nt(ht,ht.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Hy(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),nt(ht,ht.current),n)break;return null;case 22:case 23:return t.lanes=0,By(e,t,r)}return cs(e,t,r)}var Vy,Wf,zy,Gy;Vy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Wf=function(){};zy=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Na(Mn.current);var i=null;switch(r){case"input":s=uf(e,s),n=uf(e,n),i=[];break;case"select":s=pt({},s,{value:void 0}),n=pt({},n,{value:void 0}),i=[];break;case"textarea":s=hf(e,s),n=hf(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=wu)}xf(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dl.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&at("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Gy=function(e,t,r,n){r!==n&&(t.flags|=4)};function Do(e,t){if(!ct)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $T(e,t,r){var n=t.pendingProps;switch(am(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(t),null;case 1:return Sr(t.type)&&bu(),Zt(t),null;case 3:return n=t.stateNode,ro(),it(Nr),it(sr),mm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(jc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,dn!==null&&(qf(dn),dn=null))),Wf(e,t),Zt(t),null;case 5:hm(t);var s=Na(Sl.current);if(r=t.type,e!==null&&t.stateNode!=null)zy(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ce(166));return Zt(t),null}if(e=Na(Mn.current),jc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Rn]=t,n[bl]=i,e=(t.mode&1)!==0,r){case"dialog":at("cancel",n),at("close",n);break;case"iframe":case"object":case"embed":at("load",n);break;case"video":case"audio":for(s=0;s<zo.length;s++)at(zo[s],n);break;case"source":at("error",n);break;case"img":case"image":case"link":at("error",n),at("load",n);break;case"details":at("toggle",n);break;case"input":Kx(n,i),at("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},at("invalid",n);break;case"textarea":Xx(n,i),at("invalid",n)}xf(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Sc(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Sc(n.textContent,l,e),s=["children",""+l]):dl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&at("scroll",n)}switch(r){case"input":xc(n),Yx(n,i,!0);break;case"textarea":xc(n),qx(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=wu)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=w1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Rn]=t,e[bl]=n,Vy(e,t,!1,!1),t.stateNode=e;e:{switch(o=pf(r,n),r){case"dialog":at("cancel",e),at("close",e),s=n;break;case"iframe":case"object":case"embed":at("load",e),s=n;break;case"video":case"audio":for(s=0;s<zo.length;s++)at(zo[s],e);s=n;break;case"source":at("error",e),s=n;break;case"img":case"image":case"link":at("error",e),at("load",e),s=n;break;case"details":at("toggle",e),s=n;break;case"input":Kx(e,n),s=uf(e,n),at("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=pt({},n,{value:void 0}),at("invalid",e);break;case"textarea":Xx(e,n),s=hf(e,n),at("invalid",e);break;default:s=n}xf(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?S1(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&b1(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fl(e,c):typeof c=="number"&&fl(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&at("scroll",e):c!=null&&Vh(e,i,c,o))}switch(r){case"input":xc(e),Yx(e,n,!1);break;case"textarea":xc(e),qx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Xs(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Si(e,!!n.multiple,i,!1):n.defaultValue!=null&&Si(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=wu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Zt(t),null;case 6:if(e&&t.stateNode!=null)Gy(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ce(166));if(r=Na(Sl.current),Na(Mn.current),jc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Rn]=t,(i=n.nodeValue!==r)&&(e=Mr,e!==null))switch(e.tag){case 3:Sc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Sc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Rn]=t,t.stateNode=n}return Zt(t),null;case 13:if(it(ht),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ct&&Lr!==null&&t.mode&1&&!(t.flags&128))uy(),eo(),t.flags|=98560,i=!1;else if(i=jc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ce(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[Rn]=t}else eo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Zt(t),i=!1}else dn!==null&&(qf(dn),dn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ht.current&1?Dt===0&&(Dt=3):Em())),t.updateQueue!==null&&(t.flags|=4),Zt(t),null);case 4:return ro(),Wf(e,t),e===null&&yl(t.stateNode.containerInfo),Zt(t),null;case 10:return cm(t.type._context),Zt(t),null;case 17:return Sr(t.type)&&bu(),Zt(t),null;case 19:if(it(ht),i=t.memoizedState,i===null)return Zt(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Do(i,!1);else{if(Dt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ku(e),o!==null){for(t.flags|=128,Do(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return nt(ht,ht.current&1|2),t.child}e=e.sibling}i.tail!==null&&Nt()>so&&(t.flags|=128,n=!0,Do(i,!1),t.lanes=4194304)}else{if(!n)if(e=ku(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Do(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ct)return Zt(t),null}else 2*Nt()-i.renderingStartTime>so&&r!==1073741824&&(t.flags|=128,n=!0,Do(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Nt(),t.sibling=null,r=ht.current,nt(ht,n?r&1|2:r&1),t):(Zt(t),null);case 22:case 23:return Tm(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Fr&1073741824&&(Zt(t),t.subtreeFlags&6&&(t.flags|=8192)):Zt(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function WT(e,t){switch(am(t),t.tag){case 1:return Sr(t.type)&&bu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ro(),it(Nr),it(sr),mm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return hm(t),null;case 13:if(it(ht),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));eo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(ht),null;case 4:return ro(),null;case 10:return cm(t.type._context),null;case 22:case 23:return Tm(),null;case 24:return null;default:return null}}var Cc=!1,tr=!1,HT=typeof WeakSet=="function"?WeakSet:Set,Se=null;function yi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vt(e,t,n)}else r.current=null}function Hf(e,t,r){try{r()}catch(n){vt(e,t,n)}}var Bp=!1;function VT(e,t){if(Ef=gu,e=Q1(),nm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=e,f=null;t:for(;;){for(var p;m!==r||s!==0&&m.nodeType!==3||(l=o+s),m!==i||n!==0&&m.nodeType!==3||(c=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(p=m.firstChild)!==null;)f=m,m=p;for(;;){if(m===e)break t;if(f===r&&++u===s&&(l=o),f===i&&++d===n&&(c=o),(p=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cf={focusedElem:e,selectionRange:r},gu=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var h=x.memoizedProps,g=x.memoizedState,w=t.stateNode,v=w.getSnapshotBeforeUpdate(t.elementType===t.type?h:ln(t.type,h),g);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(N){vt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return x=Bp,Bp=!1,x}function tl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Hf(t,r,i)}s=s.next}while(s!==n)}}function vd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Vf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ky(e){var t=e.alternate;t!==null&&(e.alternate=null,Ky(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Rn],delete t[bl],delete t[Af],delete t[ET],delete t[CT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Yy(e){return e.tag===5||e.tag===3||e.tag===4}function Up(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function zf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=wu));else if(n!==4&&(e=e.child,e!==null))for(zf(e,t,r),e=e.sibling;e!==null;)zf(e,t,r),e=e.sibling}function Gf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Gf(e,t,r),e=e.sibling;e!==null;)Gf(e,t,r),e=e.sibling}var Ht=null,un=!1;function gs(e,t,r){for(r=r.child;r!==null;)Xy(e,t,r),r=r.sibling}function Xy(e,t,r){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(ud,r)}catch{}switch(r.tag){case 5:tr||yi(r,t);case 6:var n=Ht,s=un;Ht=null,gs(e,t,r),Ht=n,un=s,Ht!==null&&(un?(e=Ht,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ht.removeChild(r.stateNode));break;case 18:Ht!==null&&(un?(e=Ht,r=r.stateNode,e.nodeType===8?y0(e.parentNode,r):e.nodeType===1&&y0(e,r),pl(e)):y0(Ht,r.stateNode));break;case 4:n=Ht,s=un,Ht=r.stateNode.containerInfo,un=!0,gs(e,t,r),Ht=n,un=s;break;case 0:case 11:case 14:case 15:if(!tr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Hf(r,t,o),s=s.next}while(s!==n)}gs(e,t,r);break;case 1:if(!tr&&(yi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){vt(r,t,l)}gs(e,t,r);break;case 21:gs(e,t,r);break;case 22:r.mode&1?(tr=(n=tr)||r.memoizedState!==null,gs(e,t,r),tr=n):gs(e,t,r);break;default:gs(e,t,r)}}function $p(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new HT),t.forEach(function(n){var s=ZT.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function rn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ht=l.stateNode,un=!1;break e;case 3:Ht=l.stateNode.containerInfo,un=!0;break e;case 4:Ht=l.stateNode.containerInfo,un=!0;break e}l=l.return}if(Ht===null)throw Error(ce(160));Xy(i,o,s),Ht=null,un=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){vt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qy(t,e),t=t.sibling}function qy(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),Tn(e),n&4){try{tl(3,e,e.return),vd(3,e)}catch(h){vt(e,e.return,h)}try{tl(5,e,e.return)}catch(h){vt(e,e.return,h)}}break;case 1:rn(t,e),Tn(e),n&512&&r!==null&&yi(r,r.return);break;case 5:if(rn(t,e),Tn(e),n&512&&r!==null&&yi(r,r.return),e.flags&32){var s=e.stateNode;try{fl(s,"")}catch(h){vt(e,e.return,h)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&v1(s,i),pf(l,o);var u=pf(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?S1(s,m):d==="dangerouslySetInnerHTML"?b1(s,m):d==="children"?fl(s,m):Vh(s,d,m,u)}switch(l){case"input":df(s,i);break;case"textarea":y1(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Si(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Si(s,!!i.multiple,i.defaultValue,!0):Si(s,!!i.multiple,i.multiple?[]:"",!1))}s[bl]=i}catch(h){vt(e,e.return,h)}}break;case 6:if(rn(t,e),Tn(e),n&4){if(e.stateNode===null)throw Error(ce(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(h){vt(e,e.return,h)}}break;case 3:if(rn(t,e),Tn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{pl(t.containerInfo)}catch(h){vt(e,e.return,h)}break;case 4:rn(t,e),Tn(e);break;case 13:rn(t,e),Tn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Sm=Nt())),n&4&&$p(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(tr=(u=tr)||d,rn(t,e),tr=u):rn(t,e),Tn(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Se=e,d=e.child;d!==null;){for(m=Se=d;Se!==null;){switch(f=Se,p=f.child,f.tag){case 0:case 11:case 14:case 15:tl(4,f,f.return);break;case 1:yi(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(h){vt(n,r,h)}}break;case 5:yi(f,f.return);break;case 22:if(f.memoizedState!==null){Hp(m);continue}}p!==null?(p.return=f,Se=p):Hp(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=N1("display",o))}catch(h){vt(e,e.return,h)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(h){vt(e,e.return,h)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:rn(t,e),Tn(e),n&4&&$p(e);break;case 21:break;default:rn(t,e),Tn(e)}}function Tn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Yy(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(fl(s,""),n.flags&=-33);var i=Up(e);Gf(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Up(e);zf(e,l,o);break;default:throw Error(ce(161))}}catch(c){vt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zT(e,t,r){Se=e,Qy(e)}function Qy(e,t,r){for(var n=(e.mode&1)!==0;Se!==null;){var s=Se,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Cc;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||tr;l=Cc;var u=tr;if(Cc=o,(tr=c)&&!u)for(Se=s;Se!==null;)o=Se,c=o.child,o.tag===22&&o.memoizedState!==null?Vp(s):c!==null?(c.return=o,Se=c):Vp(s);for(;i!==null;)Se=i,Qy(i),i=i.sibling;Se=s,Cc=l,tr=u}Wp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Se=i):Wp(e)}}function Wp(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:tr||vd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!tr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ln(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Ep(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ep(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&pl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}tr||t.flags&512&&Vf(t)}catch(f){vt(t,t.return,f)}}if(t===e){Se=null;break}if(r=t.sibling,r!==null){r.return=t.return,Se=r;break}Se=t.return}}function Hp(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Se=r;break}Se=t.return}}function Vp(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{vd(4,t)}catch(c){vt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){vt(t,s,c)}}var i=t.return;try{Vf(t)}catch(c){vt(t,i,c)}break;case 5:var o=t.return;try{Vf(t)}catch(c){vt(t,o,c)}}}catch(c){vt(t,t.return,c)}if(t===e){Se=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Se=l;break}Se=t.return}}var GT=Math.ceil,Pu=xs.ReactCurrentDispatcher,bm=xs.ReactCurrentOwner,Jr=xs.ReactCurrentBatchConfig,Ue=0,Ut=null,kt=null,Kt=0,Fr=0,wi=aa(0),Dt=0,Cl=null,Oa=0,yd=0,Nm=0,rl=null,wr=null,Sm=0,so=1/0,Xn=null,Fu=!1,Kf=null,Gs=null,kc=!1,Ms=null,Ru=0,nl=0,Yf=null,tu=-1,ru=0;function dr(){return Ue&6?Nt():tu!==-1?tu:tu=Nt()}function Ks(e){return e.mode&1?Ue&2&&Kt!==0?Kt&-Kt:_T.transition!==null?(ru===0&&(ru=D1()),ru):(e=qe,e!==0||(e=window.event,e=e===void 0?16:W1(e.type)),e):1}function yn(e,t,r,n){if(50<nl)throw nl=0,Yf=null,Error(ce(185));Kl(e,r,n),(!(Ue&2)||e!==Ut)&&(e===Ut&&(!(Ue&2)&&(yd|=r),Dt===4&&Cs(e,Kt)),jr(e,n),r===1&&Ue===0&&!(t.mode&1)&&(so=Nt()+500,xd&&ia()))}function jr(e,t){var r=e.callbackNode;_j(e,t);var n=pu(e,e===Ut?Kt:0);if(n===0)r!==null&&Zx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Zx(r),t===1)e.tag===0?kT(zp.bind(null,e)):oy(zp.bind(null,e)),jT(function(){!(Ue&6)&&ia()}),r=null;else{switch(O1(n)){case 1:r=Xh;break;case 4:r=R1;break;case 16:r=xu;break;case 536870912:r=I1;break;default:r=xu}r=aw(r,Jy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Jy(e,t){if(tu=-1,ru=0,Ue&6)throw Error(ce(327));var r=e.callbackNode;if(ki()&&e.callbackNode!==r)return null;var n=pu(e,e===Ut?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Iu(e,n);else{t=n;var s=Ue;Ue|=2;var i=ew();(Ut!==e||Kt!==t)&&(Xn=null,so=Nt()+500,Aa(e,t));do try{XT();break}catch(l){Zy(e,l)}while(!0);lm(),Pu.current=i,Ue=s,kt!==null?t=0:(Ut=null,Kt=0,t=Dt)}if(t!==0){if(t===2&&(s=bf(e),s!==0&&(n=s,t=Xf(e,s))),t===1)throw r=Cl,Aa(e,0),Cs(e,n),jr(e,Nt()),r;if(t===6)Cs(e,n);else{if(s=e.current.alternate,!(n&30)&&!KT(s)&&(t=Iu(e,n),t===2&&(i=bf(e),i!==0&&(n=i,t=Xf(e,i))),t===1))throw r=Cl,Aa(e,0),Cs(e,n),jr(e,Nt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ce(345));case 2:ga(e,wr,Xn);break;case 3:if(Cs(e,n),(n&130023424)===n&&(t=Sm+500-Nt(),10<t)){if(pu(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){dr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=_f(ga.bind(null,e,wr,Xn),t);break}ga(e,wr,Xn);break;case 4:if(Cs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-vn(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=Nt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*GT(n/1960))-n,10<n){e.timeoutHandle=_f(ga.bind(null,e,wr,Xn),n);break}ga(e,wr,Xn);break;case 5:ga(e,wr,Xn);break;default:throw Error(ce(329))}}}return jr(e,Nt()),e.callbackNode===r?Jy.bind(null,e):null}function Xf(e,t){var r=rl;return e.current.memoizedState.isDehydrated&&(Aa(e,t).flags|=256),e=Iu(e,t),e!==2&&(t=wr,wr=r,t!==null&&qf(t)),e}function qf(e){wr===null?wr=e:wr.push.apply(wr,e)}function KT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!bn(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Cs(e,t){for(t&=~Nm,t&=~yd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-vn(t),n=1<<r;e[r]=-1,t&=~n}}function zp(e){if(Ue&6)throw Error(ce(327));ki();var t=pu(e,0);if(!(t&1))return jr(e,Nt()),null;var r=Iu(e,t);if(e.tag!==0&&r===2){var n=bf(e);n!==0&&(t=n,r=Xf(e,n))}if(r===1)throw r=Cl,Aa(e,0),Cs(e,t),jr(e,Nt()),r;if(r===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ga(e,wr,Xn),jr(e,Nt()),null}function jm(e,t){var r=Ue;Ue|=1;try{return e(t)}finally{Ue=r,Ue===0&&(so=Nt()+500,xd&&ia())}}function La(e){Ms!==null&&Ms.tag===0&&!(Ue&6)&&ki();var t=Ue;Ue|=1;var r=Jr.transition,n=qe;try{if(Jr.transition=null,qe=1,e)return e()}finally{qe=n,Jr.transition=r,Ue=t,!(Ue&6)&&ia()}}function Tm(){Fr=wi.current,it(wi)}function Aa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,ST(r)),kt!==null)for(r=kt.return;r!==null;){var n=r;switch(am(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bu();break;case 3:ro(),it(Nr),it(sr),mm();break;case 5:hm(n);break;case 4:ro();break;case 13:it(ht);break;case 19:it(ht);break;case 10:cm(n.type._context);break;case 22:case 23:Tm()}r=r.return}if(Ut=e,kt=e=Ys(e.current,null),Kt=Fr=t,Dt=0,Cl=null,Nm=yd=Oa=0,wr=rl=null,ba!==null){for(t=0;t<ba.length;t++)if(r=ba[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}ba=null}return e}function Zy(e,t){do{var r=kt;try{if(lm(),Jc.current=Au,_u){for(var n=xt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_u=!1}if(Da=0,Ot=Rt=xt=null,el=!1,jl=0,bm.current=null,r===null||r.return===null){Dt=1,Cl=t,kt=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Kt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Fp(o);if(p!==null){p.flags&=-257,Rp(p,o,l,i,t),p.mode&1&&Pp(i,u,t),t=p,c=u;var x=t.updateQueue;if(x===null){var h=new Set;h.add(c),t.updateQueue=h}else x.add(c);break e}else{if(!(t&1)){Pp(i,u,t),Em();break e}c=Error(ce(426))}}else if(ct&&l.mode&1){var g=Fp(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Rp(g,o,l,i,t),im(no(c,l));break e}}i=c=no(c,l),Dt!==4&&(Dt=2),rl===null?rl=[i]:rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var w=Oy(i,c,t);Tp(i,w);break e;case 1:l=c;var v=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Gs===null||!Gs.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=Ly(i,l,t);Tp(i,N);break e}}i=i.return}while(i!==null)}rw(r)}catch(S){t=S,kt===r&&r!==null&&(kt=r=r.return);continue}break}while(!0)}function ew(){var e=Pu.current;return Pu.current=Au,e===null?Au:e}function Em(){(Dt===0||Dt===3||Dt===2)&&(Dt=4),Ut===null||!(Oa&268435455)&&!(yd&268435455)||Cs(Ut,Kt)}function Iu(e,t){var r=Ue;Ue|=2;var n=ew();(Ut!==e||Kt!==t)&&(Xn=null,Aa(e,t));do try{YT();break}catch(s){Zy(e,s)}while(!0);if(lm(),Ue=r,Pu.current=n,kt!==null)throw Error(ce(261));return Ut=null,Kt=0,Dt}function YT(){for(;kt!==null;)tw(kt)}function XT(){for(;kt!==null&&!wj();)tw(kt)}function tw(e){var t=sw(e.alternate,e,Fr);e.memoizedProps=e.pendingProps,t===null?rw(e):kt=t,bm.current=null}function rw(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=WT(r,t),r!==null){r.flags&=32767,kt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Dt=6,kt=null;return}}else if(r=$T(r,t,Fr),r!==null){kt=r;return}if(t=t.sibling,t!==null){kt=t;return}kt=t=e}while(t!==null);Dt===0&&(Dt=5)}function ga(e,t,r){var n=qe,s=Jr.transition;try{Jr.transition=null,qe=1,qT(e,t,r,n)}finally{Jr.transition=s,qe=n}return null}function qT(e,t,r,n){do ki();while(Ms!==null);if(Ue&6)throw Error(ce(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Aj(e,i),e===Ut&&(kt=Ut=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||kc||(kc=!0,aw(xu,function(){return ki(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Jr.transition,Jr.transition=null;var o=qe;qe=1;var l=Ue;Ue|=4,bm.current=null,VT(e,r),qy(r,e),pT(Cf),gu=!!Ef,Cf=Ef=null,e.current=r,zT(r),bj(),Ue=l,qe=o,Jr.transition=i}else e.current=r;if(kc&&(kc=!1,Ms=e,Ru=s),i=e.pendingLanes,i===0&&(Gs=null),jj(r.stateNode),jr(e,Nt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Fu)throw Fu=!1,e=Kf,Kf=null,e;return Ru&1&&e.tag!==0&&ki(),i=e.pendingLanes,i&1?e===Yf?nl++:(nl=0,Yf=e):nl=0,ia(),null}function ki(){if(Ms!==null){var e=O1(Ru),t=Jr.transition,r=qe;try{if(Jr.transition=null,qe=16>e?16:e,Ms===null)var n=!1;else{if(e=Ms,Ms=null,Ru=0,Ue&6)throw Error(ce(331));var s=Ue;for(Ue|=4,Se=e.current;Se!==null;){var i=Se,o=i.child;if(Se.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Se=u;Se!==null;){var d=Se;switch(d.tag){case 0:case 11:case 15:tl(8,d,i)}var m=d.child;if(m!==null)m.return=d,Se=m;else for(;Se!==null;){d=Se;var f=d.sibling,p=d.return;if(Ky(d),d===u){Se=null;break}if(f!==null){f.return=p,Se=f;break}Se=p}}}var x=i.alternate;if(x!==null){var h=x.child;if(h!==null){x.child=null;do{var g=h.sibling;h.sibling=null,h=g}while(h!==null)}}Se=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Se=o;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:tl(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,Se=w;break e}Se=i.return}}var v=e.current;for(Se=v;Se!==null;){o=Se;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Se=y;else e:for(o=v;Se!==null;){if(l=Se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:vd(9,l)}}catch(S){vt(l,l.return,S)}if(l===o){Se=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,Se=N;break e}Se=l.return}}if(Ue=s,ia(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(ud,e)}catch{}n=!0}return n}finally{qe=r,Jr.transition=t}}return!1}function Gp(e,t,r){t=no(r,t),t=Oy(e,t,1),e=zs(e,t,1),t=dr(),e!==null&&(Kl(e,1,t),jr(e,t))}function vt(e,t,r){if(e.tag===3)Gp(e,e,r);else for(;t!==null;){if(t.tag===3){Gp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gs===null||!Gs.has(n))){e=no(r,e),e=Ly(t,e,1),t=zs(t,e,1),e=dr(),t!==null&&(Kl(t,1,e),jr(t,e));break}}t=t.return}}function QT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=dr(),e.pingedLanes|=e.suspendedLanes&r,Ut===e&&(Kt&r)===r&&(Dt===4||Dt===3&&(Kt&130023424)===Kt&&500>Nt()-Sm?Aa(e,0):Nm|=r),jr(e,t)}function nw(e,t){t===0&&(e.mode&1?(t=vc,vc<<=1,!(vc&130023424)&&(vc=4194304)):t=1);var r=dr();e=ls(e,t),e!==null&&(Kl(e,t,r),jr(e,r))}function JT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),nw(e,r)}function ZT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(t),nw(e,r)}var sw;sw=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nr.current)br=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return br=!1,UT(e,t,r);br=!!(e.flags&131072)}else br=!1,ct&&t.flags&1048576&&ly(t,ju,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;eu(e,t),e=t.pendingProps;var s=Zi(t,sr.current);Ci(t,r),s=pm(null,t,n,e,s,r);var i=gm();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Sr(n)?(i=!0,Nu(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,dm(t),s.updater=gd,t.stateNode=s,s._reactInternals=t,Of(t,n,e,r),t=Bf(null,t,n,!0,i,r)):(t.tag=0,ct&&i&&sm(t),lr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(eu(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=tE(n),e=ln(n,e),s){case 0:t=Mf(null,t,n,e,r);break e;case 1:t=Op(null,t,n,e,r);break e;case 11:t=Ip(null,t,n,e,r);break e;case 14:t=Dp(null,t,n,ln(n.type,e),r);break e}throw Error(ce(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Mf(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Op(e,t,n,s,r);case 3:e:{if($y(t),e===null)throw Error(ce(387));n=t.pendingProps,i=t.memoizedState,s=i.element,my(e,t),Cu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=no(Error(ce(423)),t),t=Lp(e,t,n,r,s);break e}else if(n!==s){s=no(Error(ce(424)),t),t=Lp(e,t,n,r,s);break e}else for(Lr=Vs(t.stateNode.containerInfo.firstChild),Mr=t,ct=!0,dn=null,r=fy(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(eo(),n===s){t=cs(e,t,r);break e}lr(e,t,n,r)}t=t.child}return t;case 5:return xy(t),e===null&&Rf(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,kf(n,s)?o=null:i!==null&&kf(n,i)&&(t.flags|=32),Uy(e,t),lr(e,t,o,r),t.child;case 6:return e===null&&Rf(t),null;case 13:return Wy(e,t,r);case 4:return fm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=to(t,null,n,r):lr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Ip(e,t,n,s,r);case 7:return lr(e,t,t.pendingProps,r),t.child;case 8:return lr(e,t,t.pendingProps.children,r),t.child;case 12:return lr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,nt(Tu,n._currentValue),n._currentValue=o,i!==null)if(bn(i.value,o)){if(i.children===s.children&&!Nr.current){t=cs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=es(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),If(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ce(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),If(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}lr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ci(t,r),s=Zr(s),n=n(s),t.flags|=1,lr(e,t,n,r),t.child;case 14:return n=t.type,s=ln(n,t.pendingProps),s=ln(n.type,s),Dp(e,t,n,s,r);case 15:return My(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),eu(e,t),t.tag=1,Sr(n)?(e=!0,Nu(t)):e=!1,Ci(t,r),Dy(t,n,s),Of(t,n,s,r),Bf(null,t,n,!0,e,r);case 19:return Hy(e,t,r);case 22:return By(e,t,r)}throw Error(ce(156,t.tag))};function aw(e,t){return F1(e,t)}function eE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,t,r,n){return new eE(e,t,r,n)}function Cm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tE(e){if(typeof e=="function")return Cm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gh)return 11;if(e===Kh)return 14}return 2}function Ys(e,t){var r=e.alternate;return r===null?(r=Qr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function nu(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")Cm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ui:return Pa(r.children,s,i,t);case zh:o=8,s|=8;break;case af:return e=Qr(12,r,t,s|2),e.elementType=af,e.lanes=i,e;case of:return e=Qr(13,r,t,s),e.elementType=of,e.lanes=i,e;case lf:return e=Qr(19,r,t,s),e.elementType=lf,e.lanes=i,e;case x1:return wd(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case h1:o=10;break e;case m1:o=9;break e;case Gh:o=11;break e;case Kh:o=14;break e;case js:o=16,n=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=Qr(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Pa(e,t,r,n){return e=Qr(7,e,n,t),e.lanes=r,e}function wd(e,t,r,n){return e=Qr(22,e,n,t),e.elementType=x1,e.lanes=r,e.stateNode={isHidden:!1},e}function C0(e,t,r){return e=Qr(6,e,null,t),e.lanes=r,e}function k0(e,t,r){return t=Qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rE(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=l0(0),this.expirationTimes=l0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=l0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function km(e,t,r,n,s,i,o,l,c){return e=new rE(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Qr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dm(i),e}function nE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ci,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function iw(e){if(!e)return qs;e=e._reactInternals;e:{if(Ga(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Sr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var r=e.type;if(Sr(r))return iy(e,r,t)}return t}function ow(e,t,r,n,s,i,o,l,c){return e=km(r,n,!0,e,s,i,o,l,c),e.context=iw(null),r=e.current,n=dr(),s=Ks(r),i=es(n,s),i.callback=t??null,zs(r,i,s),e.current.lanes=s,Kl(e,s,n),jr(e,n),e}function bd(e,t,r,n){var s=t.current,i=dr(),o=Ks(s);return r=iw(r),t.context===null?t.context=r:t.pendingContext=r,t=es(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zs(s,t,o),e!==null&&(yn(e,s,o,i),Qc(e,s,o)),o}function Du(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function _m(e,t){Kp(e,t),(e=e.alternate)&&Kp(e,t)}function sE(){return null}var lw=typeof reportError=="function"?reportError:function(e){console.error(e)};function Am(e){this._internalRoot=e}Nd.prototype.render=Am.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));bd(e,t,null,null)};Nd.prototype.unmount=Am.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;La(function(){bd(null,e,null,null)}),t[os]=null}};function Nd(e){this._internalRoot=e}Nd.prototype.unstable_scheduleHydration=function(e){if(e){var t=B1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Es.length&&t!==0&&t<Es[r].priority;r++);Es.splice(r,0,e),r===0&&$1(e)}};function Pm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Yp(){}function aE(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Du(o);i.call(u)}}var o=ow(t,n,e,0,null,!1,!1,"",Yp);return e._reactRootContainer=o,e[os]=o.current,yl(e.nodeType===8?e.parentNode:e),La(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Du(c);l.call(u)}}var c=km(e,0,!1,null,null,!1,!1,"",Yp);return e._reactRootContainer=c,e[os]=c.current,yl(e.nodeType===8?e.parentNode:e),La(function(){bd(t,c,r,n)}),c}function jd(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Du(o);l.call(c)}}bd(t,o,e,s)}else o=aE(r,t,e,s,n);return Du(o)}L1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Vo(t.pendingLanes);r!==0&&(qh(t,r|1),jr(t,Nt()),!(Ue&6)&&(so=Nt()+500,ia()))}break;case 13:La(function(){var n=ls(e,1);if(n!==null){var s=dr();yn(n,e,1,s)}}),_m(e,1)}};Qh=function(e){if(e.tag===13){var t=ls(e,134217728);if(t!==null){var r=dr();yn(t,e,134217728,r)}_m(e,134217728)}};M1=function(e){if(e.tag===13){var t=Ks(e),r=ls(e,t);if(r!==null){var n=dr();yn(r,e,t,n)}_m(e,t)}};B1=function(){return qe};U1=function(e,t){var r=qe;try{return qe=e,t()}finally{qe=r}};vf=function(e,t,r){switch(t){case"input":if(df(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=md(n);if(!s)throw Error(ce(90));g1(n),df(n,s)}}}break;case"textarea":y1(e,r);break;case"select":t=r.value,t!=null&&Si(e,!!r.multiple,t,!1)}};E1=jm;C1=La;var iE={usingClientEntryPoint:!1,Events:[Xl,mi,md,j1,T1,jm]},Oo={findFiberByHostInstance:wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oE={bundleType:Oo.bundleType,version:Oo.version,rendererPackageName:Oo.rendererPackageName,rendererConfig:Oo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=A1(e),e===null?null:e.stateNode},findFiberByHostInstance:Oo.findFiberByHostInstance||sE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_c.isDisabled&&_c.supportsFiber)try{ud=_c.inject(oE),Ln=_c}catch{}}Wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iE;Wr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pm(t))throw Error(ce(200));return nE(e,t,null,r)};Wr.createRoot=function(e,t){if(!Pm(e))throw Error(ce(299));var r=!1,n="",s=lw;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=km(e,1,!1,null,null,r,!1,n,s),e[os]=t.current,yl(e.nodeType===8?e.parentNode:e),new Am(t)};Wr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=A1(t),e=e===null?null:e.stateNode,e};Wr.flushSync=function(e){return La(e)};Wr.hydrate=function(e,t,r){if(!Sd(t))throw Error(ce(200));return jd(null,e,t,!0,r)};Wr.hydrateRoot=function(e,t,r){if(!Pm(e))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=lw;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ow(t,null,e,1,r??null,s,!1,i,o),e[os]=t.current,yl(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Nd(t)};Wr.render=function(e,t,r){if(!Sd(t))throw Error(ce(200));return jd(null,e,t,!1,r)};Wr.unmountComponentAtNode=function(e){if(!Sd(e))throw Error(ce(40));return e._reactRootContainer?(La(function(){jd(null,null,e,!1,function(){e._reactRootContainer=null,e[os]=null})}),!0):!1};Wr.unstable_batchedUpdates=jm;Wr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sd(r))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return jd(e,t,r,!1,n)};Wr.version="18.3.1-next-f1338f8080-20240426";function cw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cw)}catch(e){console.error(e)}}cw(),c1.exports=Wr;var Ka=c1.exports;const lE=qv(Ka);var uw,Xp=Ka;uw=Xp.createRoot,Xp.hydrateRoot;function cE(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,s,i,o=[],l="",c=e.split("/");for(c[0]||c.shift();s=c.shift();)r=s[0],r==="*"?(o.push(r),l+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~n?n:~i?i:s.length)),l+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~n?"?":"")+"\\"+s.substring(i))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+(t?"(?=$|/)":"/?$"),"i")}}var dw={exports:{}},fw={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=b;function uE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dE=typeof Object.is=="function"?Object.is:uE,fE=ao.useState,hE=ao.useEffect,mE=ao.useLayoutEffect,xE=ao.useDebugValue;function pE(e,t){var r=t(),n=fE({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return mE(function(){s.value=r,s.getSnapshot=t,_0(s)&&i({inst:s})},[e,r,t]),hE(function(){return _0(s)&&i({inst:s}),e(function(){_0(s)&&i({inst:s})})},[e]),xE(r),r}function _0(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!dE(e,r)}catch{return!0}}function gE(e,t){return t()}var vE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gE:pE;fw.useSyncExternalStore=ao.useSyncExternalStore!==void 0?ao.useSyncExternalStore:vE;dw.exports=fw;var yE=dw.exports;const wE=o1.useInsertionEffect,bE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",NE=bE?b.useLayoutEffect:b.useEffect,SE=wE||NE,hw=e=>{const t=b.useRef([e,(...r)=>t[0](...r)]).current;return SE(()=>{t[0]=e}),t[1]},jE="popstate",Fm="pushState",Rm="replaceState",TE="hashchange",qp=[jE,Fm,Rm,TE],EE=e=>{for(const t of qp)addEventListener(t,e);return()=>{for(const t of qp)removeEventListener(t,e)}},mw=(e,t)=>yE.useSyncExternalStore(EE,e,t),CE=()=>location.search,kE=({ssrSearch:e=""}={})=>mw(CE,()=>e),Qp=()=>location.pathname,_E=({ssrPath:e}={})=>mw(Qp,e?()=>e:Qp),AE=(e,{replace:t=!1,state:r=null}={})=>history[t?Rm:Fm](r,"",e),PE=(e={})=>[_E(e),AE],Jp=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Jp]>"u"){for(const e of[Fm,Rm]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Jp,{value:!0})}const FE=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",xw=(e="")=>e==="/"?"":e,RE=(e,t)=>e[0]==="~"?e.slice(1):xw(t)+e,IE=(e="",t)=>FE(Zp(xw(e)),Zp(t)),Zp=e=>{try{return decodeURI(e)}catch{return e}},pw={hook:PE,searchHook:kE,parser:cE,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},gw=b.createContext(pw),Ql=()=>b.useContext(gw),vw={},yw=b.createContext(vw),ww=()=>b.useContext(yw),Td=e=>{const[t,r]=e.hook(e);return[IE(e.base,t),hw((n,s)=>r(RE(n,e.base),s))]},DE=()=>Td(Ql()),bw=(e,t,r,n)=>{const{pattern:s,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",n),o=s.exec(r)||[],[l,...c]=o;return l!==void 0?[!0,(()=>{const u=i!==!1?Object.fromEntries(i.map((m,f)=>[m,c[f]])):o.groups;let d={...c};return u&&Object.assign(d,u),d})(),...n?[l]:[]]:[!1,null]},OE=({children:e,...t})=>{var d,m;const r=Ql(),n=t.hook?pw:r;let s=n;const[i,o]=((d=t.ssrPath)==null?void 0:d.split("?"))??[];o&&(t.ssrSearch=o,t.ssrPath=i),t.hrefs=t.hrefs??((m=t.hook)==null?void 0:m.hrefs);let l=b.useRef({}),c=l.current,u=c;for(let f in n){const p=f==="base"?n[f]+(t[f]||""):t[f]||n[f];c===u&&p!==u[f]&&(l.current=u={...u}),u[f]=p,p!==n[f]&&(s=u)}return b.createElement(gw.Provider,{value:s,children:e})},eg=({children:e,component:t},r)=>t?b.createElement(t,{params:r}):typeof e=="function"?e(r):e,LE=e=>{let t=b.useRef(vw),r=t.current;for(const n in e)e[n]!==r[n]&&(r=e);return Object.keys(e).length===0&&(r=e),t.current=r},Je=({path:e,nest:t,match:r,...n})=>{const s=Ql(),[i]=Td(s),[o,l,c]=r??bw(s.parser,e,i,t),u=LE({...ww(),...l});if(!o)return null;const d=c?b.createElement(OE,{base:c},eg(n,u)):eg(n,u);return b.createElement(yw.Provider,{value:u,children:d})};b.forwardRef((e,t)=>{const r=Ql(),[n,s]=Td(r),{to:i="",href:o=i,onClick:l,asChild:c,children:u,className:d,replace:m,state:f,...p}=e,x=hw(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(l==null||l(g),g.defaultPrevented||(g.preventDefault(),s(o,e)))}),h=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return c&&b.isValidElement(u)?b.cloneElement(u,{onClick:x,href:h}):b.createElement("a",{...p,onClick:x,href:h,className:d!=null&&d.call?d(n===o):d,children:u,ref:t})});const Nw=e=>Array.isArray(e)?e.flatMap(t=>Nw(t&&t.type===b.Fragment?t.props.children:t)):[e],ME=({children:e,location:t})=>{const r=Ql(),[n]=Td(r);for(const s of Nw(e)){let i=0;if(b.isValidElement(s)&&(i=bw(r.parser,s.props.path,t||n,s.props.nest))[0])return b.cloneElement(s,{match:i})}return null};var go=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ma=typeof window>"u"||"Deno"in globalThis;function Gr(){}function BE(e,t){return typeof e=="function"?e(t):e}function Qf(e){return typeof e=="number"&&e>=0&&e!==1/0}function Sw(e,t){return Math.max(e+(t||0)-Date.now(),0)}function _i(e,t){return typeof e=="function"?e(t):e}function fn(e,t){return typeof e=="function"?e(t):e}function tg(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==Im(o,t.options))return!1}else if(!kl(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function rg(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Ba(t.options.mutationKey)!==Ba(i))return!1}else if(!kl(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function Im(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ba)(e)}function Ba(e){return JSON.stringify(e,(t,r)=>Jf(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function kl(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!kl(e[r],t[r])):!1}function jw(e,t){if(e===t)return e;const r=ng(e)&&ng(t);if(r||Jf(e)&&Jf(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{};let c=0;for(let u=0;u<o;u++){const d=r?u:i[u];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(l[d]=void 0,c++):(l[d]=jw(e[d],t[d]),l[d]===e[d]&&e[d]!==void 0&&c++)}return s===o&&c===s?e:l}return t}function Ou(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function ng(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Jf(e){if(!sg(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!sg(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function sg(e){return Object.prototype.toString.call(e)==="[object Object]"}function UE(e){return new Promise(t=>{setTimeout(t,e)})}function Zf(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?jw(e,t):t}function $E(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function WE(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Dm=Symbol();function Tw(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Dm?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Sa,ks,Bi,Uv,HE=(Uv=class extends go{constructor(){super();Te(this,Sa);Te(this,ks);Te(this,Bi);ye(this,Bi,t=>{if(!Ma&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){W(this,ks)||this.setEventListener(W(this,Bi))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,ks))==null||t.call(this),ye(this,ks,void 0))}setEventListener(t){var r;ye(this,Bi,t),(r=W(this,ks))==null||r.call(this),ye(this,ks,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){W(this,Sa)!==t&&(ye(this,Sa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof W(this,Sa)=="boolean"?W(this,Sa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Sa=new WeakMap,ks=new WeakMap,Bi=new WeakMap,Uv),Om=new HE,Ui,_s,$i,$v,VE=($v=class extends go{constructor(){super();Te(this,Ui,!0);Te(this,_s);Te(this,$i);ye(this,$i,t=>{if(!Ma&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){W(this,_s)||this.setEventListener(W(this,$i))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,_s))==null||t.call(this),ye(this,_s,void 0))}setEventListener(t){var r;ye(this,$i,t),(r=W(this,_s))==null||r.call(this),ye(this,_s,t(this.setOnline.bind(this)))}setOnline(t){W(this,Ui)!==t&&(ye(this,Ui,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return W(this,Ui)}},Ui=new WeakMap,_s=new WeakMap,$i=new WeakMap,$v),Lu=new VE;function eh(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function zE(e){return Math.min(1e3*2**e,3e4)}function Ew(e){return(e??"online")==="online"?Lu.isOnline():!0}var Cw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function A0(e){return e instanceof Cw}function kw(e){let t=!1,r=0,n=!1,s;const i=eh(),o=h=>{var g;n||(f(new Cw(h)),(g=e.abort)==null||g.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>Om.isFocused()&&(e.networkMode==="always"||Lu.isOnline())&&e.canRun(),d=()=>Ew(e.networkMode)&&e.canRun(),m=h=>{var g;n||(n=!0,(g=e.onSuccess)==null||g.call(e,h),s==null||s(),i.resolve(h))},f=h=>{var g;n||(n=!0,(g=e.onError)==null||g.call(e,h),s==null||s(),i.reject(h))},p=()=>new Promise(h=>{var g;s=w=>{(n||u())&&h(w)},(g=e.onPause)==null||g.call(e)}).then(()=>{var h;s=void 0,n||(h=e.onContinue)==null||h.call(e)}),x=()=>{if(n)return;let h;const g=r===0?e.initialPromise:void 0;try{h=g??e.fn()}catch(w){h=Promise.reject(w)}Promise.resolve(h).then(m).catch(w=>{var C;if(n)return;const v=e.retry??(Ma?0:3),y=e.retryDelay??zE,N=typeof y=="function"?y(r,w):y,S=v===!0||typeof v=="number"&&r<v||typeof v=="function"&&v(r,w);if(t||!S){f(w);return}r++,(C=e.onFail)==null||C.call(e,r,w),UE(N).then(()=>u()?void 0:p()).then(()=>{t?f(w):x()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?x():p().then(x),i)}}function GE(){let e=[],t=0,r=l=>{l()},n=l=>{l()},s=l=>setTimeout(l,0);const i=l=>{t?e.push(l):s(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var It=GE(),ja,Wv,_w=(Wv=class{constructor(){Te(this,ja)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Qf(this.gcTime)&&ye(this,ja,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ma?1/0:5*60*1e3))}clearGcTimeout(){W(this,ja)&&(clearTimeout(W(this,ja)),ye(this,ja,void 0))}},ja=new WeakMap,Wv),Wi,Hi,zr,er,Wl,Ta,cn,Yn,Hv,KE=(Hv=class extends _w{constructor(t){super();Te(this,cn);Te(this,Wi);Te(this,Hi);Te(this,zr);Te(this,er);Te(this,Wl);Te(this,Ta);ye(this,Ta,!1),ye(this,Wl,t.defaultOptions),this.setOptions(t.options),this.observers=[],ye(this,zr,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ye(this,Wi,YE(this.options)),this.state=t.state??W(this,Wi),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=W(this,er))==null?void 0:t.promise}setOptions(t){this.options={...W(this,Wl),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&W(this,zr).remove(this)}setData(t,r){const n=Zf(this.state.data,t,this.options);return Re(this,cn,Yn).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Re(this,cn,Yn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=W(this,er))==null?void 0:n.promise;return(s=W(this,er))==null||s.cancel(t),r?r.then(Gr).catch(Gr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(W(this,Wi))}isActive(){return this.observers.some(t=>fn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Dm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Sw(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,er))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,er))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),W(this,zr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(W(this,er)&&(W(this,Ta)?W(this,er).cancel({revert:!0}):W(this,er).cancelRetry()),this.scheduleGc()),W(this,zr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Re(this,cn,Yn).call(this,{type:"invalidate"})}fetch(t,r){var c,u,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(W(this,er))return W(this,er).continueRetry(),W(this,er).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(f=>f.options.queryFn);m&&this.setOptions(m.options)}const n=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(ye(this,Ta,!0),n.signal)})},i=()=>{const m=Tw(this.options,r),f={queryKey:this.queryKey,meta:this.meta};return s(f),ye(this,Ta,!1),this.options.persister?this.options.persister(m,f,this):m(f)},o={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};s(o),(c=this.options.behavior)==null||c.onFetch(o,this),ye(this,Hi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Re(this,cn,Yn).call(this,{type:"fetch",meta:(d=o.fetchOptions)==null?void 0:d.meta});const l=m=>{var f,p,x,h;A0(m)&&m.silent||Re(this,cn,Yn).call(this,{type:"error",error:m}),A0(m)||((p=(f=W(this,zr).config).onError)==null||p.call(f,m,this),(h=(x=W(this,zr).config).onSettled)==null||h.call(x,this.state.data,m,this)),this.scheduleGc()};return ye(this,er,kw({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onSuccess:m=>{var f,p,x,h;if(m===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(m)}catch(g){l(g);return}(p=(f=W(this,zr).config).onSuccess)==null||p.call(f,m,this),(h=(x=W(this,zr).config).onSettled)==null||h.call(x,m,this.state.error,this),this.scheduleGc()},onError:l,onFail:(m,f)=>{Re(this,cn,Yn).call(this,{type:"failed",failureCount:m,error:f})},onPause:()=>{Re(this,cn,Yn).call(this,{type:"pause"})},onContinue:()=>{Re(this,cn,Yn).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),W(this,er).start()}},Wi=new WeakMap,Hi=new WeakMap,zr=new WeakMap,er=new WeakMap,Wl=new WeakMap,Ta=new WeakMap,cn=new WeakSet,Yn=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Aw(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return A0(s)&&s.revert&&W(this,Hi)?{...W(this,Hi),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),It.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),W(this,zr).notify({query:this,type:"updated",action:t})})},Hv);function Aw(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ew(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function YE(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var _n,Vv,XE=(Vv=class extends go{constructor(t={}){super();Te(this,_n);this.config=t,ye(this,_n,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??Im(s,r);let o=this.get(i);return o||(o=new KE({cache:this,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){W(this,_n).has(t.queryHash)||(W(this,_n).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=W(this,_n).get(t.queryHash);r&&(t.destroy(),r===t&&W(this,_n).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){It.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return W(this,_n).get(t)}getAll(){return[...W(this,_n).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>tg(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>tg(t,n)):r}notify(t){It.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){It.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){It.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_n=new WeakMap,Vv),An,ir,Ea,Pn,Ns,zv,qE=(zv=class extends _w{constructor(t){super();Te(this,Pn);Te(this,An);Te(this,ir);Te(this,Ea);this.mutationId=t.mutationId,ye(this,ir,t.mutationCache),ye(this,An,[]),this.state=t.state||Pw(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){W(this,An).includes(t)||(W(this,An).push(t),this.clearGcTimeout(),W(this,ir).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ye(this,An,W(this,An).filter(r=>r!==t)),this.scheduleGc(),W(this,ir).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){W(this,An).length||(this.state.status==="pending"?this.scheduleGc():W(this,ir).remove(this))}continue(){var t;return((t=W(this,Ea))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,l,c,u,d,m,f,p,x,h,g,w,v,y,N,S,C,j;ye(this,Ea,kw({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(E,k)=>{Re(this,Pn,Ns).call(this,{type:"failed",failureCount:E,error:k})},onPause:()=>{Re(this,Pn,Ns).call(this,{type:"pause"})},onContinue:()=>{Re(this,Pn,Ns).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>W(this,ir).canRun(this)}));const r=this.state.status==="pending",n=!W(this,Ea).canStart();try{if(!r){Re(this,Pn,Ns).call(this,{type:"pending",variables:t,isPaused:n}),await((i=(s=W(this,ir).config).onMutate)==null?void 0:i.call(s,t,this));const k=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));k!==this.state.context&&Re(this,Pn,Ns).call(this,{type:"pending",context:k,variables:t,isPaused:n})}const E=await W(this,Ea).start();return await((u=(c=W(this,ir).config).onSuccess)==null?void 0:u.call(c,E,t,this.state.context,this)),await((m=(d=this.options).onSuccess)==null?void 0:m.call(d,E,t,this.state.context)),await((p=(f=W(this,ir).config).onSettled)==null?void 0:p.call(f,E,null,this.state.variables,this.state.context,this)),await((h=(x=this.options).onSettled)==null?void 0:h.call(x,E,null,t,this.state.context)),Re(this,Pn,Ns).call(this,{type:"success",data:E}),E}catch(E){try{throw await((w=(g=W(this,ir).config).onError)==null?void 0:w.call(g,E,t,this.state.context,this)),await((y=(v=this.options).onError)==null?void 0:y.call(v,E,t,this.state.context)),await((S=(N=W(this,ir).config).onSettled)==null?void 0:S.call(N,void 0,E,this.state.variables,this.state.context,this)),await((j=(C=this.options).onSettled)==null?void 0:j.call(C,void 0,E,t,this.state.context)),E}finally{Re(this,Pn,Ns).call(this,{type:"error",error:E})}}finally{W(this,ir).runNext(this)}}},An=new WeakMap,ir=new WeakMap,Ea=new WeakMap,Pn=new WeakSet,Ns=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),It.batch(()=>{W(this,An).forEach(n=>{n.onMutationUpdate(t)}),W(this,ir).notify({mutation:this,type:"updated",action:t})})},zv);function Pw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ar,Hl,Gv,QE=(Gv=class extends go{constructor(t={}){super();Te(this,Ar);Te(this,Hl);this.config=t,ye(this,Ar,new Map),ye(this,Hl,Date.now())}build(t,r,n){const s=new qE({mutationCache:this,mutationId:++fc(this,Hl)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){const r=Ac(t),n=W(this,Ar).get(r)??[];n.push(t),W(this,Ar).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=Ac(t);if(W(this,Ar).has(r)){const s=(n=W(this,Ar).get(r))==null?void 0:n.filter(i=>i!==t);s&&(s.length===0?W(this,Ar).delete(r):W(this,Ar).set(r,s))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=W(this,Ar).get(Ac(t)))==null?void 0:n.find(s=>s.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=W(this,Ar).get(Ac(t)))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){It.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...W(this,Ar).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>rg(r,n))}findAll(t={}){return this.getAll().filter(r=>rg(t,r))}notify(t){It.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return It.batch(()=>Promise.all(t.map(r=>r.continue().catch(Gr))))}},Ar=new WeakMap,Hl=new WeakMap,Gv);function Ac(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function ag(e){return{onFetch:(t,r)=>{var d,m,f,p,x;const n=t.options,s=(f=(m=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:m.fetchMore)==null?void 0:f.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let h=!1;const g=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?h=!0:t.signal.addEventListener("abort",()=>{h=!0}),t.signal)})},w=Tw(t.options,t.fetchOptions),v=async(y,N,S)=>{if(h)return Promise.reject();if(N==null&&y.pages.length)return Promise.resolve(y);const C={queryKey:t.queryKey,pageParam:N,direction:S?"backward":"forward",meta:t.options.meta};g(C);const j=await w(C),{maxPages:E}=t.options,k=S?WE:$E;return{pages:k(y.pages,j,E),pageParams:k(y.pageParams,N,E)}};if(s&&i.length){const y=s==="backward",N=y?JE:ig,S={pages:i,pageParams:o},C=N(n,S);l=await v(S,C,y)}else{const y=e??i.length;do{const N=c===0?o[0]??n.initialPageParam:ig(n,l);if(c>0&&N==null)break;l=await v(l,N),c++}while(c<y)}return l};t.options.persister?t.fetchFn=()=>{var h,g;return(g=(h=t.options).persister)==null?void 0:g.call(h,u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function ig(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function JE(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var gt,As,Ps,Vi,zi,Fs,Gi,Ki,Kv,ZE=(Kv=class{constructor(e={}){Te(this,gt);Te(this,As);Te(this,Ps);Te(this,Vi);Te(this,zi);Te(this,Fs);Te(this,Gi);Te(this,Ki);ye(this,gt,e.queryCache||new XE),ye(this,As,e.mutationCache||new QE),ye(this,Ps,e.defaultOptions||{}),ye(this,Vi,new Map),ye(this,zi,new Map),ye(this,Fs,0)}mount(){fc(this,Fs)._++,W(this,Fs)===1&&(ye(this,Gi,Om.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,gt).onFocus())})),ye(this,Ki,Lu.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,gt).onOnline())})))}unmount(){var e,t;fc(this,Fs)._--,W(this,Fs)===0&&((e=W(this,Gi))==null||e.call(this),ye(this,Gi,void 0),(t=W(this,Ki))==null||t.call(this),ye(this,Ki,void 0))}isFetching(e){return W(this,gt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return W(this,As).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=W(this,gt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=W(this,gt).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(_i(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return W(this,gt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=W(this,gt).get(n.queryHash),i=s==null?void 0:s.state.data,o=BE(t,i);if(o!==void 0)return W(this,gt).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return It.batch(()=>W(this,gt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=W(this,gt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=W(this,gt);It.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=W(this,gt),n={type:"active",...e};return It.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=It.batch(()=>W(this,gt).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(Gr).catch(Gr)}invalidateQueries(e={},t={}){return It.batch(()=>{if(W(this,gt).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=It.batch(()=>W(this,gt).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(Gr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Gr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=W(this,gt).build(this,t);return r.isStaleByTime(_i(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Gr).catch(Gr)}fetchInfiniteQuery(e){return e.behavior=ag(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Gr).catch(Gr)}ensureInfiniteQueryData(e){return e.behavior=ag(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Lu.isOnline()?W(this,As).resumePausedMutations():Promise.resolve()}getQueryCache(){return W(this,gt)}getMutationCache(){return W(this,As)}getDefaultOptions(){return W(this,Ps)}setDefaultOptions(e){ye(this,Ps,e)}setQueryDefaults(e,t){W(this,Vi).set(Ba(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...W(this,Vi).values()];let r={};return t.forEach(n=>{kl(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){W(this,zi).set(Ba(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...W(this,zi).values()];let r={};return t.forEach(n=>{kl(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...W(this,Ps).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Im(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===Dm&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...W(this,Ps).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){W(this,gt).clear(),W(this,As).clear()}},gt=new WeakMap,As=new WeakMap,Ps=new WeakMap,Vi=new WeakMap,zi=new WeakMap,Fs=new WeakMap,Gi=new WeakMap,Ki=new WeakMap,Kv),vr,Be,Vl,or,Ca,Yi,Rs,Fn,zl,Xi,qi,ka,_a,Is,Qi,Ge,Go,th,rh,nh,sh,ah,ih,oh,Fw,Yv,eC=(Yv=class extends go{constructor(t,r){super();Te(this,Ge);Te(this,vr);Te(this,Be);Te(this,Vl);Te(this,or);Te(this,Ca);Te(this,Yi);Te(this,Rs);Te(this,Fn);Te(this,zl);Te(this,Xi);Te(this,qi);Te(this,ka);Te(this,_a);Te(this,Is);Te(this,Qi,new Set);this.options=r,ye(this,vr,t),ye(this,Fn,null),ye(this,Rs,eh()),this.options.experimental_prefetchInRender||W(this,Rs).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(W(this,Be).addObserver(this),og(W(this,Be),this.options)?Re(this,Ge,Go).call(this):this.updateResult(),Re(this,Ge,sh).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return lh(W(this,Be),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return lh(W(this,Be),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Re(this,Ge,ah).call(this),Re(this,Ge,ih).call(this),W(this,Be).removeObserver(this)}setOptions(t,r){const n=this.options,s=W(this,Be);if(this.options=W(this,vr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof fn(this.options.enabled,W(this,Be))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Re(this,Ge,oh).call(this),W(this,Be).setOptions(this.options),n._defaulted&&!Ou(this.options,n)&&W(this,vr).getQueryCache().notify({type:"observerOptionsUpdated",query:W(this,Be),observer:this});const i=this.hasListeners();i&&lg(W(this,Be),s,this.options,n)&&Re(this,Ge,Go).call(this),this.updateResult(r),i&&(W(this,Be)!==s||fn(this.options.enabled,W(this,Be))!==fn(n.enabled,W(this,Be))||_i(this.options.staleTime,W(this,Be))!==_i(n.staleTime,W(this,Be)))&&Re(this,Ge,th).call(this);const o=Re(this,Ge,rh).call(this);i&&(W(this,Be)!==s||fn(this.options.enabled,W(this,Be))!==fn(n.enabled,W(this,Be))||o!==W(this,Is))&&Re(this,Ge,nh).call(this,o)}getOptimisticResult(t){const r=W(this,vr).getQueryCache().build(W(this,vr),t),n=this.createResult(r,t);return rC(this,n)&&(ye(this,or,n),ye(this,Yi,this.options),ye(this,Ca,W(this,Be).state)),n}getCurrentResult(){return W(this,or)}trackResult(t,r){const n={};return Object.keys(t).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),t[s])})}),n}trackProp(t){W(this,Qi).add(t)}getCurrentQuery(){return W(this,Be)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=W(this,vr).defaultQueryOptions(t),n=W(this,vr).getQueryCache().build(W(this,vr),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Re(this,Ge,Go).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),W(this,or)))}createResult(t,r){var E;const n=W(this,Be),s=this.options,i=W(this,or),o=W(this,Ca),l=W(this,Yi),u=t!==n?t.state:W(this,Vl),{state:d}=t;let m={...d},f=!1,p;if(r._optimisticResults){const k=this.hasListeners(),F=!k&&og(t,r),M=k&&lg(t,n,r,s);(F||M)&&(m={...m,...Aw(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:x,errorUpdatedAt:h,status:g}=m;if(r.select&&m.data!==void 0)if(i&&m.data===(o==null?void 0:o.data)&&r.select===W(this,zl))p=W(this,Xi);else try{ye(this,zl,r.select),p=r.select(m.data),p=Zf(i==null?void 0:i.data,p,r),ye(this,Xi,p),ye(this,Fn,null)}catch(k){ye(this,Fn,k)}else p=m.data;if(r.placeholderData!==void 0&&p===void 0&&g==="pending"){let k;if(i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData))k=i.data;else if(k=typeof r.placeholderData=="function"?r.placeholderData((E=W(this,qi))==null?void 0:E.state.data,W(this,qi)):r.placeholderData,r.select&&k!==void 0)try{k=r.select(k),ye(this,Fn,null)}catch(F){ye(this,Fn,F)}k!==void 0&&(g="success",p=Zf(i==null?void 0:i.data,k,r),f=!0)}W(this,Fn)&&(x=W(this,Fn),p=W(this,Xi),h=Date.now(),g="error");const w=m.fetchStatus==="fetching",v=g==="pending",y=g==="error",N=v&&w,S=p!==void 0,j={status:g,fetchStatus:m.fetchStatus,isPending:v,isSuccess:g==="success",isError:y,isInitialLoading:N,isLoading:N,data:p,dataUpdatedAt:m.dataUpdatedAt,error:x,errorUpdatedAt:h,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>u.dataUpdateCount||m.errorUpdateCount>u.errorUpdateCount,isFetching:w,isRefetching:w&&!v,isLoadingError:y&&!S,isPaused:m.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:y&&S,isStale:Lm(t,r),refetch:this.refetch,promise:W(this,Rs)};if(this.options.experimental_prefetchInRender){const k=R=>{j.status==="error"?R.reject(j.error):j.data!==void 0&&R.resolve(j.data)},F=()=>{const R=ye(this,Rs,j.promise=eh());k(R)},M=W(this,Rs);switch(M.status){case"pending":t.queryHash===n.queryHash&&k(M);break;case"fulfilled":(j.status==="error"||j.data!==M.value)&&F();break;case"rejected":(j.status!=="error"||j.error!==M.reason)&&F();break}}return j}updateResult(t){const r=W(this,or),n=this.createResult(W(this,Be),this.options);if(ye(this,Ca,W(this,Be).state),ye(this,Yi,this.options),W(this,Ca).data!==void 0&&ye(this,qi,W(this,Be)),Ou(n,r))return;ye(this,or,n);const s={},i=()=>{if(!r)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o=="function"?o():o;if(l==="all"||!l&&!W(this,Qi).size)return!0;const c=new Set(l??W(this,Qi));return this.options.throwOnError&&c.add("error"),Object.keys(W(this,or)).some(u=>{const d=u;return W(this,or)[d]!==r[d]&&c.has(d)})};(t==null?void 0:t.listeners)!==!1&&i()&&(s.listeners=!0),Re(this,Ge,Fw).call(this,{...s,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Re(this,Ge,sh).call(this)}},vr=new WeakMap,Be=new WeakMap,Vl=new WeakMap,or=new WeakMap,Ca=new WeakMap,Yi=new WeakMap,Rs=new WeakMap,Fn=new WeakMap,zl=new WeakMap,Xi=new WeakMap,qi=new WeakMap,ka=new WeakMap,_a=new WeakMap,Is=new WeakMap,Qi=new WeakMap,Ge=new WeakSet,Go=function(t){Re(this,Ge,oh).call(this);let r=W(this,Be).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Gr)),r},th=function(){Re(this,Ge,ah).call(this);const t=_i(this.options.staleTime,W(this,Be));if(Ma||W(this,or).isStale||!Qf(t))return;const n=Sw(W(this,or).dataUpdatedAt,t)+1;ye(this,ka,setTimeout(()=>{W(this,or).isStale||this.updateResult()},n))},rh=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(W(this,Be)):this.options.refetchInterval)??!1},nh=function(t){Re(this,Ge,ih).call(this),ye(this,Is,t),!(Ma||fn(this.options.enabled,W(this,Be))===!1||!Qf(W(this,Is))||W(this,Is)===0)&&ye(this,_a,setInterval(()=>{(this.options.refetchIntervalInBackground||Om.isFocused())&&Re(this,Ge,Go).call(this)},W(this,Is)))},sh=function(){Re(this,Ge,th).call(this),Re(this,Ge,nh).call(this,Re(this,Ge,rh).call(this))},ah=function(){W(this,ka)&&(clearTimeout(W(this,ka)),ye(this,ka,void 0))},ih=function(){W(this,_a)&&(clearInterval(W(this,_a)),ye(this,_a,void 0))},oh=function(){const t=W(this,vr).getQueryCache().build(W(this,vr),this.options);if(t===W(this,Be))return;const r=W(this,Be);ye(this,Be,t),ye(this,Vl,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},Fw=function(t){It.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(W(this,or))}),W(this,vr).getQueryCache().notify({query:W(this,Be),type:"observerResultsUpdated"})})},Yv);function tC(e,t){return fn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function og(e,t){return tC(e,t)||e.state.data!==void 0&&lh(e,t,t.refetchOnMount)}function lh(e,t,r){if(fn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Lm(e,t)}return!1}function lg(e,t,r,n){return(e!==t||fn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Lm(e,r)}function Lm(e,t){return fn(t.enabled,e)!==!1&&e.isStaleByTime(_i(t.staleTime,e))}function rC(e,t){return!Ou(e.getCurrentResult(),t)}var Ds,Os,yr,Qn,as,su,ch,Xv,nC=(Xv=class extends go{constructor(r,n){super();Te(this,as);Te(this,Ds);Te(this,Os);Te(this,yr);Te(this,Qn);ye(this,Ds,r),this.setOptions(n),this.bindMethods(),Re(this,as,su).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=W(this,Ds).defaultMutationOptions(r),Ou(this.options,n)||W(this,Ds).getMutationCache().notify({type:"observerOptionsUpdated",mutation:W(this,yr),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Ba(n.mutationKey)!==Ba(this.options.mutationKey)?this.reset():((s=W(this,yr))==null?void 0:s.state.status)==="pending"&&W(this,yr).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=W(this,yr))==null||r.removeObserver(this)}onMutationUpdate(r){Re(this,as,su).call(this),Re(this,as,ch).call(this,r)}getCurrentResult(){return W(this,Os)}reset(){var r;(r=W(this,yr))==null||r.removeObserver(this),ye(this,yr,void 0),Re(this,as,su).call(this),Re(this,as,ch).call(this)}mutate(r,n){var s;return ye(this,Qn,n),(s=W(this,yr))==null||s.removeObserver(this),ye(this,yr,W(this,Ds).getMutationCache().build(W(this,Ds),this.options)),W(this,yr).addObserver(this),W(this,yr).execute(r)}},Ds=new WeakMap,Os=new WeakMap,yr=new WeakMap,Qn=new WeakMap,as=new WeakSet,su=function(){var n;const r=((n=W(this,yr))==null?void 0:n.state)??Pw();ye(this,Os,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},ch=function(r){It.batch(()=>{var n,s,i,o,l,c,u,d;if(W(this,Qn)&&this.hasListeners()){const m=W(this,Os).variables,f=W(this,Os).context;(r==null?void 0:r.type)==="success"?((s=(n=W(this,Qn)).onSuccess)==null||s.call(n,r.data,m,f),(o=(i=W(this,Qn)).onSettled)==null||o.call(i,r.data,null,m,f)):(r==null?void 0:r.type)==="error"&&((c=(l=W(this,Qn)).onError)==null||c.call(l,r.error,m,f),(d=(u=W(this,Qn)).onSettled)==null||d.call(u,void 0,r.error,m,f))}this.listeners.forEach(m=>{m(W(this,Os))})})},Xv),Rw=b.createContext(void 0),oa=e=>{const t=b.useContext(Rw);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},sC=({client:e,children:t})=>(b.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(Rw.Provider,{value:e,children:t})),Iw=b.createContext(!1),aC=()=>b.useContext(Iw);Iw.Provider;function iC(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var oC=b.createContext(iC()),lC=()=>b.useContext(oC);function Dw(e,t){return typeof e=="function"?e(...t):!!e}function uh(){}var cC=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},uC=e=>{b.useEffect(()=>{e.clearReset()},[e])},dC=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&Dw(r,[e.error,n]),fC=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},hC=(e,t)=>e.isLoading&&e.isFetching&&!t,mC=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,cg=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function xC(e,t,r){var d,m,f,p,x;const n=oa(),s=aC(),i=lC(),o=n.defaultQueryOptions(e);(m=(d=n.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||m.call(d,o),o._optimisticResults=s?"isRestoring":"optimistic",fC(o),cC(o,i),uC(i);const l=!n.getQueryCache().get(o.queryHash),[c]=b.useState(()=>new t(n,o)),u=c.getOptimisticResult(o);if(b.useSyncExternalStore(b.useCallback(h=>{const g=s?uh:c.subscribe(It.batchCalls(h));return c.updateResult(),g},[c,s]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),b.useEffect(()=>{c.setOptions(o,{listeners:!1})},[o,c]),mC(o,u))throw cg(o,c,i);if(dC({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:n.getQueryCache().get(o.queryHash)}))throw u.error;if((p=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,o,u),o.experimental_prefetchInRender&&!Ma&&hC(u,s)){const h=l?cg(o,c,i):(x=n.getQueryCache().get(o.queryHash))==null?void 0:x.promise;h==null||h.catch(uh).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function rt(e,t){return xC(e,eC)}function Tr(e,t){const r=oa(),[n]=b.useState(()=>new nC(r,e));b.useEffect(()=>{n.setOptions(e)},[n,e]);const s=b.useSyncExternalStore(b.useCallback(o=>n.subscribe(It.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=b.useCallback((o,l)=>{n.mutate(o,l).catch(uh)},[n]);if(s.error&&Dw(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}async function Ow(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}async function Ai(e,t,r){const n=await fetch(t,{method:e,headers:r?{"Content-Type":"application/json"}:{},body:r?JSON.stringify(r):void 0,credentials:"include"});return await Ow(n),n}const pC=({on401:e})=>async({queryKey:t})=>{let r=t[0];if(t.length>1&&t[1]&&typeof t[1]=="object"){const s=new URLSearchParams,i=t[1];for(const[l,c]of Object.entries(i))c&&c!==""&&s.append(l,c);const o=s.toString();o&&(r+="?"+o)}const n=await fetch(r,{credentials:"include"});return e==="returnNull"&&n.status===401?null:(await Ow(n),await n.json())},io=new ZE({defaultOptions:{queries:{queryFn:pC({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),gC=1,vC=1e6;let P0=0;function yC(){return P0=(P0+1)%Number.MAX_SAFE_INTEGER,P0.toString()}const F0=new Map,ug=e=>{if(F0.has(e))return;const t=setTimeout(()=>{F0.delete(e),sl({type:"REMOVE_TOAST",toastId:e})},vC);F0.set(e,t)},wC=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,gC)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?ug(r):e.toasts.forEach(n=>{ug(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},au=[];let iu={toasts:[]};function sl(e){iu=wC(iu,e),au.forEach(t=>{t(iu)})}function bC({...e}){const t=yC(),r=s=>sl({type:"UPDATE_TOAST",toast:{...s,id:t}}),n=()=>sl({type:"DISMISS_TOAST",toastId:t});return sl({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||n()}}}),{id:t,dismiss:n,update:r}}function Tt(){const[e,t]=b.useState(iu);return b.useEffect(()=>(au.push(t),()=>{const r=au.indexOf(t);r>-1&&au.splice(r,1)}),[e]),{...e,toast:bC,dismiss:r=>sl({type:"DISMISS_TOAST",toastId:r})}}function Ce(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function dg(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Lw(...e){return t=>{let r=!1;const n=e.map(s=>{const i=dg(s,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():dg(e[s],null)}}}}function ut(...e){return b.useCallback(Lw(...e),e)}function la(e,t=[]){let r=[];function n(i,o){const l=b.createContext(o),c=r.length;r=[...r,o];const u=m=>{var w;const{scope:f,children:p,...x}=m,h=((w=f==null?void 0:f[e])==null?void 0:w[c])||l,g=b.useMemo(()=>x,Object.values(x));return a.jsx(h.Provider,{value:g,children:p})};u.displayName=i+"Provider";function d(m,f){var h;const p=((h=f==null?void 0:f[e])==null?void 0:h[c])||l,x=b.useContext(p);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=r.map(o=>b.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return b.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,NC(s,...t)]}function NC(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const m=c(i)[`__scope${u}`];return{...l,...m}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function _l(e){const t=jC(e),r=b.forwardRef((n,s)=>{const{children:i,...o}=n,l=b.Children.toArray(i),c=l.find(EC);if(c){const u=c.props.children,d=l.map(m=>m===c?b.Children.count(u)>1?b.Children.only(null):b.isValidElement(u)?u.props.children:null:m);return a.jsx(t,{...o,ref:s,children:b.isValidElement(u)?b.cloneElement(u,void 0,d):null})}return a.jsx(t,{...o,ref:s,children:i})});return r.displayName=`${e}.Slot`,r}var SC=_l("Slot");function jC(e){const t=b.forwardRef((r,n)=>{const{children:s,...i}=r;if(b.isValidElement(s)){const o=kC(s),l=CC(i,s.props);return s.type!==b.Fragment&&(l.ref=n?Lw(n,o):o),b.cloneElement(s,l)}return b.Children.count(s)>1?b.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Mw=Symbol("radix.slottable");function TC(e){const t=({children:r})=>a.jsx(a.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=Mw,t}function EC(e){return b.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Mw}function CC(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{i(...l),s(...l)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}function kC(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Mm(e){const t=e+"CollectionProvider",[r,n]=la(t),[s,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=h=>{const{scope:g,children:w}=h,v=bs.useRef(null),y=bs.useRef(new Map).current;return a.jsx(s,{scope:g,itemMap:y,collectionRef:v,children:w})};o.displayName=t;const l=e+"CollectionSlot",c=_l(l),u=bs.forwardRef((h,g)=>{const{scope:w,children:v}=h,y=i(l,w),N=ut(g,y.collectionRef);return a.jsx(c,{ref:N,children:v})});u.displayName=l;const d=e+"CollectionItemSlot",m="data-radix-collection-item",f=_l(d),p=bs.forwardRef((h,g)=>{const{scope:w,children:v,...y}=h,N=bs.useRef(null),S=ut(g,N),C=i(d,w);return bs.useEffect(()=>(C.itemMap.set(N,{ref:N,...y}),()=>void C.itemMap.delete(N))),a.jsx(f,{[m]:"",ref:S,children:v})});p.displayName=d;function x(h){const g=i(e+"CollectionConsumer",h);return bs.useCallback(()=>{const v=g.collectionRef.current;if(!v)return[];const y=Array.from(v.querySelectorAll(`[${m}]`));return Array.from(g.itemMap.values()).sort((C,j)=>y.indexOf(C.ref.current)-y.indexOf(j.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},x,n]}var _C=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Me=_C.reduce((e,t)=>{const r=_l(`Primitive.${t}`),n=b.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Bw(e,t){e&&Ka.flushSync(()=>e.dispatchEvent(t))}function Cr(e){const t=b.useRef(e);return b.useEffect(()=>{t.current=e}),b.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function AC(e,t=globalThis==null?void 0:globalThis.document){const r=Cr(e);b.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var PC="DismissableLayer",dh="dismissableLayer.update",FC="dismissableLayer.pointerDownOutside",RC="dismissableLayer.focusOutside",fg,Uw=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ed=b.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,u=b.useContext(Uw),[d,m]=b.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=b.useState({}),x=ut(t,j=>m(j)),h=Array.from(u.layers),[g]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=h.indexOf(g),v=d?h.indexOf(d):-1,y=u.layersWithOutsidePointerEventsDisabled.size>0,N=v>=w,S=DC(j=>{const E=j.target,k=[...u.branches].some(F=>F.contains(E));!N||k||(s==null||s(j),o==null||o(j),j.defaultPrevented||l==null||l())},f),C=OC(j=>{const E=j.target;[...u.branches].some(F=>F.contains(E))||(i==null||i(j),o==null||o(j),j.defaultPrevented||l==null||l())},f);return AC(j=>{v===u.layers.size-1&&(n==null||n(j),!j.defaultPrevented&&l&&(j.preventDefault(),l()))},f),b.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(fg=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),hg(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=fg)}},[d,f,r,u]),b.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),hg())},[d,u]),b.useEffect(()=>{const j=()=>p({});return document.addEventListener(dh,j),()=>document.removeEventListener(dh,j)},[]),a.jsx(Me.div,{...c,ref:x,style:{pointerEvents:y?N?"auto":"none":void 0,...e.style},onFocusCapture:Ce(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Ce(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Ce(e.onPointerDownCapture,S.onPointerDownCapture)})});Ed.displayName=PC;var IC="DismissableLayerBranch",$w=b.forwardRef((e,t)=>{const r=b.useContext(Uw),n=b.useRef(null),s=ut(t,n);return b.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),a.jsx(Me.div,{...e,ref:s})});$w.displayName=IC;function DC(e,t=globalThis==null?void 0:globalThis.document){const r=Cr(e),n=b.useRef(!1),s=b.useRef(()=>{});return b.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){Ww(FC,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function OC(e,t=globalThis==null?void 0:globalThis.document){const r=Cr(e),n=b.useRef(!1);return b.useEffect(()=>{const s=i=>{i.target&&!n.current&&Ww(RC,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function hg(){const e=new CustomEvent(dh);document.dispatchEvent(e)}function Ww(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?Bw(s,i):s.dispatchEvent(i)}var LC=Ed,MC=$w,ar=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},BC="Portal",Bm=b.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[s,i]=b.useState(!1);ar(()=>i(!0),[]);const o=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?lE.createPortal(a.jsx(Me.div,{...n,ref:t}),o):null});Bm.displayName=BC;function UC(e,t){return b.useReducer((r,n)=>t[r][n]??r,e)}var Cd=e=>{const{present:t,children:r}=e,n=$C(t),s=typeof r=="function"?r({present:n.isPresent}):b.Children.only(r),i=ut(n.ref,WC(s));return typeof r=="function"||n.isPresent?b.cloneElement(s,{ref:i}):null};Cd.displayName="Presence";function $C(e){const[t,r]=b.useState(),n=b.useRef({}),s=b.useRef(e),i=b.useRef("none"),o=e?"mounted":"unmounted",[l,c]=UC(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const u=Pc(n.current);i.current=l==="mounted"?u:"none"},[l]),ar(()=>{const u=n.current,d=s.current;if(d!==e){const f=i.current,p=Pc(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),ar(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,m=p=>{const h=Pc(n.current).includes(p.animationName);if(p.target===t&&h&&(c("ANIMATION_END"),!s.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=p=>{p.target===t&&(i.current=Pc(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:b.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function Pc(e){return(e==null?void 0:e.animationName)||"none"}function WC(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function oo({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=HC({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:n,l=Cr(r),c=b.useCallback(u=>{if(i){const m=typeof u=="function"?u(e):u;m!==e&&l(m)}else s(u)},[i,e,s,l]);return[o,c]}function HC({defaultProp:e,onChange:t}){const r=b.useState(e),[n]=r,s=b.useRef(n),i=Cr(t);return b.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}var VC="VisuallyHidden",Jl=b.forwardRef((e,t)=>a.jsx(Me.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));Jl.displayName=VC;var zC=Jl,Um="ToastProvider",[$m,GC,KC]=Mm("Toast"),[Hw,h7]=la("Toast",[KC]),[YC,kd]=Hw(Um),Vw=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=e,[l,c]=b.useState(null),[u,d]=b.useState(0),m=b.useRef(!1),f=b.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Um}\`. Expected non-empty \`string\`.`),a.jsx($m.Provider,{scope:t,children:a.jsx(YC,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:b.useCallback(()=>d(p=>p+1),[]),onToastRemove:b.useCallback(()=>d(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:f,children:o})})};Vw.displayName=Um;var zw="ToastViewport",XC=["F8"],fh="toast.viewportPause",hh="toast.viewportResume",Gw=b.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=XC,label:s="Notifications ({hotkey})",...i}=e,o=kd(zw,r),l=GC(r),c=b.useRef(null),u=b.useRef(null),d=b.useRef(null),m=b.useRef(null),f=ut(t,m,o.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),x=o.toastCount>0;b.useEffect(()=>{const g=w=>{var y;n.length!==0&&n.every(N=>w[N]||w.code===N)&&((y=m.current)==null||y.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n]),b.useEffect(()=>{const g=c.current,w=m.current;if(x&&g&&w){const v=()=>{if(!o.isClosePausedRef.current){const C=new CustomEvent(fh);w.dispatchEvent(C),o.isClosePausedRef.current=!0}},y=()=>{if(o.isClosePausedRef.current){const C=new CustomEvent(hh);w.dispatchEvent(C),o.isClosePausedRef.current=!1}},N=C=>{!g.contains(C.relatedTarget)&&y()},S=()=>{g.contains(document.activeElement)||y()};return g.addEventListener("focusin",v),g.addEventListener("focusout",N),g.addEventListener("pointermove",v),g.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",y),()=>{g.removeEventListener("focusin",v),g.removeEventListener("focusout",N),g.removeEventListener("pointermove",v),g.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",y)}}},[x,o.isClosePausedRef]);const h=b.useCallback(({tabbingDirection:g})=>{const v=l().map(y=>{const N=y.ref.current,S=[N,...lk(N)];return g==="forwards"?S:S.reverse()});return(g==="forwards"?v.reverse():v).flat()},[l]);return b.useEffect(()=>{const g=m.current;if(g){const w=v=>{var S,C,j;const y=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!y){const E=document.activeElement,k=v.shiftKey;if(v.target===g&&k){(S=u.current)==null||S.focus();return}const R=h({tabbingDirection:k?"backwards":"forwards"}),z=R.findIndex(B=>B===E);R0(R.slice(z+1))?v.preventDefault():k?(C=u.current)==null||C.focus():(j=d.current)==null||j.focus()}};return g.addEventListener("keydown",w),()=>g.removeEventListener("keydown",w)}},[l,h]),a.jsxs(MC,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:x?void 0:"none"},children:[x&&a.jsx(mh,{ref:u,onFocusFromOutsideViewport:()=>{const g=h({tabbingDirection:"forwards"});R0(g)}}),a.jsx($m.Slot,{scope:r,children:a.jsx(Me.ol,{tabIndex:-1,...i,ref:f})}),x&&a.jsx(mh,{ref:d,onFocusFromOutsideViewport:()=>{const g=h({tabbingDirection:"backwards"});R0(g)}})]})});Gw.displayName=zw;var Kw="ToastFocusProxy",mh=b.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,i=kd(Kw,r);return a.jsx(Jl,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&n()}})});mh.displayName=Kw;var _d="Toast",qC="toast.swipeStart",QC="toast.swipeMove",JC="toast.swipeCancel",ZC="toast.swipeEnd",Yw=b.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:i,...o}=e,[l=!0,c]=oo({prop:n,defaultProp:s,onChange:i});return a.jsx(Cd,{present:r||l,children:a.jsx(rk,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:Cr(e.onPause),onResume:Cr(e.onResume),onSwipeStart:Ce(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ce(e.onSwipeMove,u=>{const{x:d,y:m}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:Ce(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ce(e.onSwipeEnd,u=>{const{x:d,y:m}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),c(!1)})})})});Yw.displayName=_d;var[ek,tk]=Hw(_d,{onClose(){}}),rk=b.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:m,onSwipeCancel:f,onSwipeEnd:p,...x}=e,h=kd(_d,r),[g,w]=b.useState(null),v=ut(t,B=>w(B)),y=b.useRef(null),N=b.useRef(null),S=s||h.duration,C=b.useRef(0),j=b.useRef(S),E=b.useRef(0),{onToastAdd:k,onToastRemove:F}=h,M=Cr(()=>{var K;(g==null?void 0:g.contains(document.activeElement))&&((K=h.viewport)==null||K.focus()),o()}),R=b.useCallback(B=>{!B||B===1/0||(window.clearTimeout(E.current),C.current=new Date().getTime(),E.current=window.setTimeout(M,B))},[M]);b.useEffect(()=>{const B=h.viewport;if(B){const K=()=>{R(j.current),u==null||u()},X=()=>{const ee=new Date().getTime()-C.current;j.current=j.current-ee,window.clearTimeout(E.current),c==null||c()};return B.addEventListener(fh,X),B.addEventListener(hh,K),()=>{B.removeEventListener(fh,X),B.removeEventListener(hh,K)}}},[h.viewport,S,c,u,R]),b.useEffect(()=>{i&&!h.isClosePausedRef.current&&R(S)},[i,S,h.isClosePausedRef,R]),b.useEffect(()=>(k(),()=>F()),[k,F]);const z=b.useMemo(()=>g?t2(g):null,[g]);return h.viewport?a.jsxs(a.Fragment,{children:[z&&a.jsx(nk,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:z}),a.jsx(ek,{scope:r,onClose:M,children:Ka.createPortal(a.jsx($m.ItemSlot,{scope:r,children:a.jsx(LC,{asChild:!0,onEscapeKeyDown:Ce(l,()=>{h.isFocusedToastEscapeKeyDownRef.current||M(),h.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Me.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":h.swipeDirection,...x,ref:v,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ce(e.onKeyDown,B=>{B.key==="Escape"&&(l==null||l(B.nativeEvent),B.nativeEvent.defaultPrevented||(h.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:Ce(e.onPointerDown,B=>{B.button===0&&(y.current={x:B.clientX,y:B.clientY})}),onPointerMove:Ce(e.onPointerMove,B=>{if(!y.current)return;const K=B.clientX-y.current.x,X=B.clientY-y.current.y,ee=!!N.current,V=["left","right"].includes(h.swipeDirection),te=["left","up"].includes(h.swipeDirection)?Math.min:Math.max,ue=V?te(0,K):0,xe=V?0:te(0,X),L=B.pointerType==="touch"?10:2,G={x:ue,y:xe},U={originalEvent:B,delta:G};ee?(N.current=G,Fc(QC,m,U,{discrete:!1})):mg(G,h.swipeDirection,L)?(N.current=G,Fc(qC,d,U,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(K)>L||Math.abs(X)>L)&&(y.current=null)}),onPointerUp:Ce(e.onPointerUp,B=>{const K=N.current,X=B.target;if(X.hasPointerCapture(B.pointerId)&&X.releasePointerCapture(B.pointerId),N.current=null,y.current=null,K){const ee=B.currentTarget,V={originalEvent:B,delta:K};mg(K,h.swipeDirection,h.swipeThreshold)?Fc(ZC,p,V,{discrete:!0}):Fc(JC,f,V,{discrete:!0}),ee.addEventListener("click",te=>te.preventDefault(),{once:!0})}})})})}),h.viewport)})]}):null}),nk=e=>{const{__scopeToast:t,children:r,...n}=e,s=kd(_d,t),[i,o]=b.useState(!1),[l,c]=b.useState(!1);return ik(()=>o(!0)),b.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(Bm,{asChild:!0,children:a.jsx(Jl,{...n,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",r]})})})},sk="ToastTitle",Xw=b.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(Me.div,{...n,ref:t})});Xw.displayName=sk;var ak="ToastDescription",qw=b.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(Me.div,{...n,ref:t})});qw.displayName=ak;var Qw="ToastAction",Jw=b.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?a.jsx(e2,{altText:r,asChild:!0,children:a.jsx(Wm,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Qw}\`. Expected non-empty \`string\`.`),null)});Jw.displayName=Qw;var Zw="ToastClose",Wm=b.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=tk(Zw,r);return a.jsx(e2,{asChild:!0,children:a.jsx(Me.button,{type:"button",...n,ref:t,onClick:Ce(e.onClick,s.onClose)})})});Wm.displayName=Zw;var e2=b.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return a.jsx(Me.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function t2(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),ok(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...t2(n))}}),t}function Fc(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?Bw(s,i):s.dispatchEvent(i)}var mg=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),i=n>s;return t==="left"||t==="right"?i&&n>r:!i&&s>r};function ik(e=()=>{}){const t=Cr(e);ar(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function ok(e){return e.nodeType===e.ELEMENT_NODE}function lk(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function R0(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var ck=Vw,r2=Gw,n2=Yw,s2=Xw,a2=qw,i2=Jw,o2=Wm;function l2(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=l2(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function c2(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=l2(e))&&(n&&(n+=" "),n+=t);return n}const xg=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,pg=c2,Ad=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return pg(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,o=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],m=i==null?void 0:i[u];if(d===null)return null;const f=xg(d)||xg(m);return s[u][f]}),l=r&&Object.entries(r).reduce((u,d)=>{let[m,f]=d;return f===void 0||(u[m]=f),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:m,className:f,...p}=d;return Object.entries(p).every(x=>{let[h,g]=x;return Array.isArray(g)?g.includes({...i,...l}[h]):{...i,...l}[h]===g})?[...u,m,f]:u},[]);return pg(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),u2=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var dk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=b.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...l},c)=>b.createElement("svg",{ref:c,...dk,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:u2("lucide",s),...l},[...o.map(([u,d])=>b.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(e,t)=>{const r=b.forwardRef(({className:n,...s},i)=>b.createElement(fk,{ref:i,iconNode:t,className:u2(`lucide-${uk(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=Le("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=Le("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=Le("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=Le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=Le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=Le("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Le("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=Le("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=Le("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=Le("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=Le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=Le("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=Le("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=Le("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=Le("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=Le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=Le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=Le("PoundSterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=Le("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=Le("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=Le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=Le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=Le("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Vm="-",Ek=e=>{const t=kk(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(Vm);return l[0]===""&&l.length!==1&&l.shift(),x2(l,t)||Ck(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},x2=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?x2(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(Vm);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},Sg=/^\[(.+)\]$/,Ck=e=>{if(Sg.test(e)){const t=Sg.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},kk=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Ak(Object.entries(e.classGroups),r).forEach(([i,o])=>{vh(o,n,i,t)}),n},vh=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:jg(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(_k(s)){vh(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,o])=>{vh(o,jg(t,i),r,n)})})},jg=(e,t)=>{let r=e;return t.split(Vm).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},_k=e=>e.isThemeGetter,Ak=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,s]}):e,Pk=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return s(i,o),o},set(i,o){r.has(i)?r.set(i,o):s(i,o)}}},p2="!",Fk=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,o=l=>{const c=[];let u=0,d=0,m;for(let g=0;g<l.length;g++){let w=l[g];if(u===0){if(w===s&&(n||l.slice(g,g+i)===t)){c.push(l.slice(d,g)),d=g+i;continue}if(w==="/"){m=g;continue}}w==="["?u++:w==="]"&&u--}const f=c.length===0?l:l.substring(d),p=f.startsWith(p2),x=p?f.substring(1):f,h=m&&m>d?m-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:x,maybePostfixModifierPosition:h}};return r?l=>r({className:l,parseClassName:o}):o},Rk=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Ik=e=>({cache:Pk(e.cacheSize),parseClassName:Fk(e),...Ek(e)}),Dk=/\s+/,Ok=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],o=e.trim().split(Dk);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:d,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:p}=r(u);let x=!!p,h=n(x?f.substring(0,p):f);if(!h){if(!x){l=u+(l.length>0?" "+l:l);continue}if(h=n(f),!h){l=u+(l.length>0?" "+l:l);continue}x=!1}const g=Rk(d).join(":"),w=m?g+p2:g,v=w+h;if(i.includes(v))continue;i.push(v);const y=s(h,x);for(let N=0;N<y.length;++N){const S=y[N];i.push(w+S)}l=u+(l.length>0?" "+l:l)}return l};function Lk(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=g2(t))&&(n&&(n+=" "),n+=r);return n}const g2=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=g2(e[n]))&&(r&&(r+=" "),r+=t);return r};function Mk(e,...t){let r,n,s,i=o;function o(c){const u=t.reduce((d,m)=>m(d),e());return r=Ik(u),n=r.cache.get,s=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=Ok(c,r);return s(c,d),d}return function(){return i(Lk.apply(null,arguments))}}const st=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},v2=/^\[(?:([a-z-]+):)?(.+)\]$/i,Bk=/^\d+\/\d+$/,Uk=new Set(["px","full","screen"]),$k=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Wk=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Hk=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Vk=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zk=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gn=e=>Pi(e)||Uk.has(e)||Bk.test(e),vs=e=>vo(e,"length",Zk),Pi=e=>!!e&&!Number.isNaN(Number(e)),D0=e=>vo(e,"number",Pi),Lo=e=>!!e&&Number.isInteger(Number(e)),Gk=e=>e.endsWith("%")&&Pi(e.slice(0,-1)),Pe=e=>v2.test(e),ys=e=>$k.test(e),Kk=new Set(["length","size","percentage"]),Yk=e=>vo(e,Kk,y2),Xk=e=>vo(e,"position",y2),qk=new Set(["image","url"]),Qk=e=>vo(e,qk,t_),Jk=e=>vo(e,"",e_),Mo=()=>!0,vo=(e,t,r)=>{const n=v2.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Zk=e=>Wk.test(e)&&!Hk.test(e),y2=()=>!1,e_=e=>Vk.test(e),t_=e=>zk.test(e),r_=()=>{const e=st("colors"),t=st("spacing"),r=st("blur"),n=st("brightness"),s=st("borderColor"),i=st("borderRadius"),o=st("borderSpacing"),l=st("borderWidth"),c=st("contrast"),u=st("grayscale"),d=st("hueRotate"),m=st("invert"),f=st("gap"),p=st("gradientColorStops"),x=st("gradientColorStopPositions"),h=st("inset"),g=st("margin"),w=st("opacity"),v=st("padding"),y=st("saturate"),N=st("scale"),S=st("sepia"),C=st("skew"),j=st("space"),E=st("translate"),k=()=>["auto","contain","none"],F=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",Pe,t],R=()=>[Pe,t],z=()=>["",Gn,vs],B=()=>["auto",Pi,Pe],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],te=()=>["","0",Pe],ue=()=>["auto","avoid","all","avoid-page","page","left","right","column"],xe=()=>[Pi,Pe];return{cacheSize:500,separator:":",theme:{colors:[Mo],spacing:[Gn,vs],blur:["none","",ys,Pe],brightness:xe(),borderColor:[e],borderRadius:["none","","full",ys,Pe],borderSpacing:R(),borderWidth:z(),contrast:xe(),grayscale:te(),hueRotate:xe(),invert:te(),gap:R(),gradientColorStops:[e],gradientColorStopPositions:[Gk,vs],inset:M(),margin:M(),opacity:xe(),padding:R(),saturate:xe(),scale:xe(),sepia:te(),skew:xe(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",Pe]}],container:["container"],columns:[{columns:[ys]}],"break-after":[{"break-after":ue()}],"break-before":[{"break-before":ue()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),Pe]}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],start:[{start:[h]}],end:[{end:[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Lo,Pe]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Pe]}],grow:[{grow:te()}],shrink:[{shrink:te()}],order:[{order:["first","last","none",Lo,Pe]}],"grid-cols":[{"grid-cols":[Mo]}],"col-start-end":[{col:["auto",{span:["full",Lo,Pe]},Pe]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[Mo]}],"row-start-end":[{row:["auto",{span:[Lo,Pe]},Pe]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Pe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Pe]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Pe,t]}],"min-w":[{"min-w":[Pe,t,"min","max","fit"]}],"max-w":[{"max-w":[Pe,t,"none","full","min","max","fit","prose",{screen:[ys]},ys]}],h:[{h:[Pe,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Pe,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Pe,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Pe,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ys,vs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",D0]}],"font-family":[{font:[Mo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Pe]}],"line-clamp":[{"line-clamp":["none",Pi,D0]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gn,Pe]}],"list-image":[{"list-image":["none",Pe]}],"list-style-type":[{list:["none","disc","decimal",Pe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Gn,vs]}],"underline-offset":[{"underline-offset":["auto",Gn,Pe]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Pe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Pe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),Xk]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Yk]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Qk]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:X()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Gn,Pe]}],"outline-w":[{outline:[Gn,vs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[Gn,vs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ys,Jk]}],"shadow-color":[{shadow:[Mo]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ys,Pe]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[y]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Pe]}],duration:[{duration:xe()}],ease:[{ease:["linear","in","out","in-out",Pe]}],delay:[{delay:xe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Pe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Lo,Pe]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Pe]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pe]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pe]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Gn,vs,D0]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},n_=Mk(r_);function He(...e){return n_(c2(e))}const s_=ck,w2=b.forwardRef(({className:e,...t},r)=>a.jsx(r2,{ref:r,className:He("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));w2.displayName=r2.displayName;const a_=Ad("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),b2=b.forwardRef(({className:e,variant:t,...r},n)=>a.jsx(n2,{ref:n,className:He(a_({variant:t}),e),...r}));b2.displayName=n2.displayName;const i_=b.forwardRef(({className:e,...t},r)=>a.jsx(i2,{ref:r,className:He("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));i_.displayName=i2.displayName;const N2=b.forwardRef(({className:e,...t},r)=>a.jsx(o2,{ref:r,className:He("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(Tk,{className:"h-4 w-4"})}));N2.displayName=o2.displayName;const S2=b.forwardRef(({className:e,...t},r)=>a.jsx(s2,{ref:r,className:He("text-sm font-semibold",e),...t}));S2.displayName=s2.displayName;const j2=b.forwardRef(({className:e,...t},r)=>a.jsx(a2,{ref:r,className:He("text-sm opacity-90",e),...t}));j2.displayName=a2.displayName;function o_(){const{toasts:e}=Tt();return a.jsxs(s_,{children:[e.map(function({id:t,title:r,description:n,action:s,...i}){return a.jsxs(b2,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[r&&a.jsx(S2,{children:r}),n&&a.jsx(j2,{children:n})]}),s,a.jsx(N2,{})]},t)}),a.jsx(w2,{})]})}var l_=o1[" useId ".trim().toString()]||(()=>{}),c_=0;function Zl(e){const[t,r]=b.useState(l_());return ar(()=>{e||r(n=>n??String(c_++))},[e]),e||(t?`radix-${t}`:"")}const u_=["top","right","bottom","left"],Qs=Math.min,Ir=Math.max,$u=Math.round,Rc=Math.floor,$n=e=>({x:e,y:e}),d_={left:"right",right:"left",bottom:"top",top:"bottom"},f_={start:"end",end:"start"};function yh(e,t,r){return Ir(e,Qs(t,r))}function ds(e,t){return typeof e=="function"?e(t):e}function fs(e){return e.split("-")[0]}function yo(e){return e.split("-")[1]}function zm(e){return e==="x"?"y":"x"}function Gm(e){return e==="y"?"height":"width"}function Js(e){return["top","bottom"].includes(fs(e))?"y":"x"}function Km(e){return zm(Js(e))}function h_(e,t,r){r===void 0&&(r=!1);const n=yo(e),s=Km(e),i=Gm(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=Wu(o)),[o,Wu(o)]}function m_(e){const t=Wu(e);return[wh(e),t,wh(t)]}function wh(e){return e.replace(/start|end/g,t=>f_[t])}function x_(e,t,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return r?t?s:n:t?n:s;case"left":case"right":return t?i:o;default:return[]}}function p_(e,t,r,n){const s=yo(e);let i=x_(fs(e),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(wh)))),i}function Wu(e){return e.replace(/left|right|bottom|top/g,t=>d_[t])}function g_(e){return{top:0,right:0,bottom:0,left:0,...e}}function T2(e){return typeof e!="number"?g_(e):{top:e,right:e,bottom:e,left:e}}function Hu(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function Tg(e,t,r){let{reference:n,floating:s}=e;const i=Js(t),o=Km(t),l=Gm(o),c=fs(t),u=i==="y",d=n.x+n.width/2-s.width/2,m=n.y+n.height/2-s.height/2,f=n[l]/2-s[l]/2;let p;switch(c){case"top":p={x:d,y:n.y-s.height};break;case"bottom":p={x:d,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:m};break;case"left":p={x:n.x-s.width,y:m};break;default:p={x:n.x,y:n.y}}switch(yo(t)){case"start":p[o]-=f*(r&&u?-1:1);break;case"end":p[o]+=f*(r&&u?-1:1);break}return p}const v_=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:m}=Tg(u,n,c),f=n,p={},x=0;for(let h=0;h<l.length;h++){const{name:g,fn:w}=l[h],{x:v,y,data:N,reset:S}=await w({x:d,y:m,initialPlacement:n,placement:f,strategy:s,middlewareData:p,rects:u,platform:o,elements:{reference:e,floating:t}});d=v??d,m=y??m,p={...p,[g]:{...p[g],...N}},S&&x<=50&&(x++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(u=S.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):S.rects),{x:d,y:m}=Tg(u,f,c)),h=-1)}return{x:d,y:m,placement:f,strategy:s,middlewareData:p}};async function Al(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:m="floating",altBoundary:f=!1,padding:p=0}=ds(t,e),x=T2(p),g=l[f?m==="floating"?"reference":"floating":m],w=Hu(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),v=m==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,y=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),N=await(i.isElement==null?void 0:i.isElement(y))?await(i.getScale==null?void 0:i.getScale(y))||{x:1,y:1}:{x:1,y:1},S=Hu(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:y,strategy:c}):v);return{top:(w.top-S.top+x.top)/N.y,bottom:(S.bottom-w.bottom+x.bottom)/N.y,left:(w.left-S.left+x.left)/N.x,right:(S.right-w.right+x.right)/N.x}}const y_=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=ds(e,t)||{};if(u==null)return{};const m=T2(d),f={x:r,y:n},p=Km(s),x=Gm(p),h=await o.getDimensions(u),g=p==="y",w=g?"top":"left",v=g?"bottom":"right",y=g?"clientHeight":"clientWidth",N=i.reference[x]+i.reference[p]-f[p]-i.floating[x],S=f[p]-i.reference[p],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let j=C?C[y]:0;(!j||!await(o.isElement==null?void 0:o.isElement(C)))&&(j=l.floating[y]||i.floating[x]);const E=N/2-S/2,k=j/2-h[x]/2-1,F=Qs(m[w],k),M=Qs(m[v],k),R=F,z=j-h[x]-M,B=j/2-h[x]/2+E,K=yh(R,B,z),X=!c.arrow&&yo(s)!=null&&B!==K&&i.reference[x]/2-(B<R?F:M)-h[x]/2<0,ee=X?B<R?B-R:B-z:0;return{[p]:f[p]+ee,data:{[p]:K,centerOffset:B-K-ee,...X&&{alignmentOffset:ee}},reset:X}}}),w_=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:h=!0,...g}=ds(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const w=fs(s),v=Js(l),y=fs(l)===l,N=await(c.isRTL==null?void 0:c.isRTL(u.floating)),S=f||(y||!h?[Wu(l)]:m_(l)),C=x!=="none";!f&&C&&S.push(...p_(l,h,x,N));const j=[l,...S],E=await Al(t,g),k=[];let F=((n=i.flip)==null?void 0:n.overflows)||[];if(d&&k.push(E[w]),m){const B=h_(s,o,N);k.push(E[B[0]],E[B[1]])}if(F=[...F,{placement:s,overflows:k}],!k.every(B=>B<=0)){var M,R;const B=(((M=i.flip)==null?void 0:M.index)||0)+1,K=j[B];if(K)return{data:{index:B,overflows:F},reset:{placement:K}};let X=(R=F.filter(ee=>ee.overflows[0]<=0).sort((ee,V)=>ee.overflows[1]-V.overflows[1])[0])==null?void 0:R.placement;if(!X)switch(p){case"bestFit":{var z;const ee=(z=F.filter(V=>{if(C){const te=Js(V.placement);return te===v||te==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(te=>te>0).reduce((te,ue)=>te+ue,0)]).sort((V,te)=>V[1]-te[1])[0])==null?void 0:z[0];ee&&(X=ee);break}case"initialPlacement":X=l;break}if(s!==X)return{reset:{placement:X}}}return{}}}};function Eg(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Cg(e){return u_.some(t=>e[t]>=0)}const b_=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=ds(e,t);switch(n){case"referenceHidden":{const i=await Al(t,{...s,elementContext:"reference"}),o=Eg(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Cg(o)}}}case"escaped":{const i=await Al(t,{...s,altBoundary:!0}),o=Eg(i,r.floating);return{data:{escapedOffsets:o,escaped:Cg(o)}}}default:return{}}}}};async function N_(e,t){const{placement:r,platform:n,elements:s}=e,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=fs(r),l=yo(r),c=Js(r)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,m=ds(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:x}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof x=="number"&&(p=l==="end"?x*-1:x),c?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const S_=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:i,placement:o,middlewareData:l}=t,c=await N_(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},j_=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:g=>{let{x:w,y:v}=g;return{x:w,y:v}}},...c}=ds(e,t),u={x:r,y:n},d=await Al(t,c),m=Js(fs(s)),f=zm(m);let p=u[f],x=u[m];if(i){const g=f==="y"?"top":"left",w=f==="y"?"bottom":"right",v=p+d[g],y=p-d[w];p=yh(v,p,y)}if(o){const g=m==="y"?"top":"left",w=m==="y"?"bottom":"right",v=x+d[g],y=x-d[w];x=yh(v,x,y)}const h=l.fn({...t,[f]:p,[m]:x});return{...h,data:{x:h.x-r,y:h.y-n,enabled:{[f]:i,[m]:o}}}}}},T_=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=ds(e,t),d={x:r,y:n},m=Js(s),f=zm(m);let p=d[f],x=d[m];const h=ds(l,t),g=typeof h=="number"?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(c){const y=f==="y"?"height":"width",N=i.reference[f]-i.floating[y]+g.mainAxis,S=i.reference[f]+i.reference[y]-g.mainAxis;p<N?p=N:p>S&&(p=S)}if(u){var w,v;const y=f==="y"?"width":"height",N=["top","left"].includes(fs(s)),S=i.reference[m]-i.floating[y]+(N&&((w=o.offset)==null?void 0:w[m])||0)+(N?0:g.crossAxis),C=i.reference[m]+i.reference[y]+(N?0:((v=o.offset)==null?void 0:v[m])||0)-(N?g.crossAxis:0);x<S?x=S:x>C&&(x=C)}return{[f]:p,[m]:x}}}},E_=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...u}=ds(e,t),d=await Al(t,u),m=fs(s),f=yo(s),p=Js(s)==="y",{width:x,height:h}=i.floating;let g,w;m==="top"||m==="bottom"?(g=m,w=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(w=m,g=f==="end"?"top":"bottom");const v=h-d.top-d.bottom,y=x-d.left-d.right,N=Qs(h-d[g],v),S=Qs(x-d[w],y),C=!t.middlewareData.shift;let j=N,E=S;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=y),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(j=v),C&&!f){const F=Ir(d.left,0),M=Ir(d.right,0),R=Ir(d.top,0),z=Ir(d.bottom,0);p?E=x-2*(F!==0||M!==0?F+M:Ir(d.left,d.right)):j=h-2*(R!==0||z!==0?R+z:Ir(d.top,d.bottom))}await c({...t,availableWidth:E,availableHeight:j});const k=await o.getDimensions(l.floating);return x!==k.width||h!==k.height?{reset:{rects:!0}}:{}}}};function Fd(){return typeof window<"u"}function wo(e){return E2(e)?(e.nodeName||"").toLowerCase():"#document"}function Br(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vn(e){var t;return(t=(E2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function E2(e){return Fd()?e instanceof Node||e instanceof Br(e).Node:!1}function Nn(e){return Fd()?e instanceof Element||e instanceof Br(e).Element:!1}function Wn(e){return Fd()?e instanceof HTMLElement||e instanceof Br(e).HTMLElement:!1}function kg(e){return!Fd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Br(e).ShadowRoot}function ec(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Sn(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(s)}function C_(e){return["table","td","th"].includes(wo(e))}function Rd(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Ym(e){const t=Xm(),r=Nn(e)?Sn(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function k_(e){let t=Zs(e);for(;Wn(t)&&!lo(t);){if(Ym(t))return t;if(Rd(t))return null;t=Zs(t)}return null}function Xm(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function lo(e){return["html","body","#document"].includes(wo(e))}function Sn(e){return Br(e).getComputedStyle(e)}function Id(e){return Nn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Zs(e){if(wo(e)==="html")return e;const t=e.assignedSlot||e.parentNode||kg(e)&&e.host||Vn(e);return kg(t)?t.host:t}function C2(e){const t=Zs(e);return lo(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wn(t)&&ec(t)?t:C2(t)}function Pl(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=C2(e),i=s===((n=e.ownerDocument)==null?void 0:n.body),o=Br(s);if(i){const l=bh(o);return t.concat(o,o.visualViewport||[],ec(s)?s:[],l&&r?Pl(l):[])}return t.concat(s,Pl(s,[],r))}function bh(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function k2(e){const t=Sn(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Wn(e),i=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=$u(r)!==i||$u(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function qm(e){return Nn(e)?e:e.contextElement}function Fi(e){const t=qm(e);if(!Wn(t))return $n(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:i}=k2(t);let o=(i?$u(r.width):r.width)/n,l=(i?$u(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const __=$n(0);function _2(e){const t=Br(e);return!Xm()||!t.visualViewport?__:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function A_(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Br(e)?!1:t}function Ua(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),i=qm(e);let o=$n(1);t&&(n?Nn(n)&&(o=Fi(n)):o=Fi(e));const l=A_(i,r,n)?_2(i):$n(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,m=s.height/o.y;if(i){const f=Br(i),p=n&&Nn(n)?Br(n):n;let x=f,h=bh(x);for(;h&&n&&p!==x;){const g=Fi(h),w=h.getBoundingClientRect(),v=Sn(h),y=w.left+(h.clientLeft+parseFloat(v.paddingLeft))*g.x,N=w.top+(h.clientTop+parseFloat(v.paddingTop))*g.y;c*=g.x,u*=g.y,d*=g.x,m*=g.y,c+=y,u+=N,x=Br(h),h=bh(x)}}return Hu({width:d,height:m,x:c,y:u})}function Qm(e,t){const r=Id(e).scrollLeft;return t?t.left+r:Ua(Vn(e)).left+r}function A2(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=n.left+t.scrollLeft-(r?0:Qm(e,n)),i=n.top+t.scrollTop;return{x:s,y:i}}function P_(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const i=s==="fixed",o=Vn(n),l=t?Rd(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=$n(1);const d=$n(0),m=Wn(n);if((m||!m&&!i)&&((wo(n)!=="body"||ec(o))&&(c=Id(n)),Wn(n))){const p=Ua(n);u=Fi(n),d.x=p.x+n.clientLeft,d.y=p.y+n.clientTop}const f=o&&!m&&!i?A2(o,c,!0):$n(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:r.y*u.y-c.scrollTop*u.y+d.y+f.y}}function F_(e){return Array.from(e.getClientRects())}function R_(e){const t=Vn(e),r=Id(e),n=e.ownerDocument.body,s=Ir(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=Ir(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Qm(e);const l=-r.scrollTop;return Sn(n).direction==="rtl"&&(o+=Ir(t.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:l}}function I_(e,t){const r=Br(e),n=Vn(e),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=Xm();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function D_(e,t){const r=Ua(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,i=Wn(e)?Fi(e):$n(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,u=n*i.y;return{width:o,height:l,x:c,y:u}}function _g(e,t,r){let n;if(t==="viewport")n=I_(e,r);else if(t==="document")n=R_(Vn(e));else if(Nn(t))n=D_(t,r);else{const s=_2(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Hu(n)}function P2(e,t){const r=Zs(e);return r===t||!Nn(r)||lo(r)?!1:Sn(r).position==="fixed"||P2(r,t)}function O_(e,t){const r=t.get(e);if(r)return r;let n=Pl(e,[],!1).filter(l=>Nn(l)&&wo(l)!=="body"),s=null;const i=Sn(e).position==="fixed";let o=i?Zs(e):e;for(;Nn(o)&&!lo(o);){const l=Sn(o),c=Ym(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||ec(o)&&!c&&P2(e,o))?n=n.filter(d=>d!==o):s=l,o=Zs(o)}return t.set(e,n),n}function L_(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?Rd(t)?[]:O_(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const m=_g(t,d,s);return u.top=Ir(m.top,u.top),u.right=Qs(m.right,u.right),u.bottom=Qs(m.bottom,u.bottom),u.left=Ir(m.left,u.left),u},_g(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function M_(e){const{width:t,height:r}=k2(e);return{width:t,height:r}}function B_(e,t,r){const n=Wn(t),s=Vn(t),i=r==="fixed",o=Ua(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=$n(0);if(n||!n&&!i)if((wo(t)!=="body"||ec(s))&&(l=Id(t)),n){const f=Ua(t,!0,i,t);c.x=f.x+t.clientLeft,c.y=f.y+t.clientTop}else s&&(c.x=Qm(s));const u=s&&!n&&!i?A2(s,l):$n(0),d=o.left+l.scrollLeft-c.x-u.x,m=o.top+l.scrollTop-c.y-u.y;return{x:d,y:m,width:o.width,height:o.height}}function O0(e){return Sn(e).position==="static"}function Ag(e,t){if(!Wn(e)||Sn(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Vn(e)===r&&(r=r.ownerDocument.body),r}function F2(e,t){const r=Br(e);if(Rd(e))return r;if(!Wn(e)){let s=Zs(e);for(;s&&!lo(s);){if(Nn(s)&&!O0(s))return s;s=Zs(s)}return r}let n=Ag(e,t);for(;n&&C_(n)&&O0(n);)n=Ag(n,t);return n&&lo(n)&&O0(n)&&!Ym(n)?r:n||k_(e)||r}const U_=async function(e){const t=this.getOffsetParent||F2,r=this.getDimensions,n=await r(e.floating);return{reference:B_(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function $_(e){return Sn(e).direction==="rtl"}const W_={convertOffsetParentRelativeRectToViewportRelativeRect:P_,getDocumentElement:Vn,getClippingRect:L_,getOffsetParent:F2,getElementRects:U_,getClientRects:F_,getDimensions:M_,getScale:Fi,isElement:Nn,isRTL:$_};function R2(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function H_(e,t){let r=null,n;const s=Vn(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:d,top:m,width:f,height:p}=u;if(l||t(),!f||!p)return;const x=Rc(m),h=Rc(s.clientWidth-(d+f)),g=Rc(s.clientHeight-(m+p)),w=Rc(d),y={rootMargin:-x+"px "+-h+"px "+-g+"px "+-w+"px",threshold:Ir(0,Qs(1,c))||1};let N=!0;function S(C){const j=C[0].intersectionRatio;if(j!==c){if(!N)return o();j?o(!1,j):n=setTimeout(()=>{o(!1,1e-7)},1e3)}j===1&&!R2(u,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(S,{...y,root:s.ownerDocument})}catch{r=new IntersectionObserver(S,y)}r.observe(e)}return o(!0),i}function V_(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=qm(e),d=s||i?[...u?Pl(u):[],...Pl(t)]:[];d.forEach(w=>{s&&w.addEventListener("scroll",r,{passive:!0}),i&&w.addEventListener("resize",r)});const m=u&&l?H_(u,r):null;let f=-1,p=null;o&&(p=new ResizeObserver(w=>{let[v]=w;v&&v.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var y;(y=p)==null||y.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let x,h=c?Ua(e):null;c&&g();function g(){const w=Ua(e);h&&!R2(h,w)&&r(),h=w,x=requestAnimationFrame(g)}return r(),()=>{var w;d.forEach(v=>{s&&v.removeEventListener("scroll",r),i&&v.removeEventListener("resize",r)}),m==null||m(),(w=p)==null||w.disconnect(),p=null,c&&cancelAnimationFrame(x)}}const z_=S_,G_=j_,K_=w_,Y_=E_,X_=b_,Pg=y_,q_=T_,Q_=(e,t,r)=>{const n=new Map,s={platform:W_,...r},i={...s.platform,_c:n};return v_(e,t,{...s,platform:i})};var ou=typeof document<"u"?b.useLayoutEffect:b.useEffect;function Vu(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Vu(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&e.$$typeof)&&!Vu(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function I2(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Fg(e,t){const r=I2(e);return Math.round(t*r)/r}function L0(e){const t=b.useRef(e);return ou(()=>{t.current=e}),t}function J_(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,m]=b.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=b.useState(n);Vu(f,n)||p(n);const[x,h]=b.useState(null),[g,w]=b.useState(null),v=b.useCallback(V=>{V!==C.current&&(C.current=V,h(V))},[]),y=b.useCallback(V=>{V!==j.current&&(j.current=V,w(V))},[]),N=i||x,S=o||g,C=b.useRef(null),j=b.useRef(null),E=b.useRef(d),k=c!=null,F=L0(c),M=L0(s),R=L0(u),z=b.useCallback(()=>{if(!C.current||!j.current)return;const V={placement:t,strategy:r,middleware:f};M.current&&(V.platform=M.current),Q_(C.current,j.current,V).then(te=>{const ue={...te,isPositioned:R.current!==!1};B.current&&!Vu(E.current,ue)&&(E.current=ue,Ka.flushSync(()=>{m(ue)}))})},[f,t,r,M,R]);ou(()=>{u===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,m(V=>({...V,isPositioned:!1})))},[u]);const B=b.useRef(!1);ou(()=>(B.current=!0,()=>{B.current=!1}),[]),ou(()=>{if(N&&(C.current=N),S&&(j.current=S),N&&S){if(F.current)return F.current(N,S,z);z()}},[N,S,z,F,k]);const K=b.useMemo(()=>({reference:C,floating:j,setReference:v,setFloating:y}),[v,y]),X=b.useMemo(()=>({reference:N,floating:S}),[N,S]),ee=b.useMemo(()=>{const V={position:r,left:0,top:0};if(!X.floating)return V;const te=Fg(X.floating,d.x),ue=Fg(X.floating,d.y);return l?{...V,transform:"translate("+te+"px, "+ue+"px)",...I2(X.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:te,top:ue}},[r,l,X.floating,d.x,d.y]);return b.useMemo(()=>({...d,update:z,refs:K,elements:X,floatingStyles:ee}),[d,z,K,X,ee])}const Z_=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Pg({element:n.current,padding:s}).fn(r):{}:n?Pg({element:n,padding:s}).fn(r):{}}}},e3=(e,t)=>({...z_(e),options:[e,t]}),t3=(e,t)=>({...G_(e),options:[e,t]}),r3=(e,t)=>({...q_(e),options:[e,t]}),n3=(e,t)=>({...K_(e),options:[e,t]}),s3=(e,t)=>({...Y_(e),options:[e,t]}),a3=(e,t)=>({...X_(e),options:[e,t]}),i3=(e,t)=>({...Z_(e),options:[e,t]});var o3="Arrow",D2=b.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...i}=e;return a.jsx(Me.svg,{...i,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});D2.displayName=o3;var l3=D2;function O2(e){const[t,r]=b.useState(void 0);return ar(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Jm="Popper",[L2,Dd]=la(Jm),[c3,M2]=L2(Jm),B2=e=>{const{__scopePopper:t,children:r}=e,[n,s]=b.useState(null);return a.jsx(c3,{scope:t,anchor:n,onAnchorChange:s,children:r})};B2.displayName=Jm;var U2="PopperAnchor",$2=b.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,i=M2(U2,r),o=b.useRef(null),l=ut(t,o);return b.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:a.jsx(Me.div,{...s,ref:l})});$2.displayName=U2;var Zm="PopperContent",[u3,d3]=L2(Zm),W2=b.forwardRef((e,t)=>{var Y,ae,oe,se,we,pe;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:m="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:x,...h}=e,g=M2(Zm,r),[w,v]=b.useState(null),y=ut(t,Fe=>v(Fe)),[N,S]=b.useState(null),C=O2(N),j=(C==null?void 0:C.width)??0,E=(C==null?void 0:C.height)??0,k=n+(i!=="center"?"-"+i:""),F=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},M=Array.isArray(u)?u:[u],R=M.length>0,z={padding:F,boundary:M.filter(h3),altBoundary:R},{refs:B,floatingStyles:K,placement:X,isPositioned:ee,middlewareData:V}=J_({strategy:"fixed",placement:k,whileElementsMounted:(...Fe)=>V_(...Fe,{animationFrame:p==="always"}),elements:{reference:g.anchor},middleware:[e3({mainAxis:s+E,alignmentAxis:o}),c&&t3({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?r3():void 0,...z}),c&&n3({...z}),s3({...z,apply:({elements:Fe,rects:Ee,availableWidth:Pt,availableHeight:ze})=>{const{width:ge,height:pr}=Ee.reference,gr=Fe.floating.style;gr.setProperty("--radix-popper-available-width",`${Pt}px`),gr.setProperty("--radix-popper-available-height",`${ze}px`),gr.setProperty("--radix-popper-anchor-width",`${ge}px`),gr.setProperty("--radix-popper-anchor-height",`${pr}px`)}}),N&&i3({element:N,padding:l}),m3({arrowWidth:j,arrowHeight:E}),f&&a3({strategy:"referenceHidden",...z})]}),[te,ue]=z2(X),xe=Cr(x);ar(()=>{ee&&(xe==null||xe())},[ee,xe]);const L=(Y=V.arrow)==null?void 0:Y.x,G=(ae=V.arrow)==null?void 0:ae.y,U=((oe=V.arrow)==null?void 0:oe.centerOffset)!==0,[A,H]=b.useState();return ar(()=>{w&&H(window.getComputedStyle(w).zIndex)},[w]),a.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:ee?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:A,"--radix-popper-transform-origin":[(se=V.transformOrigin)==null?void 0:se.x,(we=V.transformOrigin)==null?void 0:we.y].join(" "),...((pe=V.hide)==null?void 0:pe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(u3,{scope:r,placedSide:te,onArrowChange:S,arrowX:L,arrowY:G,shouldHideArrow:U,children:a.jsx(Me.div,{"data-side":te,"data-align":ue,...h,ref:y,style:{...h.style,animation:ee?void 0:"none"}})})})});W2.displayName=Zm;var H2="PopperArrow",f3={top:"bottom",right:"left",bottom:"top",left:"right"},V2=b.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,i=d3(H2,n),o=f3[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(l3,{...s,ref:r,style:{...s.style,display:"block"}})})});V2.displayName=H2;function h3(e){return e!==null}var m3=e=>({name:"transformOrigin",options:e,fn(t){var g,w,v;const{placement:r,rects:n,middlewareData:s}=t,o=((g=s.arrow)==null?void 0:g.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[u,d]=z2(r),m={start:"0%",center:"50%",end:"100%"}[d],f=(((w=s.arrow)==null?void 0:w.x)??0)+l/2,p=(((v=s.arrow)==null?void 0:v.y)??0)+c/2;let x="",h="";return u==="bottom"?(x=o?m:`${f}px`,h=`${-c}px`):u==="top"?(x=o?m:`${f}px`,h=`${n.floating.height+c}px`):u==="right"?(x=`${-c}px`,h=o?m:`${p}px`):u==="left"&&(x=`${n.floating.width+c}px`,h=o?m:`${p}px`),{data:{x,y:h}}}});function z2(e){const[t,r="center"]=e.split("-");return[t,r]}var x3=B2,G2=$2,K2=W2,Y2=V2,[Od,m7]=la("Tooltip",[Dd]),ex=Dd(),X2="TooltipProvider",p3=700,Rg="tooltip.open",[g3,q2]=Od(X2),Q2=e=>{const{__scopeTooltip:t,delayDuration:r=p3,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=e,o=b.useRef(!0),l=b.useRef(!1),c=b.useRef(0);return b.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),a.jsx(g3,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:b.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:b.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:b.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};Q2.displayName=X2;var J2="Tooltip",[x7,Ld]=Od(J2),Nh="TooltipTrigger",v3=b.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=Ld(Nh,r),i=q2(Nh,r),o=ex(r),l=b.useRef(null),c=ut(t,l,s.onTriggerChange),u=b.useRef(!1),d=b.useRef(!1),m=b.useCallback(()=>u.current=!1,[]);return b.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),a.jsx(G2,{asChild:!0,...o,children:a.jsx(Me.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:c,onPointerMove:Ce(e.onPointerMove,f=>{f.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:Ce(e.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:Ce(e.onPointerDown,()=>{s.open&&s.onClose(),u.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:Ce(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:Ce(e.onBlur,s.onClose),onClick:Ce(e.onClick,s.onClose)})})});v3.displayName=Nh;var y3="TooltipPortal",[p7,w3]=Od(y3,{forceMount:void 0}),co="TooltipContent",Z2=b.forwardRef((e,t)=>{const r=w3(co,e.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=e,o=Ld(co,e.__scopeTooltip);return a.jsx(Cd,{present:n||o.open,children:o.disableHoverableContent?a.jsx(eb,{side:s,...i,ref:t}):a.jsx(b3,{side:s,...i,ref:t})})}),b3=b.forwardRef((e,t)=>{const r=Ld(co,e.__scopeTooltip),n=q2(co,e.__scopeTooltip),s=b.useRef(null),i=ut(t,s),[o,l]=b.useState(null),{trigger:c,onClose:u}=r,d=s.current,{onPointerInTransitChange:m}=n,f=b.useCallback(()=>{l(null),m(!1)},[m]),p=b.useCallback((x,h)=>{const g=x.currentTarget,w={x:x.clientX,y:x.clientY},v=E3(w,g.getBoundingClientRect()),y=C3(w,v),N=k3(h.getBoundingClientRect()),S=A3([...y,...N]);l(S),m(!0)},[m]);return b.useEffect(()=>()=>f(),[f]),b.useEffect(()=>{if(c&&d){const x=g=>p(g,d),h=g=>p(g,c);return c.addEventListener("pointerleave",x),d.addEventListener("pointerleave",h),()=>{c.removeEventListener("pointerleave",x),d.removeEventListener("pointerleave",h)}}},[c,d,p,f]),b.useEffect(()=>{if(o){const x=h=>{const g=h.target,w={x:h.clientX,y:h.clientY},v=(c==null?void 0:c.contains(g))||(d==null?void 0:d.contains(g)),y=!_3(w,o);v?f():y&&(f(),u())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[c,d,o,u,f]),a.jsx(eb,{...e,ref:i})}),[N3,S3]=Od(J2,{isInside:!1}),j3=TC("TooltipContent"),eb=b.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=Ld(co,r),u=ex(r),{onClose:d}=c;return b.useEffect(()=>(document.addEventListener(Rg,d),()=>document.removeEventListener(Rg,d)),[d]),b.useEffect(()=>{if(c.trigger){const m=f=>{const p=f.target;p!=null&&p.contains(c.trigger)&&d()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[c.trigger,d]),a.jsx(Ed,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:m=>m.preventDefault(),onDismiss:d,children:a.jsxs(K2,{"data-state":c.stateAttribute,...u,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(j3,{children:n}),a.jsx(N3,{scope:r,isInside:!0,children:a.jsx(zC,{id:c.contentId,role:"tooltip",children:s||n})})]})})});Z2.displayName=co;var tb="TooltipArrow",T3=b.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=ex(r);return S3(tb,r).isInside?null:a.jsx(Y2,{...s,...n,ref:t})});T3.displayName=tb;function E3(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function C3(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function k3(e){const{top:t,right:r,bottom:n,left:s}=e;return[{x:s,y:t},{x:r,y:t},{x:r,y:n},{x:s,y:n}]}function _3(e,t){const{x:r,y:n}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,c=t[i].y,u=t[o].x,d=t[o].y;c>n!=d>n&&r<(u-l)*(n-c)/(d-c)+l&&(s=!s)}return s}function A3(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),P3(t)}function P3(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const s=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const s=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var F3=Q2,rb=Z2;const R3=F3,I3=b.forwardRef(({className:e,sideOffset:t=4,...r},n)=>a.jsx(rb,{ref:n,sideOffset:t,className:He("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...r}));I3.displayName=rb.displayName;const D3=Ad("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),je=b.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},i)=>{const o=n?SC:"button";return a.jsx(o,{className:He(D3({variant:t,size:r,className:e})),ref:i,...s})});je.displayName="Button";const O3=Ad("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function De({className:e,variant:t,...r}){return a.jsx("div",{className:He(O3({variant:t}),e),...r})}function bi({id:e,title:t,content:r,type:n="info",placement:s="top",trigger:i="hover",children:o,className:l=""}){const[c,u]=b.useState(!1),[d,m]=b.useState(()=>localStorage.getItem(`tooltip-dismissed-${e}`)==="true"),f=()=>{d||u(!0)},p=()=>{u(!1)},x=()=>{m(!0),u(!1),localStorage.setItem(`tooltip-dismissed-${e}`,"true")},h=()=>{switch(n){case"help":return a.jsx(vk,{className:"h-4 w-4"});case"success":return a.jsx($t,{className:"h-4 w-4"});case"warning":return a.jsx(wg,{className:"h-4 w-4 text-yellow-400"});default:return a.jsx(wg,{className:"h-4 w-4"})}},g=()=>{switch(n){case"help":return"bg-blue-800 border-blue-600 text-blue-100";case"success":return"bg-green-800 border-green-600 text-green-100";case"warning":return"bg-yellow-800 border-yellow-600 text-yellow-100";default:return"bg-slate-800 border-slate-600 text-slate-100"}},w=()=>{switch(s){case"bottom":return"top-full left-1/2 transform -translate-x-1/2 mt-2";case"left":return"right-full top-1/2 transform -translate-y-1/2 mr-2";case"right":return"left-full top-1/2 transform -translate-y-1/2 ml-2";default:return"bottom-full left-1/2 transform -translate-x-1/2 mb-2"}},v=()=>{const N="absolute w-0 h-0 border-solid";switch(s){case"bottom":return`${N} border-l-4 border-r-4 border-b-4 border-transparent border-b-slate-600 top-0 left-1/2 transform -translate-x-1/2 -translate-y-full`;case"left":return`${N} border-t-4 border-b-4 border-l-4 border-transparent border-l-slate-600 right-0 top-1/2 transform translate-x-full -translate-y-1/2`;case"right":return`${N} border-t-4 border-b-4 border-r-4 border-transparent border-r-slate-600 left-0 top-1/2 transform -translate-x-full -translate-y-1/2`;default:return`${N} border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-600 bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full`}};if(d)return a.jsx(a.Fragment,{children:o});const y=i==="hover"?{onMouseEnter:f,onMouseLeave:p}:{onClick:()=>u(!c)};return a.jsxs("div",{className:`relative inline-block ${l}`,...y,children:[o,c&&a.jsx("div",{className:`absolute z-50 ${w()}`,children:a.jsxs("div",{className:`relative max-w-xs p-3 rounded-lg border shadow-lg ${g()}`,children:[a.jsx("div",{className:v()}),a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[h(),a.jsx("h4",{className:"font-medium text-sm",children:t})]}),a.jsx("button",{onClick:x,className:"text-slate-400 hover:text-white text-xs ml-2",children:""})]}),a.jsx("p",{className:"text-xs leading-relaxed",children:r}),a.jsx("button",{onClick:x,className:"mt-2 text-xs bg-slate-700 hover:bg-slate-600 px-2 py-1 rounded",children:"Got it"})]})})]})}function nb(e){const[t,r]=b.useState(e.currentStep||0),[n,s]=b.useState(()=>{const f=localStorage.getItem(`workflow-${e.workflow}-completed`);return f?JSON.parse(f):[]});return b.useEffect(()=>{localStorage.setItem(`workflow-${e.workflow}-completed`,JSON.stringify(n))},[n,e.workflow]),{currentStep:t,setCurrentStep:r,completedSteps:n,markStepCompleted:f=>{n.includes(f)||s(p=>[...p,f])},resetWorkflow:()=>{s([]),r(0),localStorage.removeItem(`workflow-${e.workflow}-completed`)},nextStep:()=>{t<e.steps.length-1&&r(f=>f+1)},previousStep:()=>{t>0&&r(f=>f-1)},isStepCompleted:f=>n.includes(f),getCurrentStep:()=>e.steps[t],getProgress:()=>Math.round(n.length/e.steps.length*100),totalSteps:e.steps.length}}const sb={csvUpload:{workflow:"csv-upload",steps:[{id:"file-selection",title:"Select CSV File",content:"Choose a CSV file with required headers: Name, Address, Post code, Project Type, Build Phase. Files must be under 10MB.",type:"info"},{id:"file-validation",title:"File Validation",content:"System validates file format, size, and structure. Only authentic CSV data is accepted.",type:"help"},{id:"data-processing",title:"Data Processing",content:"Extract job information from CSV rows. GPS coordinates are automatically generated from postcodes.",type:"help"},{id:"job-creation",title:"Job Creation",content:"Jobs created with build phases and location data. Ready for contractor assignment.",type:"success"}]},gpsTracking:{workflow:"gps-tracking",steps:[{id:"location-check",title:"GPS Location Check",content:"Verify GPS signal strength and accuracy. Location services must be enabled.",type:"info"},{id:"proximity-validation",title:"Work Site Proximity",content:"Must be within 1km of assigned work site. Distance calculated using GPS coordinates.",type:"help"},{id:"time-validation",title:"Working Hours Check",content:"Valid working hours: 7:45 AM - 5:00 PM. Late arrivals after 8:15 AM incur 0.50/minute deductions.",type:"warning"},{id:"session-start",title:"Start Time Tracking",content:"GPS-verified time tracking begins. Session data saved to database with coordinates.",type:"success"},{id:"session-end",title:"End Session",content:"Stop tracking and calculate pay. CIS deductions applied automatically.",type:"warning"}]},contractorOnboarding:{workflow:"contractor-onboarding",steps:[{id:"personal-info",title:"Personal Information",content:"Enter your basic personal details including name, email, phone, and Telegram ID for notifications.",type:"info"},{id:"address-info",title:"Address Details",content:"Provide your full address including postcode. This helps us match you to nearby job sites.",type:"info"},{id:"right-to-work",title:"Right to Work",content:"Confirm your right to work in the UK and provide passport details. This is legally required.",type:"warning"},{id:"cis-tax",title:"CIS & Tax Information",content:"Provide your CIS status and UTR number. This determines how your taxes are handled.",type:"help"},{id:"banking-details",title:"Banking Information",content:"Enter your bank account details for payment processing. All information is securely stored.",type:"warning"},{id:"emergency-contact",title:"Emergency Contact",content:"Provide emergency contact details for safety compliance on construction sites.",type:"info"},{id:"trade-tools",title:"Trade & Tools",content:"Specify your primary trade, experience, and available tools to match you to suitable jobs.",type:"success"}]},csvDataUpload:{workflow:"csv-upload",steps:[{id:"file-selection",title:"File Selection",content:"Select a CSV file containing job data. The file must have specific headers: Name, Address, Post code, Project Type, and Build Phase.",type:"info"},{id:"file-validation",title:"File Validation",content:"The system validates your CSV format and checks for required data fields before processing.",type:"help"},{id:"data-processing",title:"Data Processing",content:"CSV data is extracted and jobs are created automatically. Only authentic CSV data is used - no assumptions made.",type:"warning"},{id:"job-creation",title:"Job Creation",content:"Successfully processed CSV data creates jobs that can be assigned to contractors.",type:"success"}]},jobAssignment:{workflow:"job-assignment",steps:[{id:"job-selection",title:"Job Selection",content:"Choose a pending job from the list. Jobs come from CSV uploads and contain authentic project data.",type:"info"},{id:"contractor-selection",title:"Contractor Selection",content:"Select an available contractor based on their skills and current workload.",type:"help"},{id:"due-date",title:"Due Date",content:"Set a realistic completion date based on project scope and contractor availability.",type:"warning"},{id:"special-notes",title:"Special Instructions",content:"Add any specific requirements, safety notes, or special instructions for the contractor.",type:"info"},{id:"assignment-confirmation",title:"Assignment Confirmation",content:"Review all details before confirming. The contractor will be notified via Telegram if configured.",type:"success"}]},gpsTimeTracking:{workflow:"gps-tracking",steps:[{id:"location-verification",title:"Location Verification",content:"GPS coordinates are checked to ensure you are within 1km of the assigned work site.",type:"warning"},{id:"working-hours",title:"Working Hours",content:"Clock-in is only allowed between 7:45 AM - 5:00 PM. Automatic logout occurs at 5:00 PM sharp.",type:"help"},{id:"time-tracking",title:"Time Tracking",content:"Your work session is automatically tracked with GPS coordinates stored for verification.",type:"info"},{id:"pay-calculation",title:"Pay Calculation",content:"Daily pay (150) with deductions for late arrivals after 8:15 AM (0.50/minute). 20% CIS deduction applied.",type:"success"}]}},_e=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));_e.displayName="Card";const et=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("flex flex-col space-y-1.5 p-6",e),...t}));et.displayName="CardHeader";const tt=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("text-2xl font-semibold leading-none tracking-tight",e),...t}));tt.displayName="CardTitle";const mn=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("text-sm text-muted-foreground",e),...t}));mn.displayName="CardDescription";const Ae=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("p-6 pt-0",e),...t}));Ae.displayName="CardContent";const L3=b.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:He("flex items-center p-6 pt-0",e),...t}));L3.displayName="CardFooter";const tc=b.forwardRef(({className:e,...t},r)=>a.jsx("textarea",{className:He("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));tc.displayName="Textarea";function M3({contractorName:e}){const[t,r]=b.useState(!1),[n,s]=b.useState({}),{toast:i}=Tt(),o=oa(),{data:l=[],isLoading:c}=rt({queryKey:[`/api/task-inspection-results/${e}`],enabled:!!e}),u=Tr({mutationFn:async({inspectionId:x,notes:h})=>(await Ai("POST",`/api/task-inspection-results/${x}/mark-done`,{contractorName:e,fixNotes:h})).json(),onSuccess:()=>{o.invalidateQueries({queryKey:[`/api/task-inspection-results/${e}`]}),i({title:"Issue Marked as Resolved",description:"Issue has been marked as fixed. Waiting for admin approval."}),s({})},onError:x=>{i({title:"Error",description:x.message||"Failed to mark issue as resolved",variant:"destructive"})}});if(c)return a.jsxs(_e,{className:"border-slate-600 bg-slate-700/50",children:[a.jsx(et,{children:a.jsxs(tt,{className:"text-amber-500 flex items-center gap-2",children:[a.jsx(Bn,{className:"h-5 w-5"}),"Task Inspections"]})}),a.jsx(Ae,{children:a.jsx("div",{className:"text-slate-400",children:"Loading inspection results..."})})]});if(l.length===0)return a.jsxs(_e,{className:"border-slate-600 bg-slate-700/50",children:[a.jsx(et,{children:a.jsxs(tt,{className:"text-amber-500 flex items-center gap-2",children:[a.jsx($t,{className:"h-5 w-5"}),"Task Inspections"]})}),a.jsx(Ae,{children:a.jsx("div",{className:"text-slate-400",children:"No inspection results yet."})})]});const d=t?l:l.filter(x=>x.inspectionStatus==="issues"),m=l.filter(x=>x.inspectionStatus==="issues").length,f=l.filter(x=>x.inspectionStatus==="approved").length,p=l.filter(x=>x.inspectionStatus==="pending").length;return a.jsxs(_e,{className:"border-slate-600 bg-slate-700/50",children:[a.jsx(et,{children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs(tt,{className:"text-amber-500 flex items-center gap-2",children:[m>0?a.jsx(Hm,{className:"h-5 w-5 text-red-500"}):a.jsx($t,{className:"h-5 w-5 text-green-500"}),"Task Inspections"]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[m>0&&a.jsxs(De,{variant:"destructive",className:"text-xs",children:[m," Issues"]}),f>0&&a.jsxs(De,{variant:"default",className:"bg-green-600 text-xs",children:[f," Approved"]}),p>0&&a.jsxs(De,{variant:"secondary",className:"text-xs",children:[p," Pending"]})]})]})}),a.jsxs(Ae,{className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2 mb-4",children:[a.jsxs(je,{variant:t?"outline":"default",size:"sm",onClick:()=>r(!1),className:"text-xs",children:["Issues Only (",m,")"]}),a.jsxs(je,{variant:t?"default":"outline",size:"sm",onClick:()=>r(!0),className:"text-xs",children:["All Results (",l.length,")"]})]}),d.length===0?a.jsx("div",{className:"text-center py-6 text-slate-400",children:t?"No inspection results yet.":"No issues found. Great work!"}):a.jsx("div",{className:"space-y-3",children:d.map(x=>a.jsxs("div",{className:`p-4 rounded-lg border ${x.inspectionStatus==="issues"?"border-red-500/30 bg-red-900/20":x.inspectionStatus==="approved"?"border-green-500/30 bg-green-900/20":"border-amber-500/30 bg-amber-900/20"}`,children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-slate-200 text-sm",children:x.taskName}),a.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:[a.jsx("span",{className:"inline-block mr-3",children:x.phase}),a.jsxs("span",{children:["Inspected by ",x.inspectedBy]})]})]}),a.jsx(De,{variant:x.inspectionStatus==="issues"?"destructive":x.inspectionStatus==="approved"?"default":"secondary",className:"text-xs",children:x.inspectionStatus==="issues"?"Needs Attention":x.inspectionStatus==="approved"?"Approved":"Pending Review"})]}),x.notes&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Uu,{className:"h-4 w-4 text-slate-400"}),a.jsx("span",{className:"text-xs text-slate-400",children:"Inspector Notes:"})]}),a.jsx("div",{className:"text-sm text-slate-300 bg-slate-800/50 p-3 rounded border border-slate-600",children:x.notes})]}),x.photos&&x.photos.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(xh,{className:"h-4 w-4 text-slate-400"}),a.jsxs("span",{className:"text-xs text-slate-400",children:["Photos (",x.photos.length,"):"]})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2",children:x.photos.map((h,g)=>a.jsx("div",{className:"aspect-square bg-slate-800 rounded border border-slate-600 overflow-hidden",children:a.jsx("img",{src:h,alt:`Inspection photo ${g+1}`,className:"w-full h-full object-cover hover:scale-105 transition-transform cursor-pointer",onClick:()=>window.open(h,"_blank")})},g))})]}),x.inspectionStatus==="issues"&&a.jsxs("div",{className:"mt-4 p-3 bg-slate-800/70 rounded-lg border border-slate-600",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(gh,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{className:"text-sm font-medium text-slate-200",children:"Mark as Fixed"})]}),a.jsx(tc,{placeholder:"Describe what you did to fix this issue (optional)",value:n[x.id]||"",onChange:h=>s(g=>({...g,[x.id]:h.target.value})),className:"mb-3 bg-slate-700 border-slate-600 text-slate-200 text-sm",rows:2}),a.jsx(je,{onClick:()=>u.mutate({inspectionId:x.id,notes:n[x.id]||""}),disabled:u.isPending,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"sm",children:u.isPending?a.jsxs(a.Fragment,{children:[a.jsx(Bn,{className:"h-4 w-4 mr-2 animate-spin"}),"Marking as Done..."]}):a.jsxs(a.Fragment,{children:[a.jsx($t,{className:"h-4 w-4 mr-2"}),"Mark as Done"]})}),a.jsx("div",{className:"text-xs text-slate-400 mt-2 text-center",children:"This will notify the admin for re-approval"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Inspected: ",new Date(x.inspectedAt).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]},x.id))})]})]})}/*! Capacitor: https://capacitorjs.com/ - MIT License */var uo;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(uo||(uo={}));class M0 extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}}const B3=e=>{var t,r;return e!=null&&e.androidBridge?"android":!((r=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},U3=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},n=r.Plugins=r.Plugins||{},s=()=>t!==null?t.name:B3(e),i=()=>s()!=="web",o=m=>{const f=u.get(m);return!!(f!=null&&f.platforms.has(s())||l(m))},l=m=>{var f;return(f=r.PluginHeaders)===null||f===void 0?void 0:f.find(p=>p.name===m)},c=m=>e.console.error(m),u=new Map,d=(m,f={})=>{const p=u.get(m);if(p)return console.warn(`Capacitor plugin "${m}" already registered. Cannot register plugins twice.`),p.proxy;const x=s(),h=l(m);let g;const w=async()=>(!g&&x in f?g=typeof f[x]=="function"?g=await f[x]():g=f[x]:t!==null&&!g&&"web"in f&&(g=typeof f.web=="function"?g=await f.web():g=f.web),g),v=(E,k)=>{var F,M;if(h){const R=h==null?void 0:h.methods.find(z=>k===z.name);if(R)return R.rtype==="promise"?z=>r.nativePromise(m,k.toString(),z):(z,B)=>r.nativeCallback(m,k.toString(),z,B);if(E)return(F=E[k])===null||F===void 0?void 0:F.bind(E)}else{if(E)return(M=E[k])===null||M===void 0?void 0:M.bind(E);throw new M0(`"${m}" plugin is not implemented on ${x}`,uo.Unimplemented)}},y=E=>{let k;const F=(...M)=>{const R=w().then(z=>{const B=v(z,E);if(B){const K=B(...M);return k=K==null?void 0:K.remove,K}else throw new M0(`"${m}.${E}()" is not implemented on ${x}`,uo.Unimplemented)});return E==="addListener"&&(R.remove=async()=>k()),R};return F.toString=()=>`${E.toString()}() { [capacitor code] }`,Object.defineProperty(F,"name",{value:E,writable:!1,configurable:!1}),F},N=y("addListener"),S=y("removeListener"),C=(E,k)=>{const F=N({eventName:E},k),M=async()=>{const z=await F;S({eventName:E,callbackId:z},k)},R=new Promise(z=>F.then(()=>z({remove:M})));return R.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await M()},R},j=new Proxy({},{get(E,k){switch(k){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return h?C:N;case"removeListener":return S;default:return y(k)}}});return n[m]=j,u.set(m,{name:m,proxy:j,platforms:new Set([...Object.keys(f),...h?[x]:[]])}),j};return r.convertFileSrc||(r.convertFileSrc=m=>m),r.getPlatform=s,r.handleError=c,r.isNativePlatform=i,r.isPluginAvailable=o,r.registerPlugin=d,r.Exception=M0,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},$3=e=>e.Capacitor=U3(e),Fl=$3(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),tx=Fl.registerPlugin;class ab{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let n=!1;this.listeners[t]||(this.listeners[t]=[],n=!0),this.listeners[t].push(r);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(t);const o=async()=>this.removeListener(t,r);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,n){const s=this.listeners[t];if(!s){if(n){let i=this.retainedEventArguments[t];i||(i=[]),i.push(r),this.retainedEventArguments[t]=i}return}s.forEach(i=>i(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new Fl.Exception(t,uo.Unimplemented)}unavailable(t="not available"){return new Fl.Exception(t,uo.Unavailable)}async removeListener(t,r){const n=this.listeners[t];if(!n)return;const s=n.indexOf(r);this.listeners[t].splice(s,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(n=>{this.notifyListeners(t,n)}))}}const Ig=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Dg=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class W3 extends ab{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[s,i]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Dg(s).trim(),i=Dg(i).trim(),r[s]=i}),r}async setCookie(t){try{const r=Ig(t.key),n=Ig(t.value),s=`; expires=${(t.expires||"").replace("expires=","")}`,i=(t.path||"/").replace("path=",""),o=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${s}; path=${i}; ${o};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}tx("CapacitorCookies",{web:()=>new W3});const H3=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const s=n.result;t(s.indexOf(",")>=0?s.split(",")[1]:s)},n.onerror=s=>r(s),n.readAsDataURL(e)}),V3=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=e[t[o]],s),{})},z3=(e,t=!0)=>e?Object.entries(e).reduce((n,s)=>{const[i,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(u=>{l=t?encodeURIComponent(u):u,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=t?encodeURIComponent(o):o,c=`${i}=${l}`),`${n}&${c}`},"").substr(1):null,G3=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),s=V3(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(e.data||{}))i.set(o,l);r.body=i.toString()}else if(s.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(e.data))i.append(l,e.data[l]);r.body=i;const o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(s.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class K3 extends ab{async request(t){const r=G3(t,t.webFetchExtra),n=z3(t.params,t.shouldEncodeUrlParams),s=n?`${t.url}?${n}`:t.url,i=await fetch(s,r),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?t:{};o.includes("application/json")&&(l="json");let c,u;switch(l){case"arraybuffer":case"blob":u=await i.blob(),c=await H3(u);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const d={};return i.headers.forEach((m,f)=>{d[f]=m}),{data:c,headers:d,status:i.status,url:i.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}tx("CapacitorHttp",{web:()=>new K3});const B0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Sh(){const e=typeof window<"u"&&localStorage.getItem("API_BASE")||void 0,t=B0==null?void 0:B0.VITE_API_BASE,r=e||t||"";return Fl.isNativePlatform()&&!r&&console.warn("API base not set for native platform. Set 'API_BASE' in localStorage or 'VITE_API_BASE' at build time."),r}async function hn(e,t){const r=Sh(),n=r?`${r}${e}`:e;return fetch(n,t)}const Y3="modulepreload",X3=function(e){return"/"+e},Og={},q3=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=X3(c),c in Og)return;Og[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Y3,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((f,p)=>{m.addEventListener("load",f),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function Q3(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,r){return new Proxy({},{get(n,s){return(i,o,l)=>{const c=e.Capacitor.Plugins[r];if(c===void 0){l(new Error(`Capacitor plugin ${r} not found`));return}if(typeof c[s]!="function"){l(new Error(`Method ${s} not found in Capacitor plugin ${r}`));return}(async()=>{try{const u=await c[s](i);o(u)}catch(u){l(u)}})()}}})}})}function J3(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,r){return e.cordova.plugins[r]}})}function Z3(e=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!e?Q3(window):window.cordova!==void 0&&J3(window))}const Lg=tx("Geolocation",{web:()=>q3(()=>import("./web-BKZRSM4N.js"),[]).then(e=>new e.GeolocationWeb)});Z3();async function jh(){if(Fl.isNativePlatform()){await Lg.requestPermissions();const e=await Lg.getCurrentPosition({enableHighAccuracy:!0});return{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy??void 0}}return new Promise((e,t)=>{if(!navigator.geolocation)return t(new Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(r=>{e({latitude:r.coords.latitude,longitude:r.coords.longitude,accuracy:r.coords.accuracy??void 0})},r=>t(new Error(r.message||"Failed to get location")),{enableHighAccuracy:!0,timeout:1e4})})}function eA({nearestJobSite:e}){const r=(localStorage.getItem("contractorName")||"James Wilson").split(" ")[0],{data:n=[],isLoading:s}=rt({queryKey:[`/api/contractor-assignments/${r}`]});if(rt({queryKey:["/api/uploaded-jobs"]}),s)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mx-auto mb-4"}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Loading assignments..."})]});if(n.length===0)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-briefcase text-slate-500 text-3xl"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Active Assignment"}),a.jsx("div",{className:"text-slate-400 text-sm",children:"You don't have any active assignments at the moment. Check with your supervisor for new work."})]});const i=n;return a.jsx("div",{className:"space-y-3",children:i.map((o,l)=>a.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-yellow-400"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-white font-medium text-lg",children:o.workLocation}),a.jsx("div",{className:"text-slate-400 text-sm",children:o.hbxlJob})]})]}),a.jsx(De,{className:"bg-yellow-500 text-black text-xs px-2 py-1",children:"active"})]}),o.buildPhases&&o.buildPhases.length>0&&a.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:o.buildPhases.map((c,u)=>a.jsx("span",{className:"bg-blue-600 text-white text-xs px-2 py-0.5 rounded",children:c},u))})]},o.id))})}function tA(){const{toast:e}=Tt(),t=oa(),r=localStorage.getItem("userRole"),n=localStorage.getItem("adminName"),s=localStorage.getItem("contractorName");if(console.log(" GPS DASHBOARD ACCESS ATTEMPT:",{userRole:r,adminName:n,contractorName:s,isAdmin:r==="admin",shouldRedirect:r==="admin"}),r==="admin")return console.log(" ADMIN USER BLOCKED FROM GPS DASHBOARD - Redirecting to /admin"),window.location.href="/admin",a.jsx("div",{children:"Redirecting admin to dashboard..."});if(!s)return console.log(" No contractor name found - redirecting to login"),window.location.href="/login",null;const i=s.split(" ")[0],o=A=>A.split(" ").map(H=>H[0]).join("").toUpperCase().slice(0,2);nb(sb.gpsTracking);const[l,c]=b.useState(()=>localStorage.getItem("gps_timer_current")||"00:00:00"),[u,d]=b.useState(()=>localStorage.getItem("gps_timer_active")==="true"),[m,f]=b.useState(()=>{const A=localStorage.getItem("gps_timer_start");return A?new Date(A):null});b.useState(null);const[p,x]=b.useState("Unavailable"),[h,g]=b.useState(!1),[w,v]=b.useState(!1),[y,N]=b.useState(null);rt({queryKey:[`/api/work-sessions/${i}/active`],queryFn:async()=>{const A=await hn(`/api/work-sessions/${i}/active`);if(A.status===404)return null;if(!A.ok)throw new Error("Failed to fetch active session");return A.json()},retry:!1});const S=Tr({mutationFn:async A=>{const H=await hn("/api/work-sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!H.ok)throw new Error("Failed to start session");return H.json()},onSuccess:A=>{N(A.id),t.invalidateQueries({queryKey:[`/api/work-sessions/${i}/active`]}),console.log(" Work session started in database:",A.id)}}),C=Tr({mutationFn:async({sessionId:A,sessionData:H})=>{const Y=await hn(`/api/work-sessions/${A}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!Y.ok)throw new Error("Failed to end session");return Y.json()},onSuccess:A=>{N(null),t.invalidateQueries({queryKey:[`/api/work-sessions/${i}/active`]}),console.log(" Work session ended in database:",A.totalHours)}}),{data:j=[]}=rt({queryKey:[`/api/contractor-assignments/${i}`]}),E=j,k=async(A,H)=>{try{await hn("/api/update-location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:s,latitude:A,longitude:H})}),console.log(` Location sent to live monitor: ${A}, ${H}`)}catch(Y){console.error(" Failed to send location update:",Y)}},{data:F}=rt({queryKey:["/api/admin-settings/saturday_overtime"],queryFn:async()=>{const A=await hn("/api/admin-settings/saturday_overtime");if(A.status===404)return null;if(!A.ok)throw new Error("Failed to fetch Saturday overtime setting");return A.json()},retry:!1}),{data:M}=rt({queryKey:["/api/admin-settings/sunday_overtime"],queryFn:async()=>{const A=await hn("/api/admin-settings/sunday_overtime");if(A.status===404)return null;if(!A.ok)throw new Error("Failed to fetch Sunday overtime setting");return A.json()},retry:!1}),[R,z]=b.useState(null),[B,K]=b.useState(null),[X,ee]=b.useState(null),[V,te]=b.useState({isWithinRange:!1,distance:0,isValidTime:!1,canSignIn:!1}),ue=(A,H,Y,ae)=>{const se=(Y-A)*Math.PI/180,we=(ae-H)*Math.PI/180,pe=Math.sin(se/2)*Math.sin(se/2)+Math.cos(A*Math.PI/180)*Math.cos(Y*Math.PI/180)*Math.sin(we/2)*Math.sin(we/2);return 6371*(2*Math.atan2(Math.sqrt(pe),Math.sqrt(1-pe)))},xe=(A=!1)=>{const H=new Date,Y=H.getHours(),ae=H.getMinutes(),oe=Y+ae/60,se=H.getDay(),we=7+45/60,pe=17,Fe=se===6,Ee=se===0,Pt=(F==null?void 0:F.settingValue)==="true",ze=(M==null?void 0:M.settingValue)==="true";if(A&&u)return oe>=we;const ge=oe>=we&&oe<=pe;return Fe&&Pt||Ee&&ze?ge:Fe||Ee?!1:ge};b.useEffect(()=>{let A=!1;return jh().then(H=>{if(A)return;const Y={latitude:H.latitude,longitude:H.longitude,accuracy:H.accuracy??0};z(Y),u&&s&&k(Y.latitude,Y.longitude)}).catch(H=>{if(A)return;console.log("Geolocation error:",H),x("Unavailable");const Y=(H==null?void 0:H.message)||"Unable to access your location.";e({title:"GPS Error - DA17 5DB",description:`${Y} For DA17 5DB area, ensure GPS is enabled and location services are allowed.`,variant:"destructive"})}),()=>{A=!0}},[]),b.useEffect(()=>{if(E&&E.length>0&&R){let A=null,H=1/0;for(const Y of E)if(Y.latitude&&Y.longitude){const ae=ue(R.latitude,R.longitude,parseFloat(Y.latitude),parseFloat(Y.longitude));ae<H&&(H=ae,A=Y)}A?(K({latitude:parseFloat(A.latitude),longitude:parseFloat(A.longitude),accuracy:5}),ee(A),x("Good"),console.log(` Nearest job site: ${A.location} (${H.toFixed(2)}km away)`)):(K(null),ee(null),x(" Work site GPS coordinates missing - Contact admin to add location data for DA17 5DB"))}else K(null),ee(null),x((E==null?void 0:E.length)>0?"Waiting for GPS location":"No assignments")},[E,R]),b.useEffect(()=>{if(console.log(" GPS Validation Check:"),console.log("- User location:",R),console.log("- Work site location:",B),console.log("- Assignments:",(E==null?void 0:E.length)||0),R&&B){const A=ue(R.latitude,R.longitude,B.latitude,B.longitude),H=A<=3.5,Y=xe(u),ae=H&&Y;console.log(`- Distance: ${A.toFixed(2)}km`),console.log(`- Within range (1km): ${H}`),console.log(`- Valid time: ${Y}`),console.log(`- Can sign in: ${ae}`);let oe="";Y?H||(oe=`Too far from work site (${A.toFixed(2)}km away)`):oe=u?"Cannot clock out before 7:45 AM":"Outside working hours (7:45 AM - 5:00 PM)",te({isWithinRange:H,distance:A,isValidTime:Y,canSignIn:ae,errorMessage:oe})}else console.log(" Missing location data"),console.log("- User location missing:",!R),console.log("- Work site location missing:",!B),te({isWithinRange:!1,distance:0,isValidTime:xe(),canSignIn:!1,errorMessage:R?"Work site location data missing":"GPS location required - please enable location services"})},[R,B]),b.useEffect(()=>{let A;return u&&s&&R&&(console.log(" Starting continuous GPS tracking for live monitor"),A=setInterval(()=>{jh().then(H=>{const Y={latitude:H.latitude,longitude:H.longitude,accuracy:H.accuracy??0};z(Y),k(Y.latitude,Y.longitude)}).catch(H=>{console.log(" GPS update failed:",H)})},3e4)),()=>{A&&(clearInterval(A),console.log(" Stopped continuous GPS tracking"))}},[u,s,R]),b.useEffect(()=>{let A;if(u&&m){const H=()=>{const Y=new Date,ae=Y.getHours();if(Y.getMinutes(),ae>=17){console.log(" Automatic logout at 5:00 PM"),y&&C.mutate({sessionId:y,sessionData:{endTime:Y.toISOString(),gpsLatitude:(R==null?void 0:R.latitude)||0,gpsLongitude:(R==null?void 0:R.longitude)||0,status:"completed"}}),d(!1),f(null),c("00:00:00"),localStorage.removeItem("gps_timer_active"),localStorage.removeItem("gps_timer_start"),localStorage.removeItem("gps_timer_current"),e({title:"Work Day Ended",description:"Automatically logged out at 5:00 PM - work day complete",variant:"default"});return}const oe=Y.getTime()-m.getTime(),se=Math.floor(oe/(1e3*60*60)),we=Math.floor(oe%(1e3*60*60)/(1e3*60)),pe=Math.floor(oe%(1e3*60)/1e3),Fe=`${se.toString().padStart(2,"0")}:${we.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}`;c(Fe),localStorage.setItem("gps_timer_current",Fe),localStorage.setItem("gps_timer_active","true"),localStorage.setItem("gps_timer_start",m.toISOString())};H(),A=setInterval(H,1e3)}else u||c("00:00:00");return()=>{A&&clearInterval(A)}},[u,m,C,s,R,y,e]),b.useEffect(()=>{const A=localStorage.getItem("gps_timer_active"),H=localStorage.getItem("gps_timer_start"),Y=localStorage.getItem("gps_timer_current");if(A==="true"&&H){const ae=new Date(H),oe=new Date;if(oe.getTime()-ae.getTime()<24*60*60*1e3){d(!0),f(ae);const se=oe.getTime()-ae.getTime(),we=Math.floor(se/(1e3*60*60)),pe=Math.floor(se%(1e3*60*60)/(1e3*60)),Fe=Math.floor(se%(1e3*60)/1e3),Ee=`${we.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}:${Fe.toString().padStart(2,"0")}`;c(Ee)}else localStorage.removeItem("gps_timer_active"),localStorage.removeItem("gps_timer_start"),localStorage.removeItem("gps_timer_current")}else Y&&c(Y)},[]);const L=()=>{var A,H,Y,ae;if(console.log(" handleStartWork called"),console.log(" Location validation:",V),console.log(" User location:",R),console.log(" Work site location:",B),console.log(" Nearest job:",X),!V.canSignIn){console.log(" Cannot sign in:",V.errorMessage),e({title:"Cannot Sign In",description:V.errorMessage,variant:"destructive"});return}if(u){const oe=new Date,se=oe.getTime()-((m==null?void 0:m.getTime())||Date.now()),we=Math.floor(se/(1e3*60*60)),pe=Math.floor(se%(1e3*60*60)/(1e3*60)),Fe=Math.floor(se%(1e3*60)/1e3),Ee=`${we.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}:${Fe.toString().padStart(2,"0")}`;if(y){const Pt={endTime:oe.toISOString(),totalHours:Ee,status:"completed",endLatitude:(Y=R==null?void 0:R.latitude)==null?void 0:Y.toString(),endLongitude:(ae=R==null?void 0:R.longitude)==null?void 0:ae.toString()};C.mutate({sessionId:y,sessionData:Pt})}d(!1),f(null),c("00:00:00"),localStorage.removeItem("gps_timer_active"),localStorage.removeItem("gps_timer_start"),localStorage.removeItem("gps_timer_current"),e({title:"Work Ended",description:"Time tracking stopped"})}else{const oe=new Date;d(!0),f(oe);const se={contractorName:s,jobSiteLocation:(X==null?void 0:X.location)||"Unknown Location",startTime:oe.toISOString(),status:"active",startLatitude:(A=R==null?void 0:R.latitude)==null?void 0:A.toString(),startLongitude:(H=R==null?void 0:R.longitude)==null?void 0:H.toString()};S.mutate(se),R&&s&&(k(R.latitude,R.longitude),console.log(" Initial GPS location sent to live monitor at clock-in")),localStorage.setItem("gps_timer_active","true"),localStorage.setItem("gps_timer_start",oe.toISOString()),e({title:"Work Started",description:"GPS verified - tracking time started"})}},G=A=>{v(!1),e({title:A,description:`Opening ${A} interface...`})},U=A=>{switch(A){case"Good":return"bg-yellow-500 text-black";case"Poor":return"bg-orange-500 text-white";default:return"bg-red-500 text-white"}};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>v(!w),className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4 hover:bg-yellow-700 transition-colors",children:a.jsx("span",{className:"text-white font-bold text-sm",children:o(s)})}),w&&a.jsxs("div",{className:"absolute right-0 top-10 w-64 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-slate-600",children:[a.jsx("div",{className:"text-yellow-400 font-semibold",children:s}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Role: ",r||"Unknown"]}),r==="admin"&&a.jsx("div",{className:"text-red-400 text-xs",children:" ADMIN ACCESS ERROR"})]}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>window.location.href="/task-progress",className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-tasks mr-3 text-slate-400"}),"My Tasks"]}),a.jsxs("button",{onClick:()=>G("Report Issue"),className:"w-full px-4 py-2 text-left text-yellow-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-exclamation-triangle mr-3 text-yellow-400"}),"Report Issue"]}),a.jsx("div",{className:"border-t border-slate-600 mt-2 pt-2",children:a.jsxs("button",{onClick:()=>{localStorage.removeItem("userRole"),localStorage.removeItem("isLoggedIn"),window.location.href="/login"},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-sign-out-alt mr-3 text-red-400"}),"Logout"]})})]})]})]})]})]}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("i",{className:"fas fa-signal text-white mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"GPS Status"}),a.jsx(bi,{id:"gps-status-indicator",title:"GPS Status Monitor",content:"Shows GPS connection quality and work site proximity. GPS must be 'Good' and within 1km of assigned work site to start tracking. Location automatically updates every few seconds.",type:"info",placement:"right",children:a.jsx("div",{className:"text-blue-400 cursor-help",children:a.jsx("i",{className:"fas fa-info-circle text-sm"})})})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(De,{className:U(p),children:p}),a.jsx("i",{className:"fas fa-sync-alt text-slate-400"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Work Site Access"}),a.jsx(De,{className:V.canSignIn?"bg-green-600 text-white":"bg-red-600 text-white",children:V.canSignIn?"Allowed":"Restricted"})]}),R&&B&&a.jsxs("div",{className:"text-sm space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Distance from site:"}),a.jsxs("span",{className:V.isWithinRange?"text-green-400":"text-red-400",children:[V.distance.toFixed(2),"km"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-400",children:"Working hours (7:45-17:00):"}),a.jsx("span",{className:V.isValidTime?"text-green-400":"text-red-400",children:V.isValidTime?"Active":"Outside hours"})]})]}),!V.canSignIn&&V.errorMessage&&a.jsxs("div",{className:"mt-2 p-2 bg-red-900 border border-red-600 rounded text-red-200 text-sm",children:[a.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),V.errorMessage]})]}),R&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-slate-400 mr-2"}),a.jsxs("span",{className:"text-white",children:["Your Location: ",R.latitude.toFixed(6),", ",R.longitude.toFixed(6)]})]}),B&&a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("i",{className:"fas fa-building text-slate-400 mr-2"}),a.jsxs("span",{className:"text-yellow-400",children:["Work Site: ",B.latitude.toFixed(6),", ",B.longitude.toFixed(6)]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400",children:"Your Position:"}),a.jsxs("div",{className:"text-white font-mono text-xs",children:[R.latitude.toFixed(4),", ",R.longitude.toFixed(4)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400",children:"Accuracy:"}),a.jsxs("div",{className:"text-white",children:["",R.accuracy,"m"]})]})]})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-clock text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"GPS Time Tracker"})]}),a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-slate-400 mr-2"}),a.jsx("span",{className:"text-slate-400",children:B&&E&&E.length>0?(()=>{const A=E.find(H=>H.latitude&&H.longitude&&Math.abs(parseFloat(H.latitude)-B.latitude)<.001&&Math.abs(parseFloat(H.longitude)-B.longitude)<.001);return A?`Work Site: ${A.location}`:"Work Site: Unknown"})():"No assignment location"})]}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"text-4xl font-mono text-blue-400 mb-4",children:l}),a.jsxs("div",{className:"mb-4 text-center",children:[a.jsx("div",{className:"text-xl text-green-400 font-semibold",children:"GPS Timer Active"}),a.jsx("div",{className:"text-slate-400 text-xs",children:"Location verified - Time tracking in progress"})]}),a.jsx(bi,{id:"start-stop-work-button",title:"GPS Work Tracking",content:u?"Click to stop work and save time session. GPS location will be recorded for verification.":"Click to start GPS-verified time tracking. System validates you're within 1km of work site and during valid hours (7:45 AM - 5:00 PM).",type:u?"warning":"success",placement:"top",children:a.jsxs(je,{onClick:L,disabled:!V.canSignIn&&!u,className:`w-full py-3 text-white font-medium rounded-lg flex items-center justify-center ${!V.canSignIn&&!u?"bg-red-600 cursor-not-allowed opacity-75":u?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:[a.jsx("i",{className:`fas ${u?"fa-stop":V.canSignIn?"fa-play":"fa-lock"} mr-2`}),u?"Stop Work":V.canSignIn?"Start Work (GPS Verified)":"GPS Check Required"]})})]}),a.jsx("div",{className:"text-center text-slate-400 text-sm mb-2",children:R?V.canSignIn?u?"Ready to stop GPS-verified time tracking":"Ready to start GPS-verified time tracking":u?"Must be within 1km of work site to clock out":"Must be within 1km of work site during 7:45 AM - 5:00 PM":"GPS location required - please enable location services"}),V.canSignIn&&a.jsx("div",{className:"text-center text-green-400 text-xs",children:" Location verified - Ready to work"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-briefcase text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Active Assignment"})]}),a.jsx(eA,{nearestJobSite:X})]}),a.jsx(M3,{contractorName:s}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-calendar-times text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Overdue Projects"})]}),a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-calendar-check text-green-600 text-3xl"})}),a.jsx("div",{className:"text-slate-400 text-sm",children:"No overdue projects"})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:s&&(s.toLowerCase().includes("dalwayne")||s.toLowerCase().includes("diedericks"))?a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-yellow-400","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/foreman",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-foreman",children:[a.jsx("i",{className:"fas fa-users block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs Assigned"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]}):a.jsxs("div",{className:"grid grid-cols-3 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-yellow-400","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]})}),a.jsx("div",{className:"h-20"}),h&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>g(!1)})]})}function rA(){const e=localStorage.getItem("contractorName")||"Dalwayne Diedericks",t=e.split(" ")[0],{data:r=[],isLoading:n}=rt({queryKey:[`/api/contractor-assignments/${t}`],enabled:!0});return n?a.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400 mx-auto mb-4"}),a.jsx("p",{className:"text-slate-400",children:"Loading assignments..."})]})}):a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx("div",{className:"bg-slate-800 px-4 py-4",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-white mb-1",children:"Direct Job Assignments"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Jobs are assigned to you directly"})]})})}),a.jsx("div",{className:"p-3",children:r.length===0?a.jsxs("div",{className:"border-2 border-dashed border-slate-600 rounded-lg p-8 text-center",children:[a.jsx("div",{className:"w-24 h-24 mx-auto mb-6 text-slate-500",children:a.jsx("i",{className:"fas fa-briefcase text-6xl"})}),a.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Assignments"}),a.jsx("p",{className:"text-slate-400 mb-6",children:"You don't have any job assignments yet."})]}):a.jsx("div",{className:"space-y-2",children:r.map(s=>a.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${s.status==="assigned"?"bg-yellow-500":"bg-blue-600"}`,children:a.jsx("i",{className:`fas fa-briefcase text-sm ${s.status==="assigned"?"text-black":"text-white"}`})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-semibold text-yellow-400",children:s.hbxlJob||"Untitled Job"}),a.jsx("p",{className:"text-slate-400 text-xs",children:s.workLocation||"Location not set"})]})]}),a.jsx(De,{className:`text-xs px-2 py-0.5 ${s.status==="assigned"?"bg-yellow-500 text-black":s.status==="completed"?"bg-green-500 text-white":"bg-slate-500 text-white"}`,children:s.status})]}),a.jsxs("div",{className:"space-y-1 text-xs mb-2",children:[a.jsxs("div",{className:"flex items-center text-slate-300",children:[a.jsx("i",{className:"fas fa-clock text-slate-400 mr-1 w-3"}),a.jsxs("span",{children:[s.startDate,"  ",s.endDate]})]}),s.buildPhases&&s.buildPhases.length>0&&a.jsxs("div",{className:"flex items-start text-slate-300",children:[a.jsx("i",{className:"fas fa-tasks text-slate-400 mr-1 w-3 mt-0.5"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.buildPhases.slice(0,2).map((i,o)=>a.jsx("span",{className:"bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded",children:i},o)),s.buildPhases.length>2&&a.jsxs("span",{className:"text-slate-400 text-xs",children:["+",s.buildPhases.length-2," more"]})]})]}),s.specialInstructions&&a.jsxs("div",{className:"flex items-start text-slate-300 mt-1",children:[a.jsx("i",{className:"fas fa-sticky-note text-yellow-400 mr-1 w-3 mt-0.5"}),a.jsxs("div",{className:"bg-yellow-900/30 border border-yellow-700 rounded px-2 py-1 text-xs",children:[a.jsx("span",{className:"text-yellow-400 font-medium",children:"Note: "}),a.jsx("span",{children:s.specialInstructions})]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(je,{size:"sm",className:"bg-orange-600 hover:bg-orange-700 text-white text-xs px-3 py-1 h-7 flex-1",onClick:()=>{window.location.href=`/assignment/${s.id}`},children:[a.jsx("i",{className:"fas fa-comment mr-1"}),"Quick Report"]}),a.jsxs(je,{size:"sm",className:"bg-yellow-500 hover:bg-yellow-600 text-black text-xs px-3 py-1 h-7",onClick:()=>window.location.href="/task-progress",children:[a.jsx("i",{className:"fas fa-tasks mr-1"}),"Tasks"]})]})]},s.id))})}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:e&&(e.toLowerCase().includes("dalwayne")||e.toLowerCase().includes("diedericks"))?a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/foreman",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-foreman",children:[a.jsx("i",{className:"fas fa-users block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs Assigned"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]}):a.jsxs("div",{className:"grid grid-cols-3 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]})}),a.jsx("div",{className:"h-20"})]})}function nA(){const[e,t]=b.useState(!1),[r,n]=b.useState(null),[s,i]=b.useState(null),[o,l]=b.useState(!1),{toast:c}=Tt(),u=oa(),d=nb(sb.csvUpload),m=Tr({mutationFn:async N=>{const S=new FormData;S.append("csvFile",N);const C=await fetch("/api/upload-csv",{method:"POST",body:S,credentials:"include"});if(!C.ok){const j=await C.text();throw new Error(j||`Upload failed with status ${C.status}`)}return C.json()},onSuccess:N=>{d.markStepCompleted("file-selection"),d.markStepCompleted("file-validation"),d.markStepCompleted("data-processing"),d.markStepCompleted("job-creation"),c({title:"File Upload Successful",description:`Created ${N.jobsCreated} job(s) from ${N.upload.filename}`}),u.invalidateQueries({queryKey:["/api/jobs"]}),u.invalidateQueries({queryKey:["/api/csv-uploads"]}),w()},onError:N=>{c({title:"Upload Failed",description:N.message,variant:"destructive"})}}),f=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?t(!0):N.type==="dragleave"&&t(!1)},p=N=>{const S=N.name.toLowerCase();return!S.endsWith(".csv")&&!S.endsWith(".xlsx")?(c({title:"Invalid File Type",description:"Please select a CSV file (.csv) or Excel file (.xlsx)",variant:"destructive"}),!1):N.size>10*1024*1024?(c({title:"File Too Large",description:"File size must be less than 10MB",variant:"destructive"}),!1):!0},x=async N=>{var S,C,j,E,k,F;try{const R=(await N.text()).split(`
`).map(xe=>xe.trim()).filter(xe=>xe);if(R.length<4)throw new Error("CSV must contain Name, Address, Post code, and Project Type headers");let z="Data Missing from CSV",B="Data Missing from CSV",K="Data Missing from CSV",X="Data Missing from CSV",ee=[];const V=R.findIndex(xe=>xe.includes("Order Date")&&xe.includes("Build Phase")&&(xe.includes("Resource Description")||xe.includes("Type of Resource")));if(V!==-1){console.log(" Using ENHANCED CSV parsing for frontend preview");for(let A=0;A<Math.min(R.length,5);A++){const H=R[A];if(H.startsWith("Name ,")||H.startsWith("Name,")||H.startsWith("name,"))z=H.substring(H.indexOf(",")+1).replace(/,+$/,"").trim()||"Data Missing from CSV";else if(H.startsWith("Address,")||H.startsWith("Address ,"))B=H.substring(H.indexOf(",")+1).replace(/,+$/,"").trim()||"Data Missing from CSV";else if(H.startsWith("Post Code ,")||H.startsWith("Post code,")){const Y=H.indexOf(",");K=H.substring(Y+1).replace(/,+$/,"").trim().toUpperCase()||"Data Missing from CSV"}else H.startsWith("Project Type,")&&(X=H.substring(13).replace(/,+$/,"").trim()||"Data Missing from CSV")}const xe=new Set,L=R[V],G=L.split(",").map(A=>A.trim()),U=G.findIndex(A=>A.toLowerCase().includes("build phase")||A.toLowerCase().includes("phase"));if(console.log(" Phase column detection:",{headerLine:L,headers:G,buildPhaseColumnIndex:U,foundHeader:G[U]}),U>=0)for(let A=V+1;A<R.length;A++){const H=R[A];if(!H||H.trim()==="")continue;const Y=H.split(",").map(oe=>oe.trim());if(Y.length<=U)continue;const ae=Y[U]||"";ae&&ae.trim()!==""&&ae.toLowerCase()!=="material"&&ae.toLowerCase()!=="labour"&&(xe.add(ae),console.log(" Found phase:",ae))}ee=Array.from(xe)}else if(R.some(L=>(L.startsWith("Name,")||L.startsWith("name,"))&&!L.includes("Address,Postcode"))){for(let G=0;G<Math.min(R.length,5);G++){const U=R[G];U.startsWith("Name,")||U.startsWith("name,")?z=U.substring(U.indexOf(",")+1).replace(/,+$/,"").trim()||"Data Missing from CSV":U.startsWith("Address,")||U.startsWith("Address ,")?B=U.substring(U.indexOf(",")+1).replace(/,+$/,"").trim()||"Data Missing from CSV":U.startsWith("Post code,")?K=U.substring(10).replace(/,+$/,"").trim().toUpperCase()||"Data Missing from CSV":U.startsWith("Project Type,")&&(X=U.substring(13).replace(/,+$/,"").trim()||"Data Missing from CSV")}const L=R.findIndex(G=>G.includes("Order Date")&&G.includes("Build Phase"));if(L>=0){const U=R[L].split(",").map(A=>A.trim()).indexOf("Build Phase");if(U>=0)for(let A=L+1;A<R.length;A++){const Y=R[A].split(",").map(ae=>ae.trim())[U];Y&&Y!==""&&!ee.includes(Y)&&ee.push(Y)}}}else if(R.length>=2){const G=R[1].split(",");z=((S=G[0])==null?void 0:S.trim())||"Data Missing",B=((C=G[1])==null?void 0:C.trim())||"Data Missing",K=((E=(j=G[2])==null?void 0:j.trim())==null?void 0:E.toUpperCase())||"Data Missing",X=((k=G[3])==null?void 0:k.trim())||"Data Missing";const U=((F=G[4])==null?void 0:F.trim().replace(/"/g,""))||"";ee=U?U.split(",").map(A=>A.trim()).filter(A=>A):[]}console.log(" CSV PARSING DEBUG:",{enhancedFormat:V!==-1,rawLines:R.slice(0,5),extracted:{jobName:z,jobAddress:B,jobPostcode:K,jobType:X,phases:ee}});const te={headers:["Name","Address","Postcode","Project Type","Build Phases"],rows:[[z,B,K,X,ee.join(", ")]]},ue=[{name:z,address:B,postcode:K,projectType:X,buildPhases:ee.length>0?ee:["No phases specified"]}];return{headers:te.headers,rows:te.rows,rawData:te,jobPreview:ue}}catch(M){return c({title:"CSV Parse Error",description:M instanceof Error?M.message:"Failed to parse CSV file",variant:"destructive"}),null}},h=async N=>{if(N.target.files&&N.target.files[0]){const S=N.target.files[0];if(p(S)){n(S);const C=await x(S);i(C),C&&(l(!0),d.markStepCompleted("file-selection"),d.markStepCompleted("file-validation"))}}},g=async N=>{if(N.preventDefault(),t(!1),N.dataTransfer.files&&N.dataTransfer.files[0]){const S=N.dataTransfer.files[0];if(p(S)){n(S);const C=await x(S);i(C),C&&(l(!0),d.markStepCompleted("file-selection"),d.markStepCompleted("file-validation"))}}},w=()=>{n(null),i(null),l(!1);const N=document.getElementById("csv-upload");N&&(N.value=""),c({title:"Data Cleared",description:"Selected file and preview data have been cleared"})},v=()=>{l(!1)},y=()=>{r&&m.mutate(r)};return a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-amber-400",children:"Upload Job CSV File"}),a.jsx(bi,{id:"csv-upload-header",title:"CSV Upload Process",content:"Upload CSV files containing job data. The system validates format and creates jobs automatically. Only authentic CSV data is used - no assumptions made.",type:"info",placement:"right",children:a.jsx("div",{className:"text-amber-500 cursor-help",children:a.jsx(Bu,{className:"h-4 w-4"})})})]}),a.jsx("p",{className:"text-sm text-slate-400",children:"Upload CSV files to create new jobs. File format: Name, Address, Project Type, Build Phase data."})]}),a.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${e?"border-amber-400 bg-amber-900/10":"border-slate-600 hover:border-slate-500"}`,onDragEnter:f,onDragLeave:f,onDragOver:f,onDrop:g,children:[a.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:h,className:"hidden",id:"csv-upload",disabled:m.isPending}),r?a.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[a.jsx(us,{className:"h-8 w-8 text-green-500"}),a.jsx("span",{className:"text-slate-200 font-medium",children:r.name}),a.jsx(bi,{id:"clear-file-button",title:"Clear Selected File",content:"Remove the selected file and clear all data. You can then select a different file.",type:"warning",placement:"top",children:a.jsxs("button",{onClick:w,className:"flex items-center space-x-1 px-2 py-1 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded transition-colors",disabled:m.isPending,children:[a.jsx("i",{className:"fas fa-times text-sm"}),a.jsx("span",{className:"text-xs",children:"Clear"})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx(m2,{className:"mx-auto h-12 w-12 text-slate-500 mb-4"}),a.jsx(bi,{id:"file-selection-area",title:"File Selection",content:"Select a CSV or Excel file with required headers: Name, Address, Post code, Project Type, and Build Phase. Files must be under 10MB and contain authentic job data.",type:"help",placement:"top",children:a.jsx("label",{htmlFor:"csv-upload",className:"cursor-pointer text-amber-500 hover:text-amber-400 font-medium",children:"Click to upload"})}),a.jsx("span",{className:"text-slate-400",children:" or drag and drop"}),a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"CSV or Excel files, up to 10MB"})]})]}),r&&!o&&a.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-400",children:[a.jsx(us,{className:"h-4 w-4"}),a.jsxs("span",{children:[(r.size/1024).toFixed(1)," KB"]})]}),a.jsx(bi,{id:"preview-button",title:"Preview CSV Data",content:"Click to preview the jobs that will be created from your CSV file. You can review all data before approving the upload.",type:"info",placement:"left",children:a.jsxs(je,{onClick:()=>l(!0),className:"bg-amber-600 hover:bg-amber-700",children:[a.jsx(gg,{className:"h-4 w-4 mr-2"}),"Preview Jobs"]})})]}),m.error&&a.jsxs("div",{className:"mt-4 flex items-center space-x-2 text-red-400 bg-red-900/20 border border-red-700/30 p-3 rounded-lg",children:[a.jsx(Bu,{className:"h-5 w-5"}),a.jsx("span",{className:"text-sm",children:m.error.message})]}),o&&s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[a.jsx("div",{className:"bg-yellow-600 text-white p-4 text-center",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Upload & Detect Job Info"})}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:s.jobPreview.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"bg-slate-100 rounded-t-lg p-3",children:a.jsxs("h4",{className:"text-slate-700 font-semibold",children:["Detected Job Information (",s.jobPreview.length," job",s.jobPreview.length>1?"s":"",")"]})}),a.jsxs("div",{className:"bg-white border border-slate-200 rounded-b-lg p-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-green-600 rounded-sm flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:""})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-yellow-600 font-medium",children:"Name: "}),a.jsx("span",{className:"text-slate-700",children:s.jobPreview[0].name})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-green-600 rounded-sm flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:""})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-yellow-600 font-medium",children:"Postcode: "}),a.jsx("span",{className:"text-slate-700",children:s.jobPreview[0].postcode})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-green-600 rounded-sm flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:""})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-yellow-600 font-medium",children:"Project Type: "}),a.jsx("span",{className:"text-slate-700",children:s.jobPreview[0].projectType})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-green-600 rounded-sm flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:""})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-yellow-600 font-medium",children:"Address: "}),a.jsx("span",{className:"text-slate-700",children:s.jobPreview[0].address})]})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsxs("h5",{className:"text-blue-800 font-semibold mb-2",children:["Extracted HBXL Work Phases (",s.jobPreview[0].buildPhases.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.jobPreview[0].buildPhases.map((N,S)=>a.jsx("span",{className:"bg-blue-200 text-blue-800 px-3 py-1 rounded-full text-sm",children:N},S))}),a.jsx("p",{className:"text-blue-700 text-sm",children:"These real work phases will be available for time tracking once the job is approved and goes live."})]}),s.jobPreview.length>1&&a.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500",children:[a.jsxs("p",{className:"text-blue-800 text-sm font-medium",children:["+ ",s.jobPreview.length-1," more job",s.jobPreview.length>2?"s":""," will be created from this CSV"]}),a.jsx("p",{className:"text-blue-600 text-xs mt-1",children:"All jobs will be saved to the database and persist after system reboot"})]})]})]})}),a.jsxs("div",{className:"p-4 border-t border-slate-200 flex space-x-4",children:[a.jsx(je,{onClick:v,variant:"outline",className:"flex-1",children:"Cancel"}),a.jsx(je,{onClick:()=>{l(!1),y()},disabled:m.isPending,className:"bg-green-600 hover:bg-green-700 text-white flex-1",children:m.isPending?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Jobs..."]}):a.jsxs(a.Fragment,{children:[a.jsx(gg,{className:"h-4 w-4 mr-2"}),"Approve & Create Jobs"]})})]})]})})]})}function sA(e){switch(e){case"processed":return a.jsx($t,{className:"h-5 w-5 text-green-600"});case"failed":return a.jsx(ts,{className:"h-5 w-5 text-red-600"});case"processing":return a.jsx(Bn,{className:"h-5 w-5 text-yellow-600"});default:return a.jsx(Bu,{className:"h-5 w-5 text-gray-600"})}}function aA(e){switch(e){case"processed":return"Completed";case"failed":return"Failed";case"processing":return"Processing";default:return"Unknown"}}function iA(e){switch(e){case"processed":return"text-green-700 bg-green-100";case"failed":return"text-red-700 bg-red-100";case"processing":return"text-yellow-700 bg-yellow-100";default:return"text-gray-700 bg-gray-100"}}function oA(){const{toast:e}=Tt(),t=oa(),{data:r=[]}=rt({queryKey:["/api/csv-uploads"]}),n=Tr({mutationFn:async i=>{const o=await Ai("DELETE",`/api/csv-uploads/${i}`);if(!o.ok)throw new Error("Failed to delete upload record");return o.json()},onSuccess:()=>{e({title:"Upload Deleted",description:"CSV upload record and all associated jobs have been successfully deleted"}),t.invalidateQueries({queryKey:["/api/csv-uploads"]}),t.invalidateQueries({queryKey:["/api/jobs"]})},onError:i=>{e({title:"Delete Failed",description:i instanceof Error?i.message:"Failed to delete upload",variant:"destructive"})}}),s=(i,o)=>{confirm(`Are you sure you want to delete the upload record for "${o}"? This will also delete all jobs created from this upload. This action cannot be undone.`)&&n.mutate(i)};return a.jsxs("div",{className:"min-h-screen bg-slate-900",children:[a.jsx("div",{className:"bg-slate-800 border-b border-slate-700 sticky top-0 z-50",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("h1",{className:"text-2xl font-bold text-amber-400",children:"Upload Job Files"})}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("button",{onClick:()=>window.location.href="/",className:"text-slate-300 hover:text-amber-400",children:" Back to Dashboard"})})]})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsx("div",{children:a.jsx(nA,{})}),a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-amber-400 mb-4",children:"Recent Uploads"}),r.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(us,{className:"mx-auto h-12 w-12 text-slate-500 mb-4"}),a.jsx("p",{className:"text-slate-400",children:"No uploads yet"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Upload your first CSV file to get started"})]}):a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.slice().reverse().map(i=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-600 rounded-lg hover:bg-slate-700/50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(us,{className:"h-8 w-8 text-slate-400"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-200",children:i.filename}),a.jsxs("div",{className:"text-sm text-slate-400",children:[i.jobsCount," job(s) created"]}),a.jsx("div",{className:"text-xs text-slate-500",children:new Date(i.createdAt).toLocaleString()})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[sA(i.status),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${iA(i.status)}`,children:aA(i.status)})]}),a.jsx(je,{onClick:()=>s(i.id,i.filename),disabled:n.isPending,variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20 p-1 h-8 w-8",title:"Delete upload record",children:n.isPending?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-400"}):a.jsx(jk,{className:"h-4 w-4"})})]})]},i.id))})]})]})}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/admin-task-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-upload block mb-1"}),a.jsx("span",{className:"text-xs",children:"Upload"})]})]})}),a.jsx("div",{className:"h-20"})]})}function lA(){const e=()=>{localStorage.clear(),window.location.href="/login",window.location.reload()};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function Th(){const[e,t]=b.useState("00:00:00"),[r,n]=b.useState(!1),[s,i]=b.useState(null),[o,l]=b.useState(null),[c,u]=b.useState("Good"),[d,m]=b.useState(!1),{toast:f}=Tt(),{data:p=[]}=rt({queryKey:["/api/pending-inspections"],refetchInterval:3e4}),{data:x=[]}=rt({queryKey:["/api/contractor-fixed-inspections"],refetchInterval:3e4});rt({queryKey:["/api/admin/active-sessions"],refetchInterval:1e4});const{data:h}=rt({queryKey:["/api/admin/today-sessions"],refetchInterval:6e4});h!=null&&h.sessions,h!=null&&h.dailySummary;const g=Tr({mutationFn:async y=>(await Ai("POST",`/api/complete-inspection/${y}`)).json(),onSuccess:()=>{io.invalidateQueries({queryKey:["/api/pending-inspections"]}),f({title:"Inspection Completed",description:"The inspection has been marked as completed."})},onError:()=>{f({title:"Error",description:"Failed to complete inspection",variant:"destructive"})}}),w=Tr({mutationFn:async y=>(await Ai("POST",`/api/contractor-fixed-inspections/${y}/approve`,{adminName:localStorage.getItem("adminName")||"Admin"})).json(),onSuccess:()=>{io.invalidateQueries({queryKey:["/api/contractor-fixed-inspections"]}),f({title:"Fix Approved",description:"Contractor fix has been approved and removed from review"})},onError:()=>{f({title:"Error",description:"Failed to approve contractor fix",variant:"destructive"})}});Tr({mutationFn:async y=>(await Ai("POST","/api/send-onboarding-form",y)).json(),onSuccess:y=>{y.success?f({title:" Onboarding Form Sent",description:`Sent to ${y.contractorId||"contractor"} via Telegram`,duration:5e3}):f({title:" Form Send Failed",description:y.error||"Failed to send onboarding form",variant:"destructive"})},onError:y=>{f({title:" Error",description:"Failed to send onboarding form",variant:"destructive"})}}),b.useEffect(()=>{l({latitude:51.491179,longitude:.147781,accuracy:14}),u("Good")},[]),b.useEffect(()=>{let y=null;return r&&s&&(y=setInterval(()=>{const S=new Date().getTime()-s.getTime(),C=Math.floor(S/(1e3*60*60)),j=Math.floor(S%(1e3*60*60)/(1e3*60)),E=Math.floor(S%(1e3*60)/1e3);t(`${C.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`)},1e3)),()=>{y&&clearInterval(y)}},[r,s]);const v=y=>{switch(y){case"Good":return"bg-yellow-500 text-black";case"Poor":return"bg-orange-500 text-white";default:return"bg-red-500 text-white"}};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(lA,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-600 ml-2"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>m(!d),className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4 hover:bg-yellow-700 transition-colors",children:a.jsx("span",{className:"text-white font-bold text-sm",children:(localStorage.getItem("adminName")||"Admin").split(" ").map(y=>y[0]).join("").slice(0,2)})}),a.jsx("i",{className:"fas fa-chevron-down text-slate-400 text-xs ml-1"}),d&&a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-slate-800 rounded-lg shadow-xl border border-slate-600 z-50 max-h-96 overflow-y-auto",children:[a.jsxs("div",{className:"p-4 border-b border-slate-600",children:[a.jsx("div",{className:"font-medium text-white",children:localStorage.getItem("adminName")||"Admin"}),a.jsx("div",{className:"text-sm text-slate-400",children:localStorage.getItem("adminEmail")||"admin@erbuildanddesign.co.uk"}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx("i",{className:"fas fa-shield-alt text-red-500 mr-2"}),a.jsx("span",{className:"text-red-400 text-sm",children:"Admin Access"})]})]}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>{m(!1),f({title:"Account Switching",description:"Switch account functionality"})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-user-friends mr-3 w-4"}),"Switch Account"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/contractor-onboarding"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-user-plus mr-3 w-4"}),"Contractor Onboarding"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/contractor-id-capture"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-blue-400",children:[a.jsx("i",{className:"fas fa-id-card mr-3 w-4"})," Capture Contractors ID"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/job-assignments"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-tasks mr-3 w-4"}),"Assignment Management"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"HBXL Labour Assignments",description:"Opening labour assignments..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-hammer mr-3 w-4"}),"HBXL Labour Assignments"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/admin-applications"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-green-400 bg-green-900/20",children:[a.jsx("i",{className:"fas fa-clipboard-list mr-3 w-4"})," Review Applications "]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/payroll-overview"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-blue-400",children:[a.jsx("i",{className:"fas fa-clock mr-3 w-4"})," Time Tracking & Earnings "]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/contractor-onboarding-clean"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-blue-400",children:[a.jsx("i",{className:"fas fa-user-plus mr-3 w-4"}),"Contractor Onboarding"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"Planning System",description:"Opening hybrid planning system..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-project-diagram mr-3 w-4"}),"Hybrid Planning System"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"Export & Archive",description:"Opening export and archive..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-download mr-3 w-4"}),"Export & Archive"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/contractor-id-capture"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-green-400 bg-green-900/20",children:[a.jsx("i",{className:"fas fa-user-plus mr-3 w-4"})," Capture Contractor ID"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"Preview Interface",description:"Opening James's contractor interface..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-eye mr-3 w-4"}),"Preview James's Interface"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/contract-cashflow"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-green-400 bg-green-900/20",children:[a.jsx("i",{className:"fas fa-pound-sign mr-3 w-4"})," CONTRACT CASHFLOW "]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"Project Cashflow",description:"Opening project cashflow management..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-blue-400",children:[a.jsx("i",{className:"fas fa-chart-line mr-3 w-4"})," Project Cashflow"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"AI Agent Management",description:"Opening AI agent management..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-robot mr-3 w-4"}),"AI Agent Management"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/admin-site-inspections"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-red-400 bg-red-900/20",children:[a.jsx("i",{className:"fas fa-clipboard-check mr-3 w-4"})," Admin Site Inspections "]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"CIS Payroll",description:"Opening CIS payroll system..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-receipt mr-3 w-4"}),"CIS Payroll"]}),a.jsxs("button",{onClick:()=>{m(!1),f({title:"Accounting Exports",description:"Opening accounting exports..."})},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-file-export mr-3 w-4"}),"Accounting Exports"]})]}),a.jsxs("div",{className:"border-t border-slate-600 py-2",children:[a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/system-cleanup"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-red-400",children:[a.jsx("i",{className:"fas fa-broom mr-3 w-4"}),"System Cleanup"]}),a.jsxs("button",{onClick:()=>{m(!1),window.location.href="/admin-settings"},className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-yellow-400",children:[a.jsx("i",{className:"fas fa-cogs mr-3 w-4"}),"Admin Settings"]}),a.jsx("div",{className:"px-4 py-1 text-slate-400 text-sm font-medium",children:"Documents"}),a.jsx("div",{className:"px-4 py-1 text-slate-400 text-sm font-medium",children:"Help & Support"})]})]})]})]})]}),a.jsx("div",{className:"bg-yellow-600 px-4 py-2",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"fas fa-exclamation-triangle text-black mr-2"}),a.jsx("span",{className:"text-black font-medium text-sm",children:"Daily Tracking Test"})]})}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("i",{className:"fas fa-signal text-yellow-600"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-600",children:"GPS Status"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(De,{className:v(c),children:c}),a.jsx("i",{className:"fas fa-sync-alt text-slate-400"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"text-lg font-mono text-white",children:o?`${o.latitude}, ${o.longitude}`:"No GPS data"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Latitude:"}),a.jsx("div",{className:"text-white font-mono",children:(o==null?void 0:o.latitude)||"Unknown"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Longitude:"}),a.jsx("div",{className:"text-white font-mono",children:(o==null?void 0:o.longitude)||"Unknown"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Accuracy:"}),a.jsxs("div",{className:"text-white",children:["",(o==null?void 0:o.accuracy)||0," meters"]})]})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-tools text-amber-500 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-amber-500",children:"Contractor Fixes - Awaiting Review"}),x.length>0&&a.jsx(De,{className:"ml-2 bg-amber-600 text-white",children:x.length})]}),x.length>0?a.jsxs("div",{className:"space-y-3",children:[x.slice(0,3).map(y=>a.jsx("div",{className:"bg-slate-700 rounded-lg p-3 border border-amber-500/30",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(De,{className:"text-xs bg-amber-600",children:"FIXED"}),a.jsx("span",{className:"text-slate-400 text-xs",children:new Date(y.createdAt).toLocaleDateString()})]}),a.jsxs("div",{className:"text-white font-medium text-sm mb-1",children:[y.inspectorName," inspection - Assignment: ",y.assignmentId.slice(0,8),"..."]}),a.jsxs("div",{className:"text-slate-200 text-sm mb-2",children:[a.jsx("strong",{children:"Original Issue:"})," ",y.safetyNotes||y.materialsIssues||y.progressComments]}),y.nextActions&&y.nextActions.includes("Contractor fixed:")&&a.jsxs("div",{className:"text-green-300 text-sm mb-2",children:[a.jsx("strong",{children:"Contractor Notes:"})," ",y.nextActions.replace("Contractor fixed: ","")]}),a.jsx("div",{className:"text-amber-400 text-xs font-medium",children:" Needs Admin Re-Inspection"})]}),a.jsx(je,{onClick:()=>w.mutate(y.id),disabled:w.isPending,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white ml-2",children:w.isPending?"Approving...":"Mark Resolved"})]})},y.id)),x.length>3&&a.jsx("div",{className:"text-center",children:a.jsxs(je,{variant:"outline",size:"sm",className:"text-xs border-amber-500 text-amber-400 hover:bg-amber-600/10",children:["View All ",x.length," Fixed Items"]})})]}):a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-check-circle text-green-400 text-4xl"})})}),a.jsx("div",{className:"text-slate-400 text-sm",children:"No contractor fixes pending review."})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"fas fa-clipboard-check text-yellow-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-600",children:"Site Inspections Required"})]}),p.length>0&&a.jsx(De,{className:"bg-red-600 text-white",children:p.length})]}),p.length===0?a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-check-circle text-green-400 text-4xl"})})}),a.jsx("div",{className:"text-slate-400 text-sm",children:"No pending site inspections. All milestones up to date."})]}):a.jsxs("div",{className:"space-y-3",children:[p.slice(0,3).map(y=>a.jsx("div",{className:"bg-slate-700 rounded-lg p-3 border border-slate-600",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(De,{className:`text-xs ${y.notificationType==="50_percent_ready"?"bg-yellow-600":"bg-green-600"}`,children:y.notificationType==="50_percent_ready"?"50%":"100%"}),a.jsx("span",{className:"text-slate-200 font-medium text-sm",children:y.jobTitle})]}),a.jsxs("div",{className:"text-slate-400 text-xs",children:[y.contractorName,"  ",y.jobLocation]})]}),a.jsxs("div",{className:"flex gap-2 ml-3",children:[a.jsx(je,{size:"sm",variant:"outline",className:"text-xs px-2 py-1 border-slate-500 text-slate-200 hover:bg-slate-600",onClick:()=>{f({title:"Site Inspection",description:"Inspection details recorded"})},children:"View"}),a.jsx(je,{size:"sm",className:"text-xs px-2 py-1 bg-green-600 hover:bg-green-700",onClick:()=>g.mutate(y.id),disabled:g.isPending,children:""})]})]})},y.id)),p.length>3&&a.jsxs(je,{variant:"outline",className:"w-full text-sm border-slate-500 text-slate-200 hover:bg-slate-600",onClick:()=>window.location.href="/admin-inspections",children:["View All ",p.length," Inspections"]})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-5 text-center",children:[a.jsxs("button",{className:"py-3 px-4 text-yellow-600",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/live-clock-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-broadcast-tower block mb-1"}),a.jsx("span",{className:"text-xs",children:"Live Monitor"})]}),a.jsxs("button",{onClick:()=>window.location.href="/admin-task-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]}),a.jsxs("button",{onClick:()=>window.location.href="/upload",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-upload block mb-1"}),a.jsx("span",{className:"text-xs",children:"Upload"})]})]})}),a.jsx("div",{className:"h-20"})]})}function cA(){const e=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("isLoggedIn"),window.location.href="/login"};return a.jsx("div",{className:"fixed top-4 right-4 z-50",children:a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-3 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})})}function uA(){const[e,t]=b.useState("Send Form"),[r,n]=b.useState(""),[s,i]=b.useState(""),[o,l]=b.useState([{id:"1",name:"James Carpenter",phone:"07534251548",email:"james@gmail.com",specialization:["Carpentry","Flooring"],status:"pending",submittedDate:"06/08/2025",telegramId:"@james_contractor"},{id:"2",name:"Sarah Mason",phone:"07845123456",email:"sarah.mason@email.com",specialization:["Bricklaying","Masonry"],status:"pending",submittedDate:"05/08/2025",telegramId:"@sarah_mason"}]),[c,u]=b.useState([{id:"3",name:"Mike Electrician",phone:"07567890123",email:"mike.elec@email.com",specialization:["Electrical"],status:"approved",reviewedDate:"04/08/2025",telegramId:"@mike_electrical"}]),{toast:d}=Tt(),m=async()=>{if(!r||!s){d({title:"Missing Information",description:"Please provide contractor's name and Telegram ID",variant:"destructive"});return}try{const x=Math.random().toString(36).substr(2,9),h=`${window.location.origin}/contractor-form?id=${x}&name=${encodeURIComponent(r)}`,g=` Contractor Onboarding - ER Build & Design

Hello ${r}!

You've been invited to join our construction team. Please complete your contractor registration form:

 Form Link: ${h}

 What you'll need:
 Personal details & contact information
 Passport photo and right to work documents
 CIS number and tax details
 CSCS card information (if available)
 Bank details for payments
 Emergency contact details
 Your primary trade and tool availability

 Please complete within 24 hours

 Need help? Reply to this message

 Complete Form`;s&&((await fetch("https://api.telegram.org/bot8382710567:AAFshEGUHA-3P-Jf_PuLIQjskb-1_fY6iEA/sendMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:s.startsWith("@")?s.slice(1):s,text:g,parse_mode:"HTML"})})).ok?d({title:"Form Sent Successfully",description:`Professional registration form sent to ${r}`}):d({title:"Form Link Prepared",description:`Form ready for ${r}. Send manually if needed.`}));const w={id:Date.now().toString(),name:r,phone:"To Be Provided",email:"To Be Provided",specialization:["To Be Determined"],status:"invited",submittedDate:new Date().toLocaleDateString("en-GB"),telegramId:s};l(v=>[w,...v]),n(""),i("")}catch(x){console.error("Error sending form:",x),d({title:"Error",description:"Failed to send form. Please try again.",variant:"destructive"})}},f=x=>{const h=o.find(g=>g.id===x);h&&(u(g=>[...g,{...h,status:"approved",reviewedDate:new Date().toLocaleDateString("en-GB")}]),l(g=>g.filter(w=>w.id!==x)),d({title:"Application Approved",description:`${h.name} has been approved and added to the contractor network.`}))},p=x=>{const h=o.find(g=>g.id===x);h&&(l(g=>g.filter(w=>w.id!==x)),d({title:"Application Rejected",description:`${h.name}'s application has been rejected.`,variant:"destructive"}))};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(cA,{}),a.jsx("div",{className:"bg-slate-800 text-white p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsx("div",{children:a.jsx("h1",{className:"text-lg font-medium",children:"Simple Time Tracking"})}),a.jsxs("div",{className:"ml-auto flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),a.jsx("span",{className:"text-xs",children:"Online"})]})]})}),a.jsx("div",{className:"bg-slate-900 px-4 py-3",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx("p",{className:"text-slate-400 text-sm",children:"Send forms and manage contractor applications"})})}),a.jsx("div",{className:"bg-slate-900 px-4",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex space-x-6 border-b border-slate-700",children:[{key:"Send Form",label:"Send Form"},{key:"Pending Review",label:"Pending Review"},{key:"Approved",label:"Reviewed"}].map(x=>a.jsx("button",{onClick:()=>t(x.key),className:`py-3 px-1 text-sm font-medium border-b-2 ${e===x.key?"border-yellow-500 text-yellow-400":"border-transparent text-slate-400 hover:text-slate-300"}`,children:x.label},x.key))})})}),a.jsxs("div",{className:"max-w-4xl mx-auto p-4 pb-20",children:[e==="Send Form"&&a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx(h2,{className:"w-5 h-5 text-yellow-400"}),a.jsx("h3",{className:"text-yellow-400 text-lg font-medium",children:"Send Contractor Form"})]}),a.jsx("p",{className:"text-slate-400 mb-4 text-sm",children:"Send onboarding form to new contractors via Telegram"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Contractor Name *"}),a.jsx("input",{type:"text",value:r,onChange:x=>n(x.target.value),placeholder:"e.g. James Carpenter",className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white placeholder-slate-500 focus:border-yellow-500 focus:outline-none text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Telegram ID *"}),a.jsx("input",{type:"text",value:s,onChange:x=>i(x.target.value),placeholder:"@username or 1234567890",className:"w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white placeholder-slate-500 focus:border-yellow-500 focus:outline-none text-sm"}),a.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"Use @username or numeric ID"})]}),a.jsx("div",{className:"bg-slate-700 border border-slate-600 rounded p-3 mt-4",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx("div",{className:"w-5 h-5 mt-0.5",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"text-blue-400",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-blue-400 text-sm font-medium",children:"The contractor will receive a comprehensive form covering"}),a.jsx("p",{className:"text-slate-300 text-xs mt-1",children:"personal details, right to work, CIS information, banking details, emergency contacts, and trade specialization."})]})]})}),a.jsx(je,{onClick:m,className:"w-full bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2.5 mt-4 text-sm",children:"Send Form"})]})]})}),e==="Pending Review"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-yellow-400 text-lg font-medium",children:"Applications Pending Review"}),a.jsxs(De,{variant:"secondary",className:"bg-orange-600 text-white",children:[o.length," Pending"]})]}),o.length===0?a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-8 text-center",children:[a.jsx(Bn,{className:"w-12 h-12 text-slate-500 mx-auto mb-4"}),a.jsx("h4",{className:"text-slate-300 text-lg mb-2",children:"No Pending Applications"}),a.jsx("p",{className:"text-slate-500",children:"Applications will appear here when contractors submit their forms."})]}):a.jsx("div",{className:"grid gap-4",children:o.map(x=>a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white text-lg font-medium",children:x.name}),a.jsxs("div",{className:"text-slate-400 text-sm space-y-1",children:[a.jsxs("p",{children:[" ",x.email]}),a.jsxs("p",{children:[" ",x.phone]}),a.jsxs("p",{children:[" Submitted: ",x.submittedDate]}),x.telegramId&&a.jsxs("p",{children:[" ",x.telegramId]})]})]}),a.jsx(De,{variant:"secondary",className:"bg-orange-600 text-white",children:x.status})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs(je,{onClick:()=>f(x.id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white flex items-center justify-center space-x-2",children:[a.jsx($t,{className:"w-4 h-4"}),a.jsx("span",{children:"Approve"})]}),a.jsxs(je,{onClick:()=>p(x.id),variant:"destructive",className:"flex-1 flex items-center justify-center space-x-2",children:[a.jsx(ts,{className:"w-4 h-4"}),a.jsx("span",{children:"Reject"})]})]})]},x.id))})]}),e==="Approved"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-yellow-400 text-lg font-medium",children:"Approved Contractors"}),a.jsxs(De,{variant:"secondary",className:"bg-green-600 text-white",children:[c.length," Approved"]})]}),c.length===0?a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-8 text-center",children:[a.jsx($t,{className:"w-12 h-12 text-slate-500 mx-auto mb-4"}),a.jsx("h4",{className:"text-slate-300 text-lg mb-2",children:"No Approved Contractors"}),a.jsx("p",{className:"text-slate-500",children:"Approved contractors will appear here after review."})]}):a.jsx("div",{className:"grid gap-4",children:c.map(x=>a.jsxs("div",{className:"bg-slate-800 border border-green-600 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white text-lg font-medium",children:x.name}),a.jsxs("div",{className:"text-slate-400 text-sm space-y-1",children:[a.jsxs("p",{children:[" ",x.email]}),a.jsxs("p",{children:[" ",x.phone]}),a.jsxs("p",{children:[" Approved: ",x.reviewedDate]}),x.telegramId&&a.jsxs("p",{children:[" ",x.telegramId]})]})]}),a.jsx(De,{variant:"secondary",className:"bg-green-600 text-white",children:"Approved"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:x.specialization.map((h,g)=>a.jsx(De,{variant:"outline",className:"border-yellow-500 text-yellow-400",children:h},g))})]},x.id))})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"flex justify-around py-2",children:[a.jsxs("a",{href:"/",className:"flex flex-col items-center py-2 px-4",children:[a.jsx("div",{className:"w-6 h-6 mb-1",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"text-slate-400",children:a.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})})}),a.jsx("span",{className:"text-xs text-slate-400",children:"Dashboard"})]}),a.jsxs("a",{href:"/jobs",className:"flex flex-col items-center py-2 px-4",children:[a.jsx("div",{className:"w-6 h-6 mb-1",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"text-slate-400",children:a.jsx("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"})})}),a.jsx("span",{className:"text-xs text-slate-400",children:"Jobs"})]}),a.jsxs("a",{href:"/admin",className:"flex flex-col items-center py-2 px-4",children:[a.jsx("div",{className:"w-6 h-6 mb-1",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"text-yellow-400",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})}),a.jsx("span",{className:"text-xs text-yellow-400",children:"Admin"})]}),a.jsxs("a",{href:"/upload-job",className:"flex flex-col items-center py-2 px-4",children:[a.jsx("div",{className:"w-6 h-6 mb-1",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"text-slate-400",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})})}),a.jsx("span",{className:"text-xs text-slate-400",children:"Upload Job"})]})]})})]})}function dA(){const[e,t]=b.useState(1),[r,n]=b.useState({firstName:"",lastName:"",email:"",phone:"",telegramId:"",fullAddress:"",city:"",postcode:"",hasRightToWork:!1,passportNumber:"",passportPhotoUploaded:!1,passportPhotoFile:null,passportPhotoName:"",utrNumber:"",isCisRegistered:null,hasPublicLiability:!1,cisStatus:"",cisNumber:"",utrNumberDetails:"",hasValidCscs:!1,bankName:"",accountHolderName:"",sortCode:"",accountNumber:"",emergencyName:"",emergencyPhone:"",relationship:"",primaryTrade:"",yearsExperience:"",hasOwnTools:!1,toolsList:""}),{toast:s}=Tt(),i=[{number:1,title:"Personal Information",icon:Un,fields:["firstName","lastName","email","phone","fullAddress","city","postcode"]},{number:2,title:"Right to Work & Documentation",icon:I0,fields:["hasRightToWork","passportNumber"]},{number:3,title:"CIS & Tax Information",icon:us,fields:["isCisRegistered","utrNumberDetails"]},{number:4,title:"Banking Details",icon:yg,fields:["bankName","accountHolderName","sortCode","accountNumber"]},{number:5,title:"Emergency Contact",icon:Ng,fields:["emergencyName","emergencyPhone","relationship"]},{number:6,title:"Trade & Tools",icon:gh,fields:["primaryTrade","yearsExperience"]}],o=["General Builder","Carpenter","Electrician","Plumber","Plasterer","Tiler","Painter & Decorator","Bricklayer","Roofer","Groundworker","Glazier","Flooring Specialist","HVAC Technician","Steelwork","Scaffolder"],l=["0-1 years","2-5 years","6-10 years","11-15 years","16+ years"],c=(h,g)=>{try{n(w=>({...w,[h]:g}))}catch(w){console.error("Error updating form data:",w)}},u=h=>{const g=i[h-1];return g?g.fields.every(w=>{const v=r[w];return typeof v=="boolean"||v===null?w==="isCisRegistered"?v===!0||v===!1:w.startsWith("has")||w.includes("is")?v===!0:!0:v!==""&&v!==void 0&&v!==null}):!1},d=()=>{u(e)?t(h=>Math.min(h+1,6)):s({title:"Please complete the following required fields:",description:m(e),variant:"destructive"})},m=h=>{const w=i[h-1].fields.filter(y=>{const N=r[y];return typeof N=="boolean"||N===null?y==="isCisRegistered"?N==null:y.startsWith("has")||y.includes("is")?N!==!0:!1:N===""||N===void 0||N===null}),v={firstName:"First Name",lastName:"Last Name",email:"Email Address",phone:"Phone Number",fullAddress:"Full Address",city:"City",postcode:"Postcode",hasRightToWork:"Right to work confirmation",passportNumber:"Passport Number",utrNumber:"UTR Number",isCisRegistered:"CIS registration status",hasPublicLiability:"Public liability insurance",cisStatus:"CIS Status",utrNumberDetails:"UTR Number",bankName:"Bank Name",accountHolderName:"Account Holder Name",sortCode:"Sort Code",accountNumber:"Account Number",emergencyName:"Emergency Contact Name",emergencyPhone:"Emergency Phone",relationship:"Relationship",primaryTrade:"Primary Trade",yearsExperience:"Years of Experience"};return w.map(y=>` ${v[y]||y}`).join(`
`)},f=()=>{t(h=>Math.max(h-1,1))},p=async()=>{if(!u(6)){s({title:"Please complete all required fields",variant:"destructive"});return}try{const h=await fetch("/api/contractor-applications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!h.ok){const w=await h.json();throw new Error(w.error||"Failed to submit application")}const g=await h.json();console.log("Application submitted successfully:",g),s({title:"Application Submitted Successfully!",description:"Your contractor application has been submitted for review. You'll hear back from us within 24 hours."}),setTimeout(()=>{window.location.href="/contractor-success"},2e3)}catch(h){console.error("Submission error:",h),s({title:"Submission Error",description:h instanceof Error?h.message:"There was an error submitting your application. Please try again.",variant:"destructive"})}},x=()=>{try{switch(e){case 1:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Un,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Personal Information"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"First Name *"}),a.jsx("input",{type:"text",value:r.firstName,onChange:h=>c("firstName",h.target.value),placeholder:"e.g. James",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Last Name *"}),a.jsx("input",{type:"text",value:r.lastName,onChange:h=>c("lastName",h.target.value),placeholder:"e.g. Carpenter",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Email Address *"}),a.jsx("input",{type:"email",value:r.email,onChange:h=>c("email",h.target.value),placeholder:"james@example.com",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Phone Number *"}),a.jsx("input",{type:"tel",value:r.phone,onChange:h=>c("phone",h.target.value),placeholder:"07123456789",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Telegram ID (Optional)"}),a.jsx("input",{type:"text",value:r.telegramId,onChange:h=>c("telegramId",h.target.value),placeholder:"@username or user ID",className:"w-full bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"}),a.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"For work notifications"})]}),a.jsxs("div",{className:"border-t border-slate-600 pt-4",children:[a.jsx("h3",{className:"text-yellow-400 font-medium mb-4",children:"Address Details"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Full Address *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:r.fullAddress,onChange:h=>c("fullAddress",h.target.value),placeholder:"123 High Street, London",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"}),a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"City *"}),a.jsx("input",{type:"text",value:r.city,onChange:h=>c("city",h.target.value),placeholder:"London",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Postcode *"}),a.jsx("input",{type:"text",value:r.postcode,onChange:h=>c("postcode",h.target.value),placeholder:"SW1A 1AA",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]})]})]})]})]});case 2:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(I0,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Right to Work & Documentation"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:"rightToWork",checked:r.hasRightToWork,onChange:h=>c("hasRightToWork",h.target.checked),className:"w-5 h-5 text-yellow-400 bg-slate-800 border-yellow-500 rounded focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"rightToWork",className:"text-white font-medium",children:"I have the right to work in the UK *"})]}),a.jsx(_e,{className:"bg-slate-800 border-slate-600",children:a.jsxs(Ae,{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Passport Number"}),a.jsx("input",{type:"text",value:r.passportNumber,onChange:h=>c("passportNumber",h.target.value),placeholder:"e.g. 123456789",className:"w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Passport Photo"}),a.jsx("input",{type:"file",accept:"image/*,application/pdf",onChange:h=>{if(h.target.files&&h.target.files[0]){const g=h.target.files[0];if(g.size>10*1024*1024){s({title:"File too large",description:"Please select a file smaller than 10MB",variant:"destructive"});return}c("passportPhotoUploaded",!0),c("passportPhotoFile",g),c("passportPhotoName",g.name),s({title:"Photo uploaded",description:`Successfully uploaded ${g.name}`})}},className:"hidden",id:"passportUpload"}),a.jsxs("label",{htmlFor:"passportUpload",className:"bg-yellow-500 hover:bg-yellow-600 text-black font-medium px-6 py-2 rounded-lg flex items-center space-x-2 cursor-pointer inline-flex",children:[a.jsx(m2,{className:"w-4 h-4"}),a.jsx("span",{children:r.passportPhotoUploaded?"Change Photo":"Upload Passport Photo"})]}),r.passportPhotoUploaded&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[a.jsx($t,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Photo uploaded successfully"})]}),r.passportPhotoName&&a.jsxs("div",{className:"text-xs text-slate-400",children:["File: ",r.passportPhotoName]})]}),a.jsx("div",{className:"mt-2 text-xs text-slate-400",children:"Accepted formats: JPG, PNG, PDF (max 10MB)"})]})]})}),a.jsxs("div",{className:"border-t border-slate-600 pt-4",children:[a.jsx("h3",{className:"text-yellow-400 font-medium mb-4",children:"Insurance (Optional)"}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:"hasInsurance",checked:r.hasPublicLiability,onChange:h=>c("hasPublicLiability",h.target.checked),className:"w-5 h-5 text-yellow-400 bg-slate-800 border-yellow-500 rounded focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"hasInsurance",className:"text-white",children:"I have public liability insurance (optional)"})]})})]})]})]});case 3:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(us,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"CIS & Tax Information"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"CIS Registration Status *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"radio",id:"cisYes",name:"cisRegistered",checked:r.isCisRegistered===!0,onChange:h=>{c("isCisRegistered",!0),c("cisStatus","CIS Registered (20% deduction)")},className:"w-4 h-4 text-yellow-500 bg-slate-800 border-yellow-500 focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"cisYes",className:"text-white",children:"Yes - I am CIS Registered (20% deduction)"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"radio",id:"cisNo",name:"cisRegistered",checked:r.isCisRegistered===!1,onChange:h=>{c("isCisRegistered",!1),c("cisStatus","Not CIS Registered (30% deduction)")},className:"w-4 h-4 text-yellow-500 bg-slate-800 border-yellow-500 focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"cisNo",className:"text-white",children:"No - I am not CIS Registered (30% deduction)"})]})]})]}),r.isCisRegistered&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"CIS Number (if applicable)"}),a.jsx("input",{type:"text",value:r.cisNumber,onChange:h=>c("cisNumber",h.target.value),placeholder:"e.g. 123/AB12345",className:"w-full bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"UTR Number"}),a.jsx("input",{type:"text",value:r.utrNumberDetails,onChange:h=>c("utrNumberDetails",h.target.value),placeholder:"10 digit UTR number",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{className:"border-t border-slate-600 pt-4",children:[a.jsx("h3",{className:"text-yellow-400 font-medium mb-4",children:"CSCS Card Details"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:"hasValidCscs",checked:r.hasValidCscs,onChange:h=>c("hasValidCscs",h.target.checked),className:"w-5 h-5 text-yellow-400 bg-slate-800 border-yellow-500 rounded focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"hasValidCscs",className:"text-white",children:"I have a valid CSCS card"})]})]}),(r.cisNumber||r.utrNumberDetails)&&a.jsx(_e,{className:"bg-red-50 border-red-200",children:a.jsxs(Ae,{className:"p-4",children:[a.jsx("h4",{className:"text-red-800 font-medium mb-2",children:"Please complete the following required fields:"}),a.jsxs("ul",{className:"text-red-700 text-sm space-y-1",children:[!r.cisNumber&&r.isCisRegistered&&a.jsx("li",{children:" CIS number is required when registered"}),!r.utrNumberDetails&&a.jsx("li",{children:" UTR number is required when you have one"})]})]})})]})]});case 4:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(yg,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Banking Details"})]}),a.jsx(_e,{className:"bg-slate-800 border-yellow-500",children:a.jsx(Ae,{className:"p-6",children:a.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[a.jsx(I0,{className:"w-5 h-5 text-yellow-400 mt-1"}),a.jsx("p",{className:"text-slate-300 text-sm",children:"Your banking information is encrypted and secure. Required for payment processing."})]})})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Bank Name *"}),a.jsx("input",{type:"text",value:r.bankName,onChange:h=>c("bankName",h.target.value),placeholder:"e.g. Barclays, HSBC, NatWest",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Account Holder Name *"}),a.jsx("input",{type:"text",value:r.accountHolderName,onChange:h=>c("accountHolderName",h.target.value),placeholder:"Full name as on account",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Sort Code *"}),a.jsx("input",{type:"text",value:r.sortCode,onChange:h=>c("sortCode",h.target.value),placeholder:"12-34-56",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Account Number *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:r.accountNumber,onChange:h=>c("accountNumber",h.target.value),placeholder:"12345678",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 pr-12 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"}),a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"})})]})]})]})]});case 5:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Ng,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Emergency Contact"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Emergency Contact Name *"}),a.jsx("input",{type:"text",value:r.emergencyName,onChange:h=>c("emergencyName",h.target.value),placeholder:"Full name",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Emergency Contact Phone *"}),a.jsx("input",{type:"tel",value:r.emergencyPhone,onChange:h=>c("emergencyPhone",h.target.value),placeholder:"07123456789",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Relationship *"}),a.jsx("input",{type:"text",value:r.relationship,onChange:h=>c("relationship",h.target.value),placeholder:"e.g. Spouse, Parent, Sibling",className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400"})]})]})]});case 6:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(gh,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Trade & Tools"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Primary Trade *"}),a.jsxs("select",{value:r.primaryTrade,onChange:h=>c("primaryTrade",h.target.value),className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400",children:[a.jsx("option",{value:"",children:"Select your primary trade"}),o.map(h=>a.jsx("option",{value:h,className:"bg-slate-800",children:h},h))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Years of Experience *"}),a.jsxs("select",{value:r.yearsExperience,onChange:h=>c("yearsExperience",h.target.value),className:"w-full bg-slate-800 border border-yellow-500 rounded-lg px-4 py-3 text-white focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400",children:[a.jsx("option",{value:"",children:"Select your experience level"}),l.map(h=>a.jsx("option",{value:h,className:"bg-slate-800",children:h},h))]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:"hasOwnTools",checked:r.hasOwnTools,onChange:h=>c("hasOwnTools",h.target.checked),className:"w-5 h-5 text-yellow-400 bg-slate-800 border-yellow-500 rounded focus:ring-yellow-400"}),a.jsx("label",{htmlFor:"hasOwnTools",className:"text-white",children:"I have my own tools"})]}),r.hasOwnTools&&a.jsx(_e,{className:"bg-slate-800 border-slate-600",children:a.jsxs(Ae,{className:"p-6",children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"List your main tools (optional)"}),a.jsx("textarea",{value:r.toolsList,onChange:h=>c("toolsList",h.target.value),placeholder:"Drill",rows:4,className:"w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 resize-none"})]})})]})]});default:return a.jsx("div",{children:"Invalid step"})}}catch(h){return console.error("Error rendering step content:",h),a.jsxs("div",{className:"text-center text-red-400 p-8",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Something went wrong"}),a.jsx("p",{children:"Please refresh the page and try again."})]})}};try{return a.jsxs("div",{className:"min-h-screen bg-black text-white",children:[a.jsx("div",{className:"bg-slate-900 border-b border-slate-700 p-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-blue-400",children:"Contractor Registration"}),a.jsx("p",{className:"text-slate-400",children:"ER Build & Design - Complete your onboarding"})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-sm text-slate-400",children:["Step ",e," of 6"]}),a.jsxs("span",{className:"text-sm text-slate-400",children:[Math.round(e/6*100),"%"]})]}),a.jsx("div",{className:"w-full bg-slate-600 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${e/6*100}%`}})})]})]})}),a.jsx("div",{className:"max-w-2xl mx-auto p-6",children:a.jsx(_e,{className:"bg-slate-900 border-slate-700",children:a.jsxs(Ae,{className:"p-8",children:[x(),a.jsxs("div",{className:"flex justify-between items-center mt-8 pt-6 border-t border-slate-600",children:[a.jsx(je,{onClick:f,disabled:e===1,variant:"outline",className:"px-6 py-2 border-slate-600 text-slate-300 hover:bg-slate-800",children:"Previous"}),e<6?a.jsx(je,{onClick:d,className:"px-8 py-2 bg-yellow-500 hover:bg-yellow-600 text-black font-medium",children:"Next"}):a.jsx(je,{onClick:p,className:"px-8 py-2 bg-yellow-500 hover:bg-yellow-600 text-black font-medium",children:"Submit Application"})]})]})})})]})}catch(h){return console.error("Contractor form error:",h),a.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"Application Error"}),a.jsx("p",{className:"text-slate-400",children:"Sorry, there was an error loading the form. Please try refreshing the page."})]})})}}function fA(){return a.jsxs("div",{className:"min-h-screen bg-black text-white",children:[a.jsx("div",{className:"bg-slate-900 border-b border-slate-700 p-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold text-green-400",children:"Application Submitted Successfully!"}),a.jsx("p",{className:"text-slate-400 mt-1",children:"ER Build & Design - Contractor Registration"})]})}),a.jsx("div",{className:"max-w-2xl mx-auto p-6",children:a.jsx(_e,{className:"bg-slate-900 border-green-500",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx($t,{className:"w-16 h-16 text-green-400 mx-auto mb-6"}),a.jsx("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Thank You for Your Application!"}),a.jsx("p",{className:"text-slate-300 text-lg mb-8",children:"Your contractor registration has been submitted successfully. Our team will review your application and get back to you within 24 hours."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 bg-slate-800 p-4 rounded-lg",children:[a.jsx(Bn,{className:"w-6 h-6 text-yellow-400"}),a.jsxs("div",{className:"text-left",children:[a.jsx("h3",{className:"font-medium text-white",children:"Review Time"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Within 24 hours"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3 bg-slate-800 p-4 rounded-lg",children:[a.jsx(ph,{className:"w-6 h-6 text-blue-400"}),a.jsxs("div",{className:"text-left",children:[a.jsx("h3",{className:"font-medium text-white",children:"We'll Contact You"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Via email & Telegram"})]})]})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[a.jsx("h3",{className:"text-yellow-400 font-medium mb-3",children:"What's Next?"}),a.jsxs("ul",{className:"text-slate-300 text-left space-y-2",children:[a.jsx("li",{children:" We'll verify your documentation and credentials"}),a.jsx("li",{children:" Complete a brief phone interview if needed"}),a.jsx("li",{children:" Get approved and start receiving job assignments"}),a.jsx("li",{children:" Begin earning with ER Build & Design"})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-600",children:[a.jsx("p",{className:"text-slate-400 mb-2",children:"Questions or concerns?"}),a.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(f2,{className:"w-4 h-4 text-yellow-400"}),a.jsx("span",{className:"text-yellow-400",children:"07534251548"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ph,{className:"w-4 h-4 text-yellow-400"}),a.jsx("span",{className:"text-yellow-400",children:"admin@erbuild.co.uk"})]})]})]})]})})})]})}var hA=b.createContext(void 0);function rx(e){const t=b.useContext(hA);return e||t||"ltr"}var U0="rovingFocusGroup.onEntryFocus",mA={bubbles:!1,cancelable:!0},Md="RovingFocusGroup",[Eh,ib,xA]=Mm(Md),[pA,ob]=la(Md,[xA]),[gA,vA]=pA(Md),lb=b.forwardRef((e,t)=>a.jsx(Eh.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Eh.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(yA,{...e,ref:t})})}));lb.displayName=Md;var yA=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...m}=e,f=b.useRef(null),p=ut(t,f),x=rx(i),[h=null,g]=oo({prop:o,defaultProp:l,onChange:c}),[w,v]=b.useState(!1),y=Cr(u),N=ib(r),S=b.useRef(!1),[C,j]=b.useState(0);return b.useEffect(()=>{const E=f.current;if(E)return E.addEventListener(U0,y),()=>E.removeEventListener(U0,y)},[y]),a.jsx(gA,{scope:r,orientation:n,dir:x,loop:s,currentTabStopId:h,onItemFocus:b.useCallback(E=>g(E),[g]),onItemShiftTab:b.useCallback(()=>v(!0),[]),onFocusableItemAdd:b.useCallback(()=>j(E=>E+1),[]),onFocusableItemRemove:b.useCallback(()=>j(E=>E-1),[]),children:a.jsx(Me.div,{tabIndex:w||C===0?-1:0,"data-orientation":n,...m,ref:p,style:{outline:"none",...e.style},onMouseDown:Ce(e.onMouseDown,()=>{S.current=!0}),onFocus:Ce(e.onFocus,E=>{const k=!S.current;if(E.target===E.currentTarget&&k&&!w){const F=new CustomEvent(U0,mA);if(E.currentTarget.dispatchEvent(F),!F.defaultPrevented){const M=N().filter(X=>X.focusable),R=M.find(X=>X.active),z=M.find(X=>X.id===h),K=[R,z,...M].filter(Boolean).map(X=>X.ref.current);db(K,d)}}S.current=!1}),onBlur:Ce(e.onBlur,()=>v(!1))})})}),cb="RovingFocusGroupItem",ub=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,...o}=e,l=Zl(),c=i||l,u=vA(cb,r),d=u.currentTabStopId===c,m=ib(r),{onFocusableItemAdd:f,onFocusableItemRemove:p}=u;return b.useEffect(()=>{if(n)return f(),()=>p()},[n,f,p]),a.jsx(Eh.ItemSlot,{scope:r,id:c,focusable:n,active:s,children:a.jsx(Me.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Ce(e.onMouseDown,x=>{n?u.onItemFocus(c):x.preventDefault()}),onFocus:Ce(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Ce(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const h=NA(x,u.orientation,u.dir);if(h!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let w=m().filter(v=>v.focusable).map(v=>v.ref.current);if(h==="last")w.reverse();else if(h==="prev"||h==="next"){h==="prev"&&w.reverse();const v=w.indexOf(x.currentTarget);w=u.loop?SA(w,v+1):w.slice(v+1)}setTimeout(()=>db(w))}})})})});ub.displayName=cb;var wA={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function bA(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function NA(e,t,r){const n=bA(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return wA[n]}function db(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function SA(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var jA=lb,TA=ub,nx="Tabs",[EA,g7]=la(nx,[ob]),fb=ob(),[CA,sx]=EA(nx),hb=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=rx(l),[m,f]=oo({prop:n,onChange:s,defaultProp:i});return a.jsx(CA,{scope:r,baseId:Zl(),value:m,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Me.div,{dir:d,"data-orientation":o,...u,ref:t})})});hb.displayName=nx;var mb="TabsList",xb=b.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,i=sx(mb,r),o=fb(r);return a.jsx(jA,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:a.jsx(Me.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});xb.displayName=mb;var pb="TabsTrigger",gb=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...i}=e,o=sx(pb,r),l=fb(r),c=wb(o.baseId,n),u=bb(o.baseId,n),d=n===o.value;return a.jsx(TA,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Me.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:t,onMouseDown:Ce(e.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?o.onValueChange(n):m.preventDefault()}),onKeyDown:Ce(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(n)}),onFocus:Ce(e.onFocus,()=>{const m=o.activationMode!=="manual";!d&&!s&&m&&o.onValueChange(n)})})})});gb.displayName=pb;var vb="TabsContent",yb=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:i,...o}=e,l=sx(vb,r),c=wb(l.baseId,n),u=bb(l.baseId,n),d=n===l.value,m=b.useRef(d);return b.useEffect(()=>{const f=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(Cd,{present:s||d,children:({present:f})=>a.jsx(Me.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0},children:f&&i})})});yb.displayName=vb;function wb(e,t){return`${e}-trigger-${t}`}function bb(e,t){return`${e}-content-${t}`}var kA=hb,Nb=xb,Sb=gb,jb=yb;const _A=kA,Tb=b.forwardRef(({className:e,...t},r)=>a.jsx(Nb,{ref:r,className:He("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Tb.displayName=Nb.displayName;const lu=b.forwardRef(({className:e,...t},r)=>a.jsx(Sb,{ref:r,className:He("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));lu.displayName=Sb.displayName;const cu=b.forwardRef(({className:e,...t},r)=>a.jsx(jb,{ref:r,className:He("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));cu.displayName=jb.displayName;const qr=b.forwardRef(({className:e,type:t,...r},n)=>a.jsx("input",{type:t,className:He("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));qr.displayName="Input";var AA="Label",Eb=b.forwardRef((e,t)=>a.jsx(Me.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Eb.displayName=AA;var Cb=Eb;const PA=Ad("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),xn=b.forwardRef(({className:e,...t},r)=>a.jsx(Cb,{ref:r,className:He(PA(),e),...t}));xn.displayName=Cb.displayName;function $0({application:e,onStatusUpdate:t,onAdminUpdate:r}){const[n,s]=b.useState({adminCisVerification:e.adminCisVerification||"",adminPayRate:e.adminPayRate||"",adminNotes:e.adminNotes||""}),[i,o]=b.useState(!1),l=()=>{r(e.id,n),o(!1)},c=u=>{switch(u){case"pending":return a.jsxs(De,{variant:"outline",className:"bg-orange-100 text-orange-800 border-orange-300",children:[a.jsx(Bn,{className:"w-3 h-3 mr-1"}),"Pending Review"]});case"approved":return a.jsxs(De,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[a.jsx($t,{className:"w-3 h-3 mr-1"}),"Approved"]});case"rejected":return a.jsxs(De,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[a.jsx(ts,{className:"w-3 h-3 mr-1"}),"Rejected"]});default:return a.jsx(De,{variant:"outline",children:"Unknown"})}};return a.jsxs(_e,{className:"mb-4 bg-white border border-slate-200 shadow-lg",children:[a.jsx(et,{className:"pb-6 bg-slate-50 border-b",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-700 rounded-full flex items-center justify-center",children:a.jsx(Un,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsxs(tt,{className:"text-xl font-semibold text-slate-800",children:[e.firstName," ",e.lastName]}),a.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-slate-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(ph,{className:"w-4 h-4"}),e.email]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(f2,{className:"w-4 h-4"}),e.phone]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-slate-600",children:[a.jsx(Pd,{className:"w-4 h-4"}),a.jsxs("span",{children:[e.city,", ",e.postcode]})]}),a.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[e.yearsExperience," years experience"]})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[c(e.status),a.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(Mu,{className:"w-3 h-3"}),e.submittedAt?new Date(e.submittedAt).toLocaleDateString():"N/A"]}),a.jsx("div",{className:"flex items-center gap-2 text-sm",children:a.jsx("span",{className:"bg-slate-200 px-2 py-1 rounded text-slate-700 font-medium",children:e.primaryTrade})})]})]})}),a.jsxs(Ae,{className:"pt-6",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 text-sm",children:[a.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[a.jsx("h4",{className:"font-semibold mb-3 text-slate-800 text-base",children:"Tax & CIS Information"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" CIS Status:"}),a.jsxs("span",{className:"font-medium text-slate-800",children:[e.cisStatus||"Not CIS Registered"," ",!e.isCisRegistered||e.isCisRegistered==="false"?"(30% deduction)":""]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" UTR:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.utrNumberDetails||"Not provided"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" CIS Registered:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.isCisRegistered==="true"?"Yes":"No"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Valid CSCS:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.hasValidCscs==="true"?"Yes":"No"})]})]})]}),a.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[a.jsxs("h4",{className:"font-semibold mb-3 text-slate-800 text-base flex items-center gap-2",children:[a.jsx(bg,{className:"w-4 h-4"}),"Banking Details"]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Bank Name:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.bankName||"Not provided"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Account Holder:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.accountHolderName||"Not provided"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Sort Code:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.sortCode||"Not provided"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Account Number:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.accountNumber||"Not provided"})]})]})]}),a.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[a.jsx("h4",{className:"font-semibold mb-3 text-slate-800 text-base",children:"Work Details"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Right to Work:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.hasRightToWork==="true"?"Yes":"No"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Public Liability:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.hasPublicLiability==="true"?"Yes":"No"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Own Tools:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.hasOwnTools==="true"?"Yes":"No"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:" Passport Photo:"}),a.jsx("span",{className:"font-medium text-slate-800",children:e.passportPhotoUploaded==="true"?"Uploaded":"Not uploaded"})]})]})]}),a.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h4",{className:"font-semibold text-slate-800 text-base flex items-center gap-2",children:[a.jsx(Sk,{className:"w-4 h-4"}),"Admin Details"]}),a.jsx(je,{size:"sm",variant:"outline",onClick:()=>o(!i),className:"h-6 px-2 text-xs border-slate-300 hover:bg-slate-100",children:i?"Cancel":"Edit"})]}),i?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"cisVerification",className:"text-xs font-medium text-slate-700",children:"CIS Verification"}),a.jsx(qr,{id:"cisVerification",value:n.adminCisVerification,onChange:u=>s(d=>({...d,adminCisVerification:u.target.value})),placeholder:"Admin CIS verification details",className:"h-8 text-xs mt-1"})]}),a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"payRate",className:"text-xs font-medium text-slate-700",children:"Pay Rate (/hour)"}),a.jsx(qr,{id:"payRate",value:n.adminPayRate,onChange:u=>s(d=>({...d,adminPayRate:u.target.value})),placeholder:"e.g. 22.50",className:"h-8 text-xs mt-1"})]}),a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"adminNotes",className:"text-xs font-medium text-slate-700",children:"Admin Notes"}),a.jsx(tc,{id:"adminNotes",value:n.adminNotes,onChange:u=>s(d=>({...d,adminNotes:u.target.value})),placeholder:"Internal admin notes",className:"h-16 text-xs mt-1"})]}),a.jsx(je,{size:"sm",onClick:l,className:"w-full h-7 text-xs bg-slate-700 hover:bg-slate-800",children:"Save Admin Details"})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-slate-600 flex items-center gap-1",children:[a.jsx(us,{className:"w-3 h-3"}),"CIS:"]}),a.jsx("span",{className:"font-medium text-slate-800",children:e.adminCisVerification||"Not verified"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-slate-600 flex items-center gap-1",children:[a.jsx(bg,{className:"w-3 h-3"}),"Rate:"]}),a.jsx("span",{className:"font-medium text-slate-800",children:e.adminPayRate?`${e.adminPayRate}/hr`:"Not set"})]}),a.jsxs("div",{className:"text-xs",children:[a.jsx("span",{className:"text-slate-600",children:"Notes:"}),a.jsx("span",{className:"font-medium text-slate-800 ml-1",children:e.adminNotes||"None"})]})]})]})]}),e.status==="pending"&&a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t",children:[a.jsxs(je,{size:"lg",className:"bg-green-600 hover:bg-green-700 flex-1 py-3 text-base font-medium",onClick:()=>t(e.id,"approved"),children:[a.jsx($t,{className:"w-5 h-5 mr-2"}),"Approve Application"]}),a.jsxs(je,{size:"lg",variant:"destructive",className:"flex-1 py-3 text-base font-medium",onClick:()=>t(e.id,"rejected"),children:[a.jsx(ts,{className:"w-5 h-5 mr-2"}),"Reject Application"]})]}),e.status==="approved"&&a.jsx("div",{className:"mt-4 pt-4 border-t",children:a.jsxs(De,{className:"bg-green-100 text-green-800 border-green-300 px-4 py-2 text-sm",children:[a.jsx($t,{className:"w-4 h-4 mr-2"}),"Application Approved"]})}),e.status==="rejected"&&a.jsx("div",{className:"mt-4 pt-4 border-t",children:a.jsxs(De,{className:"bg-red-100 text-red-800 border-red-300 px-4 py-2 text-sm",children:[a.jsx(ts,{className:"w-4 h-4 mr-2"}),"Application Rejected"]})})]})]})}function FA(){const{toast:e}=Tt(),[t,r]=b.useState("pending"),{data:n=[],isLoading:s}=rt({queryKey:["/api/contractor-applications"]}),i=Tr({mutationFn:async({id:f,status:p})=>{const x=await fetch(`/api/contractor-applications/${f}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:p})});if(!x.ok)throw new Error("Failed to update status");return x.json()},onSuccess:()=>{io.invalidateQueries({queryKey:["/api/contractor-applications"]}),e({title:"Status Updated",description:"Application status has been updated successfully."})},onError:()=>{e({title:"Error",description:"Failed to update application status.",variant:"destructive"})}}),o=Tr({mutationFn:async({id:f,updates:p})=>{const x=await fetch(`/api/contractor-applications/${f}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!x.ok)throw new Error("Failed to update admin details");return x.json()},onSuccess:()=>{io.invalidateQueries({queryKey:["/api/contractor-applications"]}),e({title:"Admin Details Updated",description:"CIS verification and pay rate have been saved."})},onError:()=>{e({title:"Error",description:"Failed to update admin details.",variant:"destructive"})}}),l=(f,p)=>{i.mutate({id:f,status:p})},c=(f,p)=>{o.mutate({id:f,updates:p})},u=n.filter(f=>f.status==="pending"),d=n.filter(f=>f.status==="approved"),m=n.filter(f=>f.status==="rejected");return s?a.jsx("div",{className:"min-h-screen bg-slate-800 text-white p-6",children:a.jsx("div",{className:"max-w-6xl mx-auto",children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-500 mx-auto mb-4"}),a.jsx("p",{children:"Loading applications..."})]})})})}):a.jsxs("div",{className:"min-h-screen bg-slate-800 text-white",children:[a.jsx("div",{className:"bg-slate-700 text-white p-4 border-b border-slate-600",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Contractor Applications"}),a.jsx("p",{className:"text-sm opacity-75",children:"Review and manage contractor applications"}),a.jsxs("div",{className:"mt-2",children:[a.jsx("span",{className:"text-xs text-slate-400",children:"Contractor Form Link: "}),a.jsx("a",{href:"/contractor-form",className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"http://localhost:5000/contractor-form"})]})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsx(Ae,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:u.length}),a.jsx("p",{className:"text-sm text-gray-300",children:"Pending Review"})]}),a.jsx(Bn,{className:"w-8 h-8 text-yellow-600"})]})})}),a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsx(Ae,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-green-500",children:d.length}),a.jsx("p",{className:"text-sm text-gray-300",children:"Approved"})]}),a.jsx($t,{className:"w-8 h-8 text-green-500"})]})})}),a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsx(Ae,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-red-500",children:m.length}),a.jsx("p",{className:"text-sm text-gray-300",children:"Rejected"})]}),a.jsx(ts,{className:"w-8 h-8 text-red-500"})]})})})]}),a.jsxs(_A,{value:t,onValueChange:r,className:"w-full",children:[a.jsxs(Tb,{className:"grid w-full grid-cols-3 bg-slate-700",children:[a.jsxs(lu,{value:"pending",className:"data-[state=active]:bg-yellow-500 data-[state=active]:text-black",children:["Pending (",u.length,")"]}),a.jsxs(lu,{value:"approved",className:"data-[state=active]:bg-green-600 data-[state=active]:text-white",children:["Approved (",d.length,")"]}),a.jsxs(lu,{value:"rejected",className:"data-[state=active]:bg-red-600 data-[state=active]:text-white",children:["Rejected (",m.length,")"]})]}),a.jsx(cu,{value:"pending",className:"mt-6",children:u.length===0?a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx(Bn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Pending Applications"}),a.jsx("p",{className:"text-gray-400",children:"All applications have been reviewed."})]})}):a.jsx("div",{className:"space-y-4",children:u.map(f=>a.jsx($0,{application:f,onStatusUpdate:l,onAdminUpdate:c},f.id))})}),a.jsx(cu,{value:"approved",className:"mt-6",children:d.length===0?a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx($t,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Approved Applications"}),a.jsx("p",{className:"text-gray-400",children:"No applications have been approved yet."})]})}):a.jsx("div",{className:"space-y-4",children:d.map(f=>a.jsx($0,{application:f,onStatusUpdate:l,onAdminUpdate:c},f.id))})}),a.jsx(cu,{value:"rejected",className:"mt-6",children:m.length===0?a.jsx(_e,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx(ts,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Rejected Applications"}),a.jsx("p",{className:"text-gray-400",children:"No applications have been rejected."})]})}):a.jsx("div",{className:"space-y-4",children:m.map(f=>a.jsx($0,{application:f,onStatusUpdate:l,onAdminUpdate:c},f.id))})})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>r("pending"),className:`py-3 px-4 ${t==="pending"?"text-yellow-600":"text-slate-400 hover:text-white"}`,children:[a.jsx(Bn,{className:"w-5 h-5 mx-auto mb-1"}),a.jsxs("span",{className:"text-xs",children:["Pending (",u.length,")"]})]}),a.jsxs("button",{onClick:()=>r("approved"),className:`py-3 px-4 ${t==="approved"?"text-yellow-600":"text-slate-400 hover:text-white"}`,children:[a.jsx($t,{className:"w-5 h-5 mx-auto mb-1"}),a.jsxs("span",{className:"text-xs",children:["Approved (",d.length,")"]})]}),a.jsxs("button",{onClick:()=>r("rejected"),className:`py-3 px-4 ${t==="rejected"?"text-yellow-600":"text-slate-400 hover:text-white"}`,children:[a.jsx(ts,{className:"w-5 h-5 mx-auto mb-1"}),a.jsxs("span",{className:"text-xs",children:["Rejected (",m.length,")"]})]}),a.jsxs("button",{onClick:()=>window.location.href="/contractor-onboarding-clean",className:"py-3 px-4 text-slate-400 hover:text-yellow-600",children:[a.jsx("i",{className:"fas fa-user-plus block mb-1"}),a.jsx("span",{className:"text-xs",children:"Send Form"})]})]})}),a.jsx("div",{className:"h-20"})]})}function RA(){const e=()=>{localStorage.clear(),window.location.href="/login",window.location.reload()};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function Mg(){const[e,t]=b.useState(""),[r,n]=b.useState(null),[s,i]=b.useState([]),[o,l]=b.useState({}),[c,u]=b.useState({}),{toast:d}=Tt(),{data:m=[],isLoading:f,refetch:p}=rt({queryKey:["/api/job-assignments"],queryFn:async()=>{const v=await fetch("/api/job-assignments");if(!v.ok)throw new Error("Failed to fetch job assignments");return v.json()}}),x=async v=>{try{if(!(await fetch(`/api/job-assignments/${v}`,{method:"DELETE"})).ok)throw new Error("Failed to delete assignment");p(),d({title:"Assignment Deleted",description:"Job assignment has been removed successfully."})}catch{d({title:"Error",description:"Failed to delete assignment. Please try again.",variant:"destructive"})}},h=async v=>{if(r===v){n(null),i([]);return}n(v);try{const y=m.find(j=>j.id===v);if(!y)return;const S=await(await fetch(`/api/task-progress/${encodeURIComponent(y.contractorName)}/${v}`)).json(),C=[];S.forEach(j=>{j.completed===!0&&C.push({taskId:j.taskId,phase:j.phase,taskName:j.taskDescription,description:j.taskDescription,progress:100,completed:!0,inspectionStatus:"pending",notes:"",photos:[]})}),i(C)}catch(y){console.error("Error loading completed tasks:",y),i([])}},g=async()=>{if(r)try{const v=m.find(S=>S.id===r);if(!v)return;const y=s.map(S=>({assignmentId:r,contractorName:v.contractorName,taskId:S.taskId,phase:S.phase,taskName:S.taskName,inspectionStatus:o[S.taskId]||"pending",notes:c[S.taskId]||"",inspectedBy:localStorage.getItem("adminName")||"Admin",inspectedAt:new Date().toISOString()}));if(!(await fetch("/api/admin-inspections/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inspections:y})})).ok)throw new Error("Failed to submit inspection");d({title:"Inspection Submitted",description:"Task inspection completed successfully"}),n(null),i([]),l({}),u({})}catch{d({title:"Error",description:"Failed to submit inspection",variant:"destructive"})}},w=m.filter(v=>{var y,N,S;return((y=v==null?void 0:v.contractorName)==null?void 0:y.toLowerCase().includes(e.toLowerCase()))||((N=v==null?void 0:v.hbxlJob)==null?void 0:N.toLowerCase().includes(e.toLowerCase()))||((S=v==null?void 0:v.workLocation)==null?void 0:S.toLowerCase().includes(e.toLowerCase()))});return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(RA,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"RD"})})]})]}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-3xl font-bold text-yellow-400",children:"Job Assignments"}),a.jsxs(je,{onClick:()=>window.location.href="/create-assignment",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg flex items-center",children:[a.jsx("i",{className:"fas fa-plus mr-2"}),"Create Assignment"]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[a.jsx("div",{className:"p-4 border-b border-slate-700",children:a.jsx("h2",{className:"text-xl font-semibold text-yellow-400",children:"Current Assignments"})}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"mb-6",children:a.jsx("input",{type:"text",placeholder:"Search assignments...",value:e,onChange:v=>t(v.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500"})}),f?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-slate-400",children:"Loading assignments..."})}):w&&w.length>0?a.jsx("div",{className:"space-y-4",children:w.map((v,y)=>{var N;return a.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:a.jsx("i",{className:"fas fa-briefcase text-white text-lg"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:v.title||"Job Assignment"}),a.jsxs("p",{className:"text-sm text-slate-400",children:["Assigned to: ",v.contractorName||"Unknown"]}),a.jsxs("p",{className:"text-sm text-slate-400",children:["Location: ",v.workLocation||"No location specified"]}),a.jsxs("p",{className:"text-sm text-slate-400",children:["Job: ",v.hbxlJob||"No job specified"]})]})]}),a.jsxs("div",{className:"text-right flex items-center space-x-3",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Status"}),a.jsx("div",{className:"text-green-400 font-medium text-sm",children:v.status||"Assigned"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Phases"}),a.jsx("div",{className:"text-blue-400 font-medium text-sm",children:((N=v.buildPhases)==null?void 0:N.length)||0})]}),a.jsx("button",{onClick:()=>x(v.id),className:"p-3 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded-lg transition-colors border border-red-800 hover:border-red-600",title:"Delete Assignment",children:a.jsx("i",{className:"fas fa-trash text-lg"})})]})]}),a.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Start Date"}),a.jsx("div",{className:"text-white",children:v.startDate||"N/A"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Due Date"}),a.jsx("div",{className:"text-white",children:v.dueDate||"N/A"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Telegram"}),a.jsx("div",{className:"text-white",children:v.telegramNotified==="true"?" Sent":"Not sent"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-400",children:"Actions"}),a.jsx("div",{className:"flex space-x-2",children:a.jsxs("button",{onClick:()=>h(v.id),className:"text-yellow-400 hover:text-yellow-300 text-sm underline",children:[r===v.id?"Hide":"Show"," Task Inspection"]})})]})]}),r===v.id&&a.jsxs("div",{className:"mt-6 border-t border-slate-600 pt-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-amber-500/10 to-yellow-500/10 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6 border border-amber-500/20",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-amber-400 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-clipboard-check text-sm sm:text-base"}),a.jsx("span",{className:"hidden sm:inline",children:"Site Inspection Dashboard"}),a.jsx("span",{className:"sm:hidden",children:"Inspection"})]}),a.jsx("p",{className:"text-slate-300 mt-1 text-sm",children:"Quality assessment and task verification"})]}),a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-sm text-slate-400",children:"Inspector"}),a.jsx("div",{className:"text-amber-400 font-medium",children:localStorage.getItem("adminName")||"Admin"}),a.jsx("div",{className:"text-xs text-slate-500",children:new Date().toLocaleDateString("en-GB")})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:[a.jsx("div",{className:"text-slate-400 text-xs sm:text-sm",children:"Contractor"}),a.jsx("div",{className:"text-white font-medium text-sm sm:text-base",children:v.contractorName})]}),a.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:[a.jsx("div",{className:"text-slate-400 text-xs sm:text-sm",children:"Location"}),a.jsx("div",{className:"text-white font-medium text-sm sm:text-base",children:v.workLocation})]}),a.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:[a.jsx("div",{className:"text-slate-400 text-xs sm:text-sm",children:"Job Reference"}),a.jsx("div",{className:"text-white font-medium text-sm sm:text-base",children:v.hbxlJob})]})]}),s.length>0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-green-900/20 border border-green-700/30 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-green-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("i",{className:"fas fa-check text-white text-sm sm:text-lg"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("h4",{className:"text-green-400 font-semibold text-base sm:text-lg",children:[s.length," Task",s.length!==1?"s":""," Ready"]}),a.jsx("p",{className:"text-slate-300 text-xs sm:text-sm",children:"Complete - awaiting quality review"})]})]})}),a.jsx("div",{className:"space-y-3 sm:space-y-4",children:s.map(S=>a.jsxs("div",{className:"bg-slate-800/80 rounded-lg sm:rounded-xl border border-slate-600 overflow-hidden",children:[a.jsx("div",{className:"bg-slate-700/50 px-3 sm:px-6 py-3 sm:py-4 border-b border-slate-600",children:a.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start sm:items-center gap-3 min-w-0 flex-1",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx("i",{className:"fas fa-tasks text-white text-sm sm:text-base"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h5",{className:"text-white font-semibold text-sm sm:text-lg leading-tight",children:S.taskName}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4 mt-1",children:[a.jsxs("span",{className:"text-slate-400 text-xs sm:text-sm",children:["Phase: ",S.phase]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-900/30 border border-green-700/50 rounded-full text-green-400 text-xs font-medium w-fit",children:[a.jsx("i",{className:"fas fa-check-circle"}),"Complete"]})]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-400",children:"100%"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Progress"})]})]})}),a.jsxs("div",{className:"p-3 sm:p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-slate-300 font-medium mb-2 sm:mb-3 text-sm sm:text-base",children:"Quality Assessment"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsxs("button",{onClick:()=>l(C=>({...C,[S.taskId]:"approved"})),className:`px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium transition-all duration-200 text-sm sm:text-base ${o[S.taskId]==="approved"?"bg-green-600 text-white shadow-lg shadow-green-600/25 border-2 border-green-500":"bg-slate-700 text-slate-300 hover:bg-green-700 hover:text-white border-2 border-slate-600"}`,children:[a.jsx("i",{className:"fas fa-check-circle mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Approve Work"}),a.jsx("span",{className:"sm:hidden",children:"Approve"})]}),a.jsxs("button",{onClick:()=>l(C=>({...C,[S.taskId]:"issues"})),className:`px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium transition-all duration-200 text-sm sm:text-base ${o[S.taskId]==="issues"?"bg-red-600 text-white shadow-lg shadow-red-600/25 border-2 border-red-500":"bg-slate-700 text-slate-300 hover:bg-red-700 hover:text-white border-2 border-slate-600"}`,children:[a.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Requires Attention"}),a.jsx("span",{className:"sm:hidden",children:"Issues"})]}),a.jsxs("button",{className:"px-3 sm:px-4 py-2 sm:py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-200 border-2 border-blue-500 text-sm sm:text-base",children:[a.jsx("i",{className:"fas fa-camera mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Add Photo"}),a.jsx("span",{className:"sm:hidden",children:"Photo"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-slate-300 font-medium mb-2 text-sm sm:text-base",children:"Inspection Notes"}),a.jsx("textarea",{placeholder:"Record quality observations, measurements, compliance notes...",value:c[S.taskId]||"",onChange:C=>u(j=>({...j,[S.taskId]:C.target.value})),className:"w-full bg-slate-700/80 border border-slate-500 rounded-lg px-3 sm:px-4 py-2 sm:py-3 text-white placeholder-slate-400 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors text-sm sm:text-base",rows:2})]})]})]},S.taskId))}),a.jsx("div",{className:"bg-slate-800/60 rounded-lg sm:rounded-xl border border-slate-600 p-3 sm:p-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold text-base sm:text-lg",children:"Complete Inspection"}),a.jsx("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Review all assessments before submitting final report"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsx("button",{onClick:()=>{n(null),i([]),l({}),u({})},className:"px-4 sm:px-6 py-2 sm:py-3 bg-slate-600 hover:bg-slate-500 text-white rounded-lg font-medium transition-colors text-sm sm:text-base order-2 sm:order-1",children:"Cancel"}),a.jsxs("button",{onClick:g,className:"px-6 sm:px-8 py-2 sm:py-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg font-medium shadow-lg shadow-green-600/25 transition-all duration-200 text-sm sm:text-base order-1 sm:order-2",children:[a.jsx("i",{className:"fas fa-clipboard-check mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Submit Inspection Report"}),a.jsx("span",{className:"sm:hidden",children:"Submit Inspection"})]})]})]})})]}):a.jsxs("div",{className:"text-center py-8 sm:py-12 bg-slate-800/50 rounded-lg sm:rounded-xl border border-slate-600",children:[a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:a.jsx("i",{className:"fas fa-clipboard-list text-slate-400 text-lg sm:text-xl"})}),a.jsx("h4",{className:"text-white text-base sm:text-lg font-medium mb-2",children:"No Tasks Ready for Inspection"}),a.jsx("p",{className:"text-slate-400 text-xs sm:text-sm max-w-md mx-auto px-4",children:"Completed tasks will appear here automatically once contractors mark them as 100% finished. Check back later or contact the contractor for status updates."})]})]})]},y)})}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-slate-400 text-lg mb-2",children:"No job assignments found."}),a.jsx("div",{className:"text-slate-500 text-sm",children:'Use "Create Assignment" to assign jobs to contractors.'})]})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/admin-task-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]}),a.jsxs("button",{onClick:()=>window.location.href="/upload",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-upload block mb-1"}),a.jsx("span",{className:"text-xs",children:"Upload"})]})]})}),a.jsx("div",{className:"h-20"})]})}function IA(){const[e,t]=b.useState(""),[r,n]=b.useState(""),[s,i]=b.useState(!1),[o,l]=b.useState(!1),[c,u]=b.useState(null),[d,m]=b.useState(null),[f,p]=b.useState("Requesting"),[x,h]=b.useState(null),[g,w]=b.useState(null),[v,y]=b.useState(null),[N,S]=b.useState(!1),[C,j]=b.useState(null),[E,k]=b.useState("GPS check pending..."),{toast:F}=Tt();b.useEffect(()=>{let K=!1;return p("Requesting"),jh().then(X=>{K||(h(X.latitude),w(X.longitude),y(X.accuracy??null),p("Ready"))}).catch(X=>{if(K)return;p("Unavailable");const ee=(X==null?void 0:X.message)||"Unable to access your location.";k(ee),F({title:"GPS Error",description:ee,variant:"destructive"})}),()=>{K=!0}},[]);const M=async K=>{if(K.preventDefault(),localStorage.clear(),sessionStorage.clear(),e==="admin"&&r==="admin123"){localStorage.setItem("userRole","admin"),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("adminName","Admin"),console.log(" Admin login successful - role set to admin"),window.location.href="/admin",F({title:"Login Successful",description:"Welcome back, Admin!"});return}try{const X=await hn("/api/contractor-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})});if(X.ok){const ee=await X.json();if(localStorage.setItem("userRole","contractor"),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("contractorName",`${ee.firstName} ${ee.lastName}`),localStorage.setItem("contractorId",ee.id),console.log(` Contractor login successful - ${ee.firstName} ${ee.lastName}`),l(!0),u(`${ee.firstName} ${ee.lastName}`),x&&g)try{const te=await(await hn("/api/check-proximity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userLatitude:x.toString(),userLongitude:g.toString(),contractorName:`${ee.firstName} ${ee.lastName}`})})).json();S(!!te.withinRange),k(te.message||(te.withinRange?"Within range":"Too far from job site")),j(te.nearestJobSite?{location:te.nearestJobSite.location,distance:Math.round(te.nearestJobSite.distance||0),jobTitle:te.nearestJobSite.jobTitle}:null)}catch{k("Proximity check failed")}else k("GPS not ready yet; clock-in will capture when available");F({title:"Login Successful",description:`Welcome back, ${ee.firstName}!`})}else e==="contractor"&&r==="contractor123"?(localStorage.setItem("userRole","contractor"),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("contractorName","Dalwayne Diedericks"),console.log(" Legacy contractor login successful - Dalwayne Diedericks"),l(!0),u("Dalwayne Diedericks"),F({title:"Login Successful",description:"Welcome back, Dalwayne!"})):F({title:"Login Failed",description:"Invalid username or password",variant:"destructive"})}catch(X){console.error("Login error:",X),F({title:"Login Failed",description:"Unable to connect to server",variant:"destructive"})}},R=async()=>{if(!c){F({title:"Not authenticated",description:"Login first",variant:"destructive"});return}if(f!=="Ready"||x===null||g===null){F({title:"GPS Required",description:"Enable location to clock in",variant:"destructive"});return}try{const K=new Date().toISOString(),X={contractorName:c,jobSiteLocation:(C==null?void 0:C.location)||"Unknown Location",startTime:K,status:"active",startLatitude:x.toString(),startLongitude:g.toString()},ee=await hn("/api/work-sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(ee.ok){const V=await ee.json();m(V.id),localStorage.setItem("gps_timer_active","true"),localStorage.setItem("gps_timer_start",K),F({title:"Clocked In",description:`Session started for ${c}`}),window.location.href="/"}else{const V=await ee.text();F({title:"Clock-in failed",description:V||"Unable to create session",variant:"destructive"})}}catch{F({title:"Clock-in error",description:"Please try again",variant:"destructive"})}},z=async()=>{if(!c){F({title:"Not authenticated",description:"Login first",variant:"destructive"});return}try{let K=d;if(!K){const V=await hn(`/api/work-sessions/${encodeURIComponent(c)}/active`);V.ok&&(K=(await V.json()).id)}if(!K){F({title:"No active session",description:"You are not clocked in",variant:"destructive"});return}const X={endTime:new Date().toISOString(),status:"completed"};x&&g&&(X.endLatitude=x.toString(),X.endLongitude=g.toString());const ee=await hn(`/api/work-sessions/${K}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(ee.ok)F({title:"Clocked Out",description:`Session ended for ${c}`}),m(null),localStorage.removeItem("gps_timer_active"),localStorage.removeItem("gps_timer_start");else{const V=await ee.text();F({title:"Clock-out failed",description:V||"Unable to end session",variant:"destructive"})}}catch{F({title:"Clock-out error",description:"Please try again",variant:"destructive"})}},B=async()=>{await z(),localStorage.clear(),sessionStorage.clear(),l(!1),u(null),F({title:"Logged Out",description:"You have been logged out"})};return a.jsxs("div",{className:"min-h-screen bg-slate-800 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 opacity-90"}),a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(203, 213, 224, 0.15) 1px, transparent 0)",backgroundSize:"40px 40px"}}),a.jsx("div",{className:"relative w-full max-w-6xl mx-auto",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[a.jsx("div",{className:"text-left space-y-8",children:a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-600 to-yellow-600 rounded-xl flex items-center justify-center shadow-2xl",children:a.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold text-white",children:"Sculpt Projects"}),a.jsx("p",{className:"text-amber-400 font-medium",children:"GPS Time Tracking & Job Management"})]})]})})}),a.jsx("div",{className:"flex justify-center lg:justify-end",children:a.jsxs(_e,{className:"w-full max-w-md bg-slate-700 border-slate-600 shadow-2xl",children:[a.jsxs(et,{className:"text-center space-y-2 pb-6",children:[a.jsx(tt,{className:"text-2xl font-bold text-white",children:"Welcome Back"}),a.jsx(mn,{className:"text-slate-400 text-base",children:"Sign in to access your dashboard"})]}),a.jsx(Ae,{className:"space-y-6",children:o?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-slate-200",children:["Logged in as ",a.jsx("span",{className:"font-semibold",children:c})]}),a.jsxs("div",{className:"text-sm text-slate-300",children:["GPS Status: ",f,f==="Ready"&&x!==null&&g!==null&&a.jsxs("div",{className:"mt-1",children:["Lat: ",x.toFixed(5),", Lng: ",g.toFixed(5)," (",v==null?void 0:v.toFixed(0),"m)"]})]}),a.jsxs("div",{className:"text-sm text-slate-300",children:["Proximity: ",E,C&&a.jsxs("div",{className:"mt-1",children:["Nearest: ",C.location," (",C.jobTitle,")  ",C.distance,"m"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(je,{onClick:R,disabled:!N||f!=="Ready",className:"flex-1 bg-gradient-to-r from-amber-600 to-yellow-600 hover:from-amber-700 hover:to-yellow-700 text-white",children:"Clock In"}),a.jsx(je,{onClick:z,variant:"secondary",className:"flex-1",children:"Clock Out"})]}),a.jsx(je,{onClick:B,variant:"outline",className:"w-full",children:"Logout"})]}):a.jsxs("form",{onSubmit:M,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(xn,{htmlFor:"username",className:"text-slate-200 font-medium",children:"Username"}),a.jsx(qr,{id:"username",type:"text",value:e,onChange:K=>t(K.target.value),className:"bg-slate-800 border-slate-600 text-white placeholder:text-slate-400 focus:border-amber-500 focus:ring-amber-500 h-12",placeholder:"Enter username",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(xn,{htmlFor:"password",className:"text-slate-200 font-medium",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(qr,{id:"password",type:s?"text":"password",value:r,onChange:K=>n(K.target.value),className:"bg-slate-800 border-slate-600 text-white placeholder:text-slate-400 focus:border-amber-500 focus:ring-amber-500 h-12 pr-12",placeholder:"Enter password",required:!0}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-200 transition-colors",children:s?a.jsx(wk,{className:"h-5 w-5"}):a.jsx(bk,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{className:"text-sm text-slate-300",children:["GPS Status: ",f,f==="Ready"&&x!==null&&g!==null&&a.jsxs("div",{className:"mt-1",children:["Lat: ",x.toFixed(5),", Lng: ",g.toFixed(5)," (",v==null?void 0:v.toFixed(0),"m)"]})]}),a.jsx(je,{type:"submit",className:"w-full bg-gradient-to-r from-amber-600 to-yellow-600 hover:from-amber-700 hover:to-yellow-700 text-white font-medium h-12 text-base shadow-lg transition-all duration-200",children:"Sign In"})]})})]})})]})})]})}class kb{constructor(t,r){this.contractorName=t,this.assignmentId=r,this.storageKey=`task_progress_${r}`}async loadTaskProgress(){console.log(" Loading task progress...");const t=this.getFromLocalStorage();if(t.length>0)return console.log(" Found localStorage data, syncing with database..."),this.syncWithDatabase(t),t;try{const r=await fetch(`/api/task-progress/${encodeURIComponent(this.contractorName)}/${this.assignmentId}`);if(r.ok){const n=await r.json();if(n.length>0){console.log(` Restored ${n.length} tasks from database`);const s=this.convertDbToTaskFormat(n);return this.saveToLocalStorage(s),s}}}catch(r){console.error(" Database load failed:",r)}return[]}async saveTaskProgress(t){this.saveToLocalStorage(t),await this.syncWithDatabase(t)}async updateTaskCompletion(t,r){try{(await fetch("/api/task-progress/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:this.contractorName,assignmentId:this.assignmentId,taskId:t,completed:r})})).ok?console.log(` Task ${t} saved to database: ${r?"completed":"incomplete"}`):console.error(" Failed to save task to database")}catch(n){console.error(" Database save failed:",n)}}createTasksFromCSVData(t){const r=[];return t.forEach((n,s)=>{n.replace(/,+$/,"").trim().split(",").map(l=>l.trim()).filter(l=>l).forEach((l,c)=>{if(l&&l!==""){const u=`phase-${s}-item-${c}`;r.push({id:u,title:l,description:`${l} - Phase ${s+1}`,area:`Phase ${s+1}`,totalItems:1,completedItems:0,status:"not started",taskId:u,completed:!1})}})}),console.log(` Created ${r.length} tasks from authentic CSV data`),r}mergeProgressWithTasks(t,r){return t.map(n=>{const s=r.find(i=>i.id===n.id||i.title===n.title);return s?{...n,completedItems:s.completedItems,status:s.status,completed:s.completed}:n})}getFromLocalStorage(){try{const t=localStorage.getItem(this.storageKey);return t?JSON.parse(t):[]}catch(t){return console.error(" LocalStorage read failed:",t),[]}}saveToLocalStorage(t){try{localStorage.setItem(this.storageKey,JSON.stringify(t)),console.log(` Saved ${t.length} tasks to localStorage`)}catch(r){console.error(" LocalStorage save failed:",r)}}async syncWithDatabase(t){for(const r of t)r.taskId&&await this.updateTaskCompletion(r.taskId,r.status==="completed")}convertDbToTaskFormat(t){return t.map(r=>({id:r.taskId,title:r.taskDescription,description:`${r.taskDescription} - ${r.phase}`,area:r.phase,totalItems:1,completedItems:r.completed?1:0,status:r.completed?"completed":"not started",taskId:r.taskId,completed:r.completed}))}}function DA(){const{toast:e}=Tt(),t=localStorage.getItem("contractorName")||"Dalwayne Diedericks",r=t.split(" ")[0];console.log(" TaskProgress component loaded"),console.log(" contractorName from localStorage:",t),console.log(" contractorFirstName:",r);const{data:n=[],isLoading:s}=rt({queryKey:[`/api/contractor-assignments/${r}`]}),i=n[0],{data:o=[]}=rt({queryKey:[`/api/team-task-progress/${i==null?void 0:i.id}`],enabled:!!(i!=null&&i.id)}),[l,c]=b.useState(null);b.useEffect(()=>{if(i!=null&&i.id&&t){const S=new kb(t,i.id);c(S),console.log(" TaskProgressManager initialized for assignment:",i.id)}},[i==null?void 0:i.id,t]),console.log(" Task Progress Debug - contractorFirstName:",r),console.log(" Task Progress Debug - assignments:",n),console.log(" Task Progress Debug - activeAssignment:",i),console.log(" Task Progress Debug - isLoading:",s);const[u,d]=b.useState("Loading...");b.useEffect(()=>{i?(console.log(" Setting current project:",`${i.hbxlJob} - ${i.workLocation}`),d(`${i.hbxlJob} - ${i.workLocation}`)):(console.log(" No active assignment found"),d("No Active Assignment"))},[i]);const[m,f]=b.useState([]),p=S=>{console.log(` Checking teammate completion for taskId: ${S}`),console.log(" Team progress data:",o),console.log(` Current contractor: ${r}`);const C=o.find(j=>{const E=j.taskId===S,k=j.completed,F=j.completedByFirstName!==r;return console.log(` Task ${j.taskId}: matches=${E}, completed=${k}, different=${F}`),E&&k&&F});return console.log(" Found teammate completion:",C),C};b.useEffect(()=>{["task_progress_default","task_progress_DA17 5DB"].forEach(C=>localStorage.removeItem(C)),console.log(" Cleared stale task data")},[]),b.useEffect(()=>{if(console.log(" loadTasksFromCSV effect triggered"),console.log(" activeAssignment:",i),console.log(" buildPhases:",i==null?void 0:i.buildPhases),!i||!i.buildPhases){console.log(" No active assignment or build phases, skipping task loading");return}(async()=>{const C=`task_progress_${i.id}`,j=localStorage.getItem(C);let E=[];if(!j)try{console.log(" No localStorage found, checking database backup...");const F=await fetch(`/api/task-progress/${t}/${i.id}`);F.ok&&(E=await F.json(),console.log(` Found ${E.length} tasks in database backup`))}catch(F){console.log(" No database backup found:",F)}let k=[];try{const M=await(await fetch("/api/jobs")).json();console.log(" VERSION 1.3.4 RESTORATION - Looking for job:",i.hbxlJob),console.log(" Available jobs:",M.map(z=>z.title));const R=M.find(z=>{if(console.log(" Checking job:",z.title,"location:",z.location),z.title===i.hbxlJob)return console.log(" Direct title match found"),!0;if(z.location&&i.workLocation&&z.location.toLowerCase().includes(i.workLocation.toLowerCase()))return console.log(" Location-based match found"),!0;if(z.title&&i.hbxlJob){const B=z.title.toLowerCase().replace(/\s+/g,""),K=i.hbxlJob.toLowerCase().replace(/\s+/g,"");if(B.includes("flat")&&K.includes("flat"))return console.log(" Partial title match found"),!0}return!1});if(console.log(" Found matching job with phaseTaskData:",R==null?void 0:R.title),R&&R.phaseTaskData){let z=1,B={};try{typeof R.phaseTaskData=="string"?B=JSON.parse(R.phaseTaskData):B=R.phaseTaskData}catch(X){console.error(" Error parsing phaseTaskData:",X),B={}}const K=B.phases||{};console.log(" Parsed phases data:",Object.keys(K)),console.log(" Assignment build phases:",i.buildPhases),i.buildPhases.forEach(X=>{console.log(` Processing build phase: ${X}`),K[X]&&Array.isArray(K[X])?(console.log(` Found authentic data for phase ${X}:`,K[X].length,"tasks"),K[X].forEach((ee,V)=>{const te=parseInt(ee.quantity)||1,ue=ee.description||ee.task||`${X} Task`;console.log(` VERSION 1.3.4 Task ${V+1}:`,ue,"Qty:",te),k.push({id:`${X}-${z++}`,title:ue,description:ue,area:X,totalItems:te,completedItems:0,status:"not started"})})):(console.log(` No CSV data found for phase: ${X}`),k.push({id:`${X}-${z++}`,title:X,description:`Complete ${X} work`,area:X,totalItems:1,completedItems:0,status:"not started"}))}),console.log(" Total tasks created:",k.length)}else{let z=1;i.buildPhases.forEach(B=>{k.push({id:(z++).toString(),title:B,description:`Complete ${B} work`,area:B,totalItems:1,completedItems:0,status:"not started"})})}}catch(F){console.error("Failed to fetch CSV job data:",F);let M=1;i.buildPhases.forEach(R=>{k.push({id:(M++).toString(),title:R,description:`Complete ${R} work`,area:R,totalItems:1,completedItems:0,status:"not started"})})}if(j)try{const F=JSON.parse(j);k=k.map(M=>{const R=F.find(z=>z.id===M.id||z.title===M.title);return R?{...M,completedItems:R.completedItems,status:R.status}:M}),console.log(" Restored progress from localStorage")}catch(F){console.error("Failed to load saved progress:",F)}else if(E.length>0)try{k=k.map(M=>{const R=E.find(z=>z.taskId===M.id||z.taskDescription===M.title);if(R){const z=R.completed?1:0,B=R.completed?"completed":"not started";return console.log(` Restored task from database: ${M.title} - ${B}`),{...M,completedItems:z,status:B}}return M}),console.log(` Restored ${E.length} tasks from database backup`);const F=`task_progress_${i.id}`;localStorage.setItem(F,JSON.stringify(k))}catch(F){console.error("Failed to restore from database backup:",F)}f(k)})()},[i]),b.useEffect(()=>{if(m.length>0&&i&&l){const S=`task_progress_${i.id}`;localStorage.setItem(S,JSON.stringify(m)),l.saveTaskProgress(m).catch(C=>{console.error(" Failed to backup to database:",C)})}},[m,i,l]);const[x,h]=b.useState(!1),g=()=>m.reduce((S,C)=>S+C.completedItems,0),w=()=>m.reduce((S,C)=>S+C.totalItems,0),v=()=>{const S=w();return S>0?Math.round(g()/S*100):0},y=(S,C)=>{const j=m.map(F=>{if(F.id===S){const M=Math.max(0,Math.min(F.totalItems,F.completedItems+C)),R=M===0?"not started":M===F.totalItems?"completed":"in progress";return{...F,completedItems:M,status:R}}return F});f(j);const E=`task_progress_${(i==null?void 0:i.id)||"default"}`;if(localStorage.setItem(E,JSON.stringify(j)),i!=null&&i.id&&l){const F=j.find(M=>M.id===S);if(F){const M=F.status==="completed";l.updateTaskCompletion(F.taskId||F.id,M).then(()=>{console.log(` Task persisted: ${F.title} - ${M?"completed":"in progress"}`)}).catch(R=>{console.error(" Database persistence failed:",R)})}}const k=j.filter(F=>i==null?void 0:i.buildPhases.includes(F.area));if(i){const F=k.reduce((z,B)=>z+B.totalItems,0),M=k.reduce((z,B)=>z+B.completedItems,0),R=F>0?Math.round(M/F*100):0;console.log(` Task progress updated for ${i.hbxlJob}: ${R}%`),R>=50&&(console.log(` Triggering inspection check for ${R}% completion`),fetch(`/api/trigger-progress-check/${i.id}`,{method:"POST",headers:{"Content-Type":"application/json"}}).then(z=>{z.ok?console.log(` Progress monitoring triggered successfully for ${R}%`):console.error(` Progress monitoring failed: ${z.status}`)}).catch(z=>console.error(" Progress monitoring failed:",z)))}e({title:"Progress Updated",description:`Task progress ${C>0?"increased":"decreased"}`})},N=S=>{h(!1),e({title:S,description:`Opening ${S} interface...`})};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>h(!x),className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4 hover:bg-yellow-700 transition-colors",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"DD"})}),x&&a.jsxs("div",{className:"absolute right-0 top-10 w-64 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:[a.jsx("div",{className:"px-4 py-3 border-b border-slate-600",children:a.jsx("div",{className:"text-yellow-400 font-semibold",children:"Dalwayne Diedericks"})}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>N("Switch Account"),className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-user-circle mr-3 text-slate-400"}),"Switch Account"]}),a.jsxs("button",{onClick:()=>N("Report Issue"),className:"w-full px-4 py-2 text-left text-yellow-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-exclamation-triangle mr-3 text-yellow-400"}),"Report Issue"]}),a.jsxs("button",{onClick:()=>N("Documents"),className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-file-alt mr-3 text-slate-400"}),"Documents"]}),a.jsxs("button",{onClick:()=>N("Help & Support"),className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-question-circle mr-3 text-slate-400"}),"Help & Support"]}),a.jsx("div",{className:"border-t border-slate-600 mt-2 pt-2",children:a.jsxs("button",{onClick:()=>{localStorage.clear(),window.location.href="/login",window.location.reload()},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-sign-out-alt mr-3 text-red-400"}),"Sign Out & Switch Account"]})})]})]})]})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-yellow-400 mb-2",children:"Task Progress"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Project"}),a.jsx("div",{className:"text-white font-medium",children:u}),a.jsx("div",{className:"text-slate-400 text-sm mt-1",children:"Category"}),(i==null?void 0:i.specialInstructions)&&a.jsx("div",{className:"mt-3 bg-yellow-900/30 border border-yellow-700 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("i",{className:"fas fa-sticky-note text-yellow-400 mr-2 mt-0.5"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-yellow-400 font-medium text-sm mb-1",children:"Admin Notes:"}),a.jsx("div",{className:"text-white text-sm",children:i.specialInstructions})]})]})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Overall Progress"}),a.jsxs(De,{variant:"outline",className:"border-yellow-600 text-yellow-400",children:[g()," of ",w()," completed"]})]}),a.jsx("div",{className:"w-full bg-slate-700 rounded-full h-3 mb-2",children:a.jsx("div",{className:"bg-yellow-500 h-3 rounded-full transition-all duration-300",style:{width:`${v()}%`}})}),a.jsxs("div",{className:"text-slate-400 text-sm",children:[v(),"% complete"]})]}),a.jsx("div",{className:"space-y-6",children:Object.entries(m.reduce((S,C)=>{const j=C.area;return S[j]||(S[j]=[]),S[j].push(C),S},{})).map(([S,C])=>a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-amber-600 text-slate-900 font-bold px-4 py-2 rounded-lg",children:a.jsx("h3",{className:"text-lg",children:S})}),C.map(j=>{const E=p(j.id);return a.jsxs("div",{className:`bg-slate-800 rounded-lg p-4 border ml-4 ${E?"border-green-500 bg-green-900/20":"border-slate-700"}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-4 h-4 border-2 rounded-full mr-3 mt-1 ${E?"border-green-500 bg-green-500":"border-slate-500"}`,children:E&&a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx("i",{className:"fas fa-check text-white text-xs"})})}),a.jsxs("div",{children:[a.jsx("h4",{className:`font-semibold ${E?"text-green-400":"text-yellow-400"}`,children:j.title}),E&&a.jsxs("div",{className:"text-green-400 text-xs mt-1",children:[" Completed by ",E.completedByFirstName]})]})]}),a.jsx(De,{variant:"outline",className:`${E?"border-green-500 text-green-400":"border-slate-500 text-slate-400"}`,children:E?"Done by teammate":j.status})]}),a.jsx("p",{className:"text-slate-300 text-sm mb-3",children:j.description}),!E&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-orange-400 text-sm mb-4",children:[" ",j.totalItems," items left to complete"]}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("button",{onClick:()=>y(j.id,-1),disabled:j.completedItems<=0,className:"w-8 h-8 bg-slate-700 rounded-full flex items-center justify-center text-white hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-white",children:[j.completedItems," / ",j.totalItems]}),a.jsx("div",{className:"text-slate-400 text-sm",children:"completed"}),a.jsxs("div",{className:"text-orange-400 text-sm",children:[j.totalItems-j.completedItems," remaining"]})]}),a.jsx("button",{onClick:()=>y(j.id,1),disabled:j.completedItems>=j.totalItems,className:"w-8 h-8 bg-slate-700 rounded-full flex items-center justify-center text-yellow-400 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"+"}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"text-2xl font-bold text-white",children:[j.totalItems>0?Math.round(j.completedItems/j.totalItems*100):0,"%"]})})]}),a.jsx(je,{variant:"outline",className:"w-full border-yellow-600 text-yellow-400 hover:bg-yellow-600 hover:text-black",children:"Show Details"})]}),E&&a.jsxs("div",{className:"text-center py-4",children:[a.jsx("div",{className:"text-green-400 font-medium",children:"This task has been completed by your teammate"}),a.jsx("div",{className:"text-slate-400 text-sm mt-1",children:"No further action needed"})]})]},j.id)})]},S))})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"flex justify-around py-2",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"flex flex-col items-center py-2 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-home text-xl mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"flex flex-col items-center py-2 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-briefcase text-xl mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"flex flex-col items-center py-2 px-4 text-slate-400",children:[a.jsx("i",{className:"fas fa-ellipsis-h text-xl mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]})})]})}function Bg(e,[t,r]){return Math.min(r,Math.max(t,e))}var W0=0;function OA(){b.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Ug()),document.body.insertAdjacentElement("beforeend",e[1]??Ug()),W0++,()=>{W0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),W0--}},[])}function Ug(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var H0="focusScope.autoFocusOnMount",V0="focusScope.autoFocusOnUnmount",$g={bubbles:!1,cancelable:!0},LA="FocusScope",_b=b.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[l,c]=b.useState(null),u=Cr(s),d=Cr(i),m=b.useRef(null),f=ut(t,h=>c(h)),p=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(n){let h=function(y){if(p.paused||!l)return;const N=y.target;l.contains(N)?m.current=N:Ss(m.current,{select:!0})},g=function(y){if(p.paused||!l)return;const N=y.relatedTarget;N!==null&&(l.contains(N)||Ss(m.current,{select:!0}))},w=function(y){if(document.activeElement===document.body)for(const S of y)S.removedNodes.length>0&&Ss(l)};document.addEventListener("focusin",h),document.addEventListener("focusout",g);const v=new MutationObserver(w);return l&&v.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",g),v.disconnect()}}},[n,l,p.paused]),b.useEffect(()=>{if(l){Hg.add(p);const h=document.activeElement;if(!l.contains(h)){const w=new CustomEvent(H0,$g);l.addEventListener(H0,u),l.dispatchEvent(w),w.defaultPrevented||(MA(HA(Ab(l)),{select:!0}),document.activeElement===h&&Ss(l))}return()=>{l.removeEventListener(H0,u),setTimeout(()=>{const w=new CustomEvent(V0,$g);l.addEventListener(V0,d),l.dispatchEvent(w),w.defaultPrevented||Ss(h??document.body,{select:!0}),l.removeEventListener(V0,d),Hg.remove(p)},0)}}},[l,u,d,p]);const x=b.useCallback(h=>{if(!r&&!n||p.paused)return;const g=h.key==="Tab"&&!h.altKey&&!h.ctrlKey&&!h.metaKey,w=document.activeElement;if(g&&w){const v=h.currentTarget,[y,N]=BA(v);y&&N?!h.shiftKey&&w===N?(h.preventDefault(),r&&Ss(y,{select:!0})):h.shiftKey&&w===y&&(h.preventDefault(),r&&Ss(N,{select:!0})):w===v&&h.preventDefault()}},[r,n,p.paused]);return a.jsx(Me.div,{tabIndex:-1,...o,ref:f,onKeyDown:x})});_b.displayName=LA;function MA(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ss(n,{select:t}),document.activeElement!==r)return}function BA(e){const t=Ab(e),r=Wg(t,e),n=Wg(t.reverse(),e);return[r,n]}function Ab(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Wg(e,t){for(const r of e)if(!UA(r,{upTo:t}))return r}function UA(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function $A(e){return e instanceof HTMLInputElement&&"select"in e}function Ss(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&$A(e)&&t&&e.select()}}var Hg=WA();function WA(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=Vg(e,t),e.unshift(t)},remove(t){var r;e=Vg(e,t),(r=e[0])==null||r.resume()}}}function Vg(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function HA(e){return e.filter(t=>t.tagName!=="A")}function Pb(e){const t=b.useRef({value:e,previous:e});return b.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var VA=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ti=new WeakMap,Ic=new WeakMap,Dc={},z0=0,Fb=function(e){return e&&(e.host||Fb(e.parentNode))},zA=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=Fb(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},GA=function(e,t,r,n){var s=zA(t,Array.isArray(e)?e:[e]);Dc[r]||(Dc[r]=new WeakMap);var i=Dc[r],o=[],l=new Set,c=new Set(s),u=function(m){!m||l.has(m)||(l.add(m),u(m.parentNode))};s.forEach(u);var d=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(f){if(l.has(f))d(f);else try{var p=f.getAttribute(n),x=p!==null&&p!=="false",h=(ti.get(f)||0)+1,g=(i.get(f)||0)+1;ti.set(f,h),i.set(f,g),o.push(f),h===1&&x&&Ic.set(f,!0),g===1&&f.setAttribute(r,"true"),x||f.setAttribute(n,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return d(t),l.clear(),z0++,function(){o.forEach(function(m){var f=ti.get(m)-1,p=i.get(m)-1;ti.set(m,f),i.set(m,p),f||(Ic.has(m)||m.removeAttribute(n),Ic.delete(m)),p||m.removeAttribute(r)}),z0--,z0||(ti=new WeakMap,ti=new WeakMap,Ic=new WeakMap,Dc={})}},KA=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=VA(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),GA(n,s,r,"aria-hidden")):function(){return null}},In=function(){return In=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},In.apply(this,arguments)};function Rb(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function YA(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var uu="right-scroll-bar-position",du="width-before-scroll-bar",XA="with-scroll-bars-hidden",qA="--removed-body-scroll-bar-size";function G0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function QA(e,t){var r=b.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var JA=typeof window<"u"?b.useLayoutEffect:b.useEffect,zg=new WeakMap;function ZA(e,t){var r=QA(null,function(n){return e.forEach(function(s){return G0(s,n)})});return JA(function(){var n=zg.get(r);if(n){var s=new Set(n),i=new Set(e),o=r.current;s.forEach(function(l){i.has(l)||G0(l,null)}),i.forEach(function(l){s.has(l)||G0(l,o)})}zg.set(r,e)},[e]),r}function eP(e){return e}function tP(e,t){t===void 0&&(t=eP);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),r}}}};return s}function rP(e){e===void 0&&(e={});var t=tP(null);return t.options=In({async:!0,ssr:!1},e),t}var Ib=function(e){var t=e.sideCar,r=Rb(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return b.createElement(n,In({},r))};Ib.isSideCarExport=!0;function nP(e,t){return e.useMedium(t),Ib}var Db=rP(),K0=function(){},Bd=b.forwardRef(function(e,t){var r=b.useRef(null),n=b.useState({onScrollCapture:K0,onWheelCapture:K0,onTouchMoveCapture:K0}),s=n[0],i=n[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,m=e.shards,f=e.sideCar,p=e.noIsolation,x=e.inert,h=e.allowPinchZoom,g=e.as,w=g===void 0?"div":g,v=e.gapMode,y=Rb(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=f,S=ZA([r,t]),C=In(In({},y),s);return b.createElement(b.Fragment,null,d&&b.createElement(N,{sideCar:Db,removeScrollBar:u,shards:m,noIsolation:p,inert:x,setCallbacks:i,allowPinchZoom:!!h,lockRef:r,gapMode:v}),o?b.cloneElement(b.Children.only(l),In(In({},C),{ref:S})):b.createElement(w,In({},C,{className:c,ref:S}),l))});Bd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Bd.classNames={fullWidth:du,zeroRight:uu};var sP=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function aP(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=sP();return t&&e.setAttribute("nonce",t),e}function iP(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function oP(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var lP=function(){var e=0,t=null;return{add:function(r){e==0&&(t=aP())&&(iP(t,r),oP(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},cP=function(){var e=lP();return function(t,r){b.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Ob=function(){var e=cP(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},uP={left:0,top:0,right:0,gap:0},Y0=function(e){return parseInt(e||"",10)||0},dP=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Y0(r),Y0(n),Y0(s)]},fP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return uP;var t=dP(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},hP=Ob(),Ri="data-scroll-locked",mP=function(e,t,r,n){var s=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(XA,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Ri,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(uu,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(du,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(uu," .").concat(uu,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(du," .").concat(du,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Ri,`] {
    `).concat(qA,": ").concat(l,`px;
  }
`)},Gg=function(){var e=parseInt(document.body.getAttribute(Ri)||"0",10);return isFinite(e)?e:0},xP=function(){b.useEffect(function(){return document.body.setAttribute(Ri,(Gg()+1).toString()),function(){var e=Gg()-1;e<=0?document.body.removeAttribute(Ri):document.body.setAttribute(Ri,e.toString())}},[])},pP=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;xP();var i=b.useMemo(function(){return fP(s)},[s]);return b.createElement(hP,{styles:mP(i,!t,s,r?"":"!important")})},Ch=!1;if(typeof window<"u")try{var Oc=Object.defineProperty({},"passive",{get:function(){return Ch=!0,!0}});window.addEventListener("test",Oc,Oc),window.removeEventListener("test",Oc,Oc)}catch{Ch=!1}var ri=Ch?{passive:!1}:!1,gP=function(e){return e.tagName==="TEXTAREA"},Lb=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!gP(e)&&r[t]==="visible")},vP=function(e){return Lb(e,"overflowY")},yP=function(e){return Lb(e,"overflowX")},Kg=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=Mb(e,n);if(s){var i=Bb(e,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},wP=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},bP=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Mb=function(e,t){return e==="v"?vP(t):yP(t)},Bb=function(e,t){return e==="v"?wP(t):bP(t)},NP=function(e,t){return e==="h"&&t==="rtl"?-1:1},SP=function(e,t,r,n,s){var i=NP(e,window.getComputedStyle(t).direction),o=i*n,l=r.target,c=t.contains(l),u=!1,d=o>0,m=0,f=0;do{var p=Bb(e,l),x=p[0],h=p[1],g=p[2],w=h-g-i*x;(x||w)&&Mb(e,l)&&(m+=w,f+=x),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&(Math.abs(m)<1||!s)||!d&&(Math.abs(f)<1||!s))&&(u=!0),u},Lc=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Yg=function(e){return[e.deltaX,e.deltaY]},Xg=function(e){return e&&"current"in e?e.current:e},jP=function(e,t){return e[0]===t[0]&&e[1]===t[1]},TP=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},EP=0,ni=[];function CP(e){var t=b.useRef([]),r=b.useRef([0,0]),n=b.useRef(),s=b.useState(EP++)[0],i=b.useState(Ob)[0],o=b.useRef(e);b.useEffect(function(){o.current=e},[e]),b.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var h=YA([e.lockRef.current],(e.shards||[]).map(Xg),!0).filter(Boolean);return h.forEach(function(g){return g.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),h.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=b.useCallback(function(h,g){if("touches"in h&&h.touches.length===2||h.type==="wheel"&&h.ctrlKey)return!o.current.allowPinchZoom;var w=Lc(h),v=r.current,y="deltaX"in h?h.deltaX:v[0]-w[0],N="deltaY"in h?h.deltaY:v[1]-w[1],S,C=h.target,j=Math.abs(y)>Math.abs(N)?"h":"v";if("touches"in h&&j==="h"&&C.type==="range")return!1;var E=Kg(j,C);if(!E)return!0;if(E?S=j:(S=j==="v"?"h":"v",E=Kg(j,C)),!E)return!1;if(!n.current&&"changedTouches"in h&&(y||N)&&(n.current=S),!S)return!0;var k=n.current||S;return SP(k,g,h,k==="h"?y:N,!0)},[]),c=b.useCallback(function(h){var g=h;if(!(!ni.length||ni[ni.length-1]!==i)){var w="deltaY"in g?Yg(g):Lc(g),v=t.current.filter(function(S){return S.name===g.type&&(S.target===g.target||g.target===S.shadowParent)&&jP(S.delta,w)})[0];if(v&&v.should){g.cancelable&&g.preventDefault();return}if(!v){var y=(o.current.shards||[]).map(Xg).filter(Boolean).filter(function(S){return S.contains(g.target)}),N=y.length>0?l(g,y[0]):!o.current.noIsolation;N&&g.cancelable&&g.preventDefault()}}},[]),u=b.useCallback(function(h,g,w,v){var y={name:h,delta:g,target:w,should:v,shadowParent:kP(w)};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(N){return N!==y})},1)},[]),d=b.useCallback(function(h){r.current=Lc(h),n.current=void 0},[]),m=b.useCallback(function(h){u(h.type,Yg(h),h.target,l(h,e.lockRef.current))},[]),f=b.useCallback(function(h){u(h.type,Lc(h),h.target,l(h,e.lockRef.current))},[]);b.useEffect(function(){return ni.push(i),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:f}),document.addEventListener("wheel",c,ri),document.addEventListener("touchmove",c,ri),document.addEventListener("touchstart",d,ri),function(){ni=ni.filter(function(h){return h!==i}),document.removeEventListener("wheel",c,ri),document.removeEventListener("touchmove",c,ri),document.removeEventListener("touchstart",d,ri)}},[]);var p=e.removeScrollBar,x=e.inert;return b.createElement(b.Fragment,null,x?b.createElement(i,{styles:TP(s)}):null,p?b.createElement(pP,{gapMode:e.gapMode}):null)}function kP(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const _P=nP(Db,CP);var Ub=b.forwardRef(function(e,t){return b.createElement(Bd,In({},e,{ref:t,sideCar:_P}))});Ub.classNames=Bd.classNames;var AP=[" ","Enter","ArrowUp","ArrowDown"],PP=[" ","Enter"],rc="Select",[Ud,$d,FP]=Mm(rc),[bo,v7]=la(rc,[FP,Dd]),Wd=Dd(),[RP,ca]=bo(rc),[IP,DP]=bo(rc),$b=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:m,disabled:f,required:p,form:x}=e,h=Wd(t),[g,w]=b.useState(null),[v,y]=b.useState(null),[N,S]=b.useState(!1),C=rx(u),[j=!1,E]=oo({prop:n,defaultProp:s,onChange:i}),[k,F]=oo({prop:o,defaultProp:l,onChange:c}),M=b.useRef(null),R=g?x||!!g.closest("form"):!0,[z,B]=b.useState(new Set),K=Array.from(z).map(X=>X.props.value).join(";");return a.jsx(x3,{...h,children:a.jsxs(RP,{required:p,scope:t,trigger:g,onTriggerChange:w,valueNode:v,onValueNodeChange:y,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:Zl(),value:k,onValueChange:F,open:j,onOpenChange:E,dir:C,triggerPointerDownPosRef:M,disabled:f,children:[a.jsx(Ud.Provider,{scope:t,children:a.jsx(IP,{scope:e.__scopeSelect,onNativeOptionAdd:b.useCallback(X=>{B(ee=>new Set(ee).add(X))},[]),onNativeOptionRemove:b.useCallback(X=>{B(ee=>{const V=new Set(ee);return V.delete(X),V})},[]),children:r})}),R?a.jsxs(fN,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:m,value:k,onChange:X=>F(X.target.value),disabled:f,form:x,children:[k===void 0?a.jsx("option",{value:""}):null,Array.from(z)]},K):null]})})};$b.displayName=rc;var Wb="SelectTrigger",Hb=b.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,i=Wd(r),o=ca(Wb,r),l=o.disabled||n,c=ut(t,o.onTriggerChange),u=$d(r),d=b.useRef("touch"),[m,f,p]=hN(h=>{const g=u().filter(y=>!y.disabled),w=g.find(y=>y.value===o.value),v=mN(g,h,w);v!==void 0&&o.onValueChange(v.value)}),x=h=>{l||(o.onOpenChange(!0),p()),h&&(o.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return a.jsx(G2,{asChild:!0,...i,children:a.jsx(Me.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":dN(o.value)?"":void 0,...s,ref:c,onClick:Ce(s.onClick,h=>{h.currentTarget.focus(),d.current!=="mouse"&&x(h)}),onPointerDown:Ce(s.onPointerDown,h=>{d.current=h.pointerType;const g=h.target;g.hasPointerCapture(h.pointerId)&&g.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(x(h),h.preventDefault())}),onKeyDown:Ce(s.onKeyDown,h=>{const g=m.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&f(h.key),!(g&&h.key===" ")&&AP.includes(h.key)&&(x(),h.preventDefault())})})})});Hb.displayName=Wb;var Vb="SelectValue",zb=b.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:i,placeholder:o="",...l}=e,c=ca(Vb,r),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,m=ut(t,c.onValueNodeChange);return ar(()=>{u(d)},[u,d]),a.jsx(Me.span,{...l,ref:m,style:{pointerEvents:"none"},children:dN(c.value)?a.jsx(a.Fragment,{children:o}):i})});zb.displayName=Vb;var OP="SelectIcon",Gb=b.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return a.jsx(Me.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});Gb.displayName=OP;var LP="SelectPortal",Kb=e=>a.jsx(Bm,{asChild:!0,...e});Kb.displayName=LP;var $a="SelectContent",Yb=b.forwardRef((e,t)=>{const r=ca($a,e.__scopeSelect),[n,s]=b.useState();if(ar(()=>{s(new DocumentFragment)},[]),!r.open){const i=n;return i?Ka.createPortal(a.jsx(Xb,{scope:e.__scopeSelect,children:a.jsx(Ud.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),i):null}return a.jsx(qb,{...e,ref:t})});Yb.displayName=$a;var on=10,[Xb,ua]=bo($a),MP="SelectContentImpl",BP=_l("SelectContent.RemoveScroll"),qb=b.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:m,collisionBoundary:f,collisionPadding:p,sticky:x,hideWhenDetached:h,avoidCollisions:g,...w}=e,v=ca($a,r),[y,N]=b.useState(null),[S,C]=b.useState(null),j=ut(t,Y=>N(Y)),[E,k]=b.useState(null),[F,M]=b.useState(null),R=$d(r),[z,B]=b.useState(!1),K=b.useRef(!1);b.useEffect(()=>{if(y)return KA(y)},[y]),OA();const X=b.useCallback(Y=>{const[ae,...oe]=R().map(pe=>pe.ref.current),[se]=oe.slice(-1),we=document.activeElement;for(const pe of Y)if(pe===we||(pe==null||pe.scrollIntoView({block:"nearest"}),pe===ae&&S&&(S.scrollTop=0),pe===se&&S&&(S.scrollTop=S.scrollHeight),pe==null||pe.focus(),document.activeElement!==we))return},[R,S]),ee=b.useCallback(()=>X([E,y]),[X,E,y]);b.useEffect(()=>{z&&ee()},[z,ee]);const{onOpenChange:V,triggerPointerDownPosRef:te}=v;b.useEffect(()=>{if(y){let Y={x:0,y:0};const ae=se=>{var we,pe;Y={x:Math.abs(Math.round(se.pageX)-(((we=te.current)==null?void 0:we.x)??0)),y:Math.abs(Math.round(se.pageY)-(((pe=te.current)==null?void 0:pe.y)??0))}},oe=se=>{Y.x<=10&&Y.y<=10?se.preventDefault():y.contains(se.target)||V(!1),document.removeEventListener("pointermove",ae),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",ae),document.addEventListener("pointerup",oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ae),document.removeEventListener("pointerup",oe,{capture:!0})}}},[y,V,te]),b.useEffect(()=>{const Y=()=>V(!1);return window.addEventListener("blur",Y),window.addEventListener("resize",Y),()=>{window.removeEventListener("blur",Y),window.removeEventListener("resize",Y)}},[V]);const[ue,xe]=hN(Y=>{const ae=R().filter(we=>!we.disabled),oe=ae.find(we=>we.ref.current===document.activeElement),se=mN(ae,Y,oe);se&&setTimeout(()=>se.ref.current.focus())}),L=b.useCallback((Y,ae,oe)=>{const se=!K.current&&!oe;(v.value!==void 0&&v.value===ae||se)&&(k(Y),se&&(K.current=!0))},[v.value]),G=b.useCallback(()=>y==null?void 0:y.focus(),[y]),U=b.useCallback((Y,ae,oe)=>{const se=!K.current&&!oe;(v.value!==void 0&&v.value===ae||se)&&M(Y)},[v.value]),A=n==="popper"?kh:Qb,H=A===kh?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:m,collisionBoundary:f,collisionPadding:p,sticky:x,hideWhenDetached:h,avoidCollisions:g}:{};return a.jsx(Xb,{scope:r,content:y,viewport:S,onViewportChange:C,itemRefCallback:L,selectedItem:E,onItemLeave:G,itemTextRefCallback:U,focusSelectedItem:ee,selectedItemText:F,position:n,isPositioned:z,searchRef:ue,children:a.jsx(Ub,{as:BP,allowPinchZoom:!0,children:a.jsx(_b,{asChild:!0,trapped:v.open,onMountAutoFocus:Y=>{Y.preventDefault()},onUnmountAutoFocus:Ce(s,Y=>{var ae;(ae=v.trigger)==null||ae.focus({preventScroll:!0}),Y.preventDefault()}),children:a.jsx(Ed,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Y=>Y.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:a.jsx(A,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:Y=>Y.preventDefault(),...w,...H,onPlaced:()=>B(!0),ref:j,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Ce(w.onKeyDown,Y=>{const ae=Y.ctrlKey||Y.altKey||Y.metaKey;if(Y.key==="Tab"&&Y.preventDefault(),!ae&&Y.key.length===1&&xe(Y.key),["ArrowUp","ArrowDown","Home","End"].includes(Y.key)){let se=R().filter(we=>!we.disabled).map(we=>we.ref.current);if(["ArrowUp","End"].includes(Y.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(Y.key)){const we=Y.target,pe=se.indexOf(we);se=se.slice(pe+1)}setTimeout(()=>X(se)),Y.preventDefault()}})})})})})})});qb.displayName=MP;var UP="SelectItemAlignedPosition",Qb=b.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,i=ca($a,r),o=ua($a,r),[l,c]=b.useState(null),[u,d]=b.useState(null),m=ut(t,j=>d(j)),f=$d(r),p=b.useRef(!1),x=b.useRef(!0),{viewport:h,selectedItem:g,selectedItemText:w,focusSelectedItem:v}=o,y=b.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&h&&g&&w){const j=i.trigger.getBoundingClientRect(),E=u.getBoundingClientRect(),k=i.valueNode.getBoundingClientRect(),F=w.getBoundingClientRect();if(i.dir!=="rtl"){const we=F.left-E.left,pe=k.left-we,Fe=j.left-pe,Ee=j.width+Fe,Pt=Math.max(Ee,E.width),ze=window.innerWidth-on,ge=Bg(pe,[on,Math.max(on,ze-Pt)]);l.style.minWidth=Ee+"px",l.style.left=ge+"px"}else{const we=E.right-F.right,pe=window.innerWidth-k.right-we,Fe=window.innerWidth-j.right-pe,Ee=j.width+Fe,Pt=Math.max(Ee,E.width),ze=window.innerWidth-on,ge=Bg(pe,[on,Math.max(on,ze-Pt)]);l.style.minWidth=Ee+"px",l.style.right=ge+"px"}const M=f(),R=window.innerHeight-on*2,z=h.scrollHeight,B=window.getComputedStyle(u),K=parseInt(B.borderTopWidth,10),X=parseInt(B.paddingTop,10),ee=parseInt(B.borderBottomWidth,10),V=parseInt(B.paddingBottom,10),te=K+X+z+V+ee,ue=Math.min(g.offsetHeight*5,te),xe=window.getComputedStyle(h),L=parseInt(xe.paddingTop,10),G=parseInt(xe.paddingBottom,10),U=j.top+j.height/2-on,A=R-U,H=g.offsetHeight/2,Y=g.offsetTop+H,ae=K+X+Y,oe=te-ae;if(ae<=U){const we=M.length>0&&g===M[M.length-1].ref.current;l.style.bottom="0px";const pe=u.clientHeight-h.offsetTop-h.offsetHeight,Fe=Math.max(A,H+(we?G:0)+pe+ee),Ee=ae+Fe;l.style.height=Ee+"px"}else{const we=M.length>0&&g===M[0].ref.current;l.style.top="0px";const Fe=Math.max(U,K+h.offsetTop+(we?L:0)+H)+oe;l.style.height=Fe+"px",h.scrollTop=ae-U+h.offsetTop}l.style.margin=`${on}px 0`,l.style.minHeight=ue+"px",l.style.maxHeight=R+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[f,i.trigger,i.valueNode,l,u,h,g,w,i.dir,n]);ar(()=>y(),[y]);const[N,S]=b.useState();ar(()=>{u&&S(window.getComputedStyle(u).zIndex)},[u]);const C=b.useCallback(j=>{j&&x.current===!0&&(y(),v==null||v(),x.current=!1)},[y,v]);return a.jsx(WP,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:C,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:a.jsx(Me.div,{...s,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Qb.displayName=UP;var $P="SelectPopperPosition",kh=b.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=on,...i}=e,o=Wd(r);return a.jsx(K2,{...o,...i,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});kh.displayName=$P;var[WP,ax]=bo($a,{}),_h="SelectViewport",Jb=b.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,i=ua(_h,r),o=ax(_h,r),l=ut(t,i.onViewportChange),c=b.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(Ud.Slot,{scope:r,children:a.jsx(Me.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Ce(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&m){const p=Math.abs(c.current-d.scrollTop);if(p>0){const x=window.innerHeight-on*2,h=parseFloat(m.style.minHeight),g=parseFloat(m.style.height),w=Math.max(h,g);if(w<x){const v=w+p,y=Math.min(x,v),N=v-y;m.style.height=y+"px",m.style.bottom==="0px"&&(d.scrollTop=N>0?N:0,m.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});Jb.displayName=_h;var Zb="SelectGroup",[HP,VP]=bo(Zb),zP=b.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Zl();return a.jsx(HP,{scope:r,id:s,children:a.jsx(Me.div,{role:"group","aria-labelledby":s,...n,ref:t})})});zP.displayName=Zb;var eN="SelectLabel",tN=b.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=VP(eN,r);return a.jsx(Me.div,{id:s.id,...n,ref:t})});tN.displayName=eN;var zu="SelectItem",[GP,rN]=bo(zu),nN=b.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:i,...o}=e,l=ca(zu,r),c=ua(zu,r),u=l.value===n,[d,m]=b.useState(i??""),[f,p]=b.useState(!1),x=ut(t,v=>{var y;return(y=c.itemRefCallback)==null?void 0:y.call(c,v,n,s)}),h=Zl(),g=b.useRef("touch"),w=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(GP,{scope:r,value:n,disabled:s,textId:h,isSelected:u,onItemTextChange:b.useCallback(v=>{m(y=>y||((v==null?void 0:v.textContent)??"").trim())},[]),children:a.jsx(Ud.ItemSlot,{scope:r,value:n,disabled:s,textValue:d,children:a.jsx(Me.div,{role:"option","aria-labelledby":h,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:x,onFocus:Ce(o.onFocus,()=>p(!0)),onBlur:Ce(o.onBlur,()=>p(!1)),onClick:Ce(o.onClick,()=>{g.current!=="mouse"&&w()}),onPointerUp:Ce(o.onPointerUp,()=>{g.current==="mouse"&&w()}),onPointerDown:Ce(o.onPointerDown,v=>{g.current=v.pointerType}),onPointerMove:Ce(o.onPointerMove,v=>{var y;g.current=v.pointerType,s?(y=c.onItemLeave)==null||y.call(c):g.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ce(o.onPointerLeave,v=>{var y;v.currentTarget===document.activeElement&&((y=c.onItemLeave)==null||y.call(c))}),onKeyDown:Ce(o.onKeyDown,v=>{var N;((N=c.searchRef)==null?void 0:N.current)!==""&&v.key===" "||(PP.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});nN.displayName=zu;var Ko="SelectItemText",sN=b.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...i}=e,o=ca(Ko,r),l=ua(Ko,r),c=rN(Ko,r),u=DP(Ko,r),[d,m]=b.useState(null),f=ut(t,w=>m(w),c.onItemTextChange,w=>{var v;return(v=l.itemTextRefCallback)==null?void 0:v.call(l,w,c.value,c.disabled)}),p=d==null?void 0:d.textContent,x=b.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:h,onNativeOptionRemove:g}=u;return ar(()=>(h(x),()=>g(x)),[h,g,x]),a.jsxs(a.Fragment,{children:[a.jsx(Me.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ka.createPortal(i.children,o.valueNode):null]})});sN.displayName=Ko;var aN="SelectItemIndicator",iN=b.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return rN(aN,r).isSelected?a.jsx(Me.span,{"aria-hidden":!0,...n,ref:t}):null});iN.displayName=aN;var Ah="SelectScrollUpButton",oN=b.forwardRef((e,t)=>{const r=ua(Ah,e.__scopeSelect),n=ax(Ah,e.__scopeSelect),[s,i]=b.useState(!1),o=ut(t,n.onScrollButtonChange);return ar(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollTop>0;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(cN,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});oN.displayName=Ah;var Ph="SelectScrollDownButton",lN=b.forwardRef((e,t)=>{const r=ua(Ph,e.__scopeSelect),n=ax(Ph,e.__scopeSelect),[s,i]=b.useState(!1),o=ut(t,n.onScrollButtonChange);return ar(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(cN,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});lN.displayName=Ph;var cN=b.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,i=ua("SelectScrollButton",r),o=b.useRef(null),l=$d(r),c=b.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return b.useEffect(()=>()=>c(),[c]),ar(()=>{var d;const u=l().find(m=>m.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),a.jsx(Me.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Ce(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Ce(s.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Ce(s.onPointerLeave,()=>{c()})})}),KP="SelectSeparator",uN=b.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return a.jsx(Me.div,{"aria-hidden":!0,...n,ref:t})});uN.displayName=KP;var Fh="SelectArrow",YP=b.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Wd(r),i=ca(Fh,r),o=ua(Fh,r);return i.open&&o.position==="popper"?a.jsx(Y2,{...s,...n,ref:t}):null});YP.displayName=Fh;function dN(e){return e===""||e===void 0}var fN=b.forwardRef((e,t)=>{const{value:r,...n}=e,s=b.useRef(null),i=ut(t,s),o=Pb(r);return b.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&d){const m=new Event("change",{bubbles:!0});d.call(l,r),l.dispatchEvent(m)}},[o,r]),a.jsx(Jl,{asChild:!0,children:a.jsx("select",{...n,ref:i,defaultValue:r})})});fN.displayName="BubbleSelect";function hN(e){const t=Cr(e),r=b.useRef(""),n=b.useRef(0),s=b.useCallback(o=>{const l=r.current+o;t(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=b.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return b.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,i]}function mN(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=XP(e,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function XP(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var qP=$b,xN=Hb,QP=zb,JP=Gb,ZP=Kb,pN=Yb,eF=Jb,gN=tN,vN=nN,tF=sN,rF=iN,yN=oN,wN=lN,bN=uN;const Gu=qP,Ku=QP,Rl=b.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(xN,{ref:n,className:He("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,a.jsx(JP,{asChild:!0,children:a.jsx(d2,{className:"h-4 w-4 opacity-50"})})]}));Rl.displayName=xN.displayName;const NN=b.forwardRef(({className:e,...t},r)=>a.jsx(yN,{ref:r,className:He("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(gk,{className:"h-4 w-4"})}));NN.displayName=yN.displayName;const SN=b.forwardRef(({className:e,...t},r)=>a.jsx(wN,{ref:r,className:He("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(d2,{className:"h-4 w-4"})}));SN.displayName=wN.displayName;const Il=b.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>a.jsx(ZP,{children:a.jsxs(pN,{ref:s,className:He("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[a.jsx(NN,{}),a.jsx(eF,{className:He("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(SN,{})]})}));Il.displayName=pN.displayName;const nF=b.forwardRef(({className:e,...t},r)=>a.jsx(gN,{ref:r,className:He("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));nF.displayName=gN.displayName;const Ii=b.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(vN,{ref:n,className:He("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(rF,{children:a.jsx(pk,{className:"h-4 w-4"})})}),a.jsx(tF,{children:t})]}));Ii.displayName=vN.displayName;const sF=b.forwardRef(({className:e,...t},r)=>a.jsx(bN,{ref:r,className:He("-mx-1 my-1 h-px bg-muted",e),...t}));sF.displayName=bN.displayName;function aF(){const[e,t]=b.useState(!1),r=()=>{const S=new Date,C=S.getDay(),j=C<=5?5-C:7-C+5;return new Date(S.getTime()+j*24*60*60*1e3).toISOString().split("T")[0]},[n,s]=b.useState(r()),{toast:i}=Tt(),o=()=>{const S=[],C=new Date,j=C.getDay(),E=j<=5?5-j:7-j+5,k=new Date(C.getTime()+E*24*60*60*1e3);for(let F=0;F<12;F++){const M=new Date(k.getTime()-F*7*24*60*60*1e3),R=M.toISOString().split("T")[0],z=`Week ending ${M.toLocaleDateString("en-UK",{day:"numeric",month:"short",year:"numeric"})} (Fri)`;S.push({value:R,label:z})}return S},l=localStorage.getItem("contractorName")||"",c=l?l.split(" ")[0]:"";b.useEffect(()=>{l||(window.location.href="/login")},[l]);const d=(S=>{switch(S.toLowerCase()){case"dalwayne":return"dalwayne";case"mohamed":return"mohamed";case"said":return"said.tiss";default:return S.toLowerCase()}})(c),{data:m}=rt({queryKey:[`/api/contractor-application/${d}`],queryFn:async()=>{const S=await fetch(`/api/contractor-application/${d}`);if(S.status===404)return null;if(!S.ok)throw new Error("Failed to fetch contractor data");return S.json()},retry:!1}),{data:f=[]}=rt({queryKey:[`/api/work-sessions/${c}`],queryFn:async()=>{const S=await fetch(`/api/work-sessions/${c}?t=${Date.now()}`);if(!S.ok)throw new Error("Failed to fetch work sessions");return S.json()},staleTime:0,gcTime:0}),p=m!=null&&m.adminPayRate?parseFloat(m.adminPayRate):18.75,x={name:m!=null&&m.firstName&&(m!=null&&m.lastName)?`${m.firstName} ${m.lastName}`:l,email:(m==null?void 0:m.email)||"",cisRegistered:(m==null?void 0:m.isCisRegistered)==="true",dailyRate:p*8,hourlyRate:p,cisRate:(m==null?void 0:m.isCisRegistered)==="true"?20:30};console.log(` Contractor Info: ${x.name}, ${p}/hr, ${x.dailyRate}/day, CIS: ${x.cisRate}%`);const h=f.map(S=>{let C=parseFloat(S.totalHours||"0");console.log(` Using totalHours from DB: ${S.totalHours}  ${C} hours`);const j=new Date(S.startTime),E=j.getHours(),k=j.getMinutes(),F=E+k/60,M=F>8.25;console.log(` Start time check: ${F.toFixed(2)} vs 8.25 (8:15 AM) - Late: ${M}`);const R=Math.min(C,8),z=C>=8;let B=z?x.dailyRate:R*x.hourlyRate;console.log(` Earnings calculation: hoursWorked=${C}, paidHours=${R}, isFullDay=${z}`),console.log(` Rate used: ${z?`Daily ${x.dailyRate}`:`Hourly ${x.hourlyRate}  ${R}h`} = ${B}`),console.log(` Standard pay applied: ${z?`Daily ${x.dailyRate}`:"Hourly rate"} - no penalties`);const K=new Date(S.startTime).toISOString().substring(11,16),X=S.endTime?new Date(S.endTime).toISOString().substring(11,16):"Active",ee=M?" (LATE)":"";console.log(` Session ${S.id}: ${Math.min(C,8)} hours paid (${K}-${X}), started ${K}${ee} = ${B.toFixed(2)}`),console.log(` Raw data - Hours: ${C}, TotalHours from DB: ${S.totalHours}`),console.log(` Pay calculation: isFullDay=${z}, hourlyRate=${x.hourlyRate}, dailyRate=${x.dailyRate}`);const V=B;return{id:S.id,location:S.jobSiteLocation||"Work Site",date:new Date(S.startTime).toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("-"),startTime:K,endTime:X,hoursWorked:Math.min(C,8),hourlyRate:x.hourlyRate,grossEarnings:V,gpsVerified:!0}}),w=(()=>{const S=h.filter(F=>{const M=new Date(F.date),R=new Date(n),z=new Date(R.getTime()-6*24*60*60*1e3);return M>=z&&M<=R}),C=S.reduce((F,M)=>F+M.hoursWorked,0),j=S.reduce((F,M)=>F+M.grossEarnings,0),E=Math.round(j*x.cisRate/100*100)/100,k=Math.round((j-E)*100)/100;return{weekEnding:n,totalHours:C,grossEarnings:j,cisDeduction:E,netEarnings:k,cisRate:x.cisRate,sessions:S}})();console.log(` CIS Calculation: ${w.grossEarnings.toFixed(2)}  ${w.cisRate}% = ${w.cisDeduction.toFixed(2)} deduction`),console.log(` Net Payment: ${w.grossEarnings.toFixed(2)} - ${w.cisDeduction.toFixed(2)} = ${w.netEarnings.toFixed(2)}`);const v=()=>{const S={contractor:x,week:w,sessions:w.sessions};i({title:"Export Generated",description:`Week ending ${n} exported for accounting`}),console.log("Weekly Export Data:",S)},y=S=>{const C=S.split(" ");return C.length>=2?(C[0][0]+C[1][0]).toUpperCase():C[0].substring(0,2).toUpperCase()},N=S=>{if(t(!1),S==="Sign Out & Switch Account"){localStorage.clear(),window.location.href="/login",window.location.reload();return}i({title:S,description:`Opening ${S} interface...`})};return l?a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>t(!e),className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4 hover:bg-yellow-700 transition-colors",children:a.jsx("span",{className:"text-white font-bold text-sm",children:y(l)})}),e&&a.jsxs("div",{className:"absolute right-0 top-10 w-64 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:[a.jsx("div",{className:"px-4 py-3 border-b border-slate-600",children:a.jsx("div",{className:"text-yellow-400 font-semibold",children:l})}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>N("My Tasks"),className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-tasks mr-3 text-slate-400"}),"My Tasks"]}),a.jsxs("button",{onClick:()=>N("Report Issue"),className:"w-full px-4 py-2 text-left text-yellow-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-exclamation-triangle mr-3 text-yellow-400"}),"Report Issue"]}),a.jsx("div",{className:"border-t border-slate-600 mt-2 pt-2",children:a.jsxs("button",{onClick:()=>N("Sign Out & Switch Account"),className:"w-full px-4 py-2 text-left text-red-400 hover:bg-slate-700 flex items-center",children:[a.jsx("i",{className:"fas fa-sign-out-alt mr-3 text-red-400"}),"Sign Out & Switch Account"]})})]})]})]})]})]}),a.jsxs("div",{className:"p-4 pb-20",children:[a.jsx("h1",{className:"text-2xl font-bold text-yellow-400 mb-4",children:"Earnings Dashboard"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-yellow-600 to-yellow-700 rounded-xl p-4 text-black",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium opacity-80",children:"This Week"}),a.jsxs("div",{className:"text-2xl font-bold",children:["",w.netEarnings.toFixed(0)]}),a.jsx("div",{className:"text-xs opacity-70",children:"Net Earnings"})]}),a.jsx("i",{className:"fas fa-pound-sign text-3xl opacity-60"})]})}),a.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-slate-400",children:"Total Hours"}),a.jsx("div",{className:"text-2xl font-bold text-white",children:w.totalHours.toFixed(1)}),a.jsx("div",{className:"text-xs text-green-400",children:"GPS Verified"})]}),a.jsx("i",{className:"fas fa-clock text-3xl text-slate-600"})]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3 text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-green-400",children:["",w.grossEarnings.toFixed(0)]}),a.jsx("div",{className:"text-xs text-slate-400",children:"Gross"})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3 text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-red-400",children:["-",w.cisDeduction.toFixed(0)]}),a.jsxs("div",{className:"text-xs text-slate-400",children:["CIS (",w.cisRate,"%)"]})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3 text-center",children:[a.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:["",x.hourlyRate]}),a.jsx("div",{className:"text-xs text-slate-400",children:"Rate/Hour"})]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-yellow-400",children:"Week Details"}),a.jsxs(Gu,{value:n,onValueChange:s,children:[a.jsx(Rl,{className:"w-48 bg-slate-800 border-slate-600 text-white",children:a.jsx(Ku,{})}),a.jsx(Il,{children:o().map(S=>a.jsx(Ii,{value:S.value,children:S.label},S.value))})]})]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("i",{className:"fas fa-calculator text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Current Pay Rates"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Daily Rate"}),a.jsxs("div",{className:"text-white font-bold text-xl",children:["",x.dailyRate]}),a.jsx("div",{className:"text-slate-400 text-xs",children:"8-hour day"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-400 text-sm",children:"Hourly Rate"}),a.jsxs("div",{className:"text-white font-bold text-xl",children:["",x.hourlyRate.toFixed(2)]}),a.jsx("div",{className:"text-slate-400 text-xs",children:"partial day work"})]})]})]}),a.jsx("div",{className:"bg-slate-800 border-l-4 border-orange-500 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"fas fa-exclamation-triangle text-orange-500 mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-white font-semibold",children:"Not CIS Registered"}),a.jsx("div",{className:"text-slate-400 text-sm",children:"30% tax deduction applied"})]})]}),a.jsx(De,{variant:"default",className:"bg-orange-600",children:"Non-CIS"})]})}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("i",{className:"fas fa-server text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"API Server"})]}),a.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"Set the server URL for the app to use when making requests."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"text-xs text-slate-400 mb-1 block",children:"Server URL"}),a.jsx(qr,{defaultValue:Sh()||"",placeholder:"https://your-server.domain",id:"apiBaseInput",className:"bg-slate-900 border-slate-700 text-white"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(je,{onClick:()=>{const S=document.getElementById("apiBaseInput"),C=(S==null?void 0:S.value.trim())||"";C?(localStorage.setItem("API_BASE",C),i({title:"API Base Saved",description:`Using ${C} for requests.`})):(localStorage.removeItem("API_BASE"),i({title:"API Base Cleared",description:"Using relative /api requests."}))},className:"bg-yellow-600 hover:bg-yellow-700 text-black font-semibold w-full",children:"Save"}),a.jsx(je,{onClick:()=>{const S=document.getElementById("apiBaseInput");S&&(S.value=""),localStorage.removeItem("API_BASE"),i({title:"Reset",description:"API base cleared."})},className:"bg-slate-700 hover:bg-slate-600 text-white w-full",variant:"secondary",children:"Reset"})]})]}),a.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:["Current: ",a.jsx("span",{className:"text-slate-300",children:Sh()||"Relative /api"})]})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Daily Breakdown"}),w.sessions.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400 bg-slate-800 rounded-lg",children:[a.jsx("i",{className:"fas fa-calendar-times text-3xl mb-2"}),a.jsx("div",{children:"No work sessions this week"})]}):w.sessions.map(S=>a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-white font-medium text-sm",children:S.date}),a.jsxs("div",{className:"text-slate-400 text-xs",children:[S.startTime," - ",S.endTime]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-white font-semibold",children:[S.hoursWorked.toFixed(1),"h"]}),a.jsxs("div",{className:"text-green-400 text-sm",children:["",S.grossEarnings.toFixed(0)]})]})]}),a.jsxs("div",{className:"text-slate-400 text-sm truncate",children:[a.jsx("i",{className:"fas fa-map-marker-alt mr-1"}),S.location]})]},S.id))]}),a.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-white font-semibold",children:"Weekly Export"}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Generate payroll data for accounting"})]}),a.jsx("i",{className:"fas fa-file-export text-yellow-400 text-xl"})]}),a.jsxs(je,{onClick:v,className:"w-full bg-yellow-600 hover:bg-yellow-700 text-black font-semibold",children:["Export Week Ending ",new Date(n).toLocaleDateString("en-GB",{month:"short",day:"numeric"})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:l&&(l.toLowerCase().includes("dalwayne")||l.toLowerCase().includes("diedericks"))?a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/foreman",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-foreman",children:[a.jsx("i",{className:"fas fa-users block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs Assigned"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]}):a.jsxs("div",{className:"grid grid-cols-3 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]})}),e&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>t(!1)})]}):a.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-yellow-400 mb-2",children:"Redirecting to login..."}),a.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-yellow-400 border-t-transparent rounded-full mx-auto"})]})})}function hr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ct(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function jN(e,t){const r=hr(e);return isNaN(t)?Ct(e,NaN):(t&&r.setDate(r.getDate()+t),r)}const TN=6048e5,iF=6e4,oF=36e5,lF=1e3;let cF={};function nc(){return cF}function ea(e,t){var l,c,u,d;const r=nc(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=hr(e),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function fo(e){return ea(e,{weekStartsOn:1})}function uF(e){const t=hr(e),r=t.getFullYear(),n=Ct(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=fo(n),i=Ct(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=fo(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function EN(e){const t=hr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function dF(e){const t=uF(e),r=Ct(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),fo(r)}const fF={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hF=(e,t,r)=>{let n;const s=fF[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function X0(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const mF={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xF={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pF={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gF={date:X0({formats:mF,defaultWidth:"full"}),time:X0({formats:xF,defaultWidth:"full"}),dateTime:X0({formats:pF,defaultWidth:"full"})},vF={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yF=(e,t,r,n)=>vF[e];function Bo(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const wF={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bF={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NF={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},SF={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jF={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TF={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},EF=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},CF={ordinalNumber:EF,era:Bo({values:wF,defaultWidth:"wide"}),quarter:Bo({values:bF,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Bo({values:NF,defaultWidth:"wide"}),day:Bo({values:SF,defaultWidth:"wide"}),dayPeriod:Bo({values:jF,defaultWidth:"wide",formattingValues:TF,defaultFormattingWidth:"wide"})};function Uo(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?_F(l,m=>m.test(o)):kF(l,m=>m.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function kF(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function _F(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function AF(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const PF=/^(\d+)(th|st|nd|rd)?/i,FF=/\d+/i,RF={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},IF={any:[/^b/i,/^(a|c)/i]},DF={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},OF={any:[/1/i,/2/i,/3/i,/4/i]},LF={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},MF={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},BF={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},UF={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$F={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},WF={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},HF={ordinalNumber:AF({matchPattern:PF,parsePattern:FF,valueCallback:e=>parseInt(e,10)}),era:Uo({matchPatterns:RF,defaultMatchWidth:"wide",parsePatterns:IF,defaultParseWidth:"any"}),quarter:Uo({matchPatterns:DF,defaultMatchWidth:"wide",parsePatterns:OF,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Uo({matchPatterns:LF,defaultMatchWidth:"wide",parsePatterns:MF,defaultParseWidth:"any"}),day:Uo({matchPatterns:BF,defaultMatchWidth:"wide",parsePatterns:UF,defaultParseWidth:"any"}),dayPeriod:Uo({matchPatterns:$F,defaultMatchWidth:"any",parsePatterns:WF,defaultParseWidth:"any"})},VF={code:"en-US",formatDistance:hF,formatLong:gF,formatRelative:yF,localize:CF,match:HF,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zF(e){const t=hr(e),r=+fo(t)-+dF(t);return Math.round(r/TN)+1}function CN(e,t){var d,m,f,p;const r=hr(e),n=r.getFullYear(),s=nc(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(f=s.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=Ct(e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ea(o,t),c=Ct(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=ea(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function GF(e,t){var l,c,u,d;const r=nc(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=CN(e,t),i=Ct(e,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),ea(i,t)}function KF(e,t){const r=hr(e),n=+ea(r,t)-+GF(r,t);return Math.round(n/TN)+1}const qg=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},kN=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},YF=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return qg(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",qg(n,t)).replace("{{time}}",kN(s,t))},Qg={p:kN,P:YF},XF=/^D+$/,qF=/^Y+$/,QF=["D","DD","YY","YYYY"];function JF(e){return XF.test(e)}function ZF(e){return qF.test(e)}function Jg(e,t,r){const n=e6(e,t,r);if(console.warn(n),QF.includes(e))throw new RangeError(n)}function e6(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function t6(){return Object.assign({},nc())}function r6(e){let r=hr(e).getDay();return r===0&&(r=7),r}function xa(e,t){const r=hr(e),n=hr(t);return r.getTime()>n.getTime()}function n6(e,t){const r=t instanceof Date?Ct(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}const s6=10;class _N{constructor(){be(this,"subPriority",0)}validate(t,r){return!0}}class a6 extends _N{constructor(t,r,n,s,i){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=s,i&&(this.subPriority=i)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class i6 extends _N{constructor(){super(...arguments);be(this,"priority",s6);be(this,"subPriority",-1)}set(r,n){return n.timestampIsSet?r:Ct(r,n6(r,Date))}}class Ve{run(t,r,n,s){const i=this.parse(t,r,n,s);return i?{setter:new a6(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(t,r,n){return!0}}class o6 extends Ve{constructor(){super(...arguments);be(this,"priority",140);be(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,s){switch(n){case"G":case"GG":case"GGG":return s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"});case"GGGGG":return s.era(r,{width:"narrow"});case"GGGG":default:return s.era(r,{width:"wide"})||s.era(r,{width:"abbreviated"})||s.era(r,{width:"narrow"})}}set(r,n,s){return n.era=s,r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}const St={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Dn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function jt(e,t){return e&&{value:t(e.value),rest:e.rest}}function mt(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function On(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,s=r[2]?parseInt(r[2],10):0,i=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(s*oF+i*iF+o*lF),rest:t.slice(r[0].length)}}function AN(e){return mt(St.anyDigitsSigned,e)}function bt(e,t){switch(e){case 1:return mt(St.singleDigit,t);case 2:return mt(St.twoDigits,t);case 3:return mt(St.threeDigits,t);case 4:return mt(St.fourDigits,t);default:return mt(new RegExp("^\\d{1,"+e+"}"),t)}}function Yu(e,t){switch(e){case 1:return mt(St.singleDigitSigned,t);case 2:return mt(St.twoDigitsSigned,t);case 3:return mt(St.threeDigitsSigned,t);case 4:return mt(St.fourDigitsSigned,t);default:return mt(new RegExp("^-?\\d{1,"+e+"}"),t)}}function ix(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function PN(e,t){const r=t>0,n=r?t:1-t;let s;if(n<=50)s=e||100;else{const i=n+50,o=Math.trunc(i/100)*100,l=e>=i%100;s=e+o-(l?100:0)}return r?s:1-s}function FN(e){return e%400===0||e%4===0&&e%100!==0}class l6 extends Ve{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,s){const i=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return jt(bt(4,r),i);case"yo":return jt(s.ordinalNumber(r,{unit:"year"}),i);default:return jt(bt(n.length,r),i)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s){const i=r.getFullYear();if(s.isTwoDigitYear){const l=PN(s.year,i);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class c6 extends Ve{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,s){const i=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return jt(bt(4,r),i);case"Yo":return jt(s.ordinalNumber(r,{unit:"year"}),i);default:return jt(bt(n.length,r),i)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,s,i){const o=CN(r,i);if(s.isTwoDigitYear){const c=PN(s.year,o);return r.setFullYear(c,0,i.firstWeekContainsDate),r.setHours(0,0,0,0),ea(r,i)}const l=!("era"in n)||n.era===1?s.year:1-s.year;return r.setFullYear(l,0,i.firstWeekContainsDate),r.setHours(0,0,0,0),ea(r,i)}}class u6 extends Ve{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return Yu(n==="R"?4:n.length,r)}set(r,n,s){const i=Ct(r,0);return i.setFullYear(s,0,4),i.setHours(0,0,0,0),fo(i)}}class d6 extends Ve{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return Yu(n==="u"?4:n.length,r)}set(r,n,s){return r.setFullYear(s,0,1),r.setHours(0,0,0,0),r}}class f6 extends Ve{constructor(){super(...arguments);be(this,"priority",120);be(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"Q":case"QQ":return bt(n.length,r);case"Qo":return s.ordinalNumber(r,{unit:"quarter"});case"QQQ":return s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(r,{width:"wide",context:"formatting"})||s.quarter(r,{width:"abbreviated",context:"formatting"})||s.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class h6 extends Ve{constructor(){super(...arguments);be(this,"priority",120);be(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"q":case"qq":return bt(n.length,r);case"qo":return s.ordinalNumber(r,{unit:"quarter"});case"qqq":return s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(r,{width:"wide",context:"standalone"})||s.quarter(r,{width:"abbreviated",context:"standalone"})||s.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,s){return r.setMonth((s-1)*3,1),r.setHours(0,0,0,0),r}}class m6 extends Ve{constructor(){super(...arguments);be(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);be(this,"priority",110)}parse(r,n,s){const i=o=>o-1;switch(n){case"M":return jt(mt(St.month,r),i);case"MM":return jt(bt(2,r),i);case"Mo":return jt(s.ordinalNumber(r,{unit:"month"}),i);case"MMM":return s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(r,{width:"wide",context:"formatting"})||s.month(r,{width:"abbreviated",context:"formatting"})||s.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}class x6 extends Ve{constructor(){super(...arguments);be(this,"priority",110);be(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,s){const i=o=>o-1;switch(n){case"L":return jt(mt(St.month,r),i);case"LL":return jt(bt(2,r),i);case"Lo":return jt(s.ordinalNumber(r,{unit:"month"}),i);case"LLL":return s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(r,{width:"wide",context:"standalone"})||s.month(r,{width:"abbreviated",context:"standalone"})||s.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.setMonth(s,1),r.setHours(0,0,0,0),r}}function p6(e,t,r){const n=hr(e),s=KF(n,r)-t;return n.setDate(n.getDate()-s*7),n}class g6 extends Ve{constructor(){super(...arguments);be(this,"priority",100);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,s){switch(n){case"w":return mt(St.week,r);case"wo":return s.ordinalNumber(r,{unit:"week"});default:return bt(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s,i){return ea(p6(r,s,i),i)}}function v6(e,t){const r=hr(e),n=zF(r)-t;return r.setDate(r.getDate()-n*7),r}class y6 extends Ve{constructor(){super(...arguments);be(this,"priority",100);be(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,s){switch(n){case"I":return mt(St.week,r);case"Io":return s.ordinalNumber(r,{unit:"week"});default:return bt(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,s){return fo(v6(r,s))}}const w6=[31,28,31,30,31,30,31,31,30,31,30,31],b6=[31,29,31,30,31,30,31,31,30,31,30,31];class N6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"subPriority",1);be(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"d":return mt(St.date,r);case"do":return s.ordinalNumber(r,{unit:"date"});default:return bt(n.length,r)}}validate(r,n){const s=r.getFullYear(),i=FN(s),o=r.getMonth();return i?n>=1&&n<=b6[o]:n>=1&&n<=w6[o]}set(r,n,s){return r.setDate(s),r.setHours(0,0,0,0),r}}class S6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"subpriority",1);be(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,s){switch(n){case"D":case"DD":return mt(St.dayOfYear,r);case"Do":return s.ordinalNumber(r,{unit:"date"});default:return bt(n.length,r)}}validate(r,n){const s=r.getFullYear();return FN(s)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,s){return r.setMonth(0,s),r.setHours(0,0,0,0),r}}function ox(e,t,r){var m,f,p,x;const n=nc(),s=(r==null?void 0:r.weekStartsOn)??((f=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((x=(p=n.locale)==null?void 0:p.options)==null?void 0:x.weekStartsOn)??0,i=hr(e),o=i.getDay(),c=(t%7+7)%7,u=7-s,d=t<0||t>6?t-(o+u)%7:(c+u)%7-(o+u)%7;return jN(i,d)}class j6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,s){switch(n){case"E":case"EE":case"EEE":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,i){return r=ox(r,s,i),r.setHours(0,0,0,0),r}}class T6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,s,i){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+i.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return jt(bt(n.length,r),o);case"eo":return jt(s.ordinalNumber(r,{unit:"day"}),o);case"eee":return s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeeee":return s.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,i){return r=ox(r,s,i),r.setHours(0,0,0,0),r}}class E6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,s,i){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+i.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return jt(bt(n.length,r),o);case"co":return jt(s.ordinalNumber(r,{unit:"day"}),o);case"ccc":return s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"ccccc":return s.day(r,{width:"narrow",context:"standalone"});case"cccccc":return s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(r,{width:"wide",context:"standalone"})||s.day(r,{width:"abbreviated",context:"standalone"})||s.day(r,{width:"short",context:"standalone"})||s.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,s,i){return r=ox(r,s,i),r.setHours(0,0,0,0),r}}function C6(e,t){const r=hr(e),n=r6(r),s=t-n;return jN(r,s)}class k6 extends Ve{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,s){const i=o=>o===0?7:o;switch(n){case"i":case"ii":return bt(n.length,r);case"io":return s.ordinalNumber(r,{unit:"day"});case"iii":return jt(s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),i);case"iiiii":return jt(s.day(r,{width:"narrow",context:"formatting"}),i);case"iiiiii":return jt(s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),i);case"iiii":default:return jt(s.day(r,{width:"wide",context:"formatting"})||s.day(r,{width:"abbreviated",context:"formatting"})||s.day(r,{width:"short",context:"formatting"})||s.day(r,{width:"narrow",context:"formatting"}),i)}}validate(r,n){return n>=1&&n<=7}set(r,n,s){return r=C6(r,s),r.setHours(0,0,0,0),r}}class _6 extends Ve{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,s){switch(n){case"a":case"aa":case"aaa":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(ix(s),0,0,0),r}}class A6 extends Ve{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,s){switch(n){case"b":case"bb":case"bbb":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(ix(s),0,0,0),r}}class P6 extends Ve{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,s){switch(n){case"B":case"BB":case"BBB":return s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(r,{width:"wide",context:"formatting"})||s.dayPeriod(r,{width:"abbreviated",context:"formatting"})||s.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,s){return r.setHours(ix(s),0,0,0),r}}class F6 extends Ve{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,s){switch(n){case"h":return mt(St.hour12h,r);case"ho":return s.ordinalNumber(r,{unit:"hour"});default:return bt(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,s){const i=r.getHours()>=12;return i&&s<12?r.setHours(s+12,0,0,0):!i&&s===12?r.setHours(0,0,0,0):r.setHours(s,0,0,0),r}}class R6 extends Ve{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,s){switch(n){case"H":return mt(St.hour23h,r);case"Ho":return s.ordinalNumber(r,{unit:"hour"});default:return bt(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,s){return r.setHours(s,0,0,0),r}}class I6 extends Ve{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,s){switch(n){case"K":return mt(St.hour11h,r);case"Ko":return s.ordinalNumber(r,{unit:"hour"});default:return bt(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,s){return r.getHours()>=12&&s<12?r.setHours(s+12,0,0,0):r.setHours(s,0,0,0),r}}class D6 extends Ve{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,s){switch(n){case"k":return mt(St.hour24h,r);case"ko":return s.ordinalNumber(r,{unit:"hour"});default:return bt(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,s){const i=s<=24?s%24:s;return r.setHours(i,0,0,0),r}}class O6 extends Ve{constructor(){super(...arguments);be(this,"priority",60);be(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"m":return mt(St.minute,r);case"mo":return s.ordinalNumber(r,{unit:"minute"});default:return bt(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setMinutes(s,0,0),r}}class L6 extends Ve{constructor(){super(...arguments);be(this,"priority",50);be(this,"incompatibleTokens",["t","T"])}parse(r,n,s){switch(n){case"s":return mt(St.second,r);case"so":return s.ordinalNumber(r,{unit:"second"});default:return bt(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,s){return r.setSeconds(s,0),r}}class M6 extends Ve{constructor(){super(...arguments);be(this,"priority",30);be(this,"incompatibleTokens",["t","T"])}parse(r,n){const s=i=>Math.trunc(i*Math.pow(10,-n.length+3));return jt(bt(n.length,r),s)}set(r,n,s){return r.setMilliseconds(s),r}}class B6 extends Ve{constructor(){super(...arguments);be(this,"priority",10);be(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return On(Dn.basicOptionalMinutes,r);case"XX":return On(Dn.basic,r);case"XXXX":return On(Dn.basicOptionalSeconds,r);case"XXXXX":return On(Dn.extendedOptionalSeconds,r);case"XXX":default:return On(Dn.extended,r)}}set(r,n,s){return n.timestampIsSet?r:Ct(r,r.getTime()-EN(r)-s)}}class U6 extends Ve{constructor(){super(...arguments);be(this,"priority",10);be(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return On(Dn.basicOptionalMinutes,r);case"xx":return On(Dn.basic,r);case"xxxx":return On(Dn.basicOptionalSeconds,r);case"xxxxx":return On(Dn.extendedOptionalSeconds,r);case"xxx":default:return On(Dn.extended,r)}}set(r,n,s){return n.timestampIsSet?r:Ct(r,r.getTime()-EN(r)-s)}}class $6 extends Ve{constructor(){super(...arguments);be(this,"priority",40);be(this,"incompatibleTokens","*")}parse(r){return AN(r)}set(r,n,s){return[Ct(r,s*1e3),{timestampIsSet:!0}]}}class W6 extends Ve{constructor(){super(...arguments);be(this,"priority",20);be(this,"incompatibleTokens","*")}parse(r){return AN(r)}set(r,n,s){return[Ct(r,s),{timestampIsSet:!0}]}}const H6={G:new o6,y:new l6,Y:new c6,R:new u6,u:new d6,Q:new f6,q:new h6,M:new m6,L:new x6,w:new g6,I:new y6,d:new N6,D:new S6,E:new j6,e:new T6,c:new E6,i:new k6,a:new _6,b:new A6,B:new P6,h:new F6,H:new R6,K:new I6,k:new D6,m:new O6,s:new L6,S:new M6,X:new B6,x:new U6,t:new $6,T:new W6},V6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,z6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,G6=/^'([^]*?)'?$/,K6=/''/g,Y6=/\S/,X6=/[a-zA-Z]/;function nn(e,t,r,n){var h,g,w,v;const s=t6(),i=s.locale??VF,o=s.firstWeekContainsDate??((g=(h=s.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=s.weekStartsOn??((v=(w=s.locale)==null?void 0:w.options)==null?void 0:v.weekStartsOn)??0,c={firstWeekContainsDate:o,weekStartsOn:l,locale:i},u=[new i6],d=t.match(z6).map(y=>{const N=y[0];if(N in Qg){const S=Qg[N];return S(y,i.formatLong)}return y}).join("").match(V6),m=[];for(let y of d){ZF(y)&&Jg(y,t,e),JF(y)&&Jg(y,t,e);const N=y[0],S=H6[N];if(S){const{incompatibleTokens:C}=S;if(Array.isArray(C)){const E=m.find(k=>C.includes(k.token)||k.token===N);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${y}\` at the same time`)}else if(S.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${y}\` and any other token at the same time`);m.push({token:N,fullToken:y});const j=S.run(e,y,i.match,c);if(!j)return Ct(r,NaN);u.push(j.setter),e=j.rest}else{if(N.match(X6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");if(y==="''"?y="'":N==="'"&&(y=q6(y)),e.indexOf(y)===0)e=e.slice(y.length);else return Ct(r,NaN)}}if(e.length>0&&Y6.test(e))return Ct(r,NaN);const f=u.map(y=>y.priority).sort((y,N)=>N-y).filter((y,N,S)=>S.indexOf(y)===N).map(y=>u.filter(N=>N.priority===y).sort((N,S)=>S.subPriority-N.subPriority)).map(y=>y[0]);let p=hr(r);if(isNaN(p.getTime()))return Ct(r,NaN);const x={};for(const y of f){if(!y.validate(p,c))return Ct(r,NaN);const N=y.set(p,x,c);Array.isArray(N)?(p=N[0],Object.assign(x,N[1])):p=N}return Ct(r,p)}function q6(e){return e.match(G6)[1].replace(K6,"'")}function Q6(){const[e,t]=b.useState("all"),[r,n]=b.useState("endDate"),{data:s=[],isLoading:i}=rt({queryKey:["/api/job-assignments"]}),o=s.filter(f=>{if(e==="all")return!0;if(e==="overdue"){const p=nn(f.endDate,"dd/MM/yyyy",new Date);return xa(new Date,p)&&f.status!=="completed"}if(e==="upcoming"){const p=nn(f.startDate,"dd/MM/yyyy",new Date);return xa(p,new Date)}return f.status===e}).sort((f,p)=>{if(r==="endDate"){const x=nn(f.endDate,"dd/MM/yyyy",new Date),h=nn(p.endDate,"dd/MM/yyyy",new Date);return x.getTime()-h.getTime()}if(r==="startDate"){const x=nn(f.startDate,"dd/MM/yyyy",new Date),h=nn(p.startDate,"dd/MM/yyyy",new Date);return x.getTime()-h.getTime()}return r==="contractor"?f.contractorName.localeCompare(p.contractorName):0}),l=f=>{const p=nn(f.endDate,"dd/MM/yyyy",new Date),x=nn(f.startDate,"dd/MM/yyyy",new Date),h=new Date;return f.status==="completed"?"bg-green-100 text-green-800 border-green-200":xa(h,p)?"bg-red-100 text-red-800 border-red-200":xa(x,h)?"bg-blue-100 text-blue-800 border-blue-200":"bg-yellow-100 text-yellow-800 border-yellow-200"},c=f=>{const p=nn(f.endDate,"dd/MM/yyyy",new Date),x=nn(f.startDate,"dd/MM/yyyy",new Date),h=new Date;return f.status==="completed"?"Completed":xa(h,p)?"Overdue":xa(x,h)?"Upcoming":"In Progress"},u=s.filter(f=>{const p=nn(f.endDate,"dd/MM/yyyy",new Date);return xa(new Date,p)&&f.status!=="completed"}),d=s.filter(f=>f.status==="assigned"),m=s.filter(f=>f.status==="completed");return i?a.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:a.jsx("div",{className:"text-white text-lg",children:"Loading foreman dashboard..."})}):a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx("div",{className:"bg-slate-800 border-b border-slate-700 px-4 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-yellow-400",children:"Jobs Assigned"}),a.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"All team assignments and deadlines"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm text-slate-400",children:"Dalwayne Diedericks"}),a.jsx("div",{className:"text-xs text-yellow-400",children:"Site Foreman"})]}),a.jsx("div",{className:"w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-slate-900 font-semibold",children:"DD"})})]})]})}),a.jsxs("div",{className:"px-4 py-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:a.jsx(Un,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-2xl font-bold text-white",children:s.length}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Total Assignments"})]})]})}),a.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx(Bn,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-2xl font-bold text-white",children:d.length}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Active Tasks"})]})]})}),a.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center",children:a.jsx(Hm,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-2xl font-bold text-white",children:u.length}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Overdue"})]})]})}),a.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:a.jsx(Mu,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-2xl font-bold text-white",children:m.length}),a.jsx("div",{className:"text-slate-400 text-sm",children:"Completed"})]})]})})]}),a.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>t("all"),className:`px-3 py-1 rounded-md text-sm font-medium ${e==="all"?"bg-yellow-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,"data-testid":"filter-all",children:"All"}),a.jsx("button",{onClick:()=>t("assigned"),className:`px-3 py-1 rounded-md text-sm font-medium ${e==="assigned"?"bg-yellow-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,"data-testid":"filter-assigned",children:"Active"}),a.jsx("button",{onClick:()=>t("overdue"),className:`px-3 py-1 rounded-md text-sm font-medium ${e==="overdue"?"bg-yellow-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,"data-testid":"filter-overdue",children:"Overdue"}),a.jsx("button",{onClick:()=>t("completed"),className:`px-3 py-1 rounded-md text-sm font-medium ${e==="completed"?"bg-yellow-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,"data-testid":"filter-completed",children:"Completed"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-slate-400",children:"Sort by:"}),a.jsxs("select",{value:r,onChange:f=>n(f.target.value),className:"bg-slate-700 text-white border border-slate-600 rounded px-2 py-1 text-sm","data-testid":"sort-select",children:[a.jsx("option",{value:"endDate",children:"Due Date"}),a.jsx("option",{value:"startDate",children:"Start Date"}),a.jsx("option",{value:"contractor",children:"Contractor"})]})]})]})}),a.jsx("div",{className:"space-y-4",children:o.length===0?a.jsx("div",{className:"bg-slate-800 rounded-lg p-8 border border-slate-700 text-center",children:a.jsx("div",{className:"text-slate-400",children:"No assignments found for the selected filter."})}):o.map(f=>a.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 hover:border-slate-600 transition-colors","data-testid":`assignment-card-${f.id}`,children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:f.hbxlJob}),a.jsxs("div",{className:"flex items-center text-slate-400 text-sm mt-1",children:[a.jsx(Un,{className:"w-4 h-4 mr-1"}),f.contractorName]})]}),a.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${l(f)}`,"data-testid":`status-${f.id}`,children:c(f)})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-400 mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Pd,{className:"w-4 h-4 mr-1"}),f.workLocation]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Mu,{className:"w-4 h-4 mr-1"}),f.startDate," - ",f.endDate]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:f.buildPhases.map((p,x)=>a.jsx("span",{className:"bg-slate-700 text-slate-300 px-2 py-1 rounded text-xs","data-testid":`phase-${f.id}-${x}`,children:p},x))}),f.specialInstructions&&a.jsxs("div",{className:"text-sm text-slate-300 bg-slate-700 rounded p-3",children:[a.jsx("strong",{children:"Special Instructions:"})," ",f.specialInstructions]})]}),a.jsxs("div",{className:"flex flex-col gap-2 lg:ml-4",children:[a.jsxs("a",{href:`tel:${f.phone}`,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm text-center transition-colors","data-testid":`call-${f.id}`,children:["Call ",f.contractorName.split(" ")[0]]}),a.jsx("a",{href:`mailto:${f.email}`,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm text-center transition-colors","data-testid":`email-${f.id}`,children:"Email"})]})]})},f.id))})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-dashboard",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/jobs",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-jobs",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/foreman",className:"py-3 px-4 text-yellow-400","data-testid":"nav-foreman",children:[a.jsx("i",{className:"fas fa-users block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs Assigned"})]}),a.jsxs("button",{onClick:()=>window.location.href="/more",className:"py-3 px-4 text-slate-400 hover:text-white","data-testid":"nav-more",children:[a.jsx("i",{className:"fas fa-ellipsis-h block mb-1"}),a.jsx("span",{className:"text-xs",children:"More"})]})]})}),a.jsx("div",{className:"h-20"})]})}function J6(){const e=()=>{localStorage.clear(),window.location.href="/login",window.location.reload()};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function Z6(){var r;const{toast:e}=Tt(),t=n=>{n==="Create Job"?window.location.href="/create-assignment":e({title:n,description:`${n} functionality`})};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(J6,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"RD"})})]})]}),a.jsx("div",{className:"bg-yellow-600 px-4 py-2",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"fas fa-user-shield text-black mr-2"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-black font-medium text-sm",children:"Admin Dashboard"}),a.jsxs("div",{className:"text-black text-xs",children:["Welcome ",((r=localStorage.getItem("adminName"))==null?void 0:r.split(" ")[0])||"Admin"]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("div",{className:"bg-orange-500 text-white px-2 py-1 rounded text-xs flex items-center",children:[a.jsx("i",{className:"fas fa-plus mr-1"}),"Job"]}),a.jsx("div",{className:"bg-yellow-700 text-white px-2 py-1 rounded text-xs",children:a.jsx("i",{className:"fas fa-user"})})]})]})}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Jobs"}),a.jsx("i",{className:"fas fa-briefcase text-blue-400"})]}),a.jsx("div",{className:"text-2xl font-bold text-white",children:"0"}),a.jsx("div",{className:"text-slate-500 text-xs",children:"Total"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Active"}),a.jsx("i",{className:"fas fa-circle text-green-400"})]}),a.jsx("div",{className:"text-2xl font-bold text-white",children:"0"}),a.jsx("div",{className:"text-slate-500 text-xs",children:"Working"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Hours"}),a.jsx("i",{className:"fas fa-clock text-yellow-400"})]}),a.jsx("div",{className:"text-2xl font-bold text-white",children:"0"}),a.jsx("div",{className:"text-slate-500 text-xs",children:"Today"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Pay"}),a.jsx("i",{className:"fas fa-pound-sign text-yellow-400"})]}),a.jsx("div",{className:"text-2xl font-bold text-white",children:"0"}),a.jsx("div",{className:"text-slate-500 text-xs",children:"Pending"})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-bolt text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Quick Actions"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("button",{onClick:()=>t("Create Job"),className:"bg-slate-700 hover:bg-slate-600 rounded-lg p-4 text-center border border-slate-600 transition-colors",children:[a.jsx("i",{className:"fas fa-plus text-orange-400 text-2xl mb-2 block"}),a.jsx("div",{className:"text-white font-medium",children:"Create Job"}),a.jsx("div",{className:"text-slate-400 text-xs",children:"Create new assignment"})]}),a.jsxs("button",{onClick:()=>t("Time Tracking"),className:"bg-slate-700 hover:bg-slate-600 rounded-lg p-4 text-center border border-slate-600 transition-colors",children:[a.jsx("i",{className:"fas fa-clock text-yellow-400 text-2xl mb-2 block"}),a.jsx("div",{className:"text-white font-medium",children:"Time Tracking"}),a.jsx("div",{className:"text-slate-400 text-xs",children:"Monitor active sessions"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"bg-slate-700 hover:bg-slate-600 rounded-lg p-4 text-center border border-slate-600 transition-colors",children:[a.jsx("i",{className:"fas fa-tasks text-blue-400 text-2xl mb-2 block"}),a.jsx("div",{className:"text-white font-medium",children:"Assignments"}),a.jsx("div",{className:"text-slate-400 text-xs",children:"Manage job assignments"})]})]})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-chart-line text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Recent Activity"})]}),a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-slate-400",children:"No recent activity"})})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{className:"py-3 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]}),a.jsxs("button",{onClick:()=>window.location.href="/upload",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-upload block mb-1"}),a.jsx("span",{className:"text-xs",children:"Upload"})]})]})}),a.jsx("div",{className:"h-20"})]})}class oi{static clearLocalStorage(){try{["uploadedJobs","processedCSVs","createdJobs","csvFiles","jobAssignments","contractorData","tempData","debugLogs","formData","userPreferences","timeTracking","gpsData"].forEach(r=>{localStorage.removeItem(r)}),console.log(" LocalStorage cleared")}catch(t){console.error("Error clearing localStorage:",t)}}static clearSessionStorage(){try{sessionStorage.clear(),console.log(" SessionStorage cleared")}catch(t){console.error("Error clearing sessionStorage:",t)}}static clearBrowserCache(){try{"caches"in window&&caches.keys().then(t=>{t.forEach(r=>{caches.delete(r)})}),console.log(" Browser cache cleared")}catch(t){console.error("Error clearing browser cache:",t)}}static resetComponentStates(){try{window.dispatchEvent(new Event("app-reset")),console.log(" Component states reset")}catch(t){console.error("Error resetting component states:",t)}}static performFullCleanup(){console.log(" Starting system cleanup..."),this.clearLocalStorage(),this.clearSessionStorage(),this.clearBrowserCache(),this.resetComponentStates(),console.log(" System cleanup completed"),setTimeout(()=>{window.location.reload()},1e3)}static checkForRemainingData(){const t=Object.keys(localStorage),r=Object.keys(sessionStorage);return console.log("LocalStorage keys:",t),console.log("SessionStorage keys:",r),{localStorage:t,sessionStorage:r}}}window.addEventListener("beforeunload",()=>{oi.clearSessionStorage()});function eR(){const e=()=>{localStorage.clear(),window.location.href="/login",window.location.reload()};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function tR(){const[e,t]=b.useState(!1),[r,n]=b.useState(null),{toast:s}=Tt(),i=async()=>{t(!0);try{const l=oi.checkForRemainingData();oi.performFullCleanup(),setTimeout(()=>{const c=oi.checkForRemainingData();n({before:l,after:c}),s({title:"System Cleaned",description:"All temporary data and caches have been cleared"}),t(!1)},500)}catch{s({title:"Cleanup Error",description:"Error during system cleanup",variant:"destructive"}),t(!1)}},o=()=>{oi.clearLocalStorage(),oi.clearSessionStorage(),s({title:"Quick Cleanup Complete",description:"Storage data cleared without page reload"})};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(eR,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"RD"})})]})]}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h1",{className:"text-3xl font-bold text-yellow-400",children:"System Cleanup"})}),a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-broom text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Data Cleanup Actions"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-4",children:[a.jsx(je,{onClick:i,disabled:e,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2",children:e?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Cleaning..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-trash-alt mr-2"}),"Full System Cleanup"]})}),a.jsxs(je,{onClick:o,className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-2",children:[a.jsx("i",{className:"fas fa-eraser mr-2"}),"Quick Storage Clear"]})]}),a.jsxs("div",{className:"text-sm text-slate-400",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Full System Cleanup:"})," Clears all localStorage, sessionStorage, browser cache, and reloads the page for a completely fresh start."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Quick Storage Clear:"})," Clears only localStorage and sessionStorage without page reload."]})]})]})]}),r&&a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-chart-bar text-green-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-green-400",children:"Cleanup Results"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-yellow-400 font-medium mb-2",children:"Before Cleanup"}),a.jsxs("div",{className:"text-sm text-slate-300",children:[a.jsxs("p",{children:["LocalStorage keys: ",r.before.localStorage.length]}),a.jsxs("p",{children:["SessionStorage keys: ",r.before.sessionStorage.length]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-green-400 font-medium mb-2",children:"After Cleanup"}),a.jsxs("div",{className:"text-sm text-slate-300",children:[a.jsxs("p",{children:["LocalStorage keys: ",r.after.localStorage.length]}),a.jsxs("p",{children:["SessionStorage keys: ",r.after.sessionStorage.length]})]})]})]}),r.after.localStorage.length===0&&r.after.sessionStorage.length===0&&a.jsx("div",{className:"mt-4 p-3 bg-green-900 border border-green-600 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"fas fa-check-circle text-green-400 mr-2"}),a.jsx("span",{className:"text-green-300 font-medium",children:"System is completely clean!"})]})})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("i",{className:"fas fa-info-circle text-blue-400 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-400",children:"System Status"})]}),a.jsxs("div",{className:"text-sm text-slate-300 space-y-2",children:[a.jsx("p",{children:" All temporary test data removed from memory storage"}),a.jsx("p",{children:" CSV upload caches cleared"}),a.jsx("p",{children:" Job assignment data reset"}),a.jsx("p",{children:" Component states refreshed"}),a.jsx("p",{children:" Browser cache cleared"})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/admin-task-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]}),a.jsxs("button",{onClick:()=>window.location.href="/upload",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-upload block mb-1"}),a.jsx("span",{className:"text-xs",children:"Upload"})]})]})}),a.jsx("div",{className:"h-20"})]})}function rR(){const e=()=>{localStorage.clear(),window.location.href="/login",window.location.reload()};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function nR(){const[e,t]=b.useState([]),[r,n]=b.useState(""),[s,i]=b.useState(""),[o,l]=b.useState(""),[c,u]=b.useState(""),[d,m]=b.useState(""),[f,p]=b.useState("06/08/2025"),[x,h]=b.useState("13/08/2025"),[g,w]=b.useState(""),[v,y]=b.useState([]),[N,S]=b.useState([]),[C,j]=b.useState([]),{toast:E}=Tt(),{data:k=[]}=rt({queryKey:["/api/contractor-applications"],select:B=>B.filter(K=>K.status==="approved").map(K=>({id:K.id,firstName:K.firstName,lastName:K.lastName,email:K.email,phone:K.phone,primaryTrade:K.primaryTrade}))});b.useEffect(()=>{(async()=>{try{console.log(" Loading jobs from database...");const K=await fetch("/api/jobs");if(!K.ok)throw new Error("Failed to fetch jobs");const X=await K.json();console.log(" Loaded jobs from database:",X.length);const ee=X.map(V=>({id:V.id,name:V.title,location:V.location,status:V.status,phases:V.phases?V.phases.split(", "):[],phaseData:V.phases?V.phases.split(", ").reduce((te,ue)=>(te[ue]=[],te),{}):{}}));y(ee),console.log(" Transformed jobs for dropdown:",ee.length)}catch(K){console.error(" Error loading jobs:",K),E({title:"Error Loading Jobs",description:"Could not load jobs from database",variant:"destructive"})}})()},[]),b.useEffect(()=>{if(d){console.log("=== PHASE EXTRACTION DEBUG ==="),console.log("Selected HBXL Job:",d),console.log("All uploaded jobs:",v);const B=v.find(K=>K.name===d);if(console.log("Found selected job:",B),B)if(console.log("Job phase data exists:",!!B.phaseData),console.log("Phase data type:",typeof B.phaseData),console.log("Phase data content:",B.phaseData),B.phaseData&&typeof B.phaseData=="object"&&B.phaseData!==null){const K=Object.keys(B.phaseData);j(K),console.log(" Extracted phases:",K)}else console.log(" Phase data invalid or missing"),console.log("Selected job structure:",JSON.stringify(B,null,2)),j([]);else console.log(" No job found with name:",d),j([]);console.log("=== END DEBUG ===")}else j([])},[d,v]);const F=B=>{S(K=>K.includes(B)?K.filter(X=>X!==B):[...K,B])},M=()=>{S([...C])},R=()=>{S([])},z=async()=>{if(e.length===0){E({title:"Missing Information",description:"Please select at least one contractor",variant:"destructive"});return}if(!c||!d){E({title:"Missing Information",description:"Please fill in work location and select an HBXL job",variant:"destructive"});return}if(N.length===0){E({title:"No Phases Selected",description:"Please select at least one build phase",variant:"destructive"});return}try{const B=[];for(const X of e){const ee=k.find(xe=>xe.id===X);if(!ee)continue;const V={contractorName:`${ee.firstName} ${ee.lastName}`,email:ee.email,phone:ee.phone,workLocation:c,hbxlJob:d,buildPhases:N,startDate:f,endDate:x,specialInstructions:e.length>1?`TEAM ASSIGNMENT: Working with ${e.length} contractors. ${g}`.trim():g,status:"assigned",sendTelegramNotification:!0,teamAssignment:e.length>1,teamMembers:e.length>1?e.map(xe=>{const L=k.find(G=>G.id===xe);return L?`${L.firstName} ${L.lastName}`:""}).filter(Boolean):void 0};console.log(` Creating assignment for ${ee.firstName} ${ee.lastName}:`,V);const te=await fetch("/api/job-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(!te.ok)throw new Error(`Failed to create assignment for ${ee.firstName}: ${te.status}`);const ue=await te.json();B.push(ue),console.log(` Assignment saved for ${ee.firstName} ${ee.lastName}`)}const K=e.map(X=>{const ee=k.find(V=>V.id===X);return ee?`${ee.firstName} ${ee.lastName}`:""}).filter(Boolean).join(", ");E({title:"Assignments Created",description:e.length>1?`Team assignment created for ${e.length} contractors: ${K}. Telegram notifications sent to each.`:`Job assigned to ${K}. Telegram notification sent.`}),setTimeout(()=>{window.location.href="/job-assignments"},2e3)}catch(B){console.error(" Assignment creation failed:",B),E({title:"Assignment Error",description:"Failed to create assignment. Please try again.",variant:"destructive"})}};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(rR,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:"Pro"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Pro"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Simple Time Tracking"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-green-500",children:"Online"}),a.jsx("i",{className:"fas fa-sun text-yellow-400 ml-2"}),a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center ml-4",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"RD"})})]})]}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-3xl font-bold text-yellow-400",children:"Job Assignments"}),a.jsx(je,{onClick:()=>window.location.href="/job-assignments",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"+ Create Assignment"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[a.jsxs("div",{className:"flex items-center mb-6",children:[a.jsx("i",{className:"fas fa-user-plus text-yellow-400 mr-2"}),a.jsx("h3",{className:"text-xl font-semibold text-yellow-400",children:"Create New Job Assignment"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:["Select Contractors *",a.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"(Can select multiple for team work)"})]}),a.jsx("div",{className:"relative mb-3",children:a.jsxs("select",{onChange:B=>{const K=B.target.value;if(K&&!e.includes(K)){const X=[...e,K];if(t(X),X.length===1){const ee=k.find(V=>V.id===K);ee&&(n(`${ee.firstName} ${ee.lastName}`),i(ee.email),l(ee.phone))}else{const ee=X.map(V=>{const te=k.find(ue=>ue.id===V);return te?`${te.firstName} ${te.lastName}`:""}).filter(Boolean);n(ee.join(", ")),i(""),l("")}B.target.value=""}},className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",children:[a.jsx("option",{value:"",children:"Choose contractors..."}),k.map(B=>a.jsxs("option",{value:B.id,disabled:e.includes(B.id),children:[B.firstName," ",B.lastName," - ",B.primaryTrade]},B.id))]})}),e.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-slate-400",children:"Selected Contractors:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(B=>{const K=k.find(X=>X.id===B);return K?a.jsxs(De,{className:"bg-blue-600 text-white px-3 py-1 flex items-center gap-2",children:[a.jsxs("span",{children:[K.firstName," ",K.lastName]}),a.jsxs("span",{className:"text-blue-200 text-xs",children:["(",K.primaryTrade,")"]}),a.jsx("button",{onClick:()=>{const X=e.filter(ee=>ee!==B);if(t(X),X.length===0)n(""),i(""),l("");else if(X.length===1){const ee=k.find(V=>V.id===X[0]);ee&&(n(`${ee.firstName} ${ee.lastName}`),i(ee.email),l(ee.phone))}else{const ee=X.map(V=>{const te=k.find(ue=>ue.id===V);return te?`${te.firstName} ${te.lastName}`:""}).filter(Boolean);n(ee.join(", ")),i(""),l("")}},className:"text-blue-200 hover:text-white ml-1",children:""})]},B):null})}),e.length>1&&a.jsxs("div",{className:"text-xs text-green-400 bg-green-900/20 border border-green-700 rounded p-2",children:[" Team Assignment: ",e.length," contractors will work together on this job"]})]})]}),e.length===1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:["Email * ",a.jsx("span",{className:"text-slate-400 text-xs",children:"(Auto-filled from contractor profile)"})]}),a.jsx("input",{type:"email",value:s,onChange:B=>i(B.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"Enter email address"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:["Phone ",a.jsx("span",{className:"text-slate-400 text-xs",children:"(Auto-filled from contractor profile)"})]}),a.jsx("input",{type:"text",value:o,onChange:B=>l(B.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"Enter phone number"})]})]}),e.length>1&&a.jsxs("div",{className:"bg-blue-900/20 border border-blue-700 rounded-lg p-4",children:[a.jsx("div",{className:"text-yellow-400 font-medium mb-2",children:"Team Assignment Mode"}),a.jsx("div",{className:"text-slate-300 text-sm",children:"For team assignments with multiple contractors, notifications will be sent to each contractor individually. Contact details are managed through their individual profiles."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Work Location (Postcode) *"}),a.jsx("input",{type:"text",value:c,onChange:B=>u(B.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"Enter postcode"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"HBXL Job *"}),a.jsxs("select",{value:d,onChange:B=>{if(console.log("Job selection changed to:",B.target.value),m(B.target.value),S([]),B.target.value){const K=v.find(X=>X.name===B.target.value);if(K&&K.location){const X=K.location.split(", "),ee=X[X.length-1];u(ee),console.log(" Auto-populated work location with postcode:",ee)}}else u("")},className:"w-full bg-slate-700 border border-yellow-500 rounded-lg px-4 py-3 text-white focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",children:[a.jsx("option",{value:"",children:"Select HBXL job"}),v.map(B=>a.jsxs("option",{value:B.name,children:[B.name," ",B.phaseData?`(${Object.keys(B.phaseData).length} phases)`:"(No phases)"]},B.id))]}),v.length===0&&a.jsx("p",{className:"text-red-400 text-sm mt-2",children:"No jobs available. Upload CSV files on the Upload Job page first."}),v.length>0&&a.jsxs("p",{className:"text-green-400 text-sm mt-2",children:[" ",v.length," job(s) loaded from CSV uploads"]})]}),d&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Build Phases"}),a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:M,className:"text-yellow-400 text-sm hover:text-yellow-300",children:"Select All"}),a.jsx("button",{onClick:R,className:"text-yellow-400 text-sm hover:text-yellow-300",children:"Clear All"})]})}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:C.length>0?C.map(B=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:B,checked:N.includes(B),onChange:()=>F(B),className:"w-4 h-4 text-yellow-400 bg-slate-700 border-slate-600 rounded focus:ring-yellow-500"}),a.jsx("label",{htmlFor:B,className:"text-white text-sm",children:B})]},B)):a.jsx("div",{className:"col-span-2 text-slate-400 text-sm text-center py-4 border border-slate-600 rounded-lg bg-slate-800",children:d?`No phases found for "${d}". Upload a CSV file first to get real phase data.`:"Select an HBXL job to see available phases"})}),a.jsxs("div",{className:"mt-2 text-slate-400 text-sm",children:["Selected: ",N.length," of ",C.length," phases from ",d]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Start Date"}),a.jsx("input",{type:"text",value:f,onChange:B=>p(B.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"DD/MM/YYYY"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"End Date"}),a.jsx("input",{type:"text",value:x,onChange:B=>h(B.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"DD/MM/YYYY"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Special Instructions"}),a.jsx("textarea",{value:g,onChange:B=>w(B.target.value),rows:4,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",placeholder:"Any special instructions for the contractor..."})]}),a.jsxs("div",{className:"flex space-x-4 pt-4",children:[a.jsx(je,{onClick:()=>window.location.href="/job-assignments",variant:"outline",className:"bg-slate-700 border-slate-600 text-white hover:bg-slate-600",children:"Cancel"}),a.jsx(je,{onClick:z,className:"bg-green-600 hover:bg-green-700 text-white",children:"Create Assignment"})]})]})]})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700",children:a.jsxs("div",{className:"grid grid-cols-4 text-center",children:[a.jsxs("button",{onClick:()=>window.location.href="/",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-home block mb-1"}),a.jsx("span",{className:"text-xs",children:"Dashboard"})]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"py-3 px-4 text-yellow-400",children:[a.jsx("i",{className:"fas fa-briefcase block mb-1"}),a.jsx("span",{className:"text-xs",children:"Jobs"})]}),a.jsxs("button",{onClick:()=>window.location.href="/admin-task-monitor",className:"py-3 px-4 text-slate-400 hover:text-white",children:[a.jsx("i",{className:"fas fa-user-cog block mb-1"}),a.jsx("span",{className:"text-xs",children:"Admin"})]})]})}),a.jsx("div",{className:"h-20"})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xu={};Xu.version="0.18.5";var RN=1252,sR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],IN=function(e){sR.indexOf(e)!=-1&&(RN=e)};function aR(){IN(1252)}var Dl=function(e){IN(e)};function iR(){Dl(1200),aR()}var Mc=function(t){return String.fromCharCode(t)},Zg=function(t){return String.fromCharCode(t)},va,Bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ol(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Bs.charAt(i)+Bs.charAt(o)+Bs.charAt(l)+Bs.charAt(c);return t}function hs(e){var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Bs.indexOf(e.charAt(u++)),o=Bs.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Bs.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Bs.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var We=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ps=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Wa(e){return We?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ev(e){return We?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var pn=function(t){return We?ps(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hd(e){if(typeof ArrayBuffer>"u")return pn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function sc(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function oR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var zt=We?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ps(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function lR(e){for(var t=[],r=0,n=e.length+250,s=Wa(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Wa(65535),n=65530)}return t.push(s.slice(0,r)),zt(t)}var al=/\u0000/g,Bc=/[\u0001-\u0006]/g;function Di(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function gn(e,t){var r=""+e;return r.length>=t?r:yt("0",t-r.length)+r}function lx(e,t){var r=""+e;return r.length>=t?r:yt(" ",t-r.length)+r}function qu(e,t){var r=""+e;return r.length>=t?r:r+yt(" ",t-r.length)}function cR(e,t){var r=""+Math.round(e);return r.length>=t?r:yt("0",t-r.length)+r}function uR(e,t){var r=""+e;return r.length>=t?r:yt("0",t-r.length)+r}var tv=Math.pow(2,32);function si(e,t){if(e>tv||e<-tv)return cR(e,t);var r=Math.round(e);return uR(r,t)}function Qu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var rv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ju(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,o=1,l=0,c=1,u=0,d=0,m=Math.floor(s);u<t&&(m=Math.floor(s),l=m*o+i,d=m*u+c,!(s-m<5e-8));)s=1/(s-m),i=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=o)),!r)return[0,n*l,d];var f=Math.floor(n*l/d);return[f,n*l-f*d,d]}function Uc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=yR(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var DN=new Date(1899,11,31,0,0,0),hR=DN.getTime(),mR=new Date(1900,2,1,0,0,0);function ON(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=mR&&(r+=24*60*60*1e3),(r-(hR+(e.getTimezoneOffset()-DN.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function cx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pR(e){var t=e<0?12:11,r=cx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function gR(e){var t=cx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function vR(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=pR(e):t===10?r=e.toFixed(10).substr(0,12):r=gR(e),cx(xR(r.toUpperCase()))}function Rh(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):vR(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ta(14,ON(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wR(e,t,r,n){var s="",i=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return q0[r.m-1][1];case 5:return q0[r.m-1][0];default:return q0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return rv[r.q][0];default:return rv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?gn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=gn(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?gn(c,u):"";return d}function Us(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var LN=/%/g;function bR(e,t,r){var n=t.replace(LN,""),s=t.length-n.length;return rs(e,n,r*Math.pow(10,2*s))+yt("%",s)}function NR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function MN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+MN(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var BN=/# (\?+)( ?)\/( ?)(\d+)/;function SR(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),o=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?yt(" ",e[1].length+1+e[4].length):lx(o,e[1].length)+e[2]+"/"+e[3]+gn(l,e[4].length))}function jR(e,t,r){return r+(t===0?"":""+t)+yt(" ",e[1].length+2+e[4].length)}var UN=/^#*0*\.([0#]+)/,$N=/\).*[0#]/,WN=/\(###\) ###\\?-####/;function cr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function sv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function av(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function TR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ER(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vr(e,t,r){if(e.charCodeAt(0)===40&&!t.match($N)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vr("n",n,r):"("+Vr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return NR(e,t,r);if(t.indexOf("%")!==-1)return bR(e,t,r);if(t.indexOf("E")!==-1)return MN(t,r);if(t.charCodeAt(0)===36)return"$"+Vr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+si(c,t.length);if(t.match(/^[#?]+$/))return s=si(r,0),s==="0"&&(s=""),s.length>t.length?s:cr(t.substr(0,t.length-s.length))+s;if(i=t.match(BN))return SR(i,c,u);if(t.match(/^#+0+$/))return u+si(c,t.length-t.indexOf("0"));if(i=t.match(UN))return s=sv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+cr(i[1])).replace(/\.$/,"."+cr(i[1])).replace(/\.(\d*)$/,function(x,h){return"."+h+yt("0",cr(i[1]).length-h.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+sv(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Us(si(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vr(e,t,-r):Us(""+(Math.floor(r)+TR(r,i[1].length)))+"."+gn(av(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Vr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Di(Vr(e,t.replace(/[\\-]/g,""),r)),o=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(WN))return s=Vr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Ju(c,Math.pow(10,o)-1,!1),s=""+u,d=rs("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=qu(l[2],o),d.length<i[4].length&&(d=cr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Ju(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?lx(l[1],o)+i[2]+"/"+i[3]+qu(l[2],o):yt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=si(r,0),t.length<=s.length?s:cr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,f=t.length-s.length-m;return cr(t.substr(0,m)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=av(r,i[1].length),r<0?"-"+Vr(e,t,-r):Us(ER(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?gn(0,3-x.length):"")+x})+"."+gn(o,i[1].length);switch(t){case"###,##0.00":return Vr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Us(si(c,0));return p!=="0"?u+p:"";case"###,###.00":return Vr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kR(e,t,r){var n=t.replace(LN,""),s=t.length-n.length;return rs(e,n,r*Math.pow(10,2*s))+yt("%",s)}function HN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+HN(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function En(e,t,r){if(e.charCodeAt(0)===40&&!t.match($N)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?En("n",n,r):"("+En("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CR(e,t,r);if(t.indexOf("%")!==-1)return kR(e,t,r);if(t.indexOf("E")!==-1)return HN(t,r);if(t.charCodeAt(0)===36)return"$"+En(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+gn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:cr(t.substr(0,t.length-s.length))+s;if(i=t.match(BN))return jR(i,c,u);if(t.match(/^#+0+$/))return u+gn(c,t.length-t.indexOf("0"));if(i=t.match(UN))return s=(""+r).replace(/^([^\.]+)$/,"$1."+cr(i[1])).replace(/\.$/,"."+cr(i[1])),s=s.replace(/\.(\d*)$/,function(x,h){return"."+h+yt("0",cr(i[1]).length-h.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Us(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+En(e,t,-r):Us(""+r)+"."+yt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return En(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Di(En(e,t.replace(/[\\-]/g,""),r)),o=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(WN))return s=En(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Ju(c,Math.pow(10,o)-1,!1),s=""+u,d=rs("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=qu(l[2],o),d.length<i[4].length&&(d=cr(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Ju(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?lx(l[1],o)+i[2]+"/"+i[3]+qu(l[2],o):yt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:cr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,f=t.length-s.length-m;return cr(t.substr(0,m)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+En(e,t,-r):Us(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?gn(0,3-x.length):"")+x})+"."+gn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Us(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return En(e,t.slice(0,t.lastIndexOf(".")),r)+cr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rs(e,t,r){return(r|0)===r?En(e,t,r):Vr(e,t,r)}function _R(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var VN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zN(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Qu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(VN))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AR(e,t,r,n){for(var s=[],i="",o=0,l="",c="t",u,d,m,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Qu(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);s[s.length]={t:"t",v:i},++o;break;case"\\":var p=e.charAt(++o),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Uc(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Uc(t,r),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var h={t:l,v:l};if(u==null&&(u=Uc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(h.v=u.H>=12?"P":"A"),h.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(h.v=u.H>=12?"PM":"AM"),h.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(h.v=u.H>=12?"":""),h.t="T",o+=5,f="h"):(h.t="t",++o),u==null&&h.t==="T")return"";s[s.length]=h,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(VN)){if(u==null&&(u=Uc(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",zN(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,w=0,v;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",g<1&&(g=1);break;case"s":(v=s[o].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",N;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=wR(s[o].t.charCodeAt(0),s[o].v,u,w),s[o].t="t";break;case"n":case"?":for(N=o+1;s[N]!=null&&((l=s[N].t)==="?"||l==="D"||(l===" "||l==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[o].v+=s[N].v,s[N]={v:"",t:";"},++N;y+=s[o].v,o=N-1;break;case"G":s[o].t="t",s[o].v=Rh(t,r);break}var S="",C,j;if(y.length>0){y.charCodeAt(0)==40?(C=t<0&&y.charCodeAt(0)===45?-t:t,j=rs("n",y,C)):(C=t<0&&n>1?-t:t,j=rs("n",y,C),C<0&&s[0]&&s[0].t=="t"&&(j=j.substr(1),s[0].v="-"+s[0].v)),N=j.length-1;var E=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){E=o;break}var k=s.length;if(E===s.length&&j.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(N>=s[o].v.length-1?(N-=s[o].v.length,s[o].v=j.substr(N+1,s[o].v.length)):N<0?s[o].v="":(s[o].v=j.substr(0,N+1),N=-1),s[o].t="t",k=o);N>=0&&k<s.length&&(s[k].v=j.substr(0,N+1)+s[k].v)}else if(E!==s.length&&j.indexOf("E")===-1){for(N=j.indexOf(".")-1,o=E;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")-1:s[o].v.length-1,S=s[o].v.substr(d+1);d>=0;--d)N>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(S=j.charAt(N--)+S);s[o].v=S,s[o].t="t",k=o}for(N>=0&&k<s.length&&(s[k].v=j.substr(0,N+1)+s[k].v),N=j.indexOf(".")+1,o=E;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==E)){for(d=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")+1:0,S=s[o].v.substr(0,d);d<s[o].v.length;++d)N<j.length&&(S+=j.charAt(N++));s[o].v=S,s[o].t="t",k=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(C=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=rs(s[o].t,s[o].v,C),s[o].t="t");var F="";for(o=0;o!==s.length;++o)s[o]!=null&&(F+=s[o].v);return F}var iv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ov(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function PR(e,t){var r=_R(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(iv),l=r[1].match(iv);return ov(t,o)?[n,r[0]]:ov(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function ta(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:wt)[e],n==null&&(n=r.table&&r.table[nv[e]]||wt[nv[e]]),n==null&&(n=fR[e]||"General");break}if(Qu(n,0))return Rh(t,r);t instanceof Date&&(t=ON(t,r.date1904));var s=PR(n,t);if(Qu(s[1]))return Rh(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AR(s[1],t,r,s[0])}function GN(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(wt[r]==null){t<0&&(t=r);continue}if(wt[r]==e){t=r;break}}t<0&&(t=391)}return wt[t]=e,t}function Vd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&GN(e[t],t)}function zd(){wt=dR()}var KN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function FR(e){var t=typeof e=="number"?wt[e]:e;return t=t.replace(KN,"(\\d+)"),new RegExp("^"+t+"$")}function RR(e,t,r){var n=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(KN)||[]).forEach(function(m,f){var p=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:s=p;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&i==-1?d:u+"T"+d}var IR=function(){var e={};e.version="1.2.0";function t(){for(var j=0,E=new Array(256),k=0;k!=256;++k)j=k,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,E[k]=j;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(j){var E=0,k=0,F=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)M[F]=j[F];for(F=0;F!=256;++F)for(k=j[F],E=256+F;E<4096;E+=256)k=M[E]=k>>>8^j[k&255];var R=[];for(F=1;F!=16;++F)R[F-1]=typeof Int32Array<"u"?M.subarray(F*256,F*256+256):M.slice(F*256,F*256+256);return R}var s=n(r),i=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],m=s[6],f=s[7],p=s[8],x=s[9],h=s[10],g=s[11],w=s[12],v=s[13],y=s[14];function N(j,E){for(var k=E^-1,F=0,M=j.length;F<M;)k=k>>>8^r[(k^j.charCodeAt(F++))&255];return~k}function S(j,E){for(var k=E^-1,F=j.length-15,M=0;M<F;)k=y[j[M++]^k&255]^v[j[M++]^k>>8&255]^w[j[M++]^k>>16&255]^g[j[M++]^k>>>24]^h[j[M++]]^x[j[M++]]^p[j[M++]]^f[j[M++]]^m[j[M++]]^d[j[M++]]^u[j[M++]]^c[j[M++]]^l[j[M++]]^o[j[M++]]^i[j[M++]]^r[j[M++]];for(F+=15;M<F;)k=k>>>8^r[(k^j[M++])&255];return~k}function C(j,E){for(var k=E^-1,F=0,M=j.length,R=0,z=0;F<M;)R=j.charCodeAt(F++),R<128?k=k>>>8^r[(k^R)&255]:R<2048?(k=k>>>8^r[(k^(192|R>>6&31))&255],k=k>>>8^r[(k^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,z=j.charCodeAt(F++)&1023,k=k>>>8^r[(k^(240|R>>8&7))&255],k=k>>>8^r[(k^(128|R>>2&63))&255],k=k>>>8^r[(k^(128|z>>6&15|(R&3)<<4))&255],k=k>>>8^r[(k^(128|z&63))&255]):(k=k>>>8^r[(k^(224|R>>12&15))&255],k=k>>>8^r[(k^(128|R>>6&63))&255],k=k>>>8^r[(k^(128|R&63))&255]);return~k}return e.table=r,e.bstr=N,e.buf=S,e.str=C,e}(),Ze=function(){var t={};t.version="1.2.1";function r(T,I){for(var _=T.split("/"),P=I.split("/"),D=0,O=0,Q=Math.min(_.length,P.length);D<Q;++D){if(O=_[D].length-P[D].length)return O;if(_[D]!=P[D])return _[D]<P[D]?-1:1}return _.length-P.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var I=T.lastIndexOf("/");return I===-1?T:T.slice(0,I+1)}function s(T){if(T.charAt(T.length-1)=="/")return s(T.slice(0,-1));var I=T.lastIndexOf("/");return I===-1?T:T.slice(I+1)}function i(T,I){typeof I=="string"&&(I=new Date(I));var _=I.getHours();_=_<<6|I.getMinutes(),_=_<<5|I.getSeconds()>>>1,T.write_shift(2,_);var P=I.getFullYear()-1980;P=P<<4|I.getMonth()+1,P=P<<5|I.getDate(),T.write_shift(2,P)}function o(T){var I=T.read_shift(2)&65535,_=T.read_shift(2)&65535,P=new Date,D=_&31;_>>>=5;var O=_&15;_>>>=4,P.setMilliseconds(0),P.setFullYear(_+1980),P.setMonth(O-1),P.setDate(D);var Q=I&31;I>>>=5;var ne=I&63;return I>>>=6,P.setHours(I),P.setMinutes(ne),P.setSeconds(Q<<1),P}function l(T){Rr(T,0);for(var I={},_=0;T.l<=T.length-4;){var P=T.read_shift(2),D=T.read_shift(2),O=T.l+D,Q={};switch(P){case 21589:_=T.read_shift(1),_&1&&(Q.mtime=T.read_shift(4)),D>5&&(_&2&&(Q.atime=T.read_shift(4)),_&4&&(Q.ctime=T.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}T.l=O,I[P]=Q}return I}var c;function u(){return c||(c={})}function d(T,I){if(T[0]==80&&T[1]==75)return Bx(T,I);if((T[0]|32)==109&&(T[1]|32)==105)return kS(T,I);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var _=3,P=512,D=0,O=0,Q=0,ne=0,q=0,J=[],Z=T.slice(0,512);Rr(Z,0);var le=m(Z);switch(_=le[0],_){case 3:P=512;break;case 4:P=4096;break;case 0:if(le[1]==0)return Bx(T,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}P!==512&&(Z=T.slice(0,P),Rr(Z,28));var me=T.slice(0,P);f(Z,_);var Ne=Z.read_shift(4,"i");if(_===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);Z.l+=4,Q=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),ne=Z.read_shift(4,"i"),D=Z.read_shift(4,"i"),q=Z.read_shift(4,"i"),O=Z.read_shift(4,"i");for(var de=-1,ve=0;ve<109&&(de=Z.read_shift(4,"i"),!(de<0));++ve)J[ve]=de;var ke=p(T,P);g(q,O,ke,P,J);var dt=v(ke,Q,J,P);dt[Q].name="!Directory",D>0&&ne!==z&&(dt[ne].name="!MiniFAT"),dt[J[0]].name="!FAT",dt.fat_addrs=J,dt.ssz=P;var ft={},Qt=[],Eo=[],Co=[];y(Q,dt,ke,Qt,D,ft,Eo,ne),x(Eo,Co,Qt),Qt.shift();var ko={FileIndex:Eo,FullPaths:Co};return I&&I.raw&&(ko.raw={header:me,sectors:ke}),ko}function m(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(B,"Header Signature: "),T.l+=16;var I=T.read_shift(2,"u");return[T.read_shift(2,"u"),I]}function f(T,I){var _=9;switch(T.l+=2,_=T.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function p(T,I){for(var _=Math.ceil(T.length/I)-1,P=[],D=1;D<_;++D)P[D-1]=T.slice(D*I,(D+1)*I);return P[_-1]=T.slice(_*I),P}function x(T,I,_){for(var P=0,D=0,O=0,Q=0,ne=0,q=_.length,J=[],Z=[];P<q;++P)J[P]=Z[P]=P,I[P]=_[P];for(;ne<Z.length;++ne)P=Z[ne],D=T[P].L,O=T[P].R,Q=T[P].C,J[P]===P&&(D!==-1&&J[D]!==D&&(J[P]=J[D]),O!==-1&&J[O]!==O&&(J[P]=J[O])),Q!==-1&&(J[Q]=P),D!==-1&&P!=J[P]&&(J[D]=J[P],Z.lastIndexOf(D)<ne&&Z.push(D)),O!==-1&&P!=J[P]&&(J[O]=J[P],Z.lastIndexOf(O)<ne&&Z.push(O));for(P=1;P<q;++P)J[P]===P&&(O!==-1&&J[O]!==O?J[P]=J[O]:D!==-1&&J[D]!==D&&(J[P]=J[D]));for(P=1;P<q;++P)if(T[P].type!==0){if(ne=P,ne!=J[ne])do ne=J[ne],I[P]=I[ne]+"/"+I[P];while(ne!==0&&J[ne]!==-1&&ne!=J[ne]);J[P]=-1}for(I[0]+="/",P=1;P<q;++P)T[P].type!==2&&(I[P]+="/")}function h(T,I,_){for(var P=T.start,D=T.size,O=[],Q=P;_&&D>0&&Q>=0;)O.push(I.slice(Q*R,Q*R+R)),D-=R,Q=ya(_,Q*4);return O.length===0?re(0):zt(O).slice(0,T.size)}function g(T,I,_,P,D){var O=z;if(T===z){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var Q=_[T],ne=(P>>>2)-1;if(!Q)return;for(var q=0;q<ne&&(O=ya(Q,q*4))!==z;++q)D.push(O);g(ya(Q,P-4),I-1,_,P,D)}}function w(T,I,_,P,D){var O=[],Q=[];D||(D=[]);var ne=P-1,q=0,J=0;for(q=I;q>=0;){D[q]=!0,O[O.length]=q,Q.push(T[q]);var Z=_[Math.floor(q*4/P)];if(J=q*4&ne,P<4+J)throw new Error("FAT boundary crossed: "+q+" 4 "+P);if(!T[Z])break;q=ya(T[Z],J)}return{nodes:O,data:xv([Q])}}function v(T,I,_,P){var D=T.length,O=[],Q=[],ne=[],q=[],J=P-1,Z=0,le=0,me=0,Ne=0;for(Z=0;Z<D;++Z)if(ne=[],me=Z+I,me>=D&&(me-=D),!Q[me]){q=[];var de=[];for(le=me;le>=0;){de[le]=!0,Q[le]=!0,ne[ne.length]=le,q.push(T[le]);var ve=_[Math.floor(le*4/P)];if(Ne=le*4&J,P<4+Ne)throw new Error("FAT boundary crossed: "+le+" 4 "+P);if(!T[ve]||(le=ya(T[ve],Ne),de[le]))break}O[me]={nodes:ne,data:xv([q])}}return O}function y(T,I,_,P,D,O,Q,ne){for(var q=0,J=P.length?2:0,Z=I[T].data,le=0,me=0,Ne;le<Z.length;le+=128){var de=Z.slice(le,le+128);Rr(de,64),me=de.read_shift(2),Ne=mx(de,0,me-J),P.push(Ne);var ve={name:Ne,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},ke=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);ke!==0&&(ve.ct=N(de,de.l-8));var dt=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);dt!==0&&(ve.mt=N(de,de.l-8)),ve.start=de.read_shift(4,"i"),ve.size=de.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=z,ve.name=""),ve.type===5?(q=ve.start,D>0&&q!==z&&(I[q].name="!StreamData")):ve.size>=4096?(ve.storage="fat",I[ve.start]===void 0&&(I[ve.start]=w(_,ve.start,I.fat_addrs,I.ssz)),I[ve.start].name=ve.name,ve.content=I[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:q!==z&&ve.start!==z&&I[q]&&(ve.content=h(ve,I[q].data,(I[ne]||{}).data))),ve.content&&Rr(ve.content,0),O[Ne]=ve,Q.push(ve)}}function N(T,I){return new Date((Or(T,I+4)/1e7*Math.pow(2,32)+Or(T,I)/1e7-11644473600)*1e3)}function S(T,I){return u(),d(c.readFileSync(T),I)}function C(T,I){var _=I&&I.type;switch(_||We&&Buffer.isBuffer(T)&&(_="buffer"),_||"base64"){case"file":return S(T,I);case"base64":return d(pn(hs(T)),I);case"binary":return d(pn(T),I)}return d(T,I)}function j(T,I){var _=I||{},P=_.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=P+"/",T.FileIndex[0]={name:P,type:5}),_.CLSID&&(T.FileIndex[0].clsid=_.CLSID),E(T)}function E(T){var I="Sh33tJ5";if(!Ze.find(T,"/"+I)){var _=re(4);_[0]=55,_[1]=_[3]=50,_[2]=54,T.FileIndex.push({name:I,type:2,content:_,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+I),k(T)}}function k(T,I){j(T);for(var _=!1,P=!1,D=T.FullPaths.length-1;D>=0;--D){var O=T.FileIndex[D];switch(O.type){case 0:P?_=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(O.R*O.L*O.C)&&(_=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!I)){var Q=new Date(1987,1,19),ne=0,q=Object.create?Object.create(null):{},J=[];for(D=0;D<T.FullPaths.length;++D)q[T.FullPaths[D]]=!0,T.FileIndex[D].type!==0&&J.push([T.FullPaths[D],T.FileIndex[D]]);for(D=0;D<J.length;++D){var Z=n(J[D][0]);P=q[Z],P||(J.push([Z,{name:s(Z).replace("/",""),type:1,clsid:X,ct:Q,mt:Q,content:null}]),q[Z]=!0)}for(J.sort(function(Ne,de){return r(Ne[0],de[0])}),T.FullPaths=[],T.FileIndex=[],D=0;D<J.length;++D)T.FullPaths[D]=J[D][0],T.FileIndex[D]=J[D][1];for(D=0;D<J.length;++D){var le=T.FileIndex[D],me=T.FullPaths[D];if(le.name=s(me).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||X,D===0)le.C=J.length>1?1:-1,le.size=0,le.type=5;else if(me.slice(-1)=="/"){for(ne=D+1;ne<J.length&&n(T.FullPaths[ne])!=me;++ne);for(le.C=ne>=J.length?-1:ne,ne=D+1;ne<J.length&&n(T.FullPaths[ne])!=n(me);++ne);le.R=ne>=J.length?-1:ne,le.type=1}else n(T.FullPaths[D+1]||"")==n(me)&&(le.R=D+1),le.type=2}}}function F(T,I){var _=I||{};if(_.fileType=="mad")return _S(T,_);switch(k(T),_.fileType){case"zip":return NS(T,_)}var P=function(Ne){for(var de=0,ve=0,ke=0;ke<Ne.FileIndex.length;++ke){var dt=Ne.FileIndex[ke];if(dt.content){var ft=dt.content.length;ft>0&&(ft<4096?de+=ft+63>>6:ve+=ft+511>>9)}}for(var Qt=Ne.FullPaths.length+3>>2,Eo=de+7>>3,Co=de+127>>7,ko=Eo+ve+Qt+Co,ma=ko+127>>7,t0=ma<=109?0:Math.ceil((ma-109)/127);ko+ma+t0+127>>7>ma;)t0=++ma<=109?0:Math.ceil((ma-109)/127);var zn=[1,t0,ma,Co,Qt,ve,de,0];return Ne.FileIndex[0].size=de<<6,zn[7]=(Ne.FileIndex[0].start=zn[0]+zn[1]+zn[2]+zn[3]+zn[4]+zn[5])+(zn[6]+7>>3),zn}(T),D=re(P[7]<<9),O=0,Q=0;{for(O=0;O<8;++O)D.write_shift(1,K[O]);for(O=0;O<8;++O)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),O=0;O<3;++O)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,P[2]),D.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:z),D.write_shift(4,P[3]),D.write_shift(-4,P[1]?P[0]-1:z),D.write_shift(4,P[1]),O=0;O<109;++O)D.write_shift(-4,O<P[2]?P[1]+O:-1)}if(P[1])for(Q=0;Q<P[1];++Q){for(;O<236+Q*127;++O)D.write_shift(-4,O<P[2]?P[1]+O:-1);D.write_shift(-4,Q===P[1]-1?z:Q+1)}var ne=function(Ne){for(Q+=Ne;O<Q-1;++O)D.write_shift(-4,O+1);Ne&&(++O,D.write_shift(-4,z))};for(Q=O=0,Q+=P[1];O<Q;++O)D.write_shift(-4,ee.DIFSECT);for(Q+=P[2];O<Q;++O)D.write_shift(-4,ee.FATSECT);ne(P[3]),ne(P[4]);for(var q=0,J=0,Z=T.FileIndex[0];q<T.FileIndex.length;++q)Z=T.FileIndex[q],Z.content&&(J=Z.content.length,!(J<4096)&&(Z.start=Q,ne(J+511>>9)));for(ne(P[6]+7>>3);D.l&511;)D.write_shift(-4,ee.ENDOFCHAIN);for(Q=O=0,q=0;q<T.FileIndex.length;++q)Z=T.FileIndex[q],Z.content&&(J=Z.content.length,!(!J||J>=4096)&&(Z.start=Q,ne(J+63>>6)));for(;D.l&511;)D.write_shift(-4,ee.ENDOFCHAIN);for(O=0;O<P[4]<<2;++O){var le=T.FullPaths[O];if(!le||le.length===0){for(q=0;q<17;++q)D.write_shift(4,0);for(q=0;q<3;++q)D.write_shift(4,-1);for(q=0;q<12;++q)D.write_shift(4,0);continue}Z=T.FileIndex[O],O===0&&(Z.start=Z.size?Z.start-1:z);var me=O===0&&_.root||Z.name;if(J=2*(me.length+1),D.write_shift(64,me,"utf16le"),D.write_shift(2,J),D.write_shift(1,Z.type),D.write_shift(1,Z.color),D.write_shift(-4,Z.L),D.write_shift(-4,Z.R),D.write_shift(-4,Z.C),Z.clsid)D.write_shift(16,Z.clsid,"hex");else for(q=0;q<4;++q)D.write_shift(4,0);D.write_shift(4,Z.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,Z.start),D.write_shift(4,Z.size),D.write_shift(4,0)}for(O=1;O<T.FileIndex.length;++O)if(Z=T.FileIndex[O],Z.size>=4096)if(D.l=Z.start+1<<9,We&&Buffer.isBuffer(Z.content))Z.content.copy(D,D.l,0,Z.size),D.l+=Z.size+511&-512;else{for(q=0;q<Z.size;++q)D.write_shift(1,Z.content[q]);for(;q&511;++q)D.write_shift(1,0)}for(O=1;O<T.FileIndex.length;++O)if(Z=T.FileIndex[O],Z.size>0&&Z.size<4096)if(We&&Buffer.isBuffer(Z.content))Z.content.copy(D,D.l,0,Z.size),D.l+=Z.size+63&-64;else{for(q=0;q<Z.size;++q)D.write_shift(1,Z.content[q]);for(;q&63;++q)D.write_shift(1,0)}if(We)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function M(T,I){var _=T.FullPaths.map(function(q){return q.toUpperCase()}),P=_.map(function(q){var J=q.split("/");return J[J.length-(q.slice(-1)=="/"?2:1)]}),D=!1;I.charCodeAt(0)===47?(D=!0,I=_[0].slice(0,-1)+I):D=I.indexOf("/")!==-1;var O=I.toUpperCase(),Q=D===!0?_.indexOf(O):P.indexOf(O);if(Q!==-1)return T.FileIndex[Q];var ne=!O.match(Bc);for(O=O.replace(al,""),ne&&(O=O.replace(Bc,"!")),Q=0;Q<_.length;++Q)if((ne?_[Q].replace(Bc,"!"):_[Q]).replace(al,"")==O||(ne?P[Q].replace(Bc,"!"):P[Q]).replace(al,"")==O)return T.FileIndex[Q];return null}var R=64,z=-2,B="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(T,I,_){u();var P=F(T,_);c.writeFileSync(I,P)}function te(T){for(var I=new Array(T.length),_=0;_<T.length;++_)I[_]=String.fromCharCode(T[_]);return I.join("")}function ue(T,I){var _=F(T,I);switch(I&&I.type||"buffer"){case"file":return u(),c.writeFileSync(I.filename,_),_;case"binary":return typeof _=="string"?_:te(_);case"base64":return Ol(typeof _=="string"?_:te(_));case"buffer":if(We)return Buffer.isBuffer(_)?_:ps(_);case"array":return typeof _=="string"?pn(_):_}return _}var xe;function L(T){try{var I=T.InflateRaw,_=new I;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)xe=T;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function G(T,I){if(!xe)return Lx(T,I);var _=xe.InflateRaw,P=new _,D=P._processChunk(T.slice(T.l),P._finishFlushFlag);return T.l+=P.bytesRead,D}function U(T){return xe?xe.deflateRawSync(T):Px(T)}var A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(T){var I=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(I>>16|I>>8|I)&255}for(var oe=typeof Uint8Array<"u",se=oe?new Uint8Array(256):[],we=0;we<256;++we)se[we]=ae(we);function pe(T,I){var _=se[T&255];return I<=8?_>>>8-I:(_=_<<8|se[T>>8&255],I<=16?_>>>16-I:(_=_<<8|se[T>>16&255],_>>>24-I))}function Fe(T,I){var _=I&7,P=I>>>3;return(T[P]|(_<=6?0:T[P+1]<<8))>>>_&3}function Ee(T,I){var _=I&7,P=I>>>3;return(T[P]|(_<=5?0:T[P+1]<<8))>>>_&7}function Pt(T,I){var _=I&7,P=I>>>3;return(T[P]|(_<=4?0:T[P+1]<<8))>>>_&15}function ze(T,I){var _=I&7,P=I>>>3;return(T[P]|(_<=3?0:T[P+1]<<8))>>>_&31}function ge(T,I){var _=I&7,P=I>>>3;return(T[P]|(_<=1?0:T[P+1]<<8))>>>_&127}function pr(T,I,_){var P=I&7,D=I>>>3,O=(1<<_)-1,Q=T[D]>>>P;return _<8-P||(Q|=T[D+1]<<8-P,_<16-P)||(Q|=T[D+2]<<16-P,_<24-P)||(Q|=T[D+3]<<24-P),Q&O}function gr(T,I,_){var P=I&7,D=I>>>3;return P<=5?T[D]|=(_&7)<<P:(T[D]|=_<<P&255,T[D+1]=(_&7)>>8-P),I+3}function fa(T,I,_){var P=I&7,D=I>>>3;return _=(_&1)<<P,T[D]|=_,I+1}function Za(T,I,_){var P=I&7,D=I>>>3;return _<<=P,T[D]|=_&255,_>>>=8,T[D+1]=_,I+8}function Ax(T,I,_){var P=I&7,D=I>>>3;return _<<=P,T[D]|=_&255,_>>>=8,T[D+1]=_&255,T[D+2]=_>>>8,I+16}function Qd(T,I){var _=T.length,P=2*_>I?2*_:I+5,D=0;if(_>=I)return T;if(We){var O=ev(P);if(T.copy)T.copy(O);else for(;D<T.length;++D)O[D]=T[D];return O}else if(oe){var Q=new Uint8Array(P);if(Q.set)Q.set(T);else for(;D<_;++D)Q[D]=T[D];return Q}return T.length=P,T}function jn(T){for(var I=new Array(T),_=0;_<T;++_)I[_]=0;return I}function uc(T,I,_){var P=1,D=0,O=0,Q=0,ne=0,q=T.length,J=oe?new Uint16Array(32):jn(32);for(O=0;O<32;++O)J[O]=0;for(O=q;O<_;++O)T[O]=0;q=T.length;var Z=oe?new Uint16Array(q):jn(q);for(O=0;O<q;++O)J[D=T[O]]++,P<D&&(P=D),Z[O]=0;for(J[0]=0,O=1;O<=P;++O)J[O+16]=ne=ne+J[O-1]<<1;for(O=0;O<q;++O)ne=T[O],ne!=0&&(Z[O]=J[ne+16]++);var le=0;for(O=0;O<q;++O)if(le=T[O],le!=0)for(ne=pe(Z[O],P)>>P-le,Q=(1<<P+4-le)-1;Q>=0;--Q)I[ne|Q<<le]=le&15|O<<4;return P}var Jd=oe?new Uint16Array(512):jn(512),Zd=oe?new Uint16Array(32):jn(32);if(!oe){for(var ha=0;ha<512;++ha)Jd[ha]=0;for(ha=0;ha<32;++ha)Zd[ha]=0}(function(){for(var T=[],I=0;I<32;I++)T.push(5);uc(T,Zd,32);var _=[];for(I=0;I<=143;I++)_.push(8);for(;I<=255;I++)_.push(9);for(;I<=279;I++)_.push(7);for(;I<=287;I++)_.push(8);uc(_,Jd,288)})();var vS=function(){for(var I=oe?new Uint8Array(32768):[],_=0,P=0;_<Y.length-1;++_)for(;P<Y[_+1];++P)I[P]=_;for(;P<32768;++P)I[P]=29;var D=oe?new Uint8Array(259):[];for(_=0,P=0;_<H.length-1;++_)for(;P<H[_+1];++P)D[P]=_;function O(ne,q){for(var J=0;J<ne.length;){var Z=Math.min(65535,ne.length-J),le=J+Z==ne.length;for(q.write_shift(1,+le),q.write_shift(2,Z),q.write_shift(2,~Z&65535);Z-- >0;)q[q.l++]=ne[J++]}return q.l}function Q(ne,q){for(var J=0,Z=0,le=oe?new Uint16Array(32768):[];Z<ne.length;){var me=Math.min(65535,ne.length-Z);if(me<10){for(J=gr(q,J,+(Z+me==ne.length)),J&7&&(J+=8-(J&7)),q.l=J/8|0,q.write_shift(2,me),q.write_shift(2,~me&65535);me-- >0;)q[q.l++]=ne[Z++];J=q.l*8;continue}J=gr(q,J,+(Z+me==ne.length)+2);for(var Ne=0;me-- >0;){var de=ne[Z];Ne=(Ne<<5^de)&32767;var ve=-1,ke=0;if((ve=le[Ne])&&(ve|=Z&-32768,ve>Z&&(ve-=32768),ve<Z))for(;ne[ve+ke]==ne[Z+ke]&&ke<250;)++ke;if(ke>2){de=D[ke],de<=22?J=Za(q,J,se[de+1]>>1)-1:(Za(q,J,3),J+=5,Za(q,J,se[de-23]>>5),J+=3);var dt=de<8?0:de-4>>2;dt>0&&(Ax(q,J,ke-H[de]),J+=dt),de=I[Z-ve],J=Za(q,J,se[de]>>3),J-=3;var ft=de<4?0:de-2>>1;ft>0&&(Ax(q,J,Z-ve-Y[de]),J+=ft);for(var Qt=0;Qt<ke;++Qt)le[Ne]=Z&32767,Ne=(Ne<<5^ne[Z])&32767,++Z;me-=ke-1}else de<=143?de=de+48:J=fa(q,J,1),J=Za(q,J,se[de]),le[Ne]=Z&32767,++Z}J=Za(q,J,0)-1}return q.l=(J+7)/8|0,q.l}return function(q,J){return q.length<8?O(q,J):Q(q,J)}}();function Px(T){var I=re(50+Math.floor(T.length*1.1)),_=vS(T,I);return I.slice(0,_)}var Fx=oe?new Uint16Array(32768):jn(32768),Rx=oe?new Uint16Array(32768):jn(32768),Ix=oe?new Uint16Array(128):jn(128),Dx=1,Ox=1;function yS(T,I){var _=ze(T,I)+257;I+=5;var P=ze(T,I)+1;I+=5;var D=Pt(T,I)+4;I+=4;for(var O=0,Q=oe?new Uint8Array(19):jn(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,J=oe?new Uint8Array(8):jn(8),Z=oe?new Uint8Array(8):jn(8),le=Q.length,me=0;me<D;++me)Q[A[me]]=O=Ee(T,I),q<O&&(q=O),J[O]++,I+=3;var Ne=0;for(J[0]=0,me=1;me<=q;++me)Z[me]=Ne=Ne+J[me-1]<<1;for(me=0;me<le;++me)(Ne=Q[me])!=0&&(ne[me]=Z[Ne]++);var de=0;for(me=0;me<le;++me)if(de=Q[me],de!=0){Ne=se[ne[me]]>>8-de;for(var ve=(1<<7-de)-1;ve>=0;--ve)Ix[Ne|ve<<de]=de&7|me<<3}var ke=[];for(q=1;ke.length<_+P;)switch(Ne=Ix[ge(T,I)],I+=Ne&7,Ne>>>=3){case 16:for(O=3+Fe(T,I),I+=2,Ne=ke[ke.length-1];O-- >0;)ke.push(Ne);break;case 17:for(O=3+Ee(T,I),I+=3;O-- >0;)ke.push(0);break;case 18:for(O=11+ge(T,I),I+=7;O-- >0;)ke.push(0);break;default:ke.push(Ne),q<Ne&&(q=Ne);break}var dt=ke.slice(0,_),ft=ke.slice(_);for(me=_;me<286;++me)dt[me]=0;for(me=P;me<30;++me)ft[me]=0;return Dx=uc(dt,Fx,286),Ox=uc(ft,Rx,30),I}function wS(T,I){if(T[0]==3&&!(T[1]&3))return[Wa(I),2];for(var _=0,P=0,D=ev(I||1<<18),O=0,Q=D.length>>>0,ne=0,q=0;!(P&1);){if(P=Ee(T,_),_+=3,P>>>1)P>>1==1?(ne=9,q=5):(_=yS(T,_),ne=Dx,q=Ox);else{_&7&&(_+=8-(_&7));var J=T[_>>>3]|T[(_>>>3)+1]<<8;if(_+=32,J>0)for(!I&&Q<O+J&&(D=Qd(D,O+J),Q=D.length);J-- >0;)D[O++]=T[_>>>3],_+=8;continue}for(;;){!I&&Q<O+32767&&(D=Qd(D,O+32767),Q=D.length);var Z=pr(T,_,ne),le=P>>>1==1?Jd[Z]:Fx[Z];if(_+=le&15,le>>>=4,!(le>>>8&255))D[O++]=le;else{if(le==256)break;le-=257;var me=le<8?0:le-4>>2;me>5&&(me=0);var Ne=O+H[le];me>0&&(Ne+=pr(T,_,me),_+=me),Z=pr(T,_,q),le=P>>>1==1?Zd[Z]:Rx[Z],_+=le&15,le>>>=4;var de=le<4?0:le-2>>1,ve=Y[le];for(de>0&&(ve+=pr(T,_,de),_+=de),!I&&Q<Ne&&(D=Qd(D,Ne+100),Q=D.length);O<Ne;)D[O]=D[O-ve],++O}}}return I?[D,_+7>>>3]:[D.slice(0,O),_+7>>>3]}function Lx(T,I){var _=T.slice(T.l||0),P=wS(_,I);return T.l+=P[1],P[0]}function Mx(T,I){if(T)typeof console<"u"&&console.error(I);else throw new Error(I)}function Bx(T,I){var _=T;Rr(_,0);var P=[],D=[],O={FileIndex:P,FullPaths:D};j(O,{root:I.root});for(var Q=_.length-4;(_[Q]!=80||_[Q+1]!=75||_[Q+2]!=5||_[Q+3]!=6)&&Q>=0;)--Q;_.l=Q+4,_.l+=4;var ne=_.read_shift(2);_.l+=6;var q=_.read_shift(4);for(_.l=q,Q=0;Q<ne;++Q){_.l+=20;var J=_.read_shift(4),Z=_.read_shift(4),le=_.read_shift(2),me=_.read_shift(2),Ne=_.read_shift(2);_.l+=8;var de=_.read_shift(4),ve=l(_.slice(_.l+le,_.l+le+me));_.l+=le+me+Ne;var ke=_.l;_.l=de+4,bS(_,J,Z,O,ve),_.l=ke}return O}function bS(T,I,_,P,D){T.l+=2;var O=T.read_shift(2),Q=T.read_shift(2),ne=o(T);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var q=T.read_shift(4),J=T.read_shift(4),Z=T.read_shift(4),le=T.read_shift(2),me=T.read_shift(2),Ne="",de=0;de<le;++de)Ne+=String.fromCharCode(T[T.l++]);if(me){var ve=l(T.slice(T.l,T.l+me));(ve[21589]||{}).mt&&(ne=ve[21589].mt),((D||{})[21589]||{}).mt&&(ne=D[21589].mt)}T.l+=me;var ke=T.slice(T.l,T.l+J);switch(Q){case 8:ke=G(T,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var dt=!1;O&8&&(q=T.read_shift(4),q==134695760&&(q=T.read_shift(4),dt=!0),J=T.read_shift(4),Z=T.read_shift(4)),J!=I&&Mx(dt,"Bad compressed size: "+I+" != "+J),Z!=_&&Mx(dt,"Bad uncompressed size: "+_+" != "+Z),e0(P,Ne,ke,{unsafe:!0,mt:ne})}function NS(T,I){var _=I||{},P=[],D=[],O=re(1),Q=_.compression?8:0,ne=0,q=0,J=0,Z=0,le=0,me=T.FullPaths[0],Ne=me,de=T.FileIndex[0],ve=[],ke=0;for(q=1;q<T.FullPaths.length;++q)if(Ne=T.FullPaths[q].slice(me.length),de=T.FileIndex[q],!(!de.size||!de.content||Ne=="Sh33tJ5")){var dt=Z,ft=re(Ne.length);for(J=0;J<Ne.length;++J)ft.write_shift(1,Ne.charCodeAt(J)&127);ft=ft.slice(0,ft.l),ve[le]=IR.buf(de.content,0);var Qt=de.content;Q==8&&(Qt=U(Qt)),O=re(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,ne),O.write_shift(2,Q),de.mt?i(O,de.mt):O.write_shift(4,0),O.write_shift(-4,ve[le]),O.write_shift(4,Qt.length),O.write_shift(4,de.content.length),O.write_shift(2,ft.length),O.write_shift(2,0),Z+=O.length,P.push(O),Z+=ft.length,P.push(ft),Z+=Qt.length,P.push(Qt),O=re(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,ne),O.write_shift(2,Q),O.write_shift(4,0),O.write_shift(-4,ve[le]),O.write_shift(4,Qt.length),O.write_shift(4,de.content.length),O.write_shift(2,ft.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,dt),ke+=O.l,D.push(O),ke+=ft.length,D.push(ft),++le}return O=re(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,le),O.write_shift(2,le),O.write_shift(4,ke),O.write_shift(4,Z),O.write_shift(2,0),zt([zt(P),zt(D),O])}var dc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function SS(T,I){if(T.ctype)return T.ctype;var _=T.name||"",P=_.match(/\.([^\.]+)$/);return P&&dc[P[1]]||I&&(P=(_=I).match(/[\.\\]([^\.\\])+$/),P&&dc[P[1]])?dc[P[1]]:"application/octet-stream"}function jS(T){for(var I=Ol(T),_=[],P=0;P<I.length;P+=76)_.push(I.slice(P,P+76));return _.join(`\r
`)+`\r
`}function TS(T){var I=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(J){var Z=J.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],P=I.split(`\r
`),D=0;D<P.length;++D){var O=P[D];if(O.length==0){_.push("");continue}for(var Q=0;Q<O.length;){var ne=76,q=O.slice(Q,Q+ne);q.charAt(ne-1)=="="?ne--:q.charAt(ne-2)=="="?ne-=2:q.charAt(ne-3)=="="&&(ne-=3),q=O.slice(Q,Q+ne),Q+=ne,Q<O.length&&(q+="="),_.push(q)}}return _.join(`\r
`)}function ES(T){for(var I=[],_=0;_<T.length;++_){for(var P=T[_];_<=T.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+T[++_];I.push(P)}for(var D=0;D<I.length;++D)I[D]=I[D].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return pn(I.join(`\r
`))}function CS(T,I,_){for(var P="",D="",O="",Q,ne=0;ne<10;++ne){var q=I[ne];if(!q||q.match(/^\s*$/))break;var J=q.match(/^(.*?):\s*([^\s].*)$/);if(J)switch(J[1].toLowerCase()){case"content-location":P=J[2].trim();break;case"content-type":O=J[2].trim();break;case"content-transfer-encoding":D=J[2].trim();break}}switch(++ne,D.toLowerCase()){case"base64":Q=pn(hs(I.slice(ne).join("")));break;case"quoted-printable":Q=ES(I.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var Z=e0(T,P.slice(_.length),Q,{unsafe:!0});O&&(Z.ctype=O)}function kS(T,I){if(te(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=I&&I.root||"",P=(We&&Buffer.isBuffer(T)?T.toString("binary"):te(T)).split(`\r
`),D=0,O="";for(D=0;D<P.length;++D)if(O=P[D],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),_||(_=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),O.slice(0,_.length)!=_););var Q=(P[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var ne="--"+(Q[1]||""),q=[],J=[],Z={FileIndex:q,FullPaths:J};j(Z);var le,me=0;for(D=0;D<P.length;++D){var Ne=P[D];Ne!==ne&&Ne!==ne+"--"||(me++&&CS(Z,P.slice(le,D),_),le=D)}return Z}function _S(T,I){var _=I||{},P=_.boundary||"SheetJS";P="------="+P;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],O=T.FullPaths[0],Q=O,ne=T.FileIndex[0],q=1;q<T.FullPaths.length;++q)if(Q=T.FullPaths[q].slice(O.length),ne=T.FileIndex[q],!(!ne.size||!ne.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ke){return"_x"+ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ke){return"_u"+ke.charCodeAt(0).toString(16)+"_"});for(var J=ne.content,Z=We&&Buffer.isBuffer(J)?J.toString("binary"):te(J),le=0,me=Math.min(1024,Z.length),Ne=0,de=0;de<=me;++de)(Ne=Z.charCodeAt(de))>=32&&Ne<128&&++le;var ve=le>=me*4/5;D.push(P),D.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+Q),D.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),D.push("Content-Type: "+SS(ne,Q)),D.push(""),D.push(ve?TS(Z):jS(Z))}return D.push(P+`--\r
`),D.join(`\r
`)}function AS(T){var I={};return j(I,T),I}function e0(T,I,_,P){var D=P&&P.unsafe;D||j(T);var O=!D&&Ze.find(T,I);if(!O){var Q=T.FullPaths[0];I.slice(0,Q.length)==Q?Q=I:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+I).replace("//","/")),O={name:s(I),type:2},T.FileIndex.push(O),T.FullPaths.push(Q),D||Ze.utils.cfb_gc(T)}return O.content=_,O.size=_?_.length:0,P&&(P.CLSID&&(O.clsid=P.CLSID),P.mt&&(O.mt=P.mt),P.ct&&(O.ct=P.ct)),O}function PS(T,I){j(T);var _=Ze.find(T,I);if(_){for(var P=0;P<T.FileIndex.length;++P)if(T.FileIndex[P]==_)return T.FileIndex.splice(P,1),T.FullPaths.splice(P,1),!0}return!1}function FS(T,I,_){j(T);var P=Ze.find(T,I);if(P){for(var D=0;D<T.FileIndex.length;++D)if(T.FileIndex[D]==P)return T.FileIndex[D].name=s(_),T.FullPaths[D]=_,!0}return!1}function RS(T){k(T,!0)}return t.find=M,t.read=C,t.parse=d,t.write=ue,t.writeFile=V,t.utils={cfb_new:AS,cfb_add:e0,cfb_del:PS,cfb_mov:FS,cfb_gc:RS,ReadShift:ol,CheckField:d4,prep_blob:Rr,bconcat:zt,use_zlib:L,_deflateRaw:Px,_inflateRaw:Lx,consts:ee},t}();function DR(e){return typeof e=="string"?Hd(e):Array.isArray(e)?oR(e):e}function ac(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ml(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([DR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=sc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function lv(e,t){for(var r=[],n=qt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function ux(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Gd(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function OR(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Zu=new Date(1899,11,30,0,0,0);function kr(e,t){var r=e.getTime(),n=Zu.getTime()+(e.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var YN=new Date,LR=Zu.getTime()+(YN.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4,cv=YN.getTimezoneOffset();function XN(e){var t=new Date;return t.setTime(e*24*60*60*1e3+LR),t.getTimezoneOffset()!==cv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-cv)*6e4),t}var uv=new Date("2017-02-19T19:06:09.000Z"),qN=isNaN(uv.getFullYear())?new Date("2/19/17"):uv,MR=qN.getFullYear()==2017;function fr(e,t){var r=new Date(e);if(MR)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(qN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Kd(e,t){if(We&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function _r(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_r(e[r]));return t}function yt(e,t){for(var r="";r.length<t;)r+=e;return r}function ns(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var BR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ll(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&BR.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ie(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return We?n=ps(r):n=lR(r),Ze.utils.cfb_add(e,t,n)}Ze.utils.cfb_add(e,t,r)}else e.file(t,r)}function dx(){return Ze.utils.cfb_new()}var At=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,UR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fx=ux(UR),hx=/[&<>'"]/g,$R=/[\u0000-\u0008\u000b-\u001f]/g;function Xe(e){var t=e+"";return t.replace(hx,function(r){return fx[r]}).replace($R,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function dv(e){return Xe(e).replace(/ /g,"_x0020_")}var QN=/[\u0000-\u001f]/g;function WR(e){var t=e+"";return t.replace(hx,function(r){return fx[r]}).replace(/\n/g,"<br/>").replace(QN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function HR(e){var t=e+"";return t.replace(hx,function(r){return fx[r]}).replace(QN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function VR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function zR(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q0(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function fv(e){var t=Wa(2*e.length),r,n,s=1,i=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function hv(e){return ps(e,"binary").toString("utf8")}var $c="foo bar baz",il=We&&(hv($c)==Q0($c)&&hv||fv($c)==Q0($c)&&fv)||Q0,Ml=We?function(e){return ps(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},GR=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),JN=/(^\s|\s$|\n)/;function Gt(e,t){return"<"+e+(t.match(JN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bl(e){return qt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function fe(e,t,r){return"<"+e+(r!=null?Bl(r):"")+(t!=null?(t.match(JN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ih(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function KR(e,t){switch(typeof e){case"string":var r=fe("vt:lpwstr",Xe(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return fe((e|0)==e?"vt:i4":"vt:r8",Xe(String(e)));case"boolean":return fe("vt:bool",e?"true":"false")}if(e instanceof Date)return fe("vt:filetime",Ih(e));throw new Error("Unable to serialize "+e)}var Lt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},No=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Dr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function YR(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function XR(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=n?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var mv=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},xv=We?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ps(t)})):mv(e)}:mv,pv=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Yo(e,s)));return n.join("").replace(al,"")},mx=We?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(al,""):pv(e,t,r)}:pv,gv=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},ZN=We?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gv(e,t,r)}:gv,vv=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(li(e,s)));return n.join("")},ic=We?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):vv(t,r,n)}:vv,e4=function(e,t){var r=Or(e,t);return r>0?ic(e,t+4,t+4+r-1):""},t4=e4,r4=function(e,t){var r=Or(e,t);return r>0?ic(e,t+4,t+4+r-1):""},n4=r4,s4=function(e,t){var r=2*Or(e,t);return r>0?ic(e,t+4,t+4+r-1):""},a4=s4,i4=function(t,r){var n=Or(t,r);return n>0?mx(t,r+4,r+4+n):""},o4=i4,l4=function(e,t){var r=Or(e,t);return r>0?ic(e,t+4,t+4+r):""},c4=l4,u4=function(e,t){return YR(e,t)},ed=u4,xx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};We&&(t4=function(t,r){if(!Buffer.isBuffer(t))return e4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},n4=function(t,r){if(!Buffer.isBuffer(t))return r4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},a4=function(t,r){if(!Buffer.isBuffer(t))return s4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},o4=function(t,r){if(!Buffer.isBuffer(t))return i4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},c4=function(t,r){if(!Buffer.isBuffer(t))return l4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ed=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):u4(t,r)},xx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var li=function(e,t){return e[t]},Yo=function(e,t){return e[t+1]*256+e[t]},qR=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Or=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ya=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},QR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ol(e,t){var r="",n,s,i=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,We&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Yo(this,u)),u+=2;e*=2;break;case"utf8":r=ic(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mx(this,this.l,this.l+e);break;case"wstr":return ol.call(this,e,"dbcs");case"lpstr-ansi":r=t4(this,this.l),e=4+Or(this,this.l);break;case"lpstr-cp":r=n4(this,this.l),e=4+Or(this,this.l);break;case"lpwstr":r=a4(this,this.l),e=4+2*Or(this,this.l);break;case"lpp4":e=4+Or(this,this.l),r=o4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Or(this,this.l),r=c4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=li(this,this.l+e++))!==0;)i.push(Mc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Yo(this,this.l+e))!==0;)i.push(Mc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=li(this,u),this.l=u+1,l=ol.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Mc(Yo(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=li(this,u),this.l=u+1,l=ol.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Mc(li(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=li(this,this.l),this.l++,n;case 2:return n=(t==="i"?qR:Yo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ya:QR)(this,this.l),this.l+=4,n):(s=Or(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=ed(this,this.l):s=ed([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=ZN(this,this.l,e);break}}return this.l+=e,r}var JR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ZR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},eI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function tI(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)eI(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,JR(this,t,this.l);break;case 8:if(n=8,r==="f"){XR(this,t,this.l);break}case 16:break;case-4:n=4,ZR(this,t,this.l);break}return this.l+=n,this}function d4(e,t){var r=ZN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Rr(e,t){e.l=t,e.read_shift=ol,e.chk=d4,e.write_shift=tI}function Hn(e,t){e.l+=t}function re(e){var t=Wa(e);return Rr(t,0),t}function Er(){var e=[],t=We?256:2048,r=function(u){var d=re(u);return Rr(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),zt(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ie(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=YL[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&xx(r)&&e.push(r)}}function ll(e,t,r){var n=_r(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yv(e,t,r){var n=_r(e);return n.s=ll(n.s,t.s,r),n.e=ll(n.e,t.s,r),n}function cl(e,t){if(e.cRel&&e.c<0)for(e=_r(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_r(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Qe(e);return!e.cRel&&e.cRel!=null&&(r=sI(r)),!e.rRel&&e.rRel!=null&&(r=rI(r)),r}function J0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+rr(e.s.c)+":"+(e.e.cRel?"":"$")+rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yt(e.s.r)+":"+(e.e.rRel?"":"$")+Yt(e.e.r):cl(e.s,t.biff)+":"+cl(e.e,t.biff)}function px(e){return parseInt(nI(e),10)-1}function Yt(e){return""+(e+1)}function rI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nI(e){return e.replace(/\$(\d+)$/,"$1")}function gx(e){for(var t=aI(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function rr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sI(e){return e.replace(/^([A-Z])/,"$$$1")}function aI(e){return e.replace(/^\$([A-Z])/,"$1")}function iI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $r(e){var t=e.indexOf(":");return t==-1?{s:Mt(e),e:Mt(e)}:{s:Mt(e.slice(0,t)),e:Mt(e.slice(t+1))}}function _t(e,t){return typeof t>"u"||typeof t=="number"?_t(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof t!="string"&&(t=Qe(t)),e==t?e:e+":"+t)}function ot(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function wv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ta(e.z,r?kr(t):t)}catch{}try{return e.w=ta((e.XF||{}).numFmtId||(r?14:0),r?kr(t):t)}catch{return""+t}}function ms(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?oc[e.v]||e.v:t==null?wv(e,e.v):wv(e,t))}function Ya(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function f4(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=ot(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var p={v:t[m][f]},x=o+m,h=l+f;if(u.s.r>x&&(u.s.r=x),u.s.c>h&&(u.s.c=h),u.e.r<x&&(u.e.r=x),u.e.c<h&&(u.e.c=h),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))p=t[m][f];else if(Array.isArray(p.v)&&(p.f=t[m][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||wt[14],n.cellDates?(p.t="d",p.w=ta(p.z,kr(p.v))):(p.t="n",p.v=kr(p.v),p.w=ta(p.z,p.v))):p.t="s";if(s)i[x]||(i[x]=[]),i[x][h]&&i[x][h].z&&(p.z=i[x][h].z),i[x][h]=p;else{var g=Qe({c:h,r:x});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return u.s.c<1e7&&(i["!ref"]=_t(u)),i}function So(e,t){return f4(null,e,t)}function oI(e){return e.read_shift(4,"i")}function wn(e,t){return t||(t=re(4)),t.write_shift(4,e),t}function nr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Bt(e,t){var r=!1;return t==null&&(r=!0,t=re(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function lI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function cI(e,t){return t||(t=re(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vx(e,t){var r=e.l,n=e.read_shift(1),s=nr(e),i=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(lI(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function uI(e,t){var r=!1;return t==null&&(r=!0,t=re(15+4*e.t.length)),t.write_shift(1,0),Bt(e.t,t),r?t.slice(0,t.l):t}var dI=vx;function fI(e,t){var r=!1;return t==null&&(r=!0,t=re(23+4*e.t.length)),t.write_shift(1,1),Bt(e.t,t),t.write_shift(4,1),cI({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function tn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Xa(e,t){return t==null&&(t=re(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qa(e,t){return t==null&&(t=re(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var hI=nr,h4=Bt;function yx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function td(e,t){var r=!1;return t==null&&(r=!0,t=re(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var mI=nr,Dh=yx,wx=td;function m4(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?ed([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ya(t,0)>>2;return r?s/100:s}function x4(e,t){t==null&&(t=re(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function p4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function xI(e,t){return t||(t=re(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ja=p4,jo=xI;function To(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ha(e,t){return(t||re(8)).write_shift(8,e,"f")}function pI(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=TI[s];u&&(t.rgb=Pv(u));break;case 2:t.rgb=Pv([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function rd(e,t){if(t||(t=re(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function gI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function vI(e,t){t||(t=re(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var g4=2,Pr=3,Wc=11,nd=19,Hc=64,yI=65,wI=71,bI=4108,NI=4126,Vt=80,bv={1:{n:"CodePage",t:g4},2:{n:"Category",t:Vt},3:{n:"PresentationFormat",t:Vt},4:{n:"ByteCount",t:Pr},5:{n:"LineCount",t:Pr},6:{n:"ParagraphCount",t:Pr},7:{n:"SlideCount",t:Pr},8:{n:"NoteCount",t:Pr},9:{n:"HiddenCount",t:Pr},10:{n:"MultimediaClipCount",t:Pr},11:{n:"ScaleCrop",t:Wc},12:{n:"HeadingPairs",t:bI},13:{n:"TitlesOfParts",t:NI},14:{n:"Manager",t:Vt},15:{n:"Company",t:Vt},16:{n:"LinksUpToDate",t:Wc},17:{n:"CharacterCount",t:Pr},19:{n:"SharedDoc",t:Wc},22:{n:"HyperlinksChanged",t:Wc},23:{n:"AppVersion",t:Pr,p:"version"},24:{n:"DigSig",t:yI},26:{n:"ContentType",t:Vt},27:{n:"ContentStatus",t:Vt},28:{n:"Language",t:Vt},29:{n:"Version",t:Vt},255:{},2147483648:{n:"Locale",t:nd},2147483651:{n:"Behavior",t:nd},1919054434:{}},Nv={1:{n:"CodePage",t:g4},2:{n:"Title",t:Vt},3:{n:"Subject",t:Vt},4:{n:"Author",t:Vt},5:{n:"Keywords",t:Vt},6:{n:"Comments",t:Vt},7:{n:"Template",t:Vt},8:{n:"LastAuthor",t:Vt},9:{n:"RevNumber",t:Vt},10:{n:"EditTime",t:Hc},11:{n:"LastPrinted",t:Hc},12:{n:"CreatedDate",t:Hc},13:{n:"ModifiedDate",t:Hc},14:{n:"PageCount",t:Pr},15:{n:"WordCount",t:Pr},16:{n:"CharCount",t:Pr},17:{n:"Thumbnail",t:wI},18:{n:"Application",t:Vt},19:{n:"DocSecurity",t:Pr},255:{},2147483648:{n:"Locale",t:nd},2147483651:{n:"Behavior",t:nd},1919054434:{}};function SI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var jI=SI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),TI=_r(jI),oc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},EI={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function v4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function y4(e,t){var r=OR(EI),n=[],s;n[n.length]=At,n[n.length]=fe("Types",null,{xmlns:Lt.CT,"xmlns:xsd":Lt.xsd,"xmlns:xsi":Lt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return fe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=fe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Vc[c][t.bookType]||Vc[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=fe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Vc[c][t.bookType]||Vc[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=fe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $e={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function w4(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Oi(e){var t=[At,fe("Relationships",null,{xmlns:Lt.RELS})];return qt(e["!id"]).forEach(function(r){t[t.length]=fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ye(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[$e.HLINK,$e.XPATH,$e.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function CI(e){var t=[At];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Sv(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function kI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function _I(e){var t=[At];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Sv(e[r][0],e[r][1])),t.push(kI("",e[r][0]));return t.push(Sv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function b4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xu.version+"</meta:generator></office:meta></office:document-meta>"}var Fa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Z0(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Xe(t),n[n.length]=r?fe(e,t,r):Gt(e,t))}function N4(e,t){var r=t||{},n=[At,fe("cp:coreProperties",null,{"xmlns:cp":Lt.CORE_PROPS,"xmlns:dc":Lt.dc,"xmlns:dcterms":Lt.dcterms,"xmlns:dcmitype":Lt.dcmitype,"xmlns:xsi":Lt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Z0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ih(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Z0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ih(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Fa.length;++i){var o=Fa[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Z0(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Li=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],S4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function j4(e){var t=[],r=fe;return e||(e={}),e.Application="SheetJS",t[t.length]=At,t[t.length]=fe("Properties",null,{xmlns:Lt.EXT_PROPS,"xmlns:vt":Lt.vt}),Li.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Xe(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Xe(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function T4(e){var t=[At,fe("Properties",null,{xmlns:Lt.CUST_PROPS,"xmlns:vt":Lt.vt})];if(!e)return t.join("");var r=1;return qt(e).forEach(function(s){++r,t[t.length]=fe("property",KR(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xe(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var jv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function AI(e,t){var r=[];return qt(jv).map(function(n){for(var s=0;s<Fa.length;++s)if(Fa[s][1]==n)return Fa[s];for(s=0;s<Li.length;++s)if(Li[s][1]==n)return Li[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Gt(jv[n[1]]||n[1],s))}}),fe("DocumentProperties",r.join(""),{xmlns:Dr.o})}function PI(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&qt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Fa.length;++o)if(i==Fa[o][1])return;for(o=0;o<Li.length;++o)if(i==Li[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(fe(dv(i),l,{"dt:dt":c}))}}),t&&qt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(fe(dv(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Dr.o+'">'+s.join("")+"</"+n+">"}function FI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=re(8);return o.write_shift(4,n),o.write_shift(4,s),o}function Tv(e,t){var r=re(4),n=re(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=re(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=FI(t);break;case 31:case 80:for(n=re(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return zt([r,n])}var E4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ev(e,t,r){var n=re(8),s=[],i=[],o=8,l=0,c=re(8),u=re(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),o+=8+c.length,!t){u=re(8),u.write_shift(4,0),s.unshift(u);var d=[re(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=re(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=zt(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(E4.indexOf(e[l][0])>-1||S4.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],p=0;if(t){p=+t[e[l][0]];var x=r[p];if(x.p=="version"&&typeof f=="string"){var h=f.split(".");f=(+h[0]<<16)+(+h[1]||0)}c=Tv(x.t,f)}else{var g=RI(f);g==-1&&(g=31,f=String(f)),c=Tv(g,f)}i.push(c),u=re(8),u.write_shift(4,t?p:2+l),s.push(u),o+=8+c.length}var w=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,w),w+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),zt([n].concat(s).concat(i))}function Cv(e,t,r,n,s,i){var o=re(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=Ev(e,r,n);if(l.push(c),s){var u=Ev(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return zt(l)}function II(e,t){t||(t=re(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function DI(e,t){return e.read_shift(t)===1}function ur(e,t){return t||(t=re(2)),t.write_shift(2,+!!e),t}function C4(e){return e.read_shift(2,"u")}function Kr(e,t){return t||(t=re(2)),t.write_shift(2,e),t}function k4(e,t,r){return r||(r=re(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function _4(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function OI(e){var t=e.t||"",r=re(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=re(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return zt(s)}function LI(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function MI(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):LI(e,n,r)}function BI(e,t,r){if(r.biff>5)return MI(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function A4(e,t,r){return r||(r=re(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function kv(e,t){t||(t=re(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function UI(e){var t=re(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),kv(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&kv(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Va(e,t,r,n){return n||(n=re(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function $I(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,i,o]}function WI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function P4(e,t){return t||(t=re(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bx(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=re(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function HI(e,t){var r=!t||t.biff==8,n=re(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function VI(e,t){var r=!t||t.biff>=8?2:1,n=re(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function zI(e,t){var r=re(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=OI(e[s]);var i=zt([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function GI(){var e=re(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function KI(e){var t=re(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function YI(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=re(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function XI(e,t,r,n){var s=re(10);return Va(e,t,n,s),s.write_shift(4,r),s}function qI(e,t,r,n,s){var i=!s||s.biff==8,o=re(8+ +i+(1+i)*r.length);return Va(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function QI(e,t,r,n){var s=r&&r.biff==5;n||(n=re(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function JI(e,t){var r=t.biff==8||!t.biff?4:2,n=re(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function _v(e,t,r,n){var s=r&&r.biff==5;n||(n=re(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function ZI(e){var t=re(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function eD(e,t,r,n,s,i){var o=re(8);return Va(e,t,n,o),k4(r,i,o),o}function tD(e,t,r,n){var s=re(14);return Va(e,t,n,s),Ha(r,s),s}function rD(e,t,r){if(r.biff<8)return nD(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push($I(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function nD(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=_4(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function sD(e){var t=re(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)P4(e[r],t);return t}function aD(e){var t=re(24),r=Mt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return zt([t,UI(e[1])])}function iD(e){var t=e[1].Tooltip,r=re(10+2*(t.length+1));r.write_shift(2,2048);var n=Mt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function oD(e){return e||(e=re(4)),e.write_shift(2,1),e.write_shift(2,1),e}function lD(e,t,r){if(!r.cellStyles)return Hn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function cD(e,t){var r=re(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function uD(e){for(var t=re(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function dD(e,t,r){var n=re(15);return cc(n,e,t),n.write_shift(8,r,"f"),n}function fD(e,t,r){var n=re(9);return cc(n,e,t),n.write_shift(2,r),n}var hD=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ux({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Wa(1);switch(c.type){case"base64":d=pn(hs(l));break;case"binary":d=pn(l);break;case"buffer":case"array":d=l;break}Rr(d,0);var m=d.read_shift(1),f=!!(m&136),p=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var h=0,g=521;m==2&&(h=d.read_shift(2)),d.l+=3,m!=2&&(h=d.read_shift(4)),h>1048576&&(h=1e6),m!=2&&(g=d.read_shift(2));var w=d.read_shift(2),v=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],N={},S=Math.min(d.length,m==2?521:g-10-(p?264:0)),C=x?32:11;d.l<S&&d[d.l]!=13;)switch(N={},N.name=va.utils.decode(v,d.slice(d.l,d.l+C)).replace(/[\u0000\r\n].*$/g,""),d.l+=C,N.type=String.fromCharCode(d.read_shift(1)),m!=2&&!x&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),m==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&y.push(N),m!=2&&(d.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var j=0,E=0;for(u[0]=[],E=0;E!=y.length;++E)u[0][E]=y[E].name;for(;h-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++j]=[],E=0,E=0;E!=y.length;++E){var k=d.slice(d.l,d.l+y[E].len);d.l+=y[E].len,Rr(k,0);var F=va.utils.decode(v,k);switch(y[E].type){case"C":F.trim().length&&(u[j][E]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[j][E]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[j][E]=F;break;case"F":u[j][E]=parseFloat(F.trim());break;case"+":case"I":u[j][E]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[j][E]=!0;break;case"N":case"F":u[j][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[j][E]="##MEMO##"+(x?parseInt(F.trim(),10):k.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[j][E]=+F||0);break;case"@":u[j][E]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[j][E]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[j][E]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[j][E]=-k.read_shift(-8,"f");break;case"B":if(p&&y[E].len==8){u[j][E]=k.read_shift(8,"f");break}case"G":case"P":k.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=So(r(l,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function s(l,c){try{return Ya(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Dl(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Er(),m=ld(l,{header:1,raw:!0,cellDates:!0}),f=m[0],p=m.slice(1),x=l["!cols"]||[],h=0,g=0,w=0,v=1;for(h=0;h<f.length;++h){if(((x[h]||{}).DBF||{}).name){f[h]=x[h].DBF.name,++w;continue}if(f[h]!=null){if(++w,typeof f[h]=="number"&&(f[h]=f[h].toString(10)),typeof f[h]!="string")throw new Error("DBF Invalid column name "+f[h]+" |"+typeof f[h]+"|");if(f.indexOf(f[h])!==h){for(g=0;g<1024;++g)if(f.indexOf(f[h]+"_"+g)==-1){f[h]+="_"+g;break}}}}var y=ot(l["!ref"]),N=[],S=[],C=[];for(h=0;h<=y.e.c-y.s.c;++h){var j="",E="",k=0,F=[];for(g=0;g<p.length;++g)p[g][h]!=null&&F.push(p[g][h]);if(F.length==0||f[h]==null){N[h]="?";continue}for(g=0;g<F.length;++g){switch(typeof F[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=F[g]instanceof Date?"D":"C";break;default:E="C"}k=Math.max(k,String(F[g]).length),j=j&&j!=E?"C":E}k>250&&(k=250),E=((x[h]||{}).DBF||{}).type,E=="C"&&x[h].DBF.len>k&&(k=x[h].DBF.len),j=="B"&&E=="N"&&(j="N",C[h]=x[h].DBF.dec,k=x[h].DBF.len),S[h]=j=="C"||E=="N"?k:i[j]||0,v+=S[h],N[h]=j}var M=d.next(32);for(M.write_shift(4,318902576),M.write_shift(4,p.length),M.write_shift(2,296+32*w),M.write_shift(2,v),h=0;h<4;++h)M.write_shift(4,0);for(M.write_shift(4,0|(+t[RN]||3)<<8),h=0,g=0;h<f.length;++h)if(f[h]!=null){var R=d.next(32),z=(f[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,z,"sbcs"),R.write_shift(1,N[h]=="?"?"C":N[h],"sbcs"),R.write_shift(4,g),R.write_shift(1,S[h]||i[N[h]]||0),R.write_shift(1,C[h]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),g+=S[h]||i[N[h]]||0}var B=d.next(264);for(B.write_shift(4,13),h=0;h<65;++h)B.write_shift(4,0);for(h=0;h<p.length;++h){var K=d.next(v);for(K.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(N[g]){case"L":K.write_shift(1,p[h][g]==null?63:p[h][g]?84:70);break;case"B":K.write_shift(8,p[h][g]||0,"f");break;case"N":var X="0";for(typeof p[h][g]=="number"&&(X=p[h][g].toFixed(C[g]||0)),w=0;w<S[g]-X.length;++w)K.write_shift(1,32);K.write_shift(1,X,"sbcs");break;case"D":p[h][g]?(K.write_shift(4,("0000"+p[h][g].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(p[h][g].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+p[h][g].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(p[h][g]!=null?p[h][g]:"").slice(0,S[g]);for(K.write_shift(1,ee,"sbcs"),w=0;w<S[g]-ee.length;++w)K.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),mD=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+qt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var x=e[p];return typeof x=="number"?Zg(x):x},n=function(f,p,x){var h=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return h==59?f:Zg(h)};e["|"]=254;function s(f,p){switch(p.type){case"base64":return i(hs(f),p);case"binary":return i(f,p);case"buffer":return i(We&&Buffer.isBuffer(f)?f.toString("binary"):sc(f),p);case"array":return i(Kd(f),p)}throw new Error("Unrecognized type "+p.type)}function i(f,p){var x=f.split(/[\n\r]+/),h=-1,g=-1,w=0,v=0,y=[],N=[],S=null,C={},j=[],E=[],k=[],F=0,M;for(+p.codepage>=0&&Dl(+p.codepage);w!==x.length;++w){F=0;var R=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=R.replace(/;;/g,"\0").split(";").map(function(A){return A.replace(/\u0000/g,";")}),B=z[0],K;if(R.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&N.push(R.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,ee=!1,V=!1,te=!1,ue=-1,xe=-1;for(v=1;v<z.length;++v)switch(z[v].charAt(0)){case"A":break;case"X":g=parseInt(z[v].slice(1))-1,ee=!0;break;case"Y":for(h=parseInt(z[v].slice(1))-1,ee||(g=0),M=y.length;M<=h;++M)y[M]=[];break;case"K":K=z[v].slice(1),K.charAt(0)==='"'?K=K.slice(1,K.length-1):K==="TRUE"?K=!0:K==="FALSE"?K=!1:isNaN(ns(K))?isNaN(Ll(K).getDate())||(K=fr(K)):(K=ns(K),S!==null&&zN(S)&&(K=XN(K))),X=!0;break;case"E":te=!0;var L=fO(z[v].slice(1),{r:h,c:g});y[h][g]=[y[h][g],L];break;case"S":V=!0,y[h][g]=[y[h][g],"S5S"];break;case"G":break;case"R":ue=parseInt(z[v].slice(1))-1;break;case"C":xe=parseInt(z[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(X&&(y[h][g]&&y[h][g].length==2?y[h][g][0]=K:y[h][g]=K,S=null),V){if(te)throw new Error("SYLK shared formula cannot have own formula");var G=ue>-1&&y[ue][xe];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");y[h][g][1]=hO(G[1],{r:h-ue,c:g-xe})}break;case"F":var U=0;for(v=1;v<z.length;++v)switch(z[v].charAt(0)){case"X":g=parseInt(z[v].slice(1))-1,++U;break;case"Y":for(h=parseInt(z[v].slice(1))-1,M=y.length;M<=h;++M)y[M]=[];break;case"M":F=parseInt(z[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=N[parseInt(z[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=z[v].slice(1).split(" "),M=parseInt(k[0],10);M<=parseInt(k[1],10);++M)F=parseInt(k[2],10),E[M-1]=F===0?{hidden:!0}:{wch:F},Nx(E[M-1]);break;case"C":g=parseInt(z[v].slice(1))-1,E[g]||(E[g]={});break;case"R":h=parseInt(z[v].slice(1))-1,j[h]||(j[h]={}),F>0?(j[h].hpt=F,j[h].hpx=O4(F)):F===0&&(j[h].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}U<1&&(S=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return j.length>0&&(C["!rows"]=j),E.length>0&&(C["!cols"]=E),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,C]}function o(f,p){var x=s(f,p),h=x[0],g=x[1],w=So(h,p);return qt(g).forEach(function(v){w[v]=g[v]}),w}function l(f,p){return Ya(o(f,p),p)}function c(f,p,x,h){var g="C;Y"+(x+1)+";X"+(h+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+jx(f.f,{r:x,c:h}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,p){p.forEach(function(x,h){var g="F;W"+(h+1)+" "+(h+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=sd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ad(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,p){p.forEach(function(x,h){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*id(x.hpx)+";"),g.length>2&&f.push(g+"R"+(h+1))})}function m(f,p){var x=["ID;PWXL;N;E"],h=[],g=ot(f["!ref"]),w,v=Array.isArray(f),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),f["!cols"]&&u(x,f["!cols"]),f["!rows"]&&d(x,f["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var S=g.s.c;S<=g.e.c;++S){var C=Qe({r:N,c:S});w=v?(f[N]||[])[S]:f[C],!(!w||w.v==null&&(!w.f||w.F))&&h.push(c(w,f,N,S))}return x.join(y)+y+h.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),xD=function(){function e(i,o){switch(o.type){case"base64":return t(hs(i),o);case"binary":return t(i,o);case"buffer":return t(We&&Buffer.isBuffer(i)?i.toString("binary"):sc(i),o);case"array":return t(Kd(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,u=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var f=l[d].trim().split(","),p=f[0],x=f[1];++d;for(var h=l[d]||"";(h.match(/["]/g)||[]).length&1&&d<l.length-1;)h+=`
`+l[++d];switch(h=h.trim(),+p){case-1:if(h==="BOT"){m[++c]=[],u=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?m[c][u]=!0:h==="FALSE"?m[c][u]=!1:isNaN(ns(x))?isNaN(Ll(x).getDate())?m[c][u]=x:m[c][u]=fr(x):m[c][u]=ns(x),++u;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),m[c][u++]=h!==""?h:null;break}if(h==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return So(e(i,o),o)}function n(i,o){return Ya(r(i,o),o)}var s=function(){var i=function(c,u,d,m,f){c.push(u),c.push(d+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=ot(c["!ref"]),m,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){o(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var h=Qe({r:p,c:x});if(m=f?(c[p]||[])[x]:c[h],!m){o(u,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?o(u,1,0,"="+m.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=ta(m.z||wt[14],kr(fr(m.v)))),o(u,0,m.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),F4=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var p=m.split(`
`),x=-1,h=-1,g=0,w=[];g!==p.length;++g){var v=p[g].trim().split(":");if(v[0]==="cell"){var y=Mt(v[1]);if(w.length<=y.r)for(x=w.length;x<=y.r;++x)w[x]||(w[x]=[]);switch(x=y.r,h=y.c,v[2]){case"t":w[x][h]=e(v[3]);break;case"v":w[x][h]=+v[3];break;case"vtf":var N=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[x][h]=!!+v[4];break;default:w[x][h]=+v[4];break}v[2]=="vtf"&&(w[x][h]=[w[x][h],N])}}}return f&&f.sheetRows&&(w=w.slice(0,f.sheetRows)),w}function n(m,f){return So(r(m,f),f)}function s(m,f){return Ya(n(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var f=[],p=[],x,h="",g=$r(m["!ref"]),w=Array.isArray(m),v=g.s.r;v<=g.e.r;++v)for(var y=g.s.c;y<=g.e.c;++y)if(h=Qe({r:v,c:y}),x=w?(m[v]||[])[y]:m[h],!(!x||x.v==null||x.t==="z")){switch(p=["cell",h,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=kr(fr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||ta(x.z||wt[14],N);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(m){return[i,o,l,o,u(m),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),pD=function(){function e(d,m,f,p,x){x.raw?m[f][p]=d:d===""||(d==="TRUE"?m[f][p]=!0:d==="FALSE"?m[f][p]=!1:isNaN(ns(d))?isNaN(Ll(d).getDate())?m[f][p]=d:m[f][p]=fr(d):m[f][p]=ns(d))}function t(d,m){var f=m||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),h=x.length-1;h>=0&&x[h].length===0;)--h;for(var g=10,w=0,v=0;v<=h;++v)w=x[v].indexOf(" "),w==-1?w=x[v].length:w++,g=Math.max(g,w);for(v=0;v<=h;++v){p[v]=[];var y=0;for(e(x[v].slice(0,g).trim(),p,v,y,f),y=1;y<=(x[v].length-g)/10+1;++y)e(x[v].slice(g+(y-1)*10,g+y*10).trim(),p,v,y,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var m={},f=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?f=!f:!f&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(p in m)Object.prototype.hasOwnProperty.call(m,p)&&x.push([m[p],p]);if(!x.length){m=n;for(p in m)Object.prototype.hasOwnProperty.call(m,p)&&x.push([m[p],p])}return x.sort(function(h,g){return h[0]-g[0]||n[h[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(d,m){var f=m||{},p="",x=f.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):f&&f.FS?p=f.FS:p=s(d.slice(0,1024));var g=0,w=0,v=0,y=0,N=0,S=p.charCodeAt(0),C=!1,j=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var k=f.dateNF!=null?FR(f.dateNF):null;function F(){var M=d.slice(y,N),R={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)R.t="z";else if(f.raw)R.t="s",R.v=M;else if(M.trim().length===0)R.t="s",R.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(R.t="s",R.v=M.slice(2,-1).replace(/""/g,'"')):mO(M)?(R.t="n",R.f=M.slice(1)):(R.t="s",R.v=M);else if(M=="TRUE")R.t="b",R.v=!0;else if(M=="FALSE")R.t="b",R.v=!1;else if(!isNaN(v=ns(M)))R.t="n",f.cellText!==!1&&(R.w=M),R.v=v;else if(!isNaN(Ll(M).getDate())||k&&M.match(k)){R.z=f.dateNF||wt[14];var z=0;k&&M.match(k)&&(M=RR(M,f.dateNF,M.match(k)||[]),z=1),f.cellDates?(R.t="d",R.v=fr(M,z)):(R.t="n",R.v=kr(fr(M,z))),f.cellText!==!1&&(R.w=ta(R.z,R.v instanceof Date?kr(R.v):R.v)),f.cellNF||delete R.z}else R.t="s",R.v=M;if(R.t=="z"||(f.dense?(x[g]||(x[g]=[]),x[g][w]=R):x[Qe({c:w,r:g})]=R),y=N+1,E=d.charCodeAt(y),h.e.c<w&&(h.e.c=w),h.e.r<g&&(h.e.r=g),j==S)++w;else if(w=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;N<d.length;++N)switch(j=d.charCodeAt(N)){case 34:E===34&&(C=!C);break;case S:case 10:case 13:if(!C&&F())break e;break}return N-y>0&&F(),x["!ref"]=_t(h),x}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):So(t(d,m),m)}function l(d,m){var f="",p=m.type=="string"?[0,0,0,0]:kM(d,m);switch(m.type){case"base64":f=hs(d);break;case"binary":f=d;break;case"buffer":m.codepage==65001?f=d.toString("utf8"):m.codepage&&typeof va<"u"?f=va.utils.decode(m.codepage,d):f=We&&Buffer.isBuffer(d)?d.toString("binary"):sc(d);break;case"array":f=Kd(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+m.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=il(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=il(f):m.type=="binary"&&typeof va<"u"&&m.codepage&&(f=va.utils.decode(m.codepage,va.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?F4.to_sheet(m.type=="string"?f:il(f),m):o(f,m)}function c(d,m){return Ya(l(d,m),m)}function u(d){for(var m=[],f=ot(d["!ref"]),p,x=Array.isArray(d),h=f.s.r;h<=f.e.r;++h){for(var g=[],w=f.s.c;w<=f.e.c;++w){var v=Qe({r:h,c:w});if(p=x?(d[h]||[])[w]:d[v],!p||p.v==null){g.push("          ");continue}for(var y=(p.w||(ms(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(w===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),Av=function(){function e(L,G,U){if(L){Rr(L,L.l||0);for(var A=U.Enum||ue;L.l<L.length;){var H=L.read_shift(2),Y=A[H]||A[65535],ae=L.read_shift(2),oe=L.l+ae,se=Y.f&&Y.f(L,ae,U);if(L.l=oe,G(se,Y,H))return}}}function t(L,G){switch(G.type){case"base64":return r(pn(hs(L)),G);case"binary":return r(pn(L),G);case"buffer":case"array":return r(L,G)}throw"Unsupported type "+G.type}function r(L,G){if(!L)return L;var U=G||{},A=U.dense?[]:{},H="Sheet1",Y="",ae=0,oe={},se=[],we=[],pe={s:{r:0,c:0},e:{r:0,c:0}},Fe=U.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)U.Enum=ue,e(L,function(ge,pr,gr){switch(gr){case 0:U.vers=ge,ge>=4096&&(U.qpro=!0);break;case 6:pe=ge;break;case 204:ge&&(Y=ge);break;case 222:Y=ge;break;case 15:case 51:U.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:gr==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=U.dateNF||wt[14],U.cellDates&&(ge[1].t="d",ge[1].v=XN(ge[1].v))),U.qpro&&ge[3]>ae&&(A["!ref"]=_t(pe),oe[H]=A,se.push(H),A=U.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ae=ge[3],H=Y||"Sheet"+(ae+1),Y="");var fa=U.dense?(A[ge[0].r]||[])[ge[0].c]:A[Qe(ge[0])];if(fa){fa.t=ge[1].t,fa.v=ge[1].v,ge[1].z!=null&&(fa.z=ge[1].z),ge[1].f!=null&&(fa.f=ge[1].f);break}U.dense?(A[ge[0].r]||(A[ge[0].r]=[]),A[ge[0].r][ge[0].c]=ge[1]):A[Qe(ge[0])]=ge[1];break}},U);else if(L[2]==26||L[2]==14)U.Enum=xe,L[2]==14&&(U.qpro=!0,L.l=0),e(L,function(ge,pr,gr){switch(gr){case 204:H=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ae&&(A["!ref"]=_t(pe),oe[H]=A,se.push(H),A=U.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ae=ge[3],H="Sheet"+(ae+1)),Fe>0&&ge[0].r>=Fe)break;U.dense?(A[ge[0].r]||(A[ge[0].r]=[]),A[ge[0].r][ge[0].c]=ge[1]):A[Qe(ge[0])]=ge[1],pe.e.c<ge[0].c&&(pe.e.c=ge[0].c),pe.e.r<ge[0].r&&(pe.e.r=ge[0].r);break;case 27:ge[14e3]&&(we[ge[14e3][0]]=ge[14e3][1]);break;case 1537:we[ge[0]]=ge[1],ge[0]==ae&&(H=ge[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(A["!ref"]=_t(pe),oe[Y||H]=A,se.push(Y||H),!we.length)return{SheetNames:se,Sheets:oe};for(var Ee={},Pt=[],ze=0;ze<we.length;++ze)oe[se[ze]]?(Pt.push(we[ze]||se[ze]),Ee[we[ze]]=oe[we[ze]]||oe[se[ze]]):(Pt.push(we[ze]),Ee[we[ze]]={"!ref":"A1"});return{SheetNames:Pt,Sheets:Ee}}function n(L,G){var U=G||{};if(+U.codepage>=0&&Dl(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var A=Er(),H=ot(L["!ref"]),Y=Array.isArray(L),ae=[];he(A,0,i(1030)),he(A,6,c(H));for(var oe=Math.min(H.e.r,8191),se=H.s.r;se<=oe;++se)for(var we=Yt(se),pe=H.s.c;pe<=H.e.c;++pe){se===H.s.r&&(ae[pe]=rr(pe));var Fe=ae[pe]+we,Ee=Y?(L[se]||[])[pe]:L[Fe];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?he(A,13,p(se,pe,Ee.v)):he(A,14,h(se,pe,Ee.v));else{var Pt=ms(Ee);he(A,15,m(se,pe,Pt.slice(0,239)))}}return he(A,1),A.end()}function s(L,G){var U=G||{};if(+U.codepage>=0&&Dl(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var A=Er();he(A,0,o(L));for(var H=0,Y=0;H<L.SheetNames.length;++H)(L.Sheets[L.SheetNames[H]]||{})["!ref"]&&he(A,27,te(L.SheetNames[H],Y++));var ae=0;for(H=0;H<L.SheetNames.length;++H){var oe=L.Sheets[L.SheetNames[H]];if(!(!oe||!oe["!ref"])){for(var se=ot(oe["!ref"]),we=Array.isArray(oe),pe=[],Fe=Math.min(se.e.r,8191),Ee=se.s.r;Ee<=Fe;++Ee)for(var Pt=Yt(Ee),ze=se.s.c;ze<=se.e.c;++ze){Ee===se.s.r&&(pe[ze]=rr(ze));var ge=pe[ze]+Pt,pr=we?(oe[Ee]||[])[ze]:oe[ge];if(!(!pr||pr.t=="z"))if(pr.t=="n")he(A,23,F(Ee,ze,ae,pr.v));else{var gr=ms(pr);he(A,22,j(Ee,ze,ae,gr.slice(0,239)))}}++ae}}return he(A,1),A.end()}function i(L){var G=re(2);return G.write_shift(2,L),G}function o(L){var G=re(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var U=0,A=0,H=0,Y=0;Y<L.SheetNames.length;++Y){var ae=L.SheetNames[Y],oe=L.Sheets[ae];if(!(!oe||!oe["!ref"])){++H;var se=$r(oe["!ref"]);U<se.e.r&&(U=se.e.r),A<se.e.c&&(A=se.e.c)}}return U>8191&&(U=8191),G.write_shift(2,U),G.write_shift(1,H),G.write_shift(1,A),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(L,G,U){var A={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&U.qpro?(A.s.c=L.read_shift(1),L.l++,A.s.r=L.read_shift(2),A.e.c=L.read_shift(1),L.l++,A.e.r=L.read_shift(2),A):(A.s.c=L.read_shift(2),A.s.r=L.read_shift(2),G==12&&U.qpro&&(L.l+=2),A.e.c=L.read_shift(2),A.e.r=L.read_shift(2),G==12&&U.qpro&&(L.l+=2),A.s.c==65535&&(A.s.c=A.e.c=A.s.r=A.e.r=0),A)}function c(L){var G=re(8);return G.write_shift(2,L.s.c),G.write_shift(2,L.s.r),G.write_shift(2,L.e.c),G.write_shift(2,L.e.r),G}function u(L,G,U){var A=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(A[0].c=L.read_shift(1),A[3]=L.read_shift(1),A[0].r=L.read_shift(2),L.l+=2):(A[2]=L.read_shift(1),A[0].c=L.read_shift(2),A[0].r=L.read_shift(2)),A}function d(L,G,U){var A=L.l+G,H=u(L,G,U);if(H[1].t="s",U.vers==20768){L.l++;var Y=L.read_shift(1);return H[1].v=L.read_shift(Y,"utf8"),H}return U.qpro&&L.l++,H[1].v=L.read_shift(A-L.l,"cstr"),H}function m(L,G,U){var A=re(7+U.length);A.write_shift(1,255),A.write_shift(2,G),A.write_shift(2,L),A.write_shift(1,39);for(var H=0;H<A.length;++H){var Y=U.charCodeAt(H);A.write_shift(1,Y>=128?95:Y)}return A.write_shift(1,0),A}function f(L,G,U){var A=u(L,G,U);return A[1].v=L.read_shift(2,"i"),A}function p(L,G,U){var A=re(7);return A.write_shift(1,255),A.write_shift(2,G),A.write_shift(2,L),A.write_shift(2,U,"i"),A}function x(L,G,U){var A=u(L,G,U);return A[1].v=L.read_shift(8,"f"),A}function h(L,G,U){var A=re(13);return A.write_shift(1,255),A.write_shift(2,G),A.write_shift(2,L),A.write_shift(8,U,"f"),A}function g(L,G,U){var A=L.l+G,H=u(L,G,U);if(H[1].v=L.read_shift(8,"f"),U.qpro)L.l=A;else{var Y=L.read_shift(2);N(L.slice(L.l,L.l+Y),H),L.l+=Y}return H}function w(L,G,U){var A=G&32768;return G&=-32769,G=(A?L:0)+(G>=8192?G-16384:G),(A?"":"$")+(U?rr(G):Yt(G))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(L,G){Rr(L,0);for(var U=[],A=0,H="",Y="",ae="",oe="";L.l<L.length;){var se=L[L.l++];switch(se){case 0:U.push(L.read_shift(8,"f"));break;case 1:Y=w(G[0].c,L.read_shift(2),!0),H=w(G[0].r,L.read_shift(2),!1),U.push(Y+H);break;case 2:{var we=w(G[0].c,L.read_shift(2),!0),pe=w(G[0].r,L.read_shift(2),!1);Y=w(G[0].c,L.read_shift(2),!0),H=w(G[0].r,L.read_shift(2),!1),U.push(we+pe+":"+Y+H)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(L.read_shift(2));break;case 6:{for(var Fe="";se=L[L.l++];)Fe+=String.fromCharCode(se);U.push('"'+Fe.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:oe=U.pop(),ae=U.pop(),U.push(["AND","OR"][se-20]+"("+ae+","+oe+")");break;default:if(se<32&&y[se])oe=U.pop(),ae=U.pop(),U.push(ae+y[se]+oe);else if(v[se]){if(A=v[se][1],A==69&&(A=L[L.l++]),A>U.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+U.join("|")+"|");return}var Ee=U.slice(-A);U.length-=A,U.push(v[se][0]+"("+Ee.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}U.length==1?G[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function S(L){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=L.read_shift(2),G[3]=L[L.l++],G[0].c=L[L.l++],G}function C(L,G){var U=S(L);return U[1].t="s",U[1].v=L.read_shift(G-4,"cstr"),U}function j(L,G,U,A){var H=re(6+A.length);H.write_shift(2,L),H.write_shift(1,U),H.write_shift(1,G),H.write_shift(1,39);for(var Y=0;Y<A.length;++Y){var ae=A.charCodeAt(Y);H.write_shift(1,ae>=128?95:ae)}return H.write_shift(1,0),H}function E(L,G){var U=S(L);U[1].v=L.read_shift(2);var A=U[1].v>>1;if(U[1].v&1)switch(A&7){case 0:A=(A>>3)*5e3;break;case 1:A=(A>>3)*500;break;case 2:A=(A>>3)/20;break;case 3:A=(A>>3)/200;break;case 4:A=(A>>3)/2e3;break;case 5:A=(A>>3)/2e4;break;case 6:A=(A>>3)/16;break;case 7:A=(A>>3)/64;break}return U[1].v=A,U}function k(L,G){var U=S(L),A=L.read_shift(4),H=L.read_shift(4),Y=L.read_shift(2);if(Y==65535)return A===0&&H===3221225472?(U[1].t="e",U[1].v=15):A===0&&H===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ae=Y&32768;return Y=(Y&32767)-16446,U[1].v=(1-ae*2)*(H*Math.pow(2,Y+32)+A*Math.pow(2,Y)),U}function F(L,G,U,A){var H=re(14);if(H.write_shift(2,L),H.write_shift(1,U),H.write_shift(1,G),A==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var Y=0,ae=0,oe=0,se=0;return A<0&&(Y=1,A=-A),ae=Math.log2(A)|0,A/=Math.pow(2,ae-31),se=A>>>0,se&2147483648||(A/=2,++ae,se=A>>>0),A-=se,se|=2147483648,se>>>=0,A*=Math.pow(2,32),oe=A>>>0,H.write_shift(4,oe),H.write_shift(4,se),ae+=16383+(Y?32768:0),H.write_shift(2,ae),H}function M(L,G){var U=k(L);return L.l+=G-14,U}function R(L,G){var U=S(L),A=L.read_shift(4);return U[1].v=A>>6,U}function z(L,G){var U=S(L),A=L.read_shift(8,"f");return U[1].v=A,U}function B(L,G){var U=z(L);return L.l+=G-10,U}function K(L,G){return L[L.l+G-1]==0?L.read_shift(G,"cstr"):""}function X(L,G){var U=L[L.l++];U>G-1&&(U=G-1);for(var A="";A.length<U;)A+=String.fromCharCode(L[L.l++]);return A}function ee(L,G,U){if(!(!U.qpro||G<21)){var A=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var H=L.read_shift(G-21,"cstr");return[A,H]}}function V(L,G){for(var U={},A=L.l+G;L.l<A;){var H=L.read_shift(2);if(H==14e3){for(U[H]=[0,""],U[H][0]=L.read_shift(2);L[L.l];)U[H][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return U}function te(L,G){var U=re(5+L.length);U.write_shift(2,14e3),U.write_shift(2,G);for(var A=0;A<L.length;++A){var H=L.charCodeAt(A);U[U.l++]=H>127?95:H}return U[U.l++]=0,U}var ue={0:{n:"BOF",f:C4},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:K},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:K},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),gD=/^\s|\s$|[\t\n\r]/;function R4(e,t){if(!t.bookSST)return"";var r=[At];r[r.length]=fe("sst",null,{xmlns:No[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(gD)&&(i+=' xml:space="preserve"'),i+=">"+Xe(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function vD(e){return[e.read_shift(4),e.read_shift(4)]}function yD(e,t){return t||(t=re(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var wD=uI;function bD(e){var t=Er();ie(t,159,yD(e));for(var r=0;r<e.length;++r)ie(t,19,wD(e[r]));return ie(t,160),t.end()}function ND(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function I4(e){var t=0,r,n=ND(e),s=n.length+1,i,o,l,c,u;for(r=Wa(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var SD=function(){function e(s,i){switch(i.type){case"base64":return t(hs(s),i);case"binary":return t(s,i);case"buffer":return t(We&&Buffer.isBuffer(s)?s.toString("binary"):sc(s),i);case"array":return t(Kd(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var f=/\\\w+\b/g,p=0,x,h=-1;x=f.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(p,f.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++h,g.length){var w={v:g,t:"s"};Array.isArray(l)?l[m][h]=w:l[Qe({r:m,c:h})]=w}break}p=f.lastIndex}h>u.e.c&&(u.e.c=h)}),l["!ref"]=_t(u),l}function r(s,i){return Ya(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=ot(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=Qe({r:u,c:d});l=c?(s[u]||[])[d]:s[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ms(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Pv(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var jD=6,ss=jD;function sd(e){return Math.floor((e+Math.round(128/ss)/256)*ss)}function ad(e){return Math.floor((e-5)/ss*100+.5)/100}function Oh(e){return Math.round((e*ss+5)/ss*256)/256}function Nx(e){e.width?(e.wpx=sd(e.width),e.wch=ad(e.wpx),e.MDW=ss):e.wpx?(e.wch=ad(e.wpx),e.width=Oh(e.wch),e.MDW=ss):typeof e.wch=="number"&&(e.width=Oh(e.wch),e.wpx=sd(e.width),e.MDW=ss),e.customWidth&&delete e.customWidth}var TD=96,D4=TD;function id(e){return e*96/D4}function O4(e){return e*D4/96}function ED(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=fe("numFmt",null,{numFmtId:n,formatCode:Xe(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function CD(e){var t=[];return t[t.length]=fe("cellXfs",null),e.forEach(function(r){t[t.length]=fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function L4(e,t){var r=[At,fe("styleSheet",null,{xmlns:No[0],"xmlns:vt":Lt.vt})],n;return e.SSF&&(n=ED(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CD(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function kD(e,t){var r=e.read_shift(2),n=nr(e);return[r,n]}function _D(e,t,r){r||(r=re(6+4*t.length)),r.write_shift(2,e),Bt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function AD(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=gI(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=pI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=nr(e),n}function PD(e,t){t||(t=re(25+4*32)),t.write_shift(2,e.sz*20),vI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),rd(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Bt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var FD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ef,RD=Hn;function Fv(e,t){t||(t=re(4*3+8*7+16*1)),ef||(ef=ux(FD));var r=ef[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(rd({auto:1},t),rd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ID(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function M4(e,t,r){r||(r=re(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function $o(e,t){return t||(t=re(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var DD=Hn;function OD(e,t){return t||(t=re(51)),t.write_shift(1,0),$o(null,t),$o(null,t),$o(null,t),$o(null,t),$o(null,t),t.length>t.l?t.slice(0,t.l):t}function LD(e,t){return t||(t=re(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),td(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function MD(e,t,r){var n=re(2052);return n.write_shift(4,e),td(t,n),td(r,n),n.length>n.l?n.slice(0,n.l):n}function BD(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ie(e,615,wn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ie(e,44,_D(s,t[s]))}),ie(e,616))}}function UD(e){var t=1;ie(e,611,wn(t)),ie(e,43,PD({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ie(e,612)}function $D(e){var t=2;ie(e,603,wn(t)),ie(e,45,Fv({patternType:"none"})),ie(e,45,Fv({patternType:"gray125"})),ie(e,604)}function WD(e){var t=1;ie(e,613,wn(t)),ie(e,46,OD()),ie(e,614)}function HD(e){var t=1;ie(e,626,wn(t)),ie(e,47,M4({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ie(e,627)}function VD(e,t){ie(e,617,wn(t.length)),t.forEach(function(r){ie(e,47,M4(r,0))}),ie(e,618)}function zD(e){var t=1;ie(e,619,wn(t)),ie(e,48,LD({xfId:0,builtinId:0,name:"Normal"})),ie(e,620)}function GD(e){var t=0;ie(e,505,wn(t)),ie(e,506)}function KD(e){var t=0;ie(e,508,MD(t,"TableStyleMedium9","PivotStyleMedium4")),ie(e,509)}function YD(e,t){var r=Er();return ie(r,278),BD(r,e.SSF),UD(r),$D(r),WD(r),HD(r),VD(r,t.cellXfs),zD(r),GD(r),KD(r),ie(r,279),r.end()}function B4(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[At];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function XD(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:nr(e)}}function qD(e){var t=re(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Bt(e.name,t),t.slice(0,t.l)}function QD(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JD(e){var t=re(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function ZD(e,t){var r=re(8+2*t.length);return r.write_shift(4,e),Bt(t,r),r.slice(0,r.l)}function eO(e){return e.l+=4,e.read_shift(4)!=0}function tO(e,t){var r=re(8);return r.write_shift(4,e),r.write_shift(4,1),r}function rO(){var e=Er();return ie(e,332),ie(e,334,wn(1)),ie(e,335,qD({name:"XLDAPR",version:12e4,flags:3496657072})),ie(e,336),ie(e,339,ZD(1,"XLDAPR")),ie(e,52),ie(e,35,wn(514)),ie(e,4096,wn(0)),ie(e,4097,Kr(1)),ie(e,36),ie(e,53),ie(e,340),ie(e,337,tO(1)),ie(e,51,JD([[1,0]])),ie(e,338),ie(e,333),e.end()}function U4(){var e=[At];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function nO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ni=1024;function $4(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[fe("xml",null,{"xmlns:v":Dr.v,"xmlns:o":Dr.o,"xmlns:x":Dr.x,"xmlns:mv":Dr.mv}).replace(/\/>/,">"),fe("o:shapelayout",fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fe("v:shapetype",[fe("v:stroke",null,{joinstyle:"miter"}),fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ni<e*1e3;)Ni+=1e3;return t.forEach(function(i){var o=Mt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=fe("v:fill",c,l),d={on:"t",obscured:"t"};++Ni,s=s.concat(["<v:shape"+Bl({id:"_x0000_s"+Ni,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,fe("v:shadow",null,d),fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Gt("x:AutoFill","False"),Gt("x:Row",String(o.r)),Gt("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function W4(e){var t=[At,fe("comments",null,{xmlns:No[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Xe(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Xe(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Gt("t",Xe(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Gt("t",Xe(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sO(e,t,r){var n=[At,fe("ThreadedComments",null,{xmlns:Lt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(fe("threadedComment",Gt("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function aO(e){var t=[At,fe("personList",null,{xmlns:Lt.TCMNT,"xmlns:x":No[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function iO(e){var t={};t.iauthor=e.read_shift(4);var r=Ja(e);return t.rfx=r.s,t.ref=Qe(r.s),e.l+=16,t}function oO(e,t){return t==null&&(t=re(36)),t.write_shift(4,e[1].iauthor),jo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var lO=nr;function cO(e){return Bt(e.slice(0,54))}function uO(e){var t=Er(),r=[];return ie(t,628),ie(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ie(t,632,cO(s.a)))})}),ie(t,631),ie(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Mt(n[0]),e:Mt(n[0])};ie(t,635,oO([i,s])),s.t&&s.t.length>0&&ie(t,637,fI(s)),ie(t,636),delete s.iauthor})}),ie(t,634),ie(t,629),t.end()}function dO(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ze.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var H4=["xlsb","xlsm","xlam","biff8","xla"],fO=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+rr(d)+(c?"":"$")+Yt(u)}return function(s,i){return t=i,s.replace(e,r)}}(),Sx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jx=function(){return function(t,r){return t.replace(Sx,function(n,s,i,o,l,c){var u=gx(o)-(i?0:r.c),d=px(c)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return s+"R"+m+"C"+f})}}();function hO(e,t){return e.replace(Sx,function(r,n,s,i,o,l){return n+(s=="$"?s+i:rr(gx(i)+t.c))+(o=="$"?o+l:Yt(px(l)+t.r))})}function mO(e){return e.length!=1}function Et(e){e.l+=1}function ra(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function V4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return z4(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),o=ra(e),l=ra(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function z4(e){var t=ra(e),r=ra(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function xO(e,t,r){if(r.biff<8)return z4(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=ra(e),o=ra(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function G4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return pO(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ra(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function pO(e){var t=ra(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function gO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vO(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return yO(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function yO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function wO(e,t,r){var n=(e[e.l++]&96)>>5,s=V4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function bO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=V4(e,i,r);return[n,s,o]}function NO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function SO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function jO(e,t,r){var n=(e[e.l++]&96)>>5,s=xO(e,t-1,r);return[n,s]}function TO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Rv(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function EO(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function CO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _O(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function AO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function K4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function PO(e){return e.read_shift(2),K4(e)}function FO(e){return e.read_shift(2),K4(e)}function RO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=G4(e,0,r);return[n,s]}function IO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=vO(e,0,r);return[n,s]}function DO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=G4(e,0,r);return[n,s,i]}function OO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[O8[s],q4[s],n]}function LO(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:MO(e);return[s,(i[0]===0?q4:D8)[i[1]]]}function MO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function BO(e,t,r){e.l+=r&&r.biff==2?3:4}function UO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function $O(e){return e.l++,oc[e.read_shift(1)]}function WO(e){return e.l++,e.read_shift(2)}function HO(e){return e.l++,e.read_shift(1)!==0}function VO(e){return e.l++,To(e)}function zO(e,t,r){return e.l++,_4(e,t-1,r)}function GO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=DI(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=oc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=To(e);break;case 2:r[1]=BI(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Ja:WI)(e));return s}function YO(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=GO(e,r.biff);return o}function XO(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function qO(e,t,r){if(r.biff==5)return QO(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function QO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function JO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ZO(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function e8(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function t8(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var r8=Hn,n8=Hn,s8=Hn;function lc(e,t,r){return e.l+=2,[gO(e)]}function Tx(e){return e.l+=6,[]}var a8=lc,i8=Tx,o8=Tx,l8=lc;function Y4(e){return e.l+=2,[C4(e),e.read_shift(2)&1]}var c8=lc,u8=Y4,d8=Tx,f8=lc,h8=lc,m8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function x8(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=m8[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:i}}function p8(e){return e.l+=2,[e.read_shift(4)]}function g8(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function v8(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function y8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function w8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function b8(e){return e.l+=4,[0,0]}var Iv={1:{n:"PtgExp",f:UO},2:{n:"PtgTbl",f:s8},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:zO},26:{n:"PtgSheet",f:g8},27:{n:"PtgEndSheet",f:v8},28:{n:"PtgErr",f:$O},29:{n:"PtgBool",f:HO},30:{n:"PtgInt",f:WO},31:{n:"PtgNum",f:VO},32:{n:"PtgArray",f:TO},33:{n:"PtgFunc",f:OO},34:{n:"PtgFuncVar",f:LO},35:{n:"PtgName",f:XO},36:{n:"PtgRef",f:RO},37:{n:"PtgArea",f:wO},38:{n:"PtgMemArea",f:JO},39:{n:"PtgMemErr",f:r8},40:{n:"PtgMemNoMem",f:n8},41:{n:"PtgMemFunc",f:ZO},42:{n:"PtgRefErr",f:e8},43:{n:"PtgAreaErr",f:NO},44:{n:"PtgRefN",f:IO},45:{n:"PtgAreaN",f:jO},46:{n:"PtgMemAreaN",f:y8},47:{n:"PtgMemNoMemN",f:w8},57:{n:"PtgNameX",f:qO},58:{n:"PtgRef3d",f:DO},59:{n:"PtgArea3d",f:bO},60:{n:"PtgRefErr3d",f:t8},61:{n:"PtgAreaErr3d",f:SO},255:{}},N8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},S8={1:{n:"PtgElfLel",f:Y4},2:{n:"PtgElfRw",f:f8},3:{n:"PtgElfCol",f:a8},6:{n:"PtgElfRwV",f:h8},7:{n:"PtgElfColV",f:l8},10:{n:"PtgElfRadical",f:c8},11:{n:"PtgElfRadicalS",f:d8},13:{n:"PtgElfColS",f:i8},15:{n:"PtgElfColSV",f:o8},16:{n:"PtgElfRadicalLel",f:u8},25:{n:"PtgList",f:x8},29:{n:"PtgSxName",f:p8},255:{}},j8={0:{n:"PtgAttrNoop",f:b8},1:{n:"PtgAttrSemi",f:AO},2:{n:"PtgAttrIf",f:kO},4:{n:"PtgAttrChoose",f:EO},8:{n:"PtgAttrGoto",f:CO},16:{n:"PtgAttrSum",f:BO},32:{n:"PtgAttrBaxcel",f:Rv},33:{n:"PtgAttrBaxcel",f:Rv},64:{n:"PtgAttrSpace",f:PO},65:{n:"PtgAttrSpaceSemi",f:FO},128:{n:"PtgAttrIfError",f:_O},255:{}};function T8(e,t,r,n){if(n.biff<8)return Hn(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=YO(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=KO(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(Hn(e,t)),i}function E8(e,t,r){for(var n=e.l+t,s,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Iv[i]||Iv[N8[i]],(i===24||i===25)&&(s=(i===24?S8:j8)[e[e.l+1]]),!s||!s.f?Hn(e,t):o.push([s.n,s.f(e,t,r)]);return o}function C8(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var k8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _8(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function X4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Dv(e,t,r){var n=X4(e,t,r);return n=="#REF"?n:_8(n,r)}function ho(e,t,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,u,d,m=0,f=0,p,x="";if(!e[0]||!e[0][0])return"";for(var h=-1,g="",w=0,v=e[0].length;w<v;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),h>=0){switch(e[0][h][1][0]){case 0:g=yt(" ",e[0][h][1][1]);break;case 1:g=yt("\r",e[0][h][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}u=u+g,h=-1}l.push(u+k8[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ll(y[1][1],o,s),l.push(cl(d,i));break;case"PtgRefN":d=r?ll(y[1][1],r,s):y[1][1],l.push(cl(d,i));break;case"PtgRef3d":m=y[1][1],d=ll(y[1][2],o,s),x=Dv(n,m,s),l.push(x+"!"+cl(d,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],S=y[1][1];N||(N=0),N&=127;var C=N==0?[]:l.slice(-N);l.length-=N,S==="User"&&(S=C.shift()),l.push(S+"("+C.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":p=yv(y[1][1],r?{s:r}:o,s),l.push(J0(p,s));break;case"PtgArea":p=yv(y[1][1],o,s),l.push(J0(p,s));break;case"PtgArea3d":m=y[1][1],p=y[1][2],x=Dv(n,m,s),l.push(x+"!"+J0(p,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var j=(n.names||[])[f-1]||(n[0]||[])[f],E=j?j.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var k=y[1][1];f=y[1][2];var F;if(s.biff<=5)k<0&&(k=-k),n[k]&&(F=n[k][f]);else{var M="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][f]&&n[k][f].itab>0&&(M=n.SheetNames[n[k][f].itab-1]+"!"):M=n.SheetNames[f-1]+"!"),n[k]&&n[k][f])M+=n[k][f].Name;else if(n[0]&&n[0][f])M+=n[0][f].Name;else{var R=(X4(n,k,s)||"").split(";;");R[f-1]?M=R[f-1]:M+="SH33TJSERRX"}l.push(M);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var z="(",B=")";if(h>=0){switch(g="",e[0][h][1][0]){case 2:z=yt(" ",e[0][h][1][1])+z;break;case 3:z=yt("\r",e[0][h][1][1])+z;break;case 4:B=yt(" ",e[0][h][1][1])+B;break;case 5:B=yt("\r",e[0][h][1][1])+B;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}l.push(z+l.pop()+B);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var K={c:r.c,r:r.r};if(n.sharedf[Qe(d)]){var X=n.sharedf[Qe(d)];l.push(ho(X,o,K,n,s))}else{var ee=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(ho(u[1],o,K,n,s)),ee=!0;break}ee||l.push(y[1])}break;case"PtgArray":l.push("{"+C8(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&h>=0&&V.indexOf(e[0][w][0])==-1){y=e[0][h];var te=!0;switch(y[1][0]){case 4:te=!1;case 0:g=yt(" ",y[1][1]);break;case 5:te=!1;case 1:g=yt("\r",y[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((te?g:"")+l.pop()+(te?"":g)),h=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function A8(e){if(e==null){var t=re(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ha(e);return Ha(0)}function P8(e,t,r,n,s){var i=Va(t,r,s),o=A8(e.v),l=re(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=re(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=zt([i,o,l,u]);return m}function Yd(e,t,r){var n=e.read_shift(4),s=E8(e,n,r),i=e.read_shift(4),o=i>0?T8(e,i,s,r):null;return[s,o]}var F8=Yd,Xd=Yd,R8=Yd,I8=Yd,D8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},q4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},O8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function L8(e){var t="of:="+e.replace(Sx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function M8(e){return e.replace(/\./,"!")}var ul=typeof Map<"u";function Ex(e,t,r){var n=0,s=e.length;if(r){if(ul?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ul?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ul?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function qd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ss=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ad(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Oh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Q4(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function da(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){GN(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function B8(e,t,r){if(e&&e["!ref"]){var n=ot(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function U8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+_t(e[r])+'"/>';return t+"</mergeCells>"}function $8(e,t,r,n,s){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=Ml(Xe(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+fe("outlinePr",null,u)}!i&&!l||(s[s.length]=fe("sheetPr",l,o))}var W8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],H8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function V8(e){var t={sheet:1};return W8.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),H8.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=I4(e.password).toString(16).toUpperCase()),fe("sheetProtection",null,t)}function z8(e){return Q4(e),fe("pageMargins",null,e)}function G8(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=fe("col",null,qd(s,n)));return r[r.length]="</cols>",r.join("")}function K8(e,t,r,n){var s=typeof e.ref=="string"?e.ref:_t(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=$r(s);o.s.r==o.e.r&&(o.e.r=$r(t["!ref"]).e.r,s=_t(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe("autoFilter",null,{ref:s})}function Y8(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),fe("sheetViews",fe("sheetView",null,s),{})}function X8(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=oc[e.v];break;case"d":n&&n.cellDates?s=fr(e.v,-1).toISOString():(e=_r(e),e.t="n",s=""+(e.v=kr(fr(e.v)))),typeof e.z>"u"&&(e.z=wt[14]);break;default:s=e.v;break}var l=Gt("v",Xe(s)),c={r:t},u=da(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Gt("v",""+Ex(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=fe("f",Xe(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),fe("c",l,c)}function q8(e,t,r,n){var s=[],i=[],o=ot(e["!ref"]),l="",c,u="",d=[],m=0,f=0,p=e["!rows"],x=Array.isArray(e),h={r:u},g,w=-1;for(f=o.s.c;f<=o.e.c;++f)d[f]=rr(f);for(m=o.s.r;m<=o.e.r;++m){for(i=[],u=Yt(m),f=o.s.c;f<=o.e.c;++f){c=d[f]+u;var v=x?(e[m]||[])[f]:e[c];v!==void 0&&(l=X8(v,c,e,t))!=null&&i.push(l)}(i.length>0||p&&p[m])&&(h={r:u},p&&p[m]&&(g=p[m],g.hidden&&(h.hidden=1),w=-1,g.hpx?w=id(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(h.ht=w,h.customHeight=1),g.level&&(h.outlineLevel=g.level)),s[s.length]=fe("row",i.join(""),h))}if(p)for(;m<p.length;++m)p&&p[m]&&(h={r:m+1},g=p[m],g.hidden&&(h.hidden=1),w=-1,g.hpx?w=id(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(h.ht=w,h.customHeight=1),g.level&&(h.outlineLevel=g.level),s[s.length]=fe("row","",h));return s.join("")}function J4(e,t,r,n){var s=[At,fe("worksheet",null,{xmlns:No[0],"xmlns:r":Lt.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=ot(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=_t(d)}n||(n={}),c["!comments"]=[];var m=[];$8(c,r,e,t,s),s[s.length]=fe("dimension",null,{ref:u}),s[s.length]=Y8(c,t,e,r),t.sheetFormat&&(s[s.length]=fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=G8(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=q8(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=V8(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=K8(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=U8(c["!merges"]));var f=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(p={ref:h[0]},h[1].Target.charAt(0)!="#"&&(x=Ye(n,-1,Xe(h[1].Target).replace(/#.*$/,""),$e.HLINK),p["r:id"]="rId"+x),(f=h[1].Target.indexOf("#"))>-1&&(p.location=Xe(h[1].Target.slice(f+1))),h[1].Tooltip&&(p.tooltip=Xe(h[1].Tooltip)),s[s.length]=fe("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=z8(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Gt("ignoredErrors",fe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(x=Ye(n,-1,"../drawings/drawing"+(e+1)+".xml",$e.DRAW),s[s.length]=fe("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=m),c["!comments"].length>0&&(x=Ye(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",$e.VML),s[s.length]=fe("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Q8(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function J8(e,t,r){var n=re(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=id(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,f=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Qe(u)];x&&(m<0&&(m=p),f=p)}m<0||(++l,n.write_shift(4,m),n.write_shift(4,f))}var h=n.l;return n.l=c,n.write_shift(4,l),n.l=h,n.length>n.l?n.slice(0,n.l):n}function Z8(e,t,r,n){var s=J8(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ie(e,0,s)}var e5=Ja,t5=jo;function r5(){}function n5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=hI(e),r}function s5(e,t,r){r==null&&(r=re(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return rd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),h4(e,r),r.slice(0,r.l)}function a5(e){var t=tn(e);return[t]}function i5(e,t,r){return r==null&&(r=re(8)),Xa(t,r)}function o5(e){var t=qa(e);return[t]}function l5(e,t,r){return r==null&&(r=re(4)),Qa(t,r)}function c5(e){var t=tn(e),r=e.read_shift(1);return[t,r,"b"]}function u5(e,t,r){return r==null&&(r=re(9)),Xa(t,r),r.write_shift(1,e.v?1:0),r}function d5(e){var t=qa(e),r=e.read_shift(1);return[t,r,"b"]}function f5(e,t,r){return r==null&&(r=re(5)),Qa(t,r),r.write_shift(1,e.v?1:0),r}function h5(e){var t=tn(e),r=e.read_shift(1);return[t,r,"e"]}function m5(e,t,r){return r==null&&(r=re(9)),Xa(t,r),r.write_shift(1,e.v),r}function x5(e){var t=qa(e),r=e.read_shift(1);return[t,r,"e"]}function p5(e,t,r){return r==null&&(r=re(8)),Qa(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function g5(e){var t=tn(e),r=e.read_shift(4);return[t,r,"s"]}function v5(e,t,r){return r==null&&(r=re(12)),Xa(t,r),r.write_shift(4,t.v),r}function y5(e){var t=qa(e),r=e.read_shift(4);return[t,r,"s"]}function w5(e,t,r){return r==null&&(r=re(8)),Qa(t,r),r.write_shift(4,t.v),r}function b5(e){var t=tn(e),r=To(e);return[t,r,"n"]}function N5(e,t,r){return r==null&&(r=re(16)),Xa(t,r),Ha(e.v,r),r}function S5(e){var t=qa(e),r=To(e);return[t,r,"n"]}function j5(e,t,r){return r==null&&(r=re(12)),Qa(t,r),Ha(e.v,r),r}function T5(e){var t=tn(e),r=m4(e);return[t,r,"n"]}function E5(e,t,r){return r==null&&(r=re(12)),Xa(t,r),x4(e.v,r),r}function C5(e){var t=qa(e),r=m4(e);return[t,r,"n"]}function k5(e,t,r){return r==null&&(r=re(8)),Qa(t,r),x4(e.v,r),r}function _5(e){var t=tn(e),r=vx(e);return[t,r,"is"]}function A5(e){var t=tn(e),r=nr(e);return[t,r,"str"]}function P5(e,t,r){return r==null&&(r=re(12+4*e.v.length)),Xa(t,r),Bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function F5(e){var t=qa(e),r=nr(e);return[t,r,"str"]}function R5(e,t,r){return r==null&&(r=re(8+4*e.v.length)),Qa(t,r),Bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function I5(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=Xd(e,n-e.l,r);o[3]=ho(l,null,s,r.supbooks,r)}else e.l=n;return o}function D5(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=Xd(e,n-e.l,r);o[3]=ho(l,null,s,r.supbooks,r)}else e.l=n;return o}function O5(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var i=To(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=Xd(e,n-e.l,r);o[3]=ho(l,null,s,r.supbooks,r)}else e.l=n;return o}function L5(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var i=nr(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=Xd(e,n-e.l,r);o[3]=ho(l,null,s,r.supbooks,r)}else e.l=n;return o}var M5=Ja,B5=jo;function U5(e,t){return t==null&&(t=re(4)),t.write_shift(4,e),t}function $5(e,t){var r=e.l+t,n=Ja(e),s=yx(e),i=nr(e),o=nr(e),l=nr(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function W5(e,t){var r=re(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));jo({s:Mt(e[0]),e:Mt(e[0])},r),wx("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Bt(s||"",r),Bt(e[1].Tooltip||"",r),Bt("",r),r.slice(0,r.l)}function H5(){}function V5(e,t,r){var n=e.l+t,s=p4(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=F8(e,n-e.l,r);o[1]=l}else e.l=n;return o}function z5(e,t,r){var n=e.l+t,s=Ja(e),i=[s];if(r.cellFormula){var o=I8(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function G5(e,t,r){r==null&&(r=re(18));var n=qd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Z4=["left","right","top","bottom","header","footer"];function K5(e){var t={};return Z4.forEach(function(r){t[r]=To(e)}),t}function Y5(e,t){return t==null&&(t=re(6*8)),Q4(e),Z4.forEach(function(r){Ha(e[r],t)}),t}function X5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function q5(e,t,r){r==null&&(r=re(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Q5(e){var t=re(24);return t.write_shift(4,4),t.write_shift(4,1),jo(e,t),t}function J5(e,t){return t==null&&(t=re(16*4+2)),t.write_shift(2,e.password?I4(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Z5(){}function eL(){}function tL(e,t,r,n,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=_r(t),t.z=t.z||wt[14],t.v=kr(fr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=da(s.cellXfs,t,s),t.l&&i["!links"].push([Qe(c),t.l]),t.c&&i["!comments"].push([Qe(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Ex(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ie(e,18,w5(t,c)):ie(e,7,v5(t,c))):(c.t="str",o?ie(e,17,R5(t,c)):ie(e,6,P5(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ie(e,13,k5(t,c)):ie(e,2,E5(t,c)):o?ie(e,16,j5(t,c)):ie(e,5,N5(t,c)),!0;case"b":return c.t="b",o?ie(e,15,f5(t,c)):ie(e,4,u5(t,c)),!0;case"e":return c.t="e",o?ie(e,14,p5(t,c)):ie(e,3,m5(t,c)),!0}return o?ie(e,12,l5(t,c)):ie(e,1,i5(t,c)),!0}function rL(e,t,r,n){var s=ot(t["!ref"]||"A1"),i,o="",l=[];ie(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=Yt(d),Z8(e,t,s,d);var m=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(l[f]=rr(f)),i=l[f]+o;var p=c?(t[d]||[])[f]:t[i];if(!p){m=!1;continue}m=tL(e,p,d,f,n,t,m)}}ie(e,146)}function nL(e,t){!t||!t["!merges"]||(ie(e,177,U5(t["!merges"].length)),t["!merges"].forEach(function(r){ie(e,176,B5(r))}),ie(e,178))}function sL(e,t){!t||!t["!cols"]||(ie(e,390),t["!cols"].forEach(function(r,n){r&&ie(e,60,G5(n,r))}),ie(e,391))}function aL(e,t){!t||!t["!ref"]||(ie(e,648),ie(e,649,Q5(ot(t["!ref"]))),ie(e,650))}function iL(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ye(r,-1,n[1].Target.replace(/#.*$/,""),$e.HLINK);ie(e,494,W5(n,s))}}),delete t["!links"]}function oL(e,t,r,n){if(t["!comments"].length>0){var s=Ye(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$e.VML);ie(e,551,wx("rId"+s)),t["!legacy"]=s}}function lL(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:_t(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=$r(i);l.s.r==l.e.r&&(l.e.r=$r(t["!ref"]).e.r,i=_t(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ie(e,161,jo(ot(i))),ie(e,162)}}function cL(e,t,r){ie(e,133),ie(e,137,q5(t,r)),ie(e,138),ie(e,134)}function uL(e,t){t["!protect"]&&ie(e,535,J5(t["!protect"]))}function dL(e,t,r,n){var s=Er(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ot(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ie(s,129),(r.vbaraw||o["!outline"])&&ie(s,147,s5(l,o["!outline"])),ie(s,148,t5(c)),cL(s,o,r.Workbook),sL(s,o),rL(s,o,e,t),uL(s,o),lL(s,o,r,e),nL(s,o),iL(s,o,n),o["!margins"]&&ie(s,476,Y5(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&aL(s,o),oL(s,o,e,n),ie(s,130),s.end()}function fL(e,t){e.l+=10;var r=nr(e);return{name:r}}var hL=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function mL(e){return!e.Workbook||!e.Workbook.WBProps?"false":zR(e.Workbook.WBProps.date1904)?"true":"false"}var xL="][*?/\\".split("");function eS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return xL.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pL(e,t,r){e.forEach(function(n,s){eS(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function gL(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)B8(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function tS(e){var t=[At];t[t.length]=fe("workbook",null,{xmlns:No[0],"xmlns:r":Lt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(hL.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=fe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Xe(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=fe("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=fe("definedName",Xe(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function vL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dh(e),r.name=nr(e),r}function yL(e,t){return t||(t=re(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wx(e.strRelID,t),Bt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wL(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?nr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function bL(e,t){t||(t=re(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),h4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NL(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=mI(e),o=R8(e,0,r),l=yx(e);e.l=n;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function SL(e,t){ie(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ie(e,156,yL(s))}ie(e,144)}function jL(e,t){t||(t=re(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Bt("SheetJS",t),Bt(Xu.version,t),Bt(Xu.version,t),Bt("7262",t),t.length>t.l?t.slice(0,t.l):t}function TL(e,t){t||(t=re(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function EL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(ie(e,135),ie(e,158,TL(s)),ie(e,136))}}function CL(e,t){var r=Er();return ie(r,131),ie(r,128,jL()),ie(r,153,bL(e.Workbook&&e.Workbook.WBProps||null)),EL(r,e),SL(r,e),ie(r,132),r.end()}function kL(e,t,r){return(t.slice(-4)===".bin"?CL:tS)(e)}function _L(e,t,r,n,s){return(t.slice(-4)===".bin"?dL:J4)(e,r,n,s)}function AL(e,t,r){return(t.slice(-4)===".bin"?YD:L4)(e,r)}function PL(e,t,r){return(t.slice(-4)===".bin"?bD:R4)(e,r)}function FL(e,t,r){return(t.slice(-4)===".bin"?uO:W4)(e)}function RL(e){return(e.slice(-4)===".bin"?rO:U4)()}function IL(e,t){var r=[];return e.Props&&r.push(AI(e.Props,t)),e.Custprops&&r.push(PI(e.Props,e.Custprops)),r.join("")}function DL(){return""}function OL(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(fe("NumberFormat",null,{"ss:Format":Xe(wt[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(fe("Style",i.join(""),o))}),fe("Styles",r.join(""))}function rS(e){return fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+jx(e.Ref,{r:0,c:0})})}function LL(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(rS(s)))}return fe("Names",r.join(""))}function ML(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(rS(l)))}return i.join("")}function BL(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(fe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(fe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Gt("ProtectContents","True")),e["!protect"].objects&&s.push(Gt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Gt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Gt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Gt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":fe("WorksheetOptions",s.join(""),{xmlns:Dr.x})}function UL(e){return e.map(function(t){var r=VR(t.t||""),n=fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return fe("Comment",n,{"ss:Author":t.a})}).join("")}function $L(e,t,r,n,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Xe(jx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Mt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Xe(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Xe(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=oc[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||wt[14]);break;case"s":m="String",f=HR(e.v||"");break}var p=da(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var x=e.v!=null?f:"",h=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(h+=UL(e.c)),fe("Cell",h,l)}function WL(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=O4(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function HL(e,t,r,n){if(!e["!ref"])return"";var s=ot(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,w){Nx(g);var v=!!g.width,y=qd(w,g),N={"ss:Index":w+1};v&&(N["ss:Width"]=sd(y.width)),g.hidden&&(N["ss:Hidden"]="1"),l.push(fe("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[WL(u,(e["!rows"]||[])[u])],m=s.s.c;m<=s.e.c;++m){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>m)&&!(i[o].s.r>u)&&!(i[o].e.c<m)&&!(i[o].e.r<u)){(i[o].s.c!=m||i[o].s.r!=u)&&(f=!0);break}if(!f){var p={r:u,c:m},x=Qe(p),h=c?(e[u]||[])[m]:e[x];d.push($L(h,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function VL(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?ML(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?HL(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(BL(i,t,e,r)),n.join("")}function zL(e,t){t||(t={}),e.SSF||(e.SSF=_r(wt)),e.SSF&&(zd(),Vd(e.SSF),t.revssf=Gd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(IL(e,t)),r.push(DL()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(fe("Worksheet",VL(n,t,e),{"ss:Name":Xe(e.SheetNames[n])}));return r[2]=OL(e,t),r[3]=LL(e),At+fe("Workbook",r.join(""),{xmlns:Dr.ss,"xmlns:o":Dr.o,"xmlns:x":Dr.x,"xmlns:ss":Dr.ss,"xmlns:dt":Dr.dt,"xmlns:html":Dr.html})}var tf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function GL(e,t){var r=[],n=[],s=[],i=0,o,l=lv(bv,"n"),c=lv(Nv,"n");if(e.Props)for(o=qt(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=qt(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<s.length;++i)E4.indexOf(s[i][0])>-1||S4.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&Ze.utils.cfb_add(t,"/SummaryInformation",Cv(n,tf.SI,c,Nv)),(r.length||u.length)&&Ze.utils.cfb_add(t,"/DocumentSummaryInformation",Cv(r,tf.DSI,l,bv,u.length?u:null,tf.UDI))}function KL(e,t){var r=t||{},n=Ze.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,s,nS(e,r)),r.biff==8&&(e.Props||e.Custprops)&&GL(e,n),r.biff==8&&e.vbaraw&&dO(n,Ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var YL={0:{f:Q8},1:{f:a5},2:{f:T5},3:{f:h5},4:{f:c5},5:{f:b5},6:{f:A5},7:{f:g5},8:{f:L5},9:{f:O5},10:{f:I5},11:{f:D5},12:{f:o5},13:{f:C5},14:{f:x5},15:{f:d5},16:{f:S5},17:{f:F5},18:{f:y5},19:{f:vx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:NL},40:{},42:{},43:{f:AD},44:{f:kD},45:{f:RD},46:{f:DD},47:{f:ID},48:{},49:{f:oI},50:{},51:{f:QD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lD},62:{f:_5},63:{f:nO},64:{f:Z5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n5},148:{f:e5,p:16},151:{f:H5},152:{},153:{f:wL},154:{},155:{},156:{f:vL},157:{},158:{},159:{T:1,f:vD},160:{T:-1},161:{T:1,f:Ja},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:M5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XD},336:{T:-1},337:{f:eO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:V5},427:{f:z5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:K5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lO},633:{T:1},634:{T:-1},635:{T:1,f:iO},636:{T:-1},637:{f:dI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&xx(r)&&e.push(r)}}function XL(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return he(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function cc(e,t,r){return e||(e=re(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function qL(e,t,r,n){var s=re(9);return cc(s,e,t),k4(r,n||"b",s),s}function QL(e,t,r){var n=re(8+2*r.length);return cc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function JL(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?kr(fr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?he(e,2,fD(r,n,s)):he(e,3,dD(r,n,s));return;case"b":case"e":he(e,5,qL(r,n,t.v,t.t));return;case"s":case"str":he(e,4,QL(r,n,(t.v||"").slice(0,255)));return}he(e,1,cc(null,r,n))}function ZL(e,t,r,n){var s=Array.isArray(t),i=ot(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=_t(i)}for(var u=i.s.r;u<=i.e.r;++u){l=Yt(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=rr(d)),o=c[d]+l;var m=s?(t[u]||[])[d]:t[o];m&&JL(e,m,u,d)}}}function eM(e,t){for(var r=t||{},n=Er(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return he(n,r.biff==4?1033:r.biff==3?521:9,bx(e,16,r)),ZL(n,e.Sheets[e.SheetNames[s]],s,r),he(n,10),n.end()}function tM(e,t,r){he(e,49,YI({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function rM(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&he(e,1054,QI(s,t[s],r))})}function nM(e,t){var r=re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),he(e,2151,r),r=re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),P4(ot(t["!ref"]||"A1"),r),r.write_shift(4,4),he(e,2152,r)}function sM(e,t){for(var r=0;r<16;++r)he(e,224,_v({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){he(e,224,_v(n,0,t))})}function aM(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];he(e,440,aD(n)),n[1].Tooltip&&he(e,2048,iD(n))}delete t["!links"]}function iM(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&he(e,125,cD(qd(s,n),s))})}}function oM(e,t,r,n,s){var i=16+da(s.cellXfs,t,s);if(t.v==null&&!t.bf){he(e,513,Va(r,n,i));return}if(t.bf)he(e,6,P8(t,r,n,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?kr(fr(t.v)):t.v;he(e,515,tD(r,n,o,i));break;case"b":case"e":he(e,517,eD(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Ex(s.Strings,t.v,s.revStrings);he(e,253,XI(r,n,l,i))}else he(e,516,qI(r,n,(t.v||"").slice(0,255),i,s));break;default:he(e,513,Va(r,n,i))}}function lM(e,t,r){var n=Er(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,m="",f=[],p=ot(i["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}he(n,2057,bx(r,16,t)),he(n,13,Kr(1)),he(n,12,Kr(100)),he(n,15,ur(!0)),he(n,17,ur(!1)),he(n,16,Ha(.001)),he(n,95,ur(!0)),he(n,42,ur(!1)),he(n,43,ur(!1)),he(n,130,Kr(1)),he(n,128,ZI()),he(n,131,ur(!1)),he(n,132,ur(!1)),u&&iM(n,i["!cols"]),he(n,512,JI(p,t)),u&&(i["!links"]=[]);for(var h=p.s.r;h<=p.e.r;++h){m=Yt(h);for(var g=p.s.c;g<=p.e.c;++g){h===p.s.r&&(f[g]=rr(g)),d=f[g]+m;var w=c?(i[h]||[])[g]:i[d];w&&(oM(n,w,h,g,t),u&&w.l&&i["!links"].push([d,w.l]))}}var v=l.CodeName||l.name||s;return u&&he(n,574,KI((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&he(n,229,sD(i["!merges"])),u&&aM(n,i),he(n,442,A4(v)),u&&nM(n,i),he(n,10),n.end()}function cM(e,t,r){var n=Er(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(he(n,2057,bx(e,5,r)),r.bookType=="xla"&&he(n,135),he(n,225,l?Kr(1200):null),he(n,193,II(2)),c&&he(n,191),c&&he(n,192),he(n,226),he(n,92,HI("SheetJS",r)),he(n,66,Kr(l?1200:1252)),l&&he(n,353,Kr(0)),l&&he(n,448),he(n,317,uD(e.SheetNames.length)),l&&e.vbaraw&&he(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";he(n,442,A4(u))}he(n,156,Kr(17)),he(n,25,ur(!1)),he(n,18,ur(!1)),he(n,19,Kr(0)),l&&he(n,431,ur(!1)),l&&he(n,444,Kr(0)),he(n,61,GI()),he(n,64,ur(!1)),he(n,141,Kr(0)),he(n,34,ur(mL(e)=="true")),he(n,14,ur(!0)),l&&he(n,439,ur(!1)),he(n,218,Kr(0)),tM(n,e,r),rM(n,e.SSF,r),sM(n,r),l&&he(n,352,ur(!1));var d=n.end(),m=Er();l&&he(m,140,oD()),l&&r.Strings&&XL(m,252,zI(r.Strings)),he(m,10);var f=m.end(),p=Er(),x=0,h=0;for(h=0;h<e.SheetNames.length;++h)x+=(l?12:11)+(l?2:1)*e.SheetNames[h].length;var g=d.length+x+f.length;for(h=0;h<e.SheetNames.length;++h){var w=i[h]||{};he(p,133,VI({pos:g,hs:w.Hidden||0,dt:0,name:e.SheetNames[h]},r)),g+=t[h].length}var v=p.end();if(x!=v.length)throw new Error("BS8 "+x+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),f.length&&y.push(f),zt(y)}function uM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=_r(wt)),e&&e.SSF&&(zd(),Vd(e.SSF),r.revssf=Gd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Cx(r),r.cellXfs=[],da(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=lM(s,r,e);return n.unshift(cM(e,n,r)),zt(n)}function nS(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=$r(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return uM(e,t);case 4:case 3:case 2:return eM(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function dM(e,t,r,n){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=Qe({r,c:o}),m=n.dense?(e[r]||[])[o]:e[d],f=m&&m.v!=null&&(m.h||WR(m.w||(ms(m),m.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":m&&(p["data-t"]=m&&m.t||"z",m.v!=null&&(p["data-v"]=m.v),m.z!=null&&(p["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+d,i.push(fe("td",f,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var fM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hM="</body></html>";function mM(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sS(e,t){var r=t||{},n=r.header!=null?r.header:fM,s=r.footer!=null?r.footer:hM,i=[n],o=$r(e["!ref"]);r.dense=Array.isArray(e),i.push(mM(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(dM(e,o,l,r));return i.push("</table>"+s),i.join("")}function aS(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Mt(n.origin):n.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=$r(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var m=[],f=0,p=e["!rows"]||(e["!rows"]=[]),x=0,h=0,g=0,w=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&h<c;++x){var N=l[x];if(Ov(N)){if(n.display)continue;p[h]={hidden:!0}}var S=N.children;for(g=w=0;g<S.length;++g){var C=S[g];if(!(n.display&&Ov(C))){var j=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):GR(C.innerHTML),E=C.getAttribute("data-z")||C.getAttribute("z");for(f=0;f<m.length;++f){var k=m[f];k.s.c==w+i&&k.s.r<h+s&&h+s<=k.e.r&&(w=k.e.c+1-i,f=-1)}y=+C.getAttribute("colspan")||1,((v=+C.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:h+s,c:w+i},e:{r:h+s+(v||1)-1,c:w+i+(y||1)-1}});var F={t:"s",v:j},M=C.getAttribute("data-t")||C.getAttribute("t")||"";j!=null&&(j.length==0?F.t=M||"z":n.raw||j.trim().length==0||M=="s"||(j==="TRUE"?F={t:"b",v:!0}:j==="FALSE"?F={t:"b",v:!1}:isNaN(ns(j))?isNaN(Ll(j).getDate())||(F={t:"d",v:fr(j)},n.cellDates||(F={t:"n",v:kr(F.v)}),F.z=n.dateNF||wt[14]):F={t:"n",v:ns(j)})),F.z===void 0&&E!=null&&(F.z=E);var R="",z=C.getElementsByTagName("A");if(z&&z.length)for(var B=0;B<z.length&&!(z[B].hasAttribute("href")&&(R=z[B].getAttribute("href"),R.charAt(0)!="#"));++B);R&&R.charAt(0)!="#"&&(F.l={Target:R}),n.dense?(e[h+s]||(e[h+s]=[]),e[h+s][w+i]=F):e[Qe({c:w+i,r:h+s})]=F,u.e.c<w+i&&(u.e.c=w+i),w+=y}}++h}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,h-1+s),e["!ref"]=_t(u),h>=c&&(e["!fullref"]=_t((u.e.r=l.length-x+h-1+s,u))),e}function iS(e,t){var r=t||{},n=r.dense?[]:{};return aS(n,e,t)}function xM(e,t){return Ya(iS(e,t),t)}function Ov(e){var t="",r=pM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var gM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return At+t}}(),Lv=function(){var e=function(i){return Xe(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Xe(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,m=$r(i["!ref"]||"A1"),f=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var h="",g=i["!rows"]||[];for(u=0;u<m.s.r;++u)h=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;u<=m.e.r;++u){for(h=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+h+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var w=!1,v={},y="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>d)&&!(f[p].s.r>u)&&!(f[p].e.c<d)&&!(f[p].e.r<u)){(f[p].s.c!=d||f[p].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,v["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(w){c.push(r);continue}var N=Qe({r:u,c:d}),S=x?(i[u]||[])[d]:i[N];if(S&&S.f&&(v["table:formula"]=Xe(L8(S.f)),S.F&&S.F.slice(0,N.length)==N)){var C=$r(S.F);v["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,v["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":y=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":y=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":y=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":y=S.w||fr(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=fr(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(y);if(S.l&&S.l.Target){var E=S.l.Target;E=E.charAt(0)=="#"?"#"+M8(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),j=fe("text:a",j,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+fe("table:table-cell",fe("text:p",j,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Nx(m),m.ods=l;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[At],u=Bl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Bl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(b4().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(n(o.Sheets[o.SheetNames[m]],o,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function oS(e,t){if(t.bookType=="fods")return Lv(e,t);var r=dx(),n="",s=[],i=[];return n="mimetype",Ie(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ie(r,n,Lv(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ie(r,n,gM(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ie(r,n,At+b4()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ie(r,n,_I(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ie(r,n,CI(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function od(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function vM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):pn(Ml(e))}function yM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function na(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function wM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Ul(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ke(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Mi(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Ul(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ul(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Wt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Ke(n*8+s.type)),s.type==2&&t.push(Ke(s.data.length)),t.push(s.data))})}),na(t)}function sn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Ul(e,n),i=Ft(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Mi(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ft(l.data),u=Mi(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=Mi(i[3][0].data)>>>0>0),r.push(o)}return r}function ai(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ke(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ke(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Ke(o.data.length)}],n[2].push({data:Wt(o.meta),type:2})});var i=Wt(n);t.push(Ke(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),na(t)}function bM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ul(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[na(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=na(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function an(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(bM(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return na(t)}function ii(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Ke(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return na(t)}function rf(e,t){var r=new Uint8Array(32),n=od(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,wM(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function nf(e,t){var r=new Uint8Array(32),n=od(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function ws(e){var t=Ft(e);return Ul(t[1][0].data)}function NM(e,t,r){var n,s,i,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Mi(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=od(e[7][0].data),d=0,m=[],f=od(e[4][0].data),p=0,x=[],h=0;h<t.length;++h){if(t[h]==null){u.setUint16(h*2,65535,!0),f.setUint16(h*2,65535);continue}u.setUint16(h*2,d,!0),f.setUint16(h*2,p,!0);var g,w;switch(typeof t[h]){case"string":g=rf({t:"s",v:t[h]},r),w=nf({t:"s",v:t[h]},r);break;case"number":g=rf({t:"n",v:t[h]},r),w=nf({t:"n",v:t[h]},r);break;case"boolean":g=rf({t:"b",v:t[h]},r),w=nf({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}m.push(g),d+=g.length,x.push(w),p+=w.length,++c}for(e[2][0].data=Ke(c);h<e[7][0].data.length/2;++h)u.setUint16(h*2,65535,!0),f.setUint16(h*2,65535,!0);return e[6][0].data=na(m),e[3][0].data=na(x),c}function SM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=$r(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(_t(n)));var i=ld(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(U){typeof U=="string"&&o.push(U)})});var l={},c=[],u=Ze.read(t.numbers,{type:"base64"});u.FileIndex.map(function(G,U){return[G,u.FullPaths[U]]}).forEach(function(G){var U=G[0],A=G[1];if(U.type==2&&U.name.match(/\.iwa/)){var H=U.content,Y=an(H),ae=sn(Y);ae.forEach(function(oe){c.push(oe.id),l[oe.id]={deps:[],location:A,type:Mi(oe.messages[0].meta[1][0].data)}})}}),c.sort(function(G,U){return G-U});var d=c.filter(function(G){return G>1}).map(function(G){return[G,Ke(G)]});u.FileIndex.map(function(G,U){return[G,u.FullPaths[U]]}).forEach(function(G){var U=G[0];if(G[1],!!U.name.match(/\.iwa/)){var A=sn(an(U.content));A.forEach(function(H){H.messages.forEach(function(Y){d.forEach(function(ae){H.messages.some(function(oe){return Mi(oe.meta[1][0].data)!=11006&&yM(oe.data,ae[1])})&&l[ae[0]].deps.push(H.id)})})})}});for(var m=Ze.find(u,l[1].location),f=sn(an(m.content)),p,x=0;x<f.length;++x){var h=f[x];h.id==1&&(p=h)}var g=ws(Ft(p.messages[0].data)[1][0].data);for(m=Ze.find(u,l[g].location),f=sn(an(m.content)),x=0;x<f.length;++x)h=f[x],h.id==g&&(p=h);for(g=ws(Ft(p.messages[0].data)[2][0].data),m=Ze.find(u,l[g].location),f=sn(an(m.content)),x=0;x<f.length;++x)h=f[x],h.id==g&&(p=h);for(g=ws(Ft(p.messages[0].data)[2][0].data),m=Ze.find(u,l[g].location),f=sn(an(m.content)),x=0;x<f.length;++x)h=f[x],h.id==g&&(p=h);var w=Ft(p.messages[0].data);{w[6][0].data=Ke(n.e.r+1),w[7][0].data=Ke(n.e.c+1);var v=ws(w[46][0].data),y=Ze.find(u,l[v].location),N=sn(an(y.content));{for(var S=0;S<N.length&&N[S].id!=v;++S);if(N[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var C=Ft(N[S].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var j=0;j<=n.e.c;++j){var E=[];E[1]=E[2]=[{type:0,data:Ke(j+420690)}],C[1].push({type:2,data:Wt(E)}),C[2].push({type:0,data:Ke(j)}),C[3].push({type:0,data:Ke(j)})}C[4]=[],C[5]=[],C[6]=[];for(var k=0;k<=n.e.r;++k)E=[],E[1]=E[2]=[{type:0,data:Ke(k+726270)}],C[4].push({type:2,data:Wt(E)}),C[5].push({type:0,data:Ke(k)}),C[6].push({type:0,data:Ke(k)});N[S].messages[0].data=Wt(C)}y.content=ii(ai(N)),y.size=y.content.length,delete w[46];var F=Ft(w[4][0].data);{F[7][0].data=Ke(n.e.r+1);var M=Ft(F[1][0].data),R=ws(M[2][0].data);y=Ze.find(u,l[R].location),N=sn(an(y.content));{if(N[0].id!=R)throw"Bad HeaderStorageBucket";var z=Ft(N[0].messages[0].data);for(k=0;k<i.length;++k){var B=Ft(z[2][0].data);B[1][0].data=Ke(k),B[4][0].data=Ke(i[k].length),z[2][k]={type:z[2][0].type,data:Wt(B)}}N[0].messages[0].data=Wt(z)}y.content=ii(ai(N)),y.size=y.content.length;var K=ws(F[2][0].data);y=Ze.find(u,l[K].location),N=sn(an(y.content));{if(N[0].id!=K)throw"Bad HeaderStorageBucket";for(z=Ft(N[0].messages[0].data),j=0;j<=n.e.c;++j)B=Ft(z[2][0].data),B[1][0].data=Ke(j),B[4][0].data=Ke(n.e.r+1),z[2][j]={type:z[2][0].type,data:Wt(B)};N[0].messages[0].data=Wt(z)}y.content=ii(ai(N)),y.size=y.content.length;var X=ws(F[4][0].data);(function(){for(var G=Ze.find(u,l[X].location),U=sn(an(G.content)),A,H=0;H<U.length;++H){var Y=U[H];Y.id==X&&(A=Y)}var ae=Ft(A.messages[0].data);{ae[3]=[];var oe=[];o.forEach(function(pe,Fe){oe[1]=[{type:0,data:Ke(Fe)}],oe[2]=[{type:0,data:Ke(1)}],oe[3]=[{type:2,data:vM(pe)}],ae[3].push({type:2,data:Wt(oe)})})}A.messages[0].data=Wt(ae);var se=ai(U),we=ii(se);G.content=we,G.size=G.content.length})();var ee=Ft(F[3][0].data);{var V=ee[1][0];delete ee[2];var te=Ft(V.data);{var ue=ws(te[2][0].data);(function(){for(var G=Ze.find(u,l[ue].location),U=sn(an(G.content)),A,H=0;H<U.length;++H){var Y=U[H];Y.id==ue&&(A=Y)}var ae=Ft(A.messages[0].data);{delete ae[6],delete ee[7];var oe=new Uint8Array(ae[5][0].data);ae[5]=[];for(var se=0,we=0;we<=n.e.r;++we){var pe=Ft(oe);se+=NM(pe,i[we],o),pe[1][0].data=Ke(we),ae[5].push({data:Wt(pe),type:2})}ae[1]=[{type:0,data:Ke(n.e.c+1)}],ae[2]=[{type:0,data:Ke(n.e.r+1)}],ae[3]=[{type:0,data:Ke(se)}],ae[4]=[{type:0,data:Ke(n.e.r+1)}]}A.messages[0].data=Wt(ae);var Fe=ai(U),Ee=ii(Fe);G.content=Ee,G.size=G.content.length})()}V.data=Wt(te)}F[3][0].data=Wt(ee)}w[4][0].data=Wt(F)}p.messages[0].data=Wt(w);var xe=ai(f),L=ii(xe);return m.content=L,m.size=m.content.length,u}function jM(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Cx(e){jM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function TM(e,t){return t.bookType=="ods"?oS(e,t):t.bookType=="numbers"?SM(e,t):t.bookType=="xlsb"?EM(e,t):CM(e,t)}function EM(e,t){Ni=1024,e&&!e.SSF&&(e.SSF=_r(wt)),e&&e.SSF&&(zd(),Vd(e.SSF),t.revssf=Gd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ul?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=H4.indexOf(t.bookType)>-1,s=v4();Cx(t=t||{});var i=dx(),o="",l=0;if(t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(i,o,N4(e.Props,t)),s.coreprops.push(o),Ye(t.rels,2,o,$e.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ie(i,o,j4(e.Props)),s.extprops.push(o),Ye(t.rels,3,o,$e.EXT_PROPS),e.Custprops!==e.Props&&qt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(i,o,T4(e.Custprops)),s.custprops.push(o),Ye(t.rels,4,o,$e.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ie(i,o,_L(l-1,o,t,e,d)),s.sheets.push(o),Ye(t.wbrels,-1,"worksheets/sheet"+l+"."+r,$e.WS[0])}if(m){var p=m["!comments"],x=!1,h="";p&&p.length>0&&(h="xl/comments"+l+"."+r,Ie(i,h,FL(p,h)),s.comments.push(h),Ye(d,-1,"../comments"+l+"."+r,$e.CMNT),x=!0),m["!legacy"]&&x&&Ie(i,"xl/drawings/vmlDrawing"+l+".vml",$4(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Ie(i,w4(o),Oi(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ie(i,o,PL(t.Strings,o,t)),s.strs.push(o),Ye(t.wbrels,-1,"sharedStrings."+r,$e.SST)),o="xl/workbook."+r,Ie(i,o,kL(e,o)),s.workbooks.push(o),Ye(t.rels,1,o,$e.WB),o="xl/theme/theme1.xml",Ie(i,o,B4(e.Themes,t)),s.themes.push(o),Ye(t.wbrels,-1,"theme/theme1.xml",$e.THEME),o="xl/styles."+r,Ie(i,o,AL(e,o,t)),s.styles.push(o),Ye(t.wbrels,-1,"styles."+r,$e.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Ie(i,o,e.vbaraw),s.vba.push(o),Ye(t.wbrels,-1,"vbaProject.bin",$e.VBA)),o="xl/metadata."+r,Ie(i,o,RL(o)),s.metadata.push(o),Ye(t.wbrels,-1,"metadata."+r,$e.XLMETA),Ie(i,"[Content_Types].xml",y4(s,t)),Ie(i,"_rels/.rels",Oi(t.rels)),Ie(i,"xl/_rels/workbook."+r+".rels",Oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function CM(e,t){Ni=1024,e&&!e.SSF&&(e.SSF=_r(wt)),e&&e.SSF&&(zd(),Vd(e.SSF),t.revssf=Gd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ul?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=H4.indexOf(t.bookType)>-1,s=v4();Cx(t=t||{});var i=dx(),o="",l=0;if(t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(i,o,N4(e.Props,t)),s.coreprops.push(o),Ye(t.rels,2,o,$e.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ie(i,o,j4(e.Props)),s.extprops.push(o),Ye(t.rels,3,o,$e.EXT_PROPS),e.Custprops!==e.Props&&qt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(i,o,T4(e.Custprops)),s.custprops.push(o),Ye(t.rels,4,o,$e.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ie(i,o,J4(l-1,t,e,m)),s.sheets.push(o),Ye(t.wbrels,-1,"worksheets/sheet"+l+"."+r,$e.WS[0])}if(f){var x=f["!comments"],h=!1,g="";if(x&&x.length>0){var w=!1;x.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ie(i,g,sO(x,d,t)),s.threadedcomments.push(g),Ye(m,-1,"../threadedComments/threadedComment"+l+"."+r,$e.TCMNT)),g="xl/comments"+l+"."+r,Ie(i,g,W4(x)),s.comments.push(g),Ye(m,-1,"../comments"+l+"."+r,$e.CMNT),h=!0}f["!legacy"]&&h&&Ie(i,"xl/drawings/vmlDrawing"+l+".vml",$4(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&Ie(i,w4(o),Oi(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ie(i,o,R4(t.Strings,t)),s.strs.push(o),Ye(t.wbrels,-1,"sharedStrings."+r,$e.SST)),o="xl/workbook."+r,Ie(i,o,tS(e)),s.workbooks.push(o),Ye(t.rels,1,o,$e.WB),o="xl/theme/theme1.xml",Ie(i,o,B4(e.Themes,t)),s.themes.push(o),Ye(t.wbrels,-1,"theme/theme1.xml",$e.THEME),o="xl/styles."+r,Ie(i,o,L4(e,t)),s.styles.push(o),Ye(t.wbrels,-1,"styles."+r,$e.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Ie(i,o,e.vbaraw),s.vba.push(o),Ye(t.wbrels,-1,"vbaProject.bin",$e.VBA)),o="xl/metadata."+r,Ie(i,o,U4()),s.metadata.push(o),Ye(t.wbrels,-1,"metadata."+r,$e.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ie(i,o,aO(d)),s.people.push(o),Ye(t.wbrels,-1,"persons/person.xml",$e.PEOPLE)),Ie(i,"[Content_Types].xml",y4(s,t)),Ie(i,"_rels/.rels",Oi(t.rels)),Ie(i,"xl/_rels/workbook."+r+".rels",Oi(t.wbrels)),delete t.revssf,delete t.ssf,i}function kM(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=hs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lS(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ac(t.file,Ze.write(e,{type:We?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ze.write(e,t)}function _M(e,t){var r=_r(t||{}),n=TM(e,r);return AM(n,r)}function AM(e,t){var r={},n=We?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Hd(s))}return t.password&&typeof encrypt_agile<"u"?lS(encrypt_agile(s,t.password),t):t.type==="file"?ac(t.file,s):t.type=="string"?il(s):s}function PM(e,t){var r=t||{},n=KL(e,r);return lS(n,r)}function Cn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ol(Ml(n));case"binary":return Ml(n);case"string":return e;case"file":return ac(t.file,n,"utf8");case"buffer":return We?ps(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Cn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function FM(e,t){switch(t.type){case"base64":return Ol(e);case"binary":return e;case"string":return e;case"file":return ac(t.file,e,"binary");case"buffer":return We?ps(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ol(r):t.type=="string"?il(r):r;case"file":return ac(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function cS(e,t){iR(),gL(e);var r=_r(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=cS(e,r);return r.type="array",Hd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Cn(zL(e,r),r);case"slk":case"sylk":return Cn(mD.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Cn(sS(e.Sheets[e.SheetNames[s]],r),r);case"txt":return FM(uS(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Cn(kx(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Cn(xD.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return zc(hD.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Cn(pD.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Cn(SD.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Cn(F4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Cn(oS(e,r),r);case"wk1":return zc(Av.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return zc(Av.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),zc(nS(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),PM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return _M(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function RM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function IM(e,t,r){var n={};return n.type="file",n.file=t,RM(n),cS(e,n)}function DM(e,t,r,n,s,i,o,l){var c=Yt(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=o?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[p]!=null&&(f[i[p]]=u);continue}var h=x.v;switch(x.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(h==null)if(x.t=="e"&&h===null)f[i[p]]=null;else if(u!==void 0)f[i[p]]=u;else if(d&&h===null)f[i[p]]=null;else continue;else f[i[p]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?h:ms(x,h,l);h!=null&&(m=!1)}}return{row:f,isempty:m}}function ld(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ot(d);break;case"number":c=ot(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var m=Yt(c.s.r),f=[],p=[],x=0,h=0,g=Array.isArray(e),w=c.s.r,v=0,y={};g&&!e[w]&&(e[w]=[]);var N=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(N[v]||{}).hidden)switch(f[v]=rr(v),r=g?e[w][v]:e[f[v]+m],n){case 1:i[v]=v-c.s.c;break;case 2:i[v]=f[v];break;case 3:i[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=ms(r,null,u),h=y[o]||0,!h)y[o]=1;else{do l=o+"_"+h++;while(y[l]);y[o]=h,y[l]=1}i[v]=l}for(w=c.s.r+s;w<=c.e.r;++w)if(!(S[w]||{}).hidden){var C=DM(e,c,w,f,n,i,g,u);(C.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=C.row)}return p.length=x,p}var Mv=/"/g;function OM(e,t,r,n,s,i,o,l){for(var c=!0,u=[],d="",m=Yt(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var p=l.dense?(e[r]||[])[f]:e[n[f]+m];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:ms(p,null,l));for(var x=0,h=0;x!==d.length;++x)if((h=d.charCodeAt(x))===s||h===i||h===34||l.forceQuotes){d='"'+d.replace(Mv,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Mv,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function kx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=ot(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(f[x]||{}).hidden||(m[x]=rr(x));for(var h=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(d=OM(e,s,g,m,o,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((h++?l:"")+d)));return delete n.dense,r.join("")}function uS(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kx(e,t);return r}function LM(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=ot(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=rr(l);for(var d=s.s.r;d<=s.e.r;++d)for(i=Yt(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function dS(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var m=ot(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var f=n.header||[],p=0;t.forEach(function(h,g){qt(h).forEach(function(w){(p=f.indexOf(w))==-1&&(f[p=f.length]=w);var v=h[w],y="z",N="",S=Qe({c:l+p,r:o+g+s});u=$l(i,S),v&&typeof v=="object"&&!(v instanceof Date)?i[S]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=kr(v)),N=n.dateNF||wt[14]):v===null&&n.nullError&&(y="e",v=0),u?(u.t=y,u.v=v,delete u.w,delete u.R,N&&(u.z=N)):i[S]=u={t:y,v},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,l+f.length-1);var x=Yt(o);if(s)for(p=0;p<f.length;++p)i[rr(p+l)+x]={t:"s",v:f[p]};return i["!ref"]=_t(d),i}function MM(e,t){return dS(null,e,t)}function $l(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Mt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?$l(e,Qe(t)):$l(e,Qe({r:t,c:r||0}))}function BM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function UM(){return{SheetNames:[],Sheets:{}}}function $M(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(eS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function WM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=BM(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function HM(e,t){return e.z=t,e}function fS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function VM(e,t,r){return fS(e,"#"+t,r)}function zM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GM(e,t,r,n){for(var s=typeof t!="string"?t:ot(t),i=typeof t=="string"?t:_t(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=$l(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Kn={encode_col:rr,encode_row:Yt,encode_cell:Qe,encode_range:_t,decode_col:gx,decode_row:px,split_cell:iI,decode_cell:Mt,decode_range:$r,format_cell:ms,sheet_add_aoa:f4,sheet_add_json:dS,sheet_add_dom:aS,aoa_to_sheet:So,json_to_sheet:MM,table_to_sheet:iS,table_to_book:xM,sheet_to_csv:kx,sheet_to_txt:uS,sheet_to_json:ld,sheet_to_html:sS,sheet_to_formulae:LM,sheet_to_row_object_array:ld,sheet_get_cell:$l,book_new:UM,book_append_sheet:$M,book_set_sheet_visibility:WM,cell_set_number_format:HM,cell_set_hyperlink:fS,cell_set_internal_link:VM,cell_add_comment:zM,sheet_set_array_formula:GM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function KM(){const e=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("isLoggedIn"),window.location.href="/login"};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx(je,{onClick:e,size:"sm",className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Logout"})]})})}function YM(){const e=()=>{const d=new Date,m=d.getDay();let f;return m===0?f=-2:m===6?f=-1:f=5-m,new Date(d.getTime()+f*24*60*60*1e3).toISOString().split("T")[0]},[t,r]=b.useState(e()),n=()=>{const d=[],m=new Date,f=m.getDay(),p=f<=5?5-f:7-f+5,x=new Date(m.getTime()+p*24*60*60*1e3);for(let h=0;h<12;h++){const g=new Date(x.getTime()-h*7*24*60*60*1e3),w=g.toISOString().split("T")[0],v=`Week ending ${g.toLocaleDateString("en-UK",{day:"numeric",month:"short",year:"numeric"})} (Fri)`;d.push({value:w,label:v})}return d},{data:s,isLoading:i,error:o}=rt({queryKey:["/api/admin/time-tracking",t],queryFn:async()=>{const d=await fetch(`/api/admin/time-tracking?weekEnding=${t}`);if(!d.ok)throw new Error("Failed to fetch time tracking data");return d.json()},enabled:!!t});if(i)return a.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:a.jsx("div",{className:"text-white",children:"Loading time tracking data..."})});if(o)return a.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-red-400",children:["Error loading data: ",o.message]})});const l=(s==null?void 0:s.totals)||{totalHours:0,totalGrossEarnings:0,totalCisDeduction:0,totalNetEarnings:0,contractors:0},c=(s==null?void 0:s.contractors)||[],u=()=>{if(!s)return;const d=[["Weekly Payroll Report - Accounting Export"],[`Week ending: ${new Date(weekEnding).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}`],[""],["Summary"],["Total Hours",l.totalHours.toFixed(1)],["Gross Pay",`${l.totalGrossEarnings.toFixed(2)}`],["CIS Deductions",`${l.totalCisDeduction.toFixed(2)}`],["Net Payout",`${l.totalNetEarnings.toFixed(2)}`],["Number of Contractors",l.contractors],[""]],m=[["Daily Breakdown for Accounting"],[""],["Contractor","Date","Day","Location","Hours","Hourly Rate","Daily Gross","CIS Deduction","Daily Net","Start Time","End Time"]];c.forEach(N=>{N.sessions.forEach(S=>{const C=new Date(S.startTime),j=new Date(S.endTime),E=parseFloat(S.totalHours),k=E*N.hourlyRate,F=k*N.cisRate,M=k-F;m.push([N.contractorName,C.toLocaleDateString("en-GB"),C.toLocaleDateString("en-GB",{weekday:"long"}),S.jobSiteLocation||"Location data missing",E.toFixed(1),`${N.hourlyRate.toFixed(2)}`,`${k.toFixed(2)}`,`${F.toFixed(2)}`,`${M.toFixed(2)}`,C.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),j.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})])})});const f=[["Contractor Totals for Accounting"],[""],["Contractor Name","Total Days Worked","Total Hours","Hourly Rate","Gross Earnings","CIS Deduction (30%)","Net Pay","Primary Location"]];c.forEach(N=>{const S={};N.sessions.forEach(j=>{const E=j.jobSiteLocation||"Unknown";S[E]=(S[E]||0)+1});const C=Object.keys(S).reduce((j,E)=>S[j]>S[E]?j:E,"Unknown");f.push([N.contractorName,N.sessions.length,N.totalHours.toFixed(1),`${N.hourlyRate.toFixed(2)}`,`${N.grossEarnings.toFixed(2)}`,`${N.cisDeduction.toFixed(2)}`,`${N.netEarnings.toFixed(2)}`,C])});const p=[["Detailed Work Sessions"],[""],["Contractor","Date","Location","Hours","Rate/Hour","Daily Earnings","Start Time","End Time","Session ID"]];c.forEach(N=>{N.sessions.forEach(S=>{const C=new Date(S.startTime),j=new Date(S.endTime),E=parseFloat(S.totalHours)*N.hourlyRate;p.push([N.contractorName,C.toLocaleDateString("en-GB"),S.jobSiteLocation||"Location data missing",parseFloat(S.totalHours).toFixed(1),`${N.hourlyRate.toFixed(2)}`,`${E.toFixed(2)}`,C.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),j.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),S.id])})});const x=Kn.book_new(),h=Kn.aoa_to_sheet(d);Kn.book_append_sheet(x,h,"Summary");const g=Kn.aoa_to_sheet(m);Kn.book_append_sheet(x,g,"Daily Breakdown");const w=Kn.aoa_to_sheet(f);Kn.book_append_sheet(x,w,"Contractor Totals");const v=Kn.aoa_to_sheet(p);Kn.book_append_sheet(x,v,"Detailed Sessions");const y=`payroll_accounting_${t.replace(/-/g,"_")}.xlsx`;IM(x,y)};return a.jsxs("div",{className:"min-h-screen bg-slate-900",children:[a.jsx(KM,{}),a.jsx("div",{className:"bg-slate-800 px-6 py-4 border-b border-slate-600",children:a.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Weekly Payroll Report"}),a.jsxs("p",{className:"text-slate-300",children:["Week ending ",new Date(t).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(Gu,{value:t,onValueChange:r,children:[a.jsx(Rl,{className:"w-56 bg-slate-700 text-white border-slate-600",children:a.jsx(Ku,{})}),a.jsx(Il,{children:n().map(d=>a.jsx(Ii,{value:d.value,children:d.label},d.value))})]}),a.jsxs(je,{onClick:u,className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2","data-testid":"button-export-excel",children:[a.jsx(yk,{size:16}),"Export to Excel"]})]})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{className:"pb-3",children:a.jsx(tt,{className:"text-sm font-medium text-slate-400",children:"Total Hours"})}),a.jsx(Ae,{children:a.jsxs("div",{className:"text-2xl font-bold text-white",children:[l.totalHours.toFixed(1),"h"]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{className:"pb-3",children:a.jsx(tt,{className:"text-sm font-medium text-slate-400",children:"Gross Pay"})}),a.jsx(Ae,{children:a.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["",l.totalGrossEarnings.toFixed(2)]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{className:"pb-3",children:a.jsx(tt,{className:"text-sm font-medium text-slate-400",children:"CIS Deductions"})}),a.jsx(Ae,{children:a.jsxs("div",{className:"text-2xl font-bold text-orange-400",children:["",l.totalCisDeduction.toFixed(2)]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{className:"pb-3",children:a.jsx(tt,{className:"text-sm font-medium text-slate-400",children:"Net Payout"})}),a.jsx(Ae,{children:a.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:["",l.totalNetEarnings.toFixed(2)]})})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-white mb-4",children:["Contractor Breakdown (",l.contractors," contractors)"]}),c.map((d,m)=>a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx(tt,{className:"text-lg text-white",children:d.contractorName}),a.jsxs(mn,{className:"text-slate-400",children:["",d.hourlyRate.toFixed(2),"/hour  ",d.totalHours.toFixed(1)," hours"]})]}),a.jsxs(De,{variant:"outline",className:"text-slate-300 border-slate-600",children:[d.sessions.length," sessions"]})]})}),a.jsxs(Ae,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Gross Earnings"}),a.jsxs("div",{className:"text-lg font-semibold text-green-400",children:["",d.grossEarnings.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-slate-400 mb-1",children:["CIS (",(d.cisRate*100).toFixed(0),"%)"]}),a.jsxs("div",{className:"text-lg font-semibold text-orange-400",children:["-",d.cisDeduction.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Net Pay"}),a.jsxs("div",{className:"text-lg font-semibold text-blue-400",children:["",d.netEarnings.toFixed(2)]})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[a.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-2",children:"Work Sessions"}),a.jsx("div",{className:"space-y-2",children:d.sessions.map((f,p)=>a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("span",{className:"text-slate-400",children:[new Date(f.startTime).toLocaleDateString("en-GB")," -",f.jobSiteLocation||"Location data missing"]}),a.jsxs("span",{className:"text-slate-300",children:[parseFloat(f.totalHours).toFixed(1),"h"]})]},p))})]})]})]},m))]}),c.length===0&&a.jsx(_e,{className:"bg-slate-800 border-slate-700",children:a.jsx(Ae,{className:"text-center py-12",children:a.jsx("div",{className:"text-slate-400",children:"No contractor data found for this week"})})})]})]})}function XM(){const e=()=>{localStorage.removeItem("userRole"),localStorage.removeItem("isLoggedIn"),window.location.href="/login"};return a.jsx("div",{className:"fixed top-4 left-4 z-50 bg-slate-800 rounded-lg p-2 border border-slate-600 shadow-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Admin"}),a.jsx("button",{onClick:e,className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded",children:"Logout"})]})})}function qM(){const[e,t]=b.useState(!1),{data:r=[],isLoading:n}=rt({queryKey:["/api/admin/active-sessions"],refetchInterval:1e4}),[s,i]=b.useState({});return b.useEffect(()=>{if(r.length>0){const o=async()=>{const c={};for(const u of r)try{const d=await fetch(`/api/contractor-location/${encodeURIComponent(u.contractorName)}`);if(d.ok){const m=await d.json();c[u.contractorName]=m}}catch{console.log(`No GPS location for ${u.contractorName}`)}i(c)};o();const l=setInterval(o,3e4);return()=>clearInterval(l)}},[r]),a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsx(XM,{}),a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center",children:a.jsx("i",{className:"fas fa-clock text-white text-sm"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Live Monitor"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Real-time contractor tracking"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>t(!e),className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center hover:bg-yellow-700 transition-colors",children:a.jsx("span",{className:"text-white font-bold text-sm",children:(localStorage.getItem("adminName")||"Admin").split(" ").map(o=>o[0]).join("").slice(0,2)})}),e&&a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-slate-800 rounded-lg shadow-lg border border-slate-600 z-50",children:a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>window.location.href="/admin",className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-white",children:[a.jsx("i",{className:"fas fa-tachometer-alt mr-3 w-4"}),"Admin Dashboard"]}),a.jsxs("button",{onClick:()=>window.location.href="/payroll-overview",className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-white",children:[a.jsx("i",{className:"fas fa-clock mr-3 w-4"}),"Time Tracking"]}),a.jsxs("button",{onClick:()=>window.location.href="/job-assignments",className:"w-full px-4 py-2 text-left hover:bg-slate-700 flex items-center text-white",children:[a.jsx("i",{className:"fas fa-tasks mr-3 w-4"}),"Job Assignments"]})]})})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-green-500 text-lg font-semibold",children:"Live Clock Monitoring"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-green-500 text-sm",children:"Live"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"text-white text-base font-medium",children:["Active Workers (",r.length,")"]}),n?a.jsx("div",{className:"text-slate-400",children:"Loading..."}):r.length>0?a.jsx("div",{className:"space-y-4",children:r.map(o=>{const l=s[o.contractorName],c=l&&l.latitude&&l.longitude;return a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700/50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500":"bg-yellow-500"}`}),a.jsx("span",{className:"text-white font-medium",children:o.contractorName})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-white text-xs px-2 py-1 bg-green-700 rounded",children:"Active"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Start Time"}),a.jsx("span",{className:"text-slate-300 text-sm",children:o.startTime?new Date(o.startTime).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):"Unknown"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Location"}),a.jsx("span",{className:`text-xs px-2 py-1 rounded ${c?"bg-green-700 text-white":"bg-yellow-700 text-white"}`,children:c?"GPS Tracked":"No GPS Signal"})]}),c&&a.jsxs("div",{className:"text-xs text-slate-400 mt-2",children:["Last GPS: ",new Date(l.lastUpdate).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-slate-400 text-sm",children:"Job Site"}),a.jsx("span",{className:"text-slate-300 text-sm",children:o.jobSiteLocation||"Unknown"})]})]})]},o.id)})}):a.jsx("div",{className:"text-slate-500 text-center py-8",children:"No workers currently active"})]})]})]})}function QM(){const[e,t]=b.useState(""),[r,n]=b.useState(""),[s,i]=b.useState(""),[o,l]=b.useState(""),[c,u]=b.useState(""),{toast:d}=Tt(),m=[{name:"Marius Andronache",telegramId:"8006717361",username:"marius",password:"marius123",status:"Active"},{name:"Dalwayne Diedericks",telegramId:"8016744652",username:"dalwayne",password:"dalwayne123",status:"Active"},{name:"Earl",telegramId:"6792554033",username:"earl",password:"earl123",status:"Active"},{name:"Muhammed",telegramId:"5209713845",username:"muhammed",password:"muhammed123",status:"Active"}],f=(g,w)=>{navigator.clipboard.writeText(g),d({title:"Telegram ID Copied",description:`${w}'s Telegram ID: ${g}`})},p=(g,w,v)=>{const y=`Username: ${g}
Password: ${w}`;navigator.clipboard.writeText(y),d({title:"Login Credentials Copied",description:`${v}'s login credentials copied to clipboard`})},x=()=>{const g=` ERdesignandbuild Contractor Application

Hi ${e||"[Contractor Name]"},

Please complete your contractor application form by providing:

 **Required Information:**
 Personal details (Name, Email, Phone, Address)
 Right to work documentation
 CIS registration status
 Banking information
 Emergency contact
 Trade specializations and experience

Reply with your completed information or visit our application portal.

Best regards,
ERdesignandbuild Team`;navigator.clipboard.writeText(g),d({title:"Form Message Copied",description:"Send this message to the contractor on Telegram"})},h=()=>{if(!e||!r||!o||!c){d({title:"Missing Information",description:"Please enter contractor name, phone number, username, and password",variant:"destructive"});return}const g={name:e,phone:r,telegramId:s||"Not provided",username:o,password:c,dateAdded:new Date().toISOString(),status:"pending_application"},w=JSON.parse(localStorage.getItem("contractor_contacts")||"[]");w.push(g),localStorage.setItem("contractor_contacts",JSON.stringify(w)),d({title:"Contractor Added",description:`${e} has been added with login credentials`}),t(""),n(""),i(""),l(""),u("")};return a.jsx("div",{className:"min-h-screen bg-slate-900 text-white p-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"flex items-center mb-6",children:[a.jsx(Un,{className:"h-8 w-8 text-yellow-600 mr-3"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Contractor ID Capture"})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700 mb-6",children:[a.jsx(et,{children:a.jsxs(tt,{className:"text-yellow-600 flex items-center",children:[a.jsx(Uu,{className:"h-5 w-5 mr-2"})," Current Contractor Telegram IDs"]})}),a.jsx(Ae,{children:a.jsx("div",{className:"space-y-3",children:m.map((g,w)=>a.jsxs("div",{className:"flex items-center justify-between bg-slate-700 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-xs",children:g.name.split(" ").map(v=>v[0]).join("").slice(0,2)})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-white",children:g.name}),a.jsxs("div",{className:"text-sm text-slate-400",children:["ID: ",g.telegramId]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Username: ",g.username," | Password: ",g.password]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-xs bg-green-900 text-green-300 px-2 py-1 rounded",children:g.status}),a.jsx(je,{size:"sm",onClick:()=>f(g.telegramId,g.name),className:"bg-yellow-600 hover:bg-yellow-700 text-black","data-testid":`copy-telegram-${g.name.toLowerCase().replace(" ","-")}`,children:a.jsx(vg,{className:"h-3 w-3"})}),a.jsx(je,{size:"sm",onClick:()=>p(g.username,g.password,g.name),className:"bg-blue-600 hover:bg-blue-700 text-white","data-testid":`copy-credentials-${g.name.toLowerCase().replace(" ","-")}`,children:a.jsx(Un,{className:"h-3 w-3"})})]})]},w))})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700 mb-6",children:[a.jsx(et,{children:a.jsx(tt,{className:"text-yellow-600",children:"Add New Contractor"})}),a.jsxs(Ae,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contractor Name"}),a.jsx(qr,{value:e,onChange:g=>t(g.target.value),placeholder:"Enter contractor's full name",className:"bg-slate-700 border-slate-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone Number"}),a.jsx(qr,{value:r,onChange:g=>n(g.target.value),placeholder:"e.g., 07534251548",className:"bg-slate-700 border-slate-600"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Telegram ID (Optional)",a.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"Get this from the contractor"})]}),a.jsx(qr,{value:s,onChange:g=>i(g.target.value),placeholder:"e.g., @username or user ID number",className:"bg-slate-700 border-slate-600"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Login Username",a.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"For contractor portal access"})]}),a.jsx(qr,{value:o,onChange:g=>l(g.target.value),placeholder:"e.g., john.smith",className:"bg-slate-700 border-slate-600","data-testid":"input-username"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Login Password",a.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"For contractor portal access"})]}),a.jsx(qr,{type:"password",value:c,onChange:g=>u(g.target.value),placeholder:"Enter secure password",className:"bg-slate-700 border-slate-600","data-testid":"input-password"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs(je,{onClick:h,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 text-black",children:[a.jsx(Un,{className:"h-4 w-4 mr-2"}),"Save Contractor"]}),a.jsxs(je,{onClick:x,variant:"outline",className:"flex-1 border-slate-600 hover:bg-slate-700",children:[a.jsx(vg,{className:"h-4 w-4 mr-2"}),"Copy Form Message"]})]})]})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{children:a.jsxs(tt,{className:"text-yellow-600 flex items-center",children:[a.jsx(Uu,{className:"h-5 w-5 mr-2"}),"How to Get Telegram ID"]})}),a.jsx(Ae,{children:a.jsxs("div",{className:"space-y-3 text-sm text-slate-300",children:[a.jsxs("div",{className:"bg-slate-700 p-3 rounded",children:[a.jsx("h4",{className:"font-medium text-white mb-2",children:"Method 1: Ask the Contractor"}),a.jsx("p",{children:'Ask them to search for "@userinfobot" on Telegram and send /start. The bot will reply with their user ID.'})]}),a.jsxs("div",{className:"bg-slate-700 p-3 rounded",children:[a.jsx("h4",{className:"font-medium text-white mb-2",children:"Method 2: Username Method"}),a.jsx("p",{children:"If they have a username (like @john_contractor), you can use that instead of the numeric ID."})]}),a.jsxs("div",{className:"bg-slate-700 p-3 rounded",children:[a.jsx("h4",{className:"font-medium text-white mb-2",children:"Method 3: Phone Contact"}),a.jsx("p",{children:"Start with their phone number for initial contact, then get Telegram ID for future automated messages."})]})]})})]})]})})}var _x="Switch",[JM,y7]=la(_x),[ZM,e7]=JM(_x),hS=b.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...m}=e,[f,p]=b.useState(null),x=ut(t,y=>p(y)),h=b.useRef(!1),g=f?d||!!f.closest("form"):!0,[w=!1,v]=oo({prop:s,defaultProp:i,onChange:u});return a.jsxs(ZM,{scope:r,checked:w,disabled:l,children:[a.jsx(Me.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":pS(w),"data-disabled":l?"":void 0,disabled:l,value:c,...m,ref:x,onClick:Ce(e.onClick,y=>{v(N=>!N),g&&(h.current=y.isPropagationStopped(),h.current||y.stopPropagation())})}),g&&a.jsx(t7,{control:f,bubbles:!h.current,name:n,value:c,checked:w,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});hS.displayName=_x;var mS="SwitchThumb",xS=b.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,s=e7(mS,r);return a.jsx(Me.span,{"data-state":pS(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});xS.displayName=mS;var t7=e=>{const{control:t,checked:r,bubbles:n=!0,...s}=e,i=b.useRef(null),o=Pb(r),l=O2(t);return b.useEffect(()=>{const c=i.current,u=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==r&&m){const f=new Event("click",{bubbles:n});m.call(c,r),c.dispatchEvent(f)}},[o,r,n]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:i,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function pS(e){return e?"checked":"unchecked"}var gS=hS,r7=xS;const Lh=b.forwardRef(({className:e,...t},r)=>a.jsx(gS,{className:He("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:a.jsx(r7,{className:He("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Lh.displayName=gS.displayName;function n7(){const{toast:e}=Tt(),t=oa(),{data:r,isLoading:n}=rt({queryKey:["/api/admin-settings/saturday_overtime"],queryFn:async()=>{const f=await fetch("/api/admin-settings/saturday_overtime");if(f.status===404)return null;if(!f.ok)throw new Error("Failed to fetch Saturday overtime setting");return f.json()},retry:!1}),{data:s,isLoading:i}=rt({queryKey:["/api/admin-settings/sunday_overtime"],queryFn:async()=>{const f=await fetch("/api/admin-settings/sunday_overtime");if(f.status===404)return null;if(!f.ok)throw new Error("Failed to fetch Sunday overtime setting");return f.json()},retry:!1}),o=Tr({mutationFn:async f=>{const p={settingKey:"saturday_overtime",settingValue:f.toString(),description:"Allow contractors to work overtime on Saturdays",updatedBy:"Admin"},x=await fetch("/api/admin-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!x.ok)throw new Error("Failed to update Saturday overtime setting");return x.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["/api/admin-settings/saturday_overtime"]}),e({title:"Setting Updated",description:"Saturday overtime setting has been updated successfully."})},onError:f=>{e({title:"Update Failed",description:"Failed to update Saturday overtime setting. Please try again.",variant:"destructive"})}}),l=Tr({mutationFn:async f=>{const p={settingKey:"sunday_overtime",settingValue:f.toString(),description:"Allow contractors to work overtime on Sundays",updatedBy:"Admin"},x=await fetch("/api/admin-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!x.ok)throw new Error("Failed to update Sunday overtime setting");return x.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["/api/admin-settings/sunday_overtime"]}),e({title:"Setting Updated",description:"Sunday overtime setting has been updated successfully."})},onError:f=>{e({title:"Update Failed",description:"Failed to update Sunday overtime setting. Please try again.",variant:"destructive"})}}),c=f=>{o.mutate(f)},u=f=>{l.mutate(f)},d=(r==null?void 0:r.settingValue)==="true",m=(s==null?void 0:s.settingValue)==="true";return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-black font-bold text-sm",children:""})}),a.jsx("h1",{className:"text-2xl font-bold text-yellow-400",children:"Admin Settings"})]}),a.jsx("p",{className:"text-slate-400",children:"Configure system settings for contractor management"})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700",children:[a.jsx(et,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(tt,{className:"text-yellow-400 flex items-center space-x-2",children:[a.jsx("span",{children:"Saturday Overtime"}),d&&a.jsx(De,{className:"bg-green-600 text-white",children:"ENABLED"}),!d&&a.jsx(De,{className:"bg-red-600 text-white",children:"DISABLED"})]}),a.jsx(mn,{className:"text-slate-400",children:"Allow contractors to clock in and work overtime on Saturdays"})]}),a.jsx(Lh,{checked:d,onCheckedChange:c,disabled:n||o.isPending,className:"data-[state=checked]:bg-yellow-500"})]})}),a.jsx(Ae,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-sm text-slate-300",children:[a.jsx("div",{className:"font-semibold text-yellow-400 mb-2",children:"Current Configuration:"}),a.jsxs("ul",{className:"space-y-1 text-slate-400",children:[a.jsx("li",{children:" Regular Hours: Monday-Friday, 7:45 AM - 5:00 PM"}),a.jsxs("li",{children:[" Saturday Overtime:"," ",d?"Allowed":"Not Allowed"]}),a.jsxs("li",{children:[" Sunday Overtime:"," ",m?"Allowed":"Not Allowed"]}),a.jsx("li",{children:" GPS Validation: 1km radius required for all work sessions"})]})]}),d&&a.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-600/30 rounded-lg",children:[a.jsx("div",{className:"text-yellow-400 font-semibold mb-1",children:" Saturday Overtime Active"}),a.jsx("div",{className:"text-sm text-slate-300",children:"Contractors can now clock in on Saturdays during regular hours (7:45 AM - 5:00 PM). All GPS and location validation rules still apply."})]}),!d&&a.jsx("div",{className:"p-3 bg-slate-700/50 border border-slate-600 rounded-lg",children:a.jsx("div",{className:"text-slate-400 text-sm",children:"Saturday work is currently disabled. Contractors cannot clock in on Saturdays."})}),(r==null?void 0:r.updatedAt)&&a.jsxs("div",{className:"text-xs text-slate-500",children:["Last updated:"," ",new Date(r.updatedAt).toLocaleString()," ","by ",r.updatedBy]})]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-700 mt-4",children:[a.jsx(et,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(tt,{className:"text-yellow-400 flex items-center space-x-2",children:[a.jsx("span",{children:"Sunday Overtime"}),m&&a.jsx(De,{className:"bg-green-600 text-white",children:"ENABLED"}),!m&&a.jsx(De,{className:"bg-red-600 text-white",children:"DISABLED"})]}),a.jsx(mn,{className:"text-slate-400",children:"Allow contractors to clock in and work overtime on Sundays"})]}),a.jsx(Lh,{checked:m,onCheckedChange:u,disabled:i||l.isPending,className:"data-[state=checked]:bg-yellow-500"})]})}),a.jsx(Ae,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-sm text-slate-300",children:[a.jsx("div",{className:"font-semibold text-yellow-400 mb-2",children:"Current Configuration:"}),a.jsxs("ul",{className:"space-y-1 text-slate-400",children:[a.jsx("li",{children:" Regular Hours: Monday-Friday, 7:45 AM - 5:00 PM"}),a.jsxs("li",{children:[" Saturday Overtime:"," ",d?"Allowed":"Not Allowed"]}),a.jsxs("li",{children:[" Sunday Overtime:"," ",m?"Allowed":"Not Allowed"]}),a.jsx("li",{children:" GPS Validation: 1km radius required for all work sessions"})]})]}),m&&a.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-600/30 rounded-lg",children:[a.jsx("div",{className:"text-yellow-400 font-semibold mb-1",children:" Sunday Overtime Active"}),a.jsx("div",{className:"text-sm text-slate-300",children:"Contractors can now clock in on Sundays during regular hours (7:45 AM - 5:00 PM). All GPS and location validation rules still apply."})]}),!m&&a.jsx("div",{className:"p-3 bg-slate-700/50 border border-slate-600 rounded-lg",children:a.jsx("div",{className:"text-slate-400 text-sm",children:"Sunday work is currently disabled. Contractors cannot clock in on Sundays."})}),(s==null?void 0:s.updatedAt)&&a.jsxs("div",{className:"text-xs text-slate-500",children:["Last updated:"," ",new Date(s.updatedAt).toLocaleString()," by"," ",s.updatedBy]})]})})]})]})}function Bv(){const{toast:e}=Tt(),{data:t=[],isLoading:r}=rt({queryKey:["/api/pending-inspections"]}),n=Tr({mutationFn:async o=>{const l=await fetch(`/api/complete-inspection/${o}`,{method:"POST"});if(!l.ok)throw new Error("Failed to complete inspection");return l.json()},onSuccess:()=>{io.invalidateQueries({queryKey:["/api/pending-inspections"]}),e({title:"Inspection Completed",description:"The inspection has been marked as completed."})},onError:o=>{e({title:"Error",description:"Failed to complete inspection",variant:"destructive"})}}),s=o=>o==="50_percent_ready"?"bg-yellow-500":"bg-green-500",i=o=>o==="50_percent_ready"?a.jsx(Hm,{className:"h-4 w-4"}):a.jsx($t,{className:"h-4 w-4"});return r?a.jsx("div",{className:"min-h-screen bg-slate-800 p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold text-amber-400 mb-6",children:"Admin Inspections"}),a.jsx("div",{className:"text-slate-300",children:"Loading pending inspections..."})]})}):a.jsx("div",{className:"min-h-screen bg-slate-800 p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-amber-400 mb-2",children:"Admin Inspections"}),a.jsx("p",{className:"text-slate-300",children:"Monitor job progress and complete required site inspections at 50% and 100% milestones"})]}),t.length===0?a.jsx(_e,{className:"bg-slate-700 border-slate-600",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx($t,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-slate-200 mb-2",children:"No Pending Inspections"}),a.jsx("p",{className:"text-slate-400",children:"All current jobs are either below 50% completion or have completed their required inspections."})]})}):a.jsx("div",{className:"space-y-4",children:t.map(o=>a.jsxs(_e,{className:"bg-slate-700 border-slate-600",children:[a.jsx(et,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[i(o.notificationType),a.jsxs("div",{children:[a.jsx(tt,{className:"text-slate-200 text-lg",children:o.inspectionType}),a.jsxs(mn,{className:"text-slate-400",children:["Job: ",o.jobTitle]})]})]}),a.jsx(De,{className:`${s(o.notificationType)} text-white`,children:o.notificationType.replace("_"," ").toUpperCase()})]})}),a.jsxs(Ae,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(Un,{className:"h-4 w-4 text-amber-400"}),a.jsxs("span",{children:["Contractor: ",o.contractorName]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(Pd,{className:"h-4 w-4 text-amber-400"}),a.jsxs("span",{children:["Location: ",o.jobLocation]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(xk,{className:"h-4 w-4 text-amber-400"}),a.jsxs("span",{children:["Triggered: ",new Date(o.createdAt).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex gap-3 pt-3",children:a.jsx(je,{onClick:()=>n.mutate(o.id),disabled:n.isPending,className:"bg-green-600 hover:bg-green-700",children:n.isPending?"Completing...":"Mark Inspection Complete"})})]})]},o.id))}),a.jsxs("div",{className:"mt-8 p-4 bg-slate-700 rounded-lg border border-slate-600",children:[a.jsx("h3",{className:"text-lg font-semibold text-amber-400 mb-2",children:"How It Works"}),a.jsxs("ul",{className:"text-slate-300 space-y-1 text-sm",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:"50% Inspection:"})," Triggered automatically when job reaches 50% completion"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"100% Inspection:"})," Triggered when job is marked as fully complete"]}),a.jsx("li",{children:' Click "Mark Inspection Complete" to confirm the inspection has been done'}),a.jsx("li",{children:" Use other admin tools for detailed site reports and quality assessments"})]})]})]})})}function s7(){const{id:e}=ww(),[,t]=DE(),[r,n]=b.useState([]),[s,i]=b.useState({}),[o,l]=b.useState({}),c=oa(),{data:u,isLoading:d}=rt({queryKey:[`/api/job-assignments/${e}`],enabled:!!e});b.useEffect(()=>{(async()=>{if(u)try{const h=new kb(u.contractorName,u.id),w=await(await fetch(`/api/task-progress/${encodeURIComponent(u.contractorName)}/${u.id}`)).json(),N=(await(await fetch("/api/uploaded-jobs")).json()).find(j=>{if(j.name===u.hbxlJob)return!0;if(j.name&&u.hbxlJob){const E=j.name.toLowerCase().replace(/\s+/g,""),k=u.hbxlJob.toLowerCase().replace(/\s+/g,"");if(E.includes("flat")&&k.includes("flat"))return!0}if(j.postcode&&u.workLocation){const E=j.postcode.split(" ")[0],k=u.workLocation.split(" ")[0];if(E===k)return!0}return!1});if(!N||!N.phaseTaskDataValue){console.log("No matching job found or no task data available");return}const S=JSON.parse(N.phaseTaskDataValue),C=[];w.forEach(j=>{if(j.completed===!0){const E=j.taskId.split("-"),k=E[0]+(E.length>2?" "+E.slice(1,-1).join(" "):""),F=parseInt(E[E.length-1]);if(console.log(" Processing completed task:",{taskId:j.taskId,expectedPhase:k,taskIndex:F,progressItem:j}),u.buildPhases.includes(k)&&S[k]){const M=S[k][F];M&&C.push({taskId:j.taskId,phase:k,taskName:M.task||M.description,description:j.taskDescription||M.description,progress:100,completed:!0,inspectionStatus:"pending",notes:"",photos:[]})}else C.push({taskId:j.taskId,phase:j.phase||k,taskName:j.taskDescription,description:j.taskDescription,progress:100,completed:!0,inspectionStatus:"pending",notes:"",photos:[]})}}),console.log(` Found ${C.length} tasks for inspection:`,C),n(C)}catch(h){console.error("Error loading completed tasks:",h),n([])}})()},[u]);const m=Tr({mutationFn:async()=>{const x=r.map(h=>({assignmentId:u.id,contractorName:u.contractorName,taskId:h.taskId,phase:h.phase,taskName:h.taskName,inspectionStatus:o[h.taskId]||"pending",notes:s[h.taskId]||"",inspectedBy:localStorage.getItem("adminName")||"Admin",inspectedAt:new Date().toISOString()}));return Ai("POST","/api/admin-inspections/batch",{inspections:x})},onSuccess:()=>{c.invalidateQueries({queryKey:["/api/admin-inspections"]}),t("/admin/job-assignments")}}),f=(x,h)=>{l(g=>({...g,[x]:h}))},p=(x,h)=>{i(g=>({...g,[x]:h}))};return d?a.jsx("div",{className:"min-h-screen bg-slate-800 flex items-center justify-center",children:a.jsx("div",{className:"text-amber-500",children:"Loading assignment details..."})}):u?a.jsxs("div",{className:"min-h-screen bg-slate-800 pb-20",children:[a.jsxs("div",{className:"bg-slate-900 p-4 flex items-center gap-3 border-b border-slate-700",children:[a.jsx(je,{variant:"ghost",size:"icon",onClick:()=>t("/admin/job-assignments"),className:"text-slate-400 hover:text-white",children:a.jsx(hk,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold text-white",children:" Assignment Overview"}),a.jsx("p",{className:"text-slate-400 text-sm",children:"Admin Site Inspection"})]})]}),a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs(_e,{className:"bg-slate-900 border-slate-700",children:[a.jsx(et,{children:a.jsxs(tt,{className:"text-amber-500 flex items-center gap-2",children:[a.jsx(us,{className:"h-5 w-5"}),"Assignment Overview"]})}),a.jsx(Ae,{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(Un,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{className:"text-slate-400",children:"Contractor:"}),a.jsx("span",{children:u.contractorName})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(Pd,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{className:"text-slate-400",children:"Location:"}),a.jsx("span",{children:u.workLocation})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(Mu,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{className:"text-slate-400",children:"Start Date:"}),a.jsx("span",{children:u.startDate})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[a.jsx(mk,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{className:"text-slate-400",children:"Status:"}),a.jsx(De,{variant:"secondary",className:"bg-blue-600 text-white",children:u.status}),a.jsx("span",{className:"text-slate-400",children:"Phases:"}),a.jsx(De,{variant:"outline",className:"border-amber-500 text-amber-500",children:u.buildPhases.length})]})]})})]}),a.jsxs(_e,{className:"bg-slate-900 border-slate-700",children:[a.jsx(et,{children:a.jsx(tt,{className:"text-amber-500 flex items-center gap-2",children:" Sub-Tasks Progress"})}),a.jsx(Ae,{children:r.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-400",children:[a.jsx("p",{children:"No completed tasks available for inspection yet."}),a.jsx("p",{className:"text-sm mt-2",children:"Tasks will appear here when contractors mark them as 100% complete."})]}):a.jsx("div",{className:"space-y-4",children:u.buildPhases.map(x=>{const h=r.filter(g=>g.phase===x);return h.length===0?null:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("h3",{className:"text-slate-200 font-medium",children:[x," (",h.length," tasks)"]})}),h.map(g=>a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-slate-200 font-medium",children:g.description}),a.jsx(De,{variant:"secondary",className:"bg-green-600 text-white",children:"100% Complete"})]}),a.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Qty: 1  Progress: 100%"})]},g.taskId))]},x)})})})]}),r.length>0&&a.jsxs(_e,{className:"bg-slate-900 border-slate-700",children:[a.jsx(et,{children:a.jsx(tt,{className:"text-amber-500 flex items-center gap-2",children:" Admin Task Reporting"})}),a.jsxs(Ae,{children:[a.jsxs("div",{className:"bg-blue-900/50 rounded-lg p-4 mb-4",children:[a.jsx("div",{className:"flex items-center gap-2 mb-2",children:a.jsx("div",{className:"text-blue-400 font-semibold",children:" New Task-Based Reporting"})}),a.jsxs("div",{className:"text-blue-200 text-sm space-y-1",children:[a.jsx("p",{children:"Use the task-level buttons below to add quick notes and photos for each specific task."}),a.jsxs("div",{className:"space-y-1 mt-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(us,{className:"h-3 w-3"}),a.jsx("span",{children:"Note button: Add quick observations per task"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xh,{className:"h-3 w-3"}),a.jsx("span",{children:"Photo button: Capture evidence per task (coming soon)"})]}),a.jsx("div",{className:"text-xs text-blue-300 mt-1",children:" More efficient than complex forms"})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[r.map(x=>a.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-600 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-slate-200 font-medium",children:x.description}),a.jsxs("p",{className:"text-sm text-slate-400",children:[x.phase,"  Qty: 1"]})]}),a.jsx(De,{variant:"secondary",className:"bg-green-600 text-white",children:"Ready for Inspection"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(je,{size:"sm",variant:o[x.taskId]==="approved"?"default":"outline",onClick:()=>f(x.taskId,"approved"),className:o[x.taskId]==="approved"?"bg-green-600 hover:bg-green-700 text-white":"border-green-600 text-green-400 hover:bg-green-600 hover:text-white",children:[a.jsx($t,{className:"h-4 w-4 mr-1"}),"Approve"]}),a.jsxs(je,{size:"sm",variant:o[x.taskId]==="issues"?"default":"outline",onClick:()=>f(x.taskId,"issues"),className:o[x.taskId]==="issues"?"bg-red-600 hover:bg-red-700 text-white":"border-red-600 text-red-400 hover:bg-red-600 hover:text-white",children:[a.jsx(ts,{className:"h-4 w-4 mr-1"}),"Issues Found"]}),a.jsxs(je,{size:"sm",variant:"outline",className:"border-slate-600 text-slate-400",children:[a.jsx(xh,{className:"h-4 w-4 mr-1"}),"Photo"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Inspection Notes"}),a.jsx(tc,{placeholder:"Add notes about this specific task...",value:s[x.taskId]||"",onChange:h=>p(x.taskId,h.target.value),className:"bg-slate-700 border-slate-600 text-slate-200 min-h-[80px]"})]})]},x.taskId)),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(je,{onClick:()=>m.mutate(),disabled:m.isPending,className:"flex-1 bg-amber-600 hover:bg-amber-700 text-white",children:m.isPending?"Submitting...":"Complete Inspection"}),a.jsx(je,{variant:"outline",onClick:()=>t("/admin/job-assignments"),className:"border-slate-600 text-slate-400",children:"Cancel"})]})]})]})]})]})]}):a.jsx("div",{className:"min-h-screen bg-slate-800 flex items-center justify-center",children:a.jsx("div",{className:"text-red-400",children:"Assignment not found"})})}function a7(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),{toast:s}=Tt(),i=async()=>{n(!0);try{const c=await(await fetch("/api/telegram/recent-messages?limit=20")).json();c.success?(t(c.messages||[]),s({title:"Messages Updated",description:`Found ${c.relevantCount} relevant messages from ${c.totalChecked} total`})):s({title:"Error",description:c.error||"Failed to fetch messages",variant:"destructive"})}catch{s({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{n(!1)}},o=async l=>{try{const u=await(await fetch("/api/send-onboarding-form",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:l,contractorPhone:"unknown"})})).json();u.success?s({title:"Onboarding Sent",description:`Sent onboarding form to ${l}`}):s({title:"Send Failed",description:u.error||"Failed to send onboarding form",variant:"destructive"})}catch{s({title:"Error",description:"Failed to send onboarding form",variant:"destructive"})}};return b.useEffect(()=>{i()},[]),a.jsx("div",{className:"min-h-screen bg-slate-800 p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Telegram Messages"}),a.jsx("p",{className:"text-slate-400",children:"Recent contractor communications"})]}),a.jsxs(je,{onClick:i,disabled:r,className:"bg-amber-600 hover:bg-amber-700",children:[a.jsx(Nk,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]}),e.length===0?a.jsx(_e,{className:"bg-slate-700 border-slate-600",children:a.jsxs(Ae,{className:"p-8 text-center",children:[a.jsx(Uu,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Recent Messages"}),a.jsx("p",{className:"text-slate-400",children:r?"Loading messages...":"No relevant messages found from contractors"})]})}):a.jsx("div",{className:"space-y-4",children:e.map((l,c)=>a.jsxs(_e,{className:"bg-slate-700 border-slate-600",children:[a.jsx(et,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(tt,{className:"text-white text-lg",children:[l.from.first_name,l.from.username&&a.jsxs("span",{className:"text-slate-400 font-normal ml-2",children:["@",l.from.username]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-slate-400",children:new Date(l.date).toLocaleString()}),a.jsxs(je,{size:"sm",onClick:()=>o(l.from.first_name),className:"bg-green-600 hover:bg-green-700",children:[a.jsx(h2,{className:"h-3 w-3 mr-1"}),"Send Form"]})]})]})}),a.jsxs(Ae,{children:[a.jsx("div",{className:"bg-slate-800 p-4 rounded-lg",children:a.jsx("p",{className:"text-white",children:l.text})}),a.jsxs("div",{className:"mt-3 text-xs text-slate-400",children:["Chat ID: ",l.chatId," | Message ID: ",l.messageId]})]})]},`${l.messageId}-${c}`))})]})})}function i7(){const[e,t]=b.useState(""),[r,n]=b.useState(""),[s,i]=b.useState(""),[o,l]=b.useState("normal"),[c,u]=b.useState(!1),[d,m]=b.useState(null),{toast:f}=Tt(),p=localStorage.getItem("userRole"),x=localStorage.getItem("adminName");if(p!=="admin")return a.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-400 mb-2",children:"Access Denied"}),a.jsx("div",{className:"text-slate-400",children:"Voice control is only available to administrators"})]})});const h=[{name:"Dalwayne Diedericks",phone:"+447123456789"},{name:"Mohamed guizeni",phone:"+447123456790"},{name:"SAID tiss",phone:"+447123456791"},{name:"Marius Andronache",phone:"+447123456792"}],g=S=>{t(S);const C=h.find(j=>j.name===S);C&&n(C.phone)},w=[{title:"Site Assignment",message:"You have been assigned to a new job site. Please report to {location} by {time}. Contact the office if you have any questions."},{title:"Emergency Alert",message:"URGENT: Please evacuate the site immediately due to safety concerns. Report to the assembly point and await further instructions."},{title:"Schedule Change",message:"Your work schedule has been updated. Please check your assignment details for the new timing and location."},{title:"Equipment Reminder",message:"Reminder: Please bring your safety equipment and tools to the job site tomorrow. Contact supervisor if you need any equipment."}],v=async()=>{if(!e||!r||!s){f({title:"Missing Information",description:"Please select a contractor, phone number, and message.",variant:"destructive"});return}u(!0);try{const C=await(await fetch("/api/voice/call-contractor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:e,phoneNumber:r,message:s,type:o})})).json();m(C),C.success?f({title:"Call Initiated",description:`Voice call successfully sent to ${e}`}):f({title:"Call Failed",description:C.message,variant:"destructive"})}catch(S){console.error("Voice call error:",S),f({title:"Error",description:"Failed to initiate voice call",variant:"destructive"})}finally{u(!1)}},y=async()=>{if(!e){f({title:"Missing Information",description:"Please select a contractor.",variant:"destructive"});return}u(!0);try{const S={title:"Promise Bram Construction",location:"Bramling, CT15 7PG",startDate:new Date().toISOString()},j=await(await fetch("/api/voice/notify-assignment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:e,jobDetails:S})})).json();m(j),j.success?f({title:"Assignment Notification Sent",description:`Job assignment call sent to ${e}`}):f({title:"Notification Failed",description:j.message,variant:"destructive"})}catch(S){console.error("Assignment notification error:",S),f({title:"Error",description:"Failed to send assignment notification",variant:"destructive"})}finally{u(!1)}},N=async S=>{if(!e){f({title:"Missing Information",description:"Please select a contractor.",variant:"destructive"});return}u(!0);try{const j=await(await fetch("/api/voice/clock-action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractorName:e,action:S,location:"Bramling, CT15 7PG"})})).json();m(j),j.success?f({title:`Clock ${S.toUpperCase()} Successful`,description:j.message}):f({title:`Clock ${S.toUpperCase()} Failed`,description:j.message,variant:"destructive"})}catch(C){console.error("Clock action error:",C),f({title:"Error",description:`Failed to process clock ${S}`,variant:"destructive"})}finally{u(!1)}};return a.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[a.jsxs("div",{className:"bg-slate-800 px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center",children:a.jsx("i",{className:"fas fa-microphone text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:"Voice Agent Control"}),a.jsx("div",{className:"text-xs text-slate-400",children:"Twilio Voice Integration"})]})]}),a.jsxs(De,{variant:"default",className:"bg-green-600",children:["Admin: ",x]})]}),a.jsxs("div",{className:"p-4 pb-20",children:[a.jsx("h1",{className:"text-2xl font-bold text-green-400 mb-6",children:"Voice Agent Dashboard"}),a.jsxs(_e,{className:"bg-slate-800 border-slate-600 mb-6",children:[a.jsxs(et,{children:[a.jsx(tt,{className:"text-green-400",children:"Select Contractor"}),a.jsx(mn,{children:"Choose contractor for voice interaction"})]}),a.jsxs(Ae,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"contractor",children:"Contractor"}),a.jsxs(Gu,{value:e,onValueChange:g,children:[a.jsx(Rl,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsx(Ku,{placeholder:"Select contractor..."})}),a.jsx(Il,{children:h.map(S=>a.jsx(Ii,{value:S.name,children:S.name},S.name))})]})]}),a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"phone",children:"Phone Number"}),a.jsx(qr,{id:"phone",value:r,onChange:S=>n(S.target.value),placeholder:"+447123456789",className:"bg-slate-700 border-slate-600 text-white","data-testid":"input-phone"})]})]})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-600 mb-6",children:[a.jsxs(et,{children:[a.jsx(tt,{className:"text-green-400",children:"Voice Message"}),a.jsx(mn,{children:"Send custom voice messages to contractors"})]}),a.jsxs(Ae,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"message-type",children:"Message Type"}),a.jsxs(Gu,{value:o,onValueChange:l,children:[a.jsx(Rl,{className:"bg-slate-700 border-slate-600 text-white",children:a.jsx(Ku,{})}),a.jsxs(Il,{children:[a.jsx(Ii,{value:"normal",children:"Normal Call"}),a.jsx(Ii,{value:"emergency",children:"Emergency Alert"})]})]})]}),a.jsxs("div",{children:[a.jsx(xn,{htmlFor:"message",children:"Message"}),a.jsx(tc,{id:"message",value:s,onChange:S=>i(S.target.value),placeholder:"Enter your voice message...",className:"bg-slate-700 border-slate-600 text-white min-h-[100px]","data-testid":"input-message"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(xn,{children:"Quick Messages"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:w.map((S,C)=>a.jsx(je,{variant:"outline",size:"sm",onClick:()=>i(S.message),className:"text-left justify-start bg-slate-700 border-slate-600 hover:bg-slate-600 text-white",children:S.title},C))})]}),a.jsx(je,{onClick:v,disabled:c,className:"w-full bg-green-600 hover:bg-green-700 text-white","data-testid":"button-send-voice",children:c?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Sending Call..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-phone mr-2"}),"Send Voice Call"]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[a.jsxs(_e,{className:"bg-slate-800 border-slate-600",children:[a.jsxs(et,{children:[a.jsx(tt,{className:"text-blue-400",children:"Job Assignment"}),a.jsx(mn,{children:"Send automated job assignment calls"})]}),a.jsx(Ae,{children:a.jsxs(je,{onClick:y,disabled:c,className:"w-full bg-blue-600 hover:bg-blue-700","data-testid":"button-job-assignment",children:[a.jsx("i",{className:"fas fa-briefcase mr-2"}),"Send Job Assignment"]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-600",children:[a.jsxs(et,{children:[a.jsx(tt,{className:"text-yellow-400",children:"Clock Actions"}),a.jsx(mn,{children:"Test clock in/out functionality"})]}),a.jsxs(Ae,{className:"space-y-2",children:[a.jsxs(je,{onClick:()=>N("in"),disabled:c,className:"w-full bg-yellow-600 hover:bg-yellow-700","data-testid":"button-clock-in",children:[a.jsx("i",{className:"fas fa-clock mr-2"}),"Test Clock In"]}),a.jsxs(je,{onClick:()=>N("out"),disabled:c,className:"w-full bg-orange-600 hover:bg-orange-700","data-testid":"button-clock-out",children:[a.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Test Clock Out"]})]})]})]}),d&&a.jsxs(_e,{className:"bg-slate-800 border-slate-600",children:[a.jsxs(et,{children:[a.jsx(tt,{className:"text-purple-400",children:"Last Response"}),a.jsx(mn,{children:"Voice agent response data"})]}),a.jsx(Ae,{children:a.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(De,{variant:d.success?"default":"destructive",className:"mr-2",children:d.success?"Success":"Failed"}),a.jsx("span",{className:"text-sm text-slate-400",children:new Date().toLocaleTimeString()})]}),a.jsx("p",{className:"text-white mb-2",children:d.message}),d.data&&a.jsxs("details",{className:"text-xs text-slate-400",children:[a.jsx("summary",{className:"cursor-pointer",children:"Response Data"}),a.jsx("pre",{className:"mt-2 overflow-x-auto",children:JSON.stringify(d.data,null,2)})]})]})})]}),a.jsxs(_e,{className:"bg-slate-800 border-slate-600 mt-6",children:[a.jsx(et,{children:a.jsx(tt,{className:"text-cyan-400",children:"How Voice Agents Work"})}),a.jsxs(Ae,{className:"space-y-3 text-sm text-slate-300",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("i",{className:"fas fa-phone text-cyan-400 mr-3 mt-1"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Incoming Calls:"})," Contractors can call your Twilio number and use voice commands. Press 1 for clock in, 2 for clock out, 3 for assignment info, 4 for earnings."]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("i",{className:"fas fa-robot text-cyan-400 mr-3 mt-1"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Data Access:"})," Voice agents have full access to contractor data, work sessions, pay rates, job assignments, and can execute tasks automatically."]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("i",{className:"fas fa-microphone text-cyan-400 mr-3 mt-1"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Outgoing Calls:"})," Use this dashboard to send voice messages, job assignments, and emergency alerts to contractors automatically."]})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("i",{className:"fas fa-database text-cyan-400 mr-3 mt-1"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Real-time Updates:"})," All voice actions update the database immediately, including clock in/out times, assignment confirmations, and contractor responses."]})]})]})]})]})]})}function o7(){return a.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:a.jsx(_e,{className:"w-full max-w-md mx-4",children:a.jsxs(Ae,{className:"pt-6",children:[a.jsxs("div",{className:"flex mb-4 gap-2",children:[a.jsx(Bu,{className:"h-8 w-8 text-red-500"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),a.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function lt({children:e,requiredRole:t}){return b.useEffect(()=>{const r=localStorage.getItem("isLoggedIn"),n=localStorage.getItem("userRole");if(!r){window.location.href="/login";return}if(t&&n!==t){n==="admin"?window.location.href="/admin":n==="contractor"?window.location.href="/":window.location.href="/login";return}},[t]),a.jsx(a.Fragment,{children:e})}function l7(){const e=localStorage.getItem("userRole"),t=localStorage.getItem("adminName"),r=localStorage.getItem("contractorName");return console.log(" RoleBased Debug:",{userRole:e,adminName:t,contractorName:r,allLocalStorage:Object.fromEntries(Object.entries(localStorage))}),e==="admin"?(console.log(` Admin access for: ${t}`),a.jsx(Th,{})):e==="contractor"?(console.log(` Contractor access for: ${r}`),a.jsx(tA,{})):(console.log(" No valid role found, redirecting to login"),window.location.href="/login",a.jsx("div",{children:"Redirecting..."}))}function c7(){return a.jsx("div",{className:"relative",children:a.jsxs(ME,{children:[a.jsx(Je,{path:"/login",component:IA}),a.jsx(Je,{path:"/",component:()=>a.jsx(lt,{children:a.jsx(l7,{})})}),a.jsx(Je,{path:"/upload",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(oA,{})})}),a.jsx(Je,{path:"/admin",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Th,{})})}),a.jsx(Je,{path:"/admin-dashboard",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Th,{})})}),a.jsx(Je,{path:"/admin-task-monitor",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Z6,{})})}),a.jsx(Je,{path:"/contractor-onboarding",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(uA,{})})}),a.jsx(Je,{path:"/admin-applications",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(FA,{})})}),a.jsx(Je,{path:"/contractor-form",component:dA}),a.jsx(Je,{path:"/contractor-success",component:fA}),a.jsx(Je,{path:"/jobs",component:()=>a.jsx(lt,{requiredRole:"contractor",children:a.jsx(rA,{})})}),a.jsx(Je,{path:"/task-progress",component:()=>a.jsx(lt,{requiredRole:"contractor",children:a.jsx(DA,{})})}),a.jsx(Je,{path:"/more",component:()=>a.jsx(lt,{requiredRole:"contractor",children:a.jsx(aF,{})})}),a.jsx(Je,{path:"/foreman",component:()=>a.jsx(lt,{requiredRole:"contractor",children:a.jsx(Q6,{})})}),a.jsx(Je,{path:"/job-assignments",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Mg,{})})}),a.jsx(Je,{path:"/admin/job-assignments",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Mg,{})})}),a.jsx(Je,{path:"/system-cleanup",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(tR,{})})}),a.jsx(Je,{path:"/create-assignment",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(nR,{})})}),a.jsx(Je,{path:"/payroll-overview",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(YM,{})})}),a.jsx(Je,{path:"/live-clock-monitor",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(qM,{})})}),a.jsx(Je,{path:"/contractor-id-capture",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(QM,{})})}),a.jsx(Je,{path:"/admin-settings",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(n7,{})})}),a.jsx(Je,{path:"/admin-inspections",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Bv,{})})}),a.jsx(Je,{path:"/admin-inspection/:id",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(s7,{})})}),a.jsx(Je,{path:"/admin-telegram",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(a7,{})})}),a.jsx(Je,{path:"/admin-site-inspections",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(Bv,{})})}),a.jsx(Je,{path:"/voice-control",component:()=>a.jsx(lt,{requiredRole:"admin",children:a.jsx(i7,{})})}),a.jsx(Je,{component:o7})]})})}function u7(){return a.jsx(sC,{client:io,children:a.jsxs(R3,{children:[a.jsx(o_,{}),a.jsx(c7,{})]})})}uw(document.getElementById("root")).render(a.jsx(u7,{}));export{ab as W};
